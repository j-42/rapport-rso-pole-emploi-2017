"use strict";!function(e){function t(e){var n={};if(e.hasChildNodes()){for(var i,a,r,o="",s=e.childNodes.length,l=0;l<s;l++)i=e.childNodes.item(l),3===(i.nodeType-1|1)?o+=3===i.nodeType?i.nodeValue.trim():i.nodeValue:1!==i.nodeType||i.prefix||(a=i.nodeName,r=t(i),n.hasOwnProperty(a)?(n[a].constructor!==Array&&(n[a]=[n[a]]),n[a].push(r)):n[a]=r);o&&(n.keyValue=o)}if("undefined"!=typeof e.hasAttributes&&e.hasAttributes())for(var u,c=e.attributes.length,p=0;p<c;p++)u=e.attributes.item(p),n["@"+u.name]=u.value;return n}e.JXONTree=t}(webpublicationNamespace),function(e){function t(e){e=e.split("/");for(var t=[],n=1;n<e.length;n+=2)t[e[n]]=e[n+1];return t}function n(e){return e.split("/")[0]}e.API={debugDisable:function(){return e.Utils._assertDebug(!1)},debugEnable:function(){return e.Utils._assertDebug(!0)},debugGetState:function(){return e.Utils._assertDebug()},debugToggle:function(){return e.Utils._assertDebug(!e.Utils._assertDebug())},deviceType:function(){return e.Param.userAgent.device.type},lightboxClose:function(){e.Class.LightboxManagerNew.closeAll()},lightboxOpen:function(t){new e.Class.LightboxManagerNew({id:"api-iframe",title:t.title,header:"false"===t.header?"none":"visible",url:e.Utils.resolveVariable(decodeURIComponent(t.url))})},menuClose:function(){return e.Main.menuManager.hideMenu()},menuOpen:function(){return e.Main.menuManager.showMenu()},menuToggle:function(){return e.Main.menuManager.toggleMenu()},pageCount:function(){return e.Utils.prodTools.getPageLength()},pageLoad:function(t){if(t.number)return!!e.Utils._assertInteger(t.number,"[pageLoad] The number argument must be an integer")&&(e.Main.viewerManager.goToPage(t.number),!0);if(t.name){if("next"===t.name)e.Main.viewerManager.scrollFrame("next");else if("previous"===t.name||"prev"===t.name)e.Main.viewerManager.scrollFrame("prev");else if("first"===t.name)e.Main.viewerManager.goToPage(1);else{if("last"!==t.name)return!1;e.Main.viewerManager.goToPage(e.Utils.prodTools.getPageLength())}return!0}return e.Utils._assert(!1,"[pageLoad] The argument is missing or incorrect"),!1},broadcast:function(t){if(e.Utils._assertOneOf(t.mode,["all","others"],"Mode must be 'all' or 'others'")&&e.Utils._assertJson(t.data,"Data must be a valid json string")){var n="others"===t.mode&&this,i=JSON.parse(t.data);return i.type="broadcast",e.Main.linksManagerNew.linksBroadcast(t.mode,i,n),!0}return!1},linkClick:function(){var t=e.Main.xmlManager.get("common-configuration","config","pageCount");return function(n){return!(!e.Utils._assertInteger(n.page,"Page number must be an integer")||!e.Utils._assertInteger(n.index,"Link index must be an integer"))&&void(n.page>0&&n.page<=t&&n.index>=0&&e.Main.linksManagerNew.linkClick(n.page,{index:n.index}))}}(),welcomepageOpen:function(){var t=e.Main.startupManager.get("startup.welcomepage.url");return!!t&&(e.Main.trackerManager.trackPage({name:"welcomepage"}),new e.Class.LightboxManagerNew({animation:"none",header:"none",id:"startupPanel",url:e.Utils.resolveVariable(t)}),!0)},pdfDownload:function(){e.Main.pdfManager.download()},pdfPrint:function(){e.Main.pdfManager.print()},pdfGetUrl:function(t){return e.Param.pathRoot+"contents/pdfweb.pdf"},share:function(t){if("mail"===t.network||"email"===t.network){var n=e.Main.menuService.get("email_btn");return!!n&&(n.onload(),n.onclick(),!0)}return e.Main.shareManager.shareSocial(t.network,!0)},shareOpen:function(t){return e.Main.shareManager.open("home")},shareClose:function(t){return e.Main.shareManager.close()},searchOpen:function(){var t=e.Main.menuService.get("search_btn");return t.onload(),t.onclick(),!0},thumbnailOpen:function(){var t=e.Main.menuService.get("thumbnails_btn");return t.onload(),t.onclick(),!0},viewportGetScale:function(){return e.Starter.defaultViewportScale},menuButtonClick:function(t){return e.Main.menuManager.callButtonClick(t.name)},pageCurrent:function(){return e.Utils.getVisiblePages()}},window.addEventListener("message",function(i){if("string"==typeof i.data){var a=n(i.data),r=t(i.data);if(e.API.hasOwnProperty(a)){var o=e.API[a].call(i.source,r);i.source&&i.source.postMessage({method:a,arguments:r,result:o,queryId:r.queryId},i.origin)}}},!1)}(webpublicationNamespace),function(e){e.Class.CanvasViewerManager=function(){function t(e,t,n,i,a,r){if("undefined"==typeof r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{var o={tl:0,tr:0,br:0,bl:0};for(var s in o)r[s]=r[s]||o[s]}e.beginPath(),e.moveTo(t+r.tl,n),e.lineTo(t+i-r.tr,n),e.quadraticCurveTo(t+i,n,t+i,n+r.tr),e.lineTo(t+i,n+a-r.br),e.quadraticCurveTo(t+i,n+a,t+i-r.br,n+a),e.lineTo(t+r.bl,n+a),e.quadraticCurveTo(t,n+a,t,n+a-r.bl),e.lineTo(t,n+r.tl),e.quadraticCurveTo(t,n,t+r.tl,n),e.closePath(),e.fill(),e.stroke()}function n(e,t){var n=e+w.deltaFrameInDOM;if("undefined"!=typeof g[n])if(g[n].backgroundColors=t,t!==!1)for(var i=t.length,a=((g[n].dom.width-b*i)/2,g[n].dom.width/i),r=null,o=null,s=0;s<i;s++)r=s*a,o=a,"transparent"!==t[s]?(g[n].ctx.fillStyle=t[s],g[n].ctx.fillRect(r,0,o,g[n].dom.height)):g[n].ctx.clearRect(r,0,o,g[n].dom.height);else g[n].ctx.fillStyle=w.pageBgColor,g[n].ctx.fillRect(0,0,g[n].dom.width,g[n].dom.height)}function i(e,t,n,i){var a=t+w.deltaFrameInDOM,r=1;0===t&&(w.pagesRetina&&(r*=w.maxZoom),i&&(r*=w.zoomScale)),g[a].ctx.drawImage(e,n*r,E*r,b*r,y*r)}function a(e,t){var n=t.coord.width,i=t.coord.height,a=t.width/t.height,r=n/i;a>r?i=n/a:n=i*a;var o;if("CANVAS"===e.tagName.toUpperCase())o=e.getContext("2d");else{var s=document.createElement("canvas");o=s.getContext("2d"),s.width=e.width,s.height=e.height,o.drawImage(e,0,0,s.width,s.height),s.pageNumber=e.pageNumber,e=s}var l=e.width/t.coord.container.width,u=e.height/t.coord.container.height;return o.globalAlpha=1,o.drawImage(t,P(t.coord.x*l),P(t.coord.y*u),P(n*l),P(i*u)),e}function r(n,i){var a;if("CANVAS"===n.tagName.toUpperCase())a=n.getContext("2d");else{var r=document.createElement("canvas");a=r.getContext("2d"),r.width=n.width,r.height=n.height,a.drawImage(n,0,0,r.width,r.height),r.pageNumber=n.pageNumber,n=r}var o=n.width/i.container.width,s=n.height/i.container.height;return a.globalAlpha=.2,a.fillStyle=e.Main.cssManager.getStyle("secondary","linkBackgroundColor"),a.strokeStyle=e.Main.cssManager.getStyle("secondary","linkColor"),"rect"===i.type?(a.fillRect(i.x*o,i.y*s,i.w*o,i.h*s),a.stroke()):"circle"===i.type?(a.beginPath(),a.ellipse(i.x*o,i.y*s,i.w*o/2,i.h*s/2,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke()):"roundrect"===i.type?t(a,i.x*o,i.y*s,i.w*o,i.h*s,i.radius):"roundrectcomplex"===i.type&&t(a,i.x*o,i.y*s,i.w*o,i.h*s,{tl:i.tl_radius,tr:i.tr_radius,br:i.br_radius,bl:i.bl_radius}),n}function o(e){b=e.width,y=e.height,E=e.top,M=e.left}function s(){var t=1*w.zoomScale;w.pagesRetina&&(t*=w.maxZoom),g[w.deltaFrameInDOM].dom.width=d*t,g[w.deltaFrameInDOM].dom.height=m*t,g[w.deltaFrameInDOM].dom.style.width=d*t+"px",g[w.deltaFrameInDOM].dom.style.height=m*t+"px",n(0,g[w.deltaFrameInDOM].backgroundColors),e.Utils.scaleDom3d(g[w.deltaFrameInDOM].dom,1/t,0,0)}function l(){var t=1;w.pagesRetina&&(t*=w.maxZoom),g[w.deltaFrameInDOM].dom.width=d*t,g[w.deltaFrameInDOM].dom.height=m*t,g[w.deltaFrameInDOM].dom.style.width=d*t+"px",g[w.deltaFrameInDOM].dom.style.height=m*t+"px",n(0,g[w.deltaFrameInDOM].backgroundColors),e.Utils.scaleDom3d(g[w.deltaFrameInDOM].dom,1/t,0,0)}function u(){d=window.innerWidth,m=window.innerHeight;for(var t,n=g.length;n--;)t=g[n],w.verticalSlider?t.dom.style.top=n*m+"px":t.dom.style.left=n*d+"px",w.pagesRetina&&"webpub-viewer__canvas-0"===t.dom.id?(t.dom.width=d*w.maxZoom,t.dom.height=m*w.maxZoom,t.dom.style.width=d*w.maxZoom+"px",t.dom.style.height=m*w.maxZoom+"px",e.Utils.scaleDom3d(t.dom,1/w.maxZoom,0,0)):(t.dom.width=d,t.dom.height=m,t.dom.style.width=d+"px",t.dom.style.height=m+"px")}function c(){for(var e,t=-w.deltaFrameInDOM;t<=w.deltaFrameInDOM;)e=document.createElement("canvas"),e.className="webpub-viewer__canvas",e.id="webpub-viewer__canvas-"+t,w.container.appendChild(e),g[t+w.deltaFrameInDOM]={dom:e,ctx:e.getContext("2d")},t++}function p(e){d=window.innerWidth,m=window.innerHeight;var t;for(t in e)"undefined"!=typeof w[t]&&(w[t]=e[t]);w.zoomScale=Math.max(1,parseFloat(w.zoomScale,10)),w.maxZoom=Math.max(1,parseFloat(w.maxZoom,10));var n=1*w.zoomScale;w.pagesRetina&&(n*=w.maxZoom);var i=Math.max(d*n,m*n);i>4095&&(w.zoomScale=w.zoomScale/(i/4095)),v&&u()}function h(e){p(e||{}),c(),v=!0}var d=0,m=0,f=Math,g=[],v=!1,b=0,y=0,E=0,M=0,P=function(e,t){var n=t?f.pow(10,t):1;return f.round(e*n)/n},w={deltaFrameInDOM:1,pagesInFrame:1,pagesRetina:!0,pageShadowSize:0,maxZoom:2.5,zoomScale:1.5,pageBgColor:"rgb(240, 240, 240, 0)",useBgColorPerPage:!0,verticalSlider:!1,container:null};return{init:h,setConfig:p,clearDomFrame:n,addImageIntoPageDom:a,addLinkBoxIntoPageDom:r,visualizePageAtFrame:i,zoomIn:s,zoomOut:l,setPageSize:o,onResize:u}}}(webpublicationNamespace),function(e){e.Class.EventEmul=function(){var t=function(){this.funcListStockCallBack={}},n=t.prototype;return n.callEvent=function(){var e=null;return function(t){if(!this.existEvent(t))return!1;var n=this.funcListStockCallBack[t+"CallBackList"];e=Array.prototype.slice.call(arguments,1);for(var i in n)n[i].apply(this,e);return!1}}(),n.unbindEvent=function(){var e=null;return function(t){if(e=t+"CallBackList",this.funcListStockCallBack[e]){for(var n in this.funcListStockCallBack[e])this.funcListStockCallBack[e][n]=null,delete this.funcListStockCallBack[e][n];delete this.funcListStockCallBack[e]}return!1}}(),n.unbindById=function(){return function(e,t){return methodCallbackName=e+"CallBackList",this.funcListStockCallBack[methodCallbackName]&&this.funcListStockCallBack[methodCallbackName][t]&&(this.funcListStockCallBack[methodCallbackName][t]=null,delete this.funcListStockCallBack[methodCallbackName][t]),!1}}(),n.existEvent=function(){return function(e){return!(!this.funcListStockCallBack[e+"CallBackList"]||!Object.keys(this.funcListStockCallBack[e+"CallBackList"]).length)}}(),n.listenEvent=function(){var t=null,n=null;return function(i,a){return t=i+"CallBackList",n=e.Utils.uniqueId(),this.funcListStockCallBack[t]||(this.funcListStockCallBack[t]={}),this.funcListStockCallBack[t][n]=a,n}}(),t}()}(webpublicationNamespace),function(e){function t(){e.Main.trackerManager.trackEvent({name:"fullScreenOn"})}function n(){this.config={isFullScreen:!1,hasFullScreen:a()},i(),this.fullScreenListeners()}function i(){if(!o)for(var e=0,t=u.length;e<t;e++)if("undefined"!=typeof document.documentElement[c[e]])return r=u[e],o=c[e],s=p[e],void(l=h[e])}function a(){return!(navigator.userAgent.toLowerCase().indexOf("samsung")>-1)&&!!(document.documentElement.requestFullscreen&&document.cancelFullScreen||document.documentElement.webkitRequestFullscreen&&document.webkitCancelFullScreen||document.documentElement.mozRequestFullScreen&&document.mozCancelFullScreen||document.documentElement.msRequestFullscreen&&document.msExitFullscreen||e.Main.urlManager.get("integration"))}var r,o,s,l,u=["fullscreenchange","MSFullscreenChange","mozfullscreenchange","webkitfullscreenchange"],c=["requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen"],p=["cancelFullScreen","msCancelFullscreen","mozCancelFullScreen","webkitCancelFullScreen"],h=["fullScreen","msFullscreenElement","mozFullScreen","webkitIsFullScreen"];n.prototype.fullScreenListeners=function(){var e=this;void 0!==r&&document.addEventListener(r,function(t){e.config.isFullScreen=document[l]||!1},!1)},n.prototype.hasFullScreen=function(){return this.config.hasFullScreen},n.prototype.isFullScreen=function(){return this.config.isFullScreen},n.prototype.fullScreenOff=function(){this.config.isFullScreen&&(e.Main.urlManager.get("integration")?(parent.postMessage("wp.fullscreenOff","*"),this.config.isFullScreen=!1):s&&document[l]&&document[s]())},n.prototype.fullScreenOn=function(){this.config.hasFullScreen&&(e.Main.urlManager.get("integration")?(parent.postMessage("wp.fullscreenOn","*"),t(),this.config.isFullScreen=!0):o&&(0===o.indexOf("webkit")?document.documentElement[o](Element.ALLOW_KEYBOARD_INPUT):document.documentElement[o]()))},n.prototype.fullScreenToggle=function(){this.config.isFullScreen?this.fullScreenOff():this.fullScreenOn()},e.Class.FullScreenManager=n}(webpublicationNamespace),function(e){e.Class.HtmlViewerManager=function(){function t(e,t,n){var i=document.createElement("div");return i.style.width=e+"px",i.style.height=t+"px","undefined"==typeof n&&(n=5),"number"==typeof n?i.style.borderRadius=n+"px":"string"==typeof n?i.style.borderRadius=n:(i.style.borderTopLeftRadius=(n.tl||0)+"px",i.style.borderTopRightRadius=(n.tr||0)+"px",i.style.borderBottomRightRadius=(n.br||0)+"px",i.style.borderBottomLeftRadius=(n.bl||0)+"px"),i}function n(e,t){var n=v[e+w.deltaFrameInDOM];if("undefined"!=typeof n)if(n.innerHTML="",t===!1)n.style.background=w.pageBgColor;else if(1==t.length)n.style.background=t[0];else{var i=(parseInt(n.style.width)-t.length*y)/2,a="linear-gradient(90deg";for(var r in t){var o=r>0,s=r==t.length-1,l=r*y+(o?i:0),u=l+y+i+(s?i:0),c=t[r];a+=","+c+" "+l+"px",a+=","+c+" "+u+"px"}a+=")",n.style.background=a}}function i(t,n,i,a){!function(){var e=v[n+w.deltaFrameInDOM].querySelectorAll("[data-pageNumber='"+t.pageNumber+"']");if(e.length>0)for(var i=0;i<e.length;i++)e[i].parentNode.removeChild(e[i])}();var r=Math.round;e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.CHROME&&(r=Math.ceil),r=function(e){return e},t.style.left=r(i)+"px",t.style.top=Math.floor(M)+"px","IMG"===t.tagName.toUpperCase()?t.classList.add("webpub-viewer__page-img"):"DIV"===t.tagName.toUpperCase()&&t.classList.add("webpub-viewer__page-container");var o=1;if("svg"===t.tagName&&(o=e.Main.xmlManager.get("common-configuration","contents","swf","height")/parseFloat(t.getAttribute("height"),10)),0===n&&a){var s=e.Main.viewerManager.getScale()*w.zoomScale;e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.CHROME&&(s=1),t.style.width=r(o*y*s)+"px",t.style.height=r(E*s)+"px",t.classList.remove("not-zoomed"),e.Utils.scaleDom3d(t,1/s,1/s,0)}else t.style.width=r(o*y)+"px",t.style.height=r(E)+"px",t.classList.add("not-zoomed"),e.Utils.resetDomTransform(t);if("svg"===t.tagName){var l=t.querySelector("image");l.style.display="none";var u=document.createElement("img");u.src=l.getAttribute("xlink:href"),u.style.position="absolute",u.style.height=t.style.height,u.style.width=t.style.width,u.style.left=t.style.left,u.style.top=t.style.top,u.setAttribute("data-pageNumber",t.getAttribute("data-pageNumber")),v[n+w.deltaFrameInDOM].appendChild(u)}v[n+w.deltaFrameInDOM].appendChild(t)}function a(e){var t=v.filter(function(t){var n=Array.prototype.map.call(t.querySelectorAll("svg"),function(e){return parseInt(e.getAttribute("data-pageNumber"),10)});return JSON.stringify(n)===JSON.stringify(e)})[0];if("undefined"==typeof t)return!1;var n=v.filter(function(e){return"webpub-viewer__frame-0"===e.id})[0],i=t.id;t.id="webpub-viewer__frame-0",n.id=i,v=v.sort(function(e,t){var n=parseInt(e.id.replace("webpub-viewer__frame-",""),10),i=parseInt(t.id.replace("webpub-viewer__frame-",""),10);return n-i});for(var a=0;v[a]!==t;)t.parentNode.insertBefore(v[a],t),a++;for(a++;v[a];)v[0].parentNode.appendChild(v[a]),a++;return p(),!0}function r(e){var t=document.createElement("div");return t.classList.add("webpub-viewer__page-container"),t.style.width=e.style.width,t.style.height=e.style.height,t.style.left=e.style.left,t.style.top=e.style.top,t.pageNumber=e.pageNumber,e.style="",e.parentNode&&e.parentNode.removeChild(e),t.appendChild(e),t}function o(e,t){return"IMG"===e.tagName.toUpperCase()&&(e=r(e)),t.classList.add("webpub-viewer__page-link-image"),t.classList.add("webpub-viewer__link"+t.idLink),t.style.width=100*t.coord.width/t.coord.container.width+"%",t.style.height=100*t.coord.height/t.coord.container.height+"%",t.style.left=100*t.coord.x/t.coord.container.width+"%",t.style.top=100*t.coord.y/t.coord.container.height+"%",e.appendChild(t),e}function s(n,i){"IMG"===n.tagName.toUpperCase()&&(n=r(n)),n.classList.add("webpub-viewer__page-container");var a,o=parseInt(n.style.width),s=parseInt(n.style.height),l=o/i.container.width,u=s/i.container.height,c=i.w*l*100/o+"%",p=i.h*u*100/s+"%";return"rect"===i.type?a=t(c,p):"circle"===i.type?a=t(c,p,"50%"):"roundrect"===i.type?a=t(c,p,i.radius):"roundrectcomplex"===i.type&&(a=t(c,p,{tl:i.tl_radius,tr:i.tr_radius,br:i.br_radius,bl:i.bl_radius})),a.classList.add("webpub-viewer__page-link-dom"),a.classList.add("webpub-viewer__link"+i.id),a.style.border="1px solid "+e.Main.cssManager.getStyle("secondary","linkColor"),a.style.backgroundColor=e.Main.cssManager.getStyle("secondary","linkBackgroundColor"),a.style.left=i.x*l*100/o+"%",a.style.top=i.y*u*100/s+"%",n.appendChild(a),n}function l(e){y=e.width,E=e.height,M=e.top,P=e.left}function u(){}function c(){}function p(){f=window.innerWidth,g=window.innerHeight;for(var e,t=v.length;t--;)e=v[t],w.verticalSlider?e.style.top=t*g+"px":e.style.left=t*f+"px",e.style.width=f+"px",e.style.height=g+"px"}function h(){for(var e,t=-w.deltaFrameInDOM;t<=w.deltaFrameInDOM;)e=document.createElement("div"),e.className="webpub-viewer__frame-container",e.id="webpub-viewer__frame-"+t,w.container.appendChild(e),v[t+w.deltaFrameInDOM]=e,t++}function d(e){var t;for(t in e)"undefined"!=typeof w[t]&&(w[t]=e[t]);b&&p()}function m(e){d(e||{}),h(),b=!0}var f=0,g=0,v=(Math,[]),b=!1,y=0,E=0,M=0,P=0,w={deltaFrameInDOM:1,pagesInFrame:1,pagesRetina:!0,pageShadowSize:0,maxZoom:2.5,zoomScale:2,pageBgColor:"rgb(240, 240, 240, 0)",useBgColorPerPage:!0,verticalSlider:!1,container:null};return{init:m,setConfig:d,clearDomFrame:n,addImageIntoPageDom:o,addLinkBoxIntoPageDom:s,visualizePageAtFrame:i,zoomIn:u,zoomOut:c,setPageSize:l,onResize:p,setActiveFromPages:a}}}(webpublicationNamespace),function(e){function t(t,n){var i=t.querySelectorAll("[data-action='close']");i=Array.prototype.slice.call(i),t.hasAttribute("data-action")&&"close"===t.getAttribute("data-action")&&i.push(t);for(var a=0;a<i.length;a++)i[a].addEventListener(e.Param.eventClick,v.close.bind(null,n))}function n(t){var n=t.querySelectorAll("[data-action='menu']");n=Array.prototype.slice.call(n),t.hasAttribute("data-action")&&"menu"===t.getAttribute("data-action")&&n.push(t);for(var i=0;i<n.length;i++)n[i].addEventListener(e.Param.eventClick,NIApi.menu.toggle.bind(null))}function i(t){var n=t.querySelectorAll("[data-section='headerIcon']");n=Array.prototype.slice.call(n),t.hasAttribute("data-action")&&n.push(t);for(var i=0;i<n.length;i++)n[i].addEventListener(e.Param.eventClick,function(t){e.API.menuButtonClick({name:t})}.bind({},n[i].getAttribute("data-action")))}function a(t,n){if(this.params.disableOverlay!==!0){var i=t.querySelectorAll("[data-action='overlay']");i=Array.prototype.slice.call(i),t.hasAttribute("data-action")&&"overlay"===t.getAttribute("data-action")&&i.push(t);for(var a=0;a<i.length;a++)i[a].addEventListener(e.Param.eventClick,o.bind(i[a],n))}}function r(e){var t=e.querySelectorAll("[data-section='header']");t=Array.prototype.slice.call(t),e.hasAttribute("data-section")&&"header"===e.getAttribute("data-section")&&t.push(e);for(var n=0;n<t.length;n++)"none"===this.params.header?t[n].style.display="none":"invisible"===this.params.header&&(t[n].style.display="none")}function o(e,t){t.target===this&&v.close.call(null,e)}function s(e){for(var t,n=0;n<this.tpl.length;n++){var i=this.tpl[n].querySelector("[data-section='"+e+"']");i&&(t=i)}return t}function l(e){var t=e.querySelectorAll("iframe");Array.prototype.slice.call(t).forEach(function(e){"complete"===e.readyState?(u.call(e),c.call(e)):e.addEventListener("load",function(e){u.call(e),c.call(e)})})}function u(){e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.SAFARI&&this.parentNode&&(this.parentNode.style.display="none",this.parentNode.offsetHeight,this.parentNode.style.display="block")}function c(){try{var e=this.contentWindow.document;e.addEventListener("touchmove",function(e){1!==e.scale&&e.preventDefault()},!1);var t=0;e.addEventListener("touchend",function(e){var n=Date.now();n-t<=300&&e.preventDefault(),t=n},!0)}catch(n){}}function p(e){}function h(){e.Main.urlManager["delete"]("lightbox")}function d(e){this.parentNode.removeChild(this),e.params.onclose&&e.params.onclose()}function m(){return g.call(this),Promise.resolve()}function f(){this.params.theme&&void 0!==w[this.params.theme]&&(this.params.theme=w[this.params.theme]),b[this.params.id]&&(b[this.params.id].params.animation="none",this.close(this.params.id),this.params.animation="none"),b[this.params.id]=this;var o;P.indexOf(this.params.theme)>-1?o=e.Utils.resolveVariable("${root}mobile/template/lightbox-"+this.params.theme+".html"):(o=e.Utils.resolveVariable("${template}html/template/lightbox-"+this.params.theme+".html"),e.require(["../../${template}html/template/lightbox-"+this.params.theme+".css"]));var s=this.params.target||e.Param.viewMain,u=[];this.params.headerMenu&&this.params.headerMenu.forEach(function(t){u.push(e.Main.menuService.get(t))});var c={id:this.params.id,height:this.params.height,width:this.params.width,title:this.params.title,priority:this.params.priority,animation:this.params.animation,header:this.params.header,headerSpacer:this.params.headerSpacer,headerMenu:u||!1,menuButton:this.params.menuButton,closeButton:this.params.closeButton,position:this.params.position,originalParams:this.params.originalParams};this.params.url&&(c.url=e.Utils.addParamsToUrl(this.params.url,"_zonesecure_sessionID="+e.Param.sessionId),c.url.indexOf(".pdf")===-1&&(c.isNotPdfUrl=!0),e.Main.trackerManager.trackEvent({name:"lightboxOpen",variables:{1:this.params.url}})),this.params.activeElement&&e.Main.menuManager.setActive(this.params.activeElement),e.Utils.removeToast(),e.Main.templateManager.loadAppend(o,s,c).then(function(o){setTimeout(function(){this.params.closeImmediately===!0&&this.close(this.params.id)}.bind(this),200),this.tpl=o,"undefined"!=typeof this.params.linkType&&this.tpl[0].classList.add("webpub-lightbox-contains-"+this.params.linkType);for(var s,u=0;u<o.length;u++){r.call(this,o[u]),n.call(this,o[u]),i.call(this,o[u]),t.call(this,o[u],this.params.id),a.call(this,o[u],this.params.id),l.call(this,o[u]);var c=o[u].querySelector("[data-section='content']");c&&(s=c),s&&this.params.html&&this.setHTML(this.params.html),this.params.DOMcloseButton&&this.setHTML(this.params.DOMcloseButton.innerHTML,"right")}return this.params.subtemplate?s?e.Main.templateManager.load(this.params.subtemplate.url,s,this.params.subtemplate.params).then(e.Utils.promiseTimeout.bind({},16)).then(m.bind(this)):void console.error('You need one data-section="content" in your lightbox template'):e.Utils.promiseTimeout(16).then(m.bind(this))}.bind(this))}function g(){e.Param.viewBody.setAttribute("data-lightbox",this.params.id),window.setTimeout(function(){var t=s.call(this,"content");"theater"===this.params.theme&&t&&"100%"===t.style.height&&e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.SAFARI&&(t.style.height="calc(100% - 108px)"),e.Main.menuManager.hideMenu();for(var n=0;n<this.tpl.length;n++)this.tpl[n].classList.add("webpub--active");this.params.onload&&this.params.onload.call(this,this.tpl,{rightSection:s.call(this,"right")})}.bind(this),16)}function v(e){this.params=e||{},this.resolveConfigs(this.params),f.call(this)}var b={},y=["visible","none","invisible"],E=["normal","high"],M=["none","slideup","slidedown","slideleft","slideright","fade","pop","fadeslideup","fadeslidedown","fadeslideleft","fadeslideright","fadepop"],P=["default","theater","modale","page","panel"],w={"default":P[0],DEFAULT:P[0],theater:P[1],THEATER:P[1],fullscreen:P[1],FULLSCREEN:P[1],modale:P[2],MODALE:P[2],modal:P[2],MODAL:P[2],page:P[3],PAGE:P[3],panel:P[4],PANEL:P[4]};v.prototype.resolveConfigs=function(t){if(this.params.theme=this.params.theme||"default",void 0!==w[this.params.theme]&&(this.params.theme=w[this.params.theme]),this.params.position=this.params.position||"bottom",this.params.priority=this.params.priority||"normal",this.params.header=this.params.header||"visible",this.params.headerSpacer=this.params.headerSpacer!==!1,this.params.menuButton=this.params.menuButton||!1,this.params.id=this.params.id||btoa(Math.random()).replace(/=/g,""),this.params.closeImmediately=this.params.closeImmediately||!1,"undefined"==typeof this.params.closeButton&&(this.params.closeButton=!0),"string"!=typeof this.params.closeButton&&"boolean"!=typeof this.params.closeButton&&(this.params.DOMcloseButton=this.params.closeButton,this.params.closeButton=""),this.params.url&&(this.params.url=e.Utils.resolveVariable(this.params.url)),this.params.height&&this.params.height.match(/^[0-9]+$/)&&(this.params.height+="px"),this.params.width&&this.params.width.match(/^[0-9]+$/)&&(this.params.width+="px"),"default"===this.params.theme?this.params.animation=this.params.animation||"slideup":"theater"===this.params.theme?this.params.animation=this.params.animation||"fadepop":"modale"===this.params.theme?this.params.animation=this.params.animation||"fadepop":"page"===this.params.theme?this.params.animation=this.params.animation||"fadepop":"panel"===this.params.theme?this.params.animation=this.params.animation||"fadeslideup":this.params.animation=this.params.animation||"fade",["theater","modale","panel"].indexOf(this.params.theme)>-1&&this.params.animation.indexOf("fade")===-1){var n="fade"+this.params.animation;M.indexOf(n)>-1&&(this.params.animation="fade"+this.params.animation)}"false"===this.params.header&&(this.params.header="none"),e.Utils._assertString(this.params.theme,"The theme key must be string"),e.Utils._assertBoolean(this.params.menuButton,"The menuButton key must be boolean"),e.Utils._assertBoolean(this.params.headerSpacer,"The headerSpacer key must be boolean"),e.Utils._assertOneOf(this.params.animation,M,"The animation key must be one of: "+M.join(", ")),e.Utils._assertOneOf(this.params.header,y,"The header key must be one of: "+y.join(", ")),e.Utils._assertOneOf(this.params.priority,E,"The priority key must be one of: "+E.join(", ")),p.call(this,this.params),e.Utils._assertString(this.params.id,"You need a lightbox ID")},v.prototype.close=function(t){if("undefined"!=typeof b[t]){b[t].params.url&&e.Main.trackerManager.trackEvent({name:"lightboxClose",variables:{1:b[t].params.url}}),h(),document.activeElement&&document.activeElement.blur&&document.activeElement.blur();for(var n="none"===b[t].params.animation?0:500,i=0;i<b[t].tpl.length;i++)b[t].tpl[i].classList.remove("webpub--active"),window.setTimeout(d.bind(b[t].tpl[i],b[t]),n);e.Param.viewBody.removeAttribute("data-lightbox"),delete b[t]}},v.prototype.closeAll=function(e){var t=e?e.except:[];for(var n in b)t.indexOf(n)===-1&&v.close(n)},v.prototype.get=function(e){return b[e]},v.prototype.getLength=function(){return Object.keys(b).length},v.prototype.exists=function(e){return b.hasOwnProperty(e)},v.prototype.setSubtemplate=function(t,n){"undefined"==typeof n&&(n="content");var i=s.call(this,n);if(i){this.params.onload=t.onload,this.params.subtemplate.params=t;var a=e.Main.templateManager.load(this.params.subtemplate.url,i,this.params.subtemplate.params);return t.onload&&(a=a.then(e.Utils.promiseTimeout.bind({},16)).then(m.bind(this))),a}console.error('You need one data-section="content" in your lightbox template')},v.prototype.setHTML=function(e,t){"undefined"==typeof t&&(t="content");var n=s.call(this,t);return n&&("string"==typeof e?n.innerHTML=e:null!==e&&(n.innerHTML="",n.appendChild(e))),Promise.resolve()},v.prototype.setTitle=function(e){var t=s.call(this,"title");t&&("string"==typeof e&&(e=document.createTextNode(e)),t.innerHTML="",t.appendChild(e))},v.prototype.setUrl=function(e){var t=s.call(this,"iframe");t&&(t.src=e)},v.close=v.prototype.close,v.closeAll=v.prototype.closeAll,v.get=v.prototype.get,v.getLength=v.prototype.getLength,v.prototype.calcModaleSize=v.calcModaleSize=function(e,t){var n=t[0].querySelector('[data-section="content"]'),i=t[0].querySelector("img.webpub-link-image, video.webpub-link-video");i.classList.contains("webpub-link-video")&&(n.style.overflow="hidden");var a=i.naturalHeight?i.naturalHeight+"px":"100%",r=i.naturalWidth?i.naturalWidth+"px":"100%";n.style.height=e.height||a,n.style.width=e.width||r;var o=window.getComputedStyle(n),s=window.getComputedStyle(i),l=0===parseInt(o.height,10)?s.height:o.height,u=parseInt(e.height||i.naturalHeight||s.height,10),c=parseInt(e.width||i.naturalWidth||s.width,10),p=parseInt(l,10),h=parseInt(o.width||s.width,10),d=c/u,m=h/p;m>d?(n.style.width=p*c/u+"px",n.style.height=p+"px"):(n.style.height=h*u/c+"px",n.style.width=h+"px")},v.overridedAppearance=function(t,n){try{if(n.height||n.width){var i=parseFloat(n.height),a=parseFloat(n.width);i||(delete t.height,delete n.height),a||(delete t.width,delete n.width)}var r=new Promise(function(i,a){var r=t.originalParams.appearance.customizationEnable,o=t.originalParams.appearance.customizationUrl;if(r===!0||!o)return void i();var s=o.split("/");s.shift(),o="${media}"+s.join("/"),NIApi.common.resolveValues(o).then(function(r){e.Utils.promiseXHR("GET",r).then(function(e){var a=JSON.parse(e.responseText),r=void 0,o=void 0;t.originalParams=t.originalParams||{},t.originalParams.appearance=t.originalParams.appearance||{};for(var s in t.originalParams.appearance)void 0!==a.appearance[s]&&"customizationEnable"!==s&&(t.originalParams.appearance[s]=a.appearance[s]);for(var l in a.appearance)void 0!==a.appearance[l]&&"customizationEnable"!==l&&(t.originalParams.appearance[l]=a.appearance[l]);t.theme=t.originalParams.appearance.style.toLowerCase(),r=t.originalParams.appearance.width,o=t.originalParams.appearance.height,"0"==r&&(r=void 0),"0"==o&&(o=void 0),n.width=t.width=r,n.height=t.height=o,i()})["catch"](function(e){a(e)})})});return r}catch(o){return Promise.reject(o)}},v.handleSpecialFormat=function(t,n){var i=this,a=e.Utils.resolveVariable(t.param);if(a){var r=function(e){var t=e.toLowerCase().split(".");return t[t.length-1]};if(n=n||{},n.id="link-"+t.id+"-"+t.type,n.height=n.height||t.height,n.width=n.width||t.width,t.onclose&&(n.onclose=t.onclose),t.theme&&!n.theme&&(n.theme=t.theme),void 0!==w[t.theme]&&(t.theme=w[t.theme]),void 0!==w[n.theme]&&(n.theme=w[n.theme]),t.animation&&(n.animation=t.animation),["jpeg","jpg","png","gif"].indexOf(r(a))!==-1){n.theme=n.theme||"theater",n.header="false"===t.header?"none":"visible";var o="modale"===n.theme?"":"100%";!!n.height||!!n.width;"modale"===n.theme?n.html="<img class='webpub-link-image' src='"+a+"'></div>":(n.html="<div class='webpub-link-image' style=\"background-image: url("+a,n.html+=')"></div>'),n.height=n.height||o,n.width=n.width||o,n.linkType="image","modale"===n.theme&&(n.onload=function(t,n){var a=n[0].querySelector("img.webpub-link-image");a&&a.complete?i.calcModaleSize(t,n):a&&(a.addEventListener("load",i.calcModaleSize.bind(i,t,n)),window.addEventListener(e.Param.eventResize,function(){window.setTimeout(function(){i.calcModaleSize(t,n)},600)}))}.bind({},n))}else if(["mp4","mpeg","mpg"].indexOf(r(a))!==-1)n.html="<video class='webpub-link-video' src='"+a+"' controls autoplay></video>",n.theme=n.theme||"theater",n.height=n.height,n.width=n.width,n.linkType="video","modale"===n.theme&&(n.onload=function(t){window.setTimeout(function(){i.calcModaleSize(n,t)},600),window.addEventListener(e.Param.eventResize,function(){window.setTimeout(function(){i.calcModaleSize(n,t)},16)})});else if(["pdf"].indexOf(r(a))!==-1&&e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS){window.open(a);setTimeout(function(){NIApi.lightbox.closeAll(),n.closeImmediately=!0},100)}else a.indexOf("http")===-1&&"/"===a[a.length-1]&&(a+="index.html"),n.url=a,n.header="false"===t.header?"none":"visible","modale"===n.theme&&(n.height=n.height||"100%",n.width=n.width||"100%");new e.Class.LightboxManagerNew(n)}return n},e.Class.LightboxManagerNew=v,NIApi.register("lightbox.open",function(t,n){if(null===t)return Promise.resolve(new e.Class.LightboxManagerNew(n));var i={},a=arguments;"url"!==t&&(a=n.split("/"),i.url=t);for(var r=0;r<a.length;r+=2)i[a[r]]=a[r+1];
return Promise.resolve(new e.Class.LightboxManagerNew(i))}),NIApi.register("lightbox.openPopup",function(t,n){var i={};if(i.originalParams=n,null===t){var a=new Promise(function(t,a){e.Class.LightboxManagerNew.overridedAppearance(i,n).then(function(){t(e.Class.LightboxManagerNew.handleSpecialFormat(n,i))})["catch"](function(a){t(e.Class.LightboxManagerNew.handleSpecialFormat(n,i))})});return a}var r=arguments;"url"!==t&&(r=n.split("/"),i.url=t);for(var o=0;o<r.length;o+=2)i[r[o]]=r[o+1];return Promise.resolve(new e.Class.LightboxManagerNew(i))}),NIApi.register("lightbox.closeAll",function(){return Promise.resolve(new e.Class.LightboxManagerNew.closeAll)}),NIApi.register("lightbox.close",function(t){return Promise.resolve(new e.Class.LightboxManagerNew.close(t))}),NIApi.register("lightbox.getOpenList",function(e){return Promise.resolve(Object.keys(b))}),NIApi.register("lightbox.setHeaderMenu",function(t){"undefined"==typeof e.Main.thumbnailListManager&&(e.Main.thumbnailListManager=new e.Class.ThumbnailListManager),e.Main.thumbnailListManager.headerMenu=t.split(",")})}(webpublicationNamespace),function(e){e.Class.LinksManagerNew=function(){function t(t){e.Main.urlManager.contains("isApp")&&e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&t.addEventListener(e.Param.eventClick,function(){e.Utils.toast({text:e.Main.xmlManager.get("locale","loading"),duration:3e3})})}function n(e){return"swiffy"===e.type}function i(e){return e!==!1}function a(e){return("undefined"==typeof e.useract||0===e.useract.length||e.useract[0].type in le)&&e.type in he}function r(e){return J.indexOf(e.type)===-1||!!e.param}function o(e){for(var t=e.length;t--;)if("video"===e[t].type&&e[t].content[0].autoplay!==!1)return e[t].index;return!1}function s(t){var a=e.Main.pageManager.getLinks(t);if(a.length){var r=a.filter(n);return!r.length||new Promise(function(n){if(H[t])n(!0);else{for(var a,o=[],s=r.length;s--;)a=r[s].content[0],a.id=r[s].index,o.push(e.Utils.GetSwiffyPromise(a));Promise.all(o).then(function(e){H[t]=e.filter(i),e=void 0,n(!0)})}})}return!1}function l(t,n){for(var i=e.Main.pageManager.getLinks(t),a=n.index.toString(),r=i.length;r--;)if(i[r].index===a){c(i[r].useract);break}}function u(t,n){e.Main.trackerManager.trackEvent({name:"link",variables:{1:t.type,2:t.param}}),n&&e.Class.LightboxManagerNew.close(n),le.hasOwnProperty(t.type)&&le[t.type](t)}function c(t,n){if(t.length){if(n&&n.preventDefault(),t.length>1){var i={id:"userActPopup"},a=document.createElement("div"),r=document.createElement("div");r.classList.add("popup-title"),r.innerText=e.Utils.prodTools.getWordLangueByIndex("multilinks_title"),a.appendChild(r);for(var o=t.length;o--;){var s=document.createElement("div");s.classList.add("search-result");var l=document.createElement("div");l.classList.add("search-result-content"),t[o].textContent||t[o].textField?l.innerText=t[o].textContent||t[o].textField:l.innerText=e.Main.xmlManager.get("locale","multilink_"+t[o].type+"_label")+" "+e.Utils.resolveVariable(t[o].param),l.addEventListener(e.Param.eventClick,u.bind({},t[o],i.id)),s.appendChild(l),a.appendChild(s)}i.html=a,new e.Class.LightboxManagerNew(i)}else u(t[0],!1);return!0}return!1}function p(t,n,i,r){var o=e.Main.pageManager.getLinks(t).filter(a);if(o.length){for(var s=[],l=[],u=R.round(j.width*n/q),c=R.round(j.height*i/Y),p=ne.linkClickMargin,h=o.length;h--;)for(var d=o[h].content.length;d--;){var m=o[h].content[d];u>=m.x&&u<=m.x+m.width&&c>=m.y&&c<=m.y+m.height&&(s=s.concat(o[h].useract)),u>=m.x-p&&u<=m.x+m.width+p&&c>=m.y-p&&c<=m.y+m.height+p&&(l=l.concat(o[h].useract))}return 0===s.length&&(s=l),s}return[]}function h(e,t,n,i){return"VIDEO"===i.target.tagName.toUpperCase()||p(e,t,n,i).length>0}function d(t,n,i,a){if("VIDEO"!==a.target.tagName.toUpperCase()){clearTimeout(e.Main.linksManagerNew._mouseIdleTimer),e.Main.tooltipManager.hide(a);var o=p(t,n,i,a);ne.linksBoxWithDom&&(o=o.filter(r)),c(o,a)}}function m(t){var n=e.Utils.resolveVariable(t.param);return n.indexOf("http")===-1&&"/"===n[n.length-1]&&(n+="index.html"),n}function f(t){var n=e.Utils.resolveVariable(t.param);return 0!==n.indexOf("#")&&(n="#"+n),e.Main.xmlManager.get("common-configuration","contents","gallery","path")+n}function g(t,n,i,a,r){if(i=i||B.getDeltaFrameForPage(n),r=r||document.getElementById("webpub-viewer__links-page-container-"+n))for(var o=0;o<t.content.length;o++)if("swiffy"===t.type){if(H[n]&&H[n].length)for(var s=H[n].length;s--;){var l=H[n][s];l.classList.contains("webpub-viewer__link-"+t.index)&&r.appendChild(he.swiffy(l,!1))}}else{var u={};u.pageNumber=n,"video"===t.type&&(u.play=ne.autoPlayVideo===!0&&0===i&&t.index===a&&t.content[o].video.autoplay!==!1),"iframe"===t.type&&(u.visible=0===i),t.useract[0]&&("drive"===t.useract[0].type&&(u.url=f(t.useract[0])),"url"!==t.useract[0].type&&"gallery"!==t.useract[0].type||(u.url=m(t.useract[0])));var c="";if(t.useract.length>0&&(c=t.useract[0].textField,""===c&&(c=e.Main.xmlManager.get("locale","tooltip_"+t.useract[0].type),"gotoPage"===t.useract[0].type))){var p=parseInt(e.Utils.resolveVariable(t.useract[0].param),10)-e.Main.xmlManager.get("common-configuration","config","shift");c+=" "+p}var h=he[t.type](t.index,t.content[o],!!t.useract.length,u,c);h!==!1&&r.appendChild(h)}}function v(){this.classList.add("webpub-viewer__links-page-container-reveal--taped")}function b(){this.classList.remove("webpub-viewer__links-page-container-reveal--taped"),setTimeout(v.bind(this),16)}function y(t,n){var i=e.Main.pageManager.getLinks(t).filter(a);if(i&&i.length&&K.indexOf(t)===-1){var r=o(i),s=document.createDocumentFragment();K.push(t);for(var l=0;l<i.length;l++)ne.linksBoxWithDom===!1&&$.indexOf(i[l].type)>-1&&(i[l].type=i[l].type+"_domManager"),g(i[l],t,n,r,s);if(s.childNodes.length){var u=document.createElement("div");u.id="webpub-viewer__links-page-container-"+t,ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink&&0===n?u.className="webpub-viewer__links-page-container-active":ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]?u.className="webpub-viewer__links-page-container-show":ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.revealOnTap&&(u.className="webpub-viewer__links-page-container-reveal",u.addEventListener(e.Param.eventClick,b.bind(u))),u.appendChild(s),s=i=void 0,u.style.left=B.getFrameCoordX(n)+B.getPageCoordX(t)+"px",u.style.top=B.getFrameCoordY(n)+X+"px",u.style.width=j.width+"px",u.style.height=j.height+"px",u.style.zIndex=t,e.Utils.styleTransformOrigin(u,"0 0"),e.Utils.styleTransform(u,"scale3d("+W+", "+Z+", 1)"),G.appendChild(u),H[t]&&H[t].length&&(0===n||ne.autoPlayAnim)&&(w(t,!1),setTimeout(function(){w(t,!0)},100))}}}function E(e){for(var t=document.querySelectorAll("#webpub-viewer__links-page-container-"+e+" .animation_for_swiffy"),n=[],i=t.length;i--;)n.push(t[i].id);return t=null,n}function M(e,t){if(K.indexOf(e)>-1){var n=document.getElementById("webpub-viewer__links-page-container-"+e);K.splice(K.indexOf(e),1);for(var i=E(e),a=i.length;a--;)document.getElementById(i[a]).swiffyElement.swiffyObject.destroy();G.removeChild(n),ee.appendChild(n),n.innerHTML="",n=void 0,ee.innerHTML=""}t&&(H[e]=void 0,delete H[e])}function P(e,t){var n=document.querySelector("#webpub-viewer__links-page-container-"+e+" .webpub-viewer__link-"+t);n&&(n.classList.contains("animation_for_swiffy")&&document.getElementById(n.id).swiffyElement.swiffyObject.destroy(),n.parentNode.removeChild(n))}function w(e,t){var n,i=E(e);if(t)for(n=i.length;n--;)document.getElementById(i[n]).swiffyElement.swiffyObject.start();else{for(n=i.length;n--;){var a=document.getElementById(i[n]);a.swiffyElement.swiffyObject.destroy(),a.parentNode.removeChild(a),H[e]=void 0,delete H[e]}var r=document.getElementById("webpub-viewer__links-page-container-"+e),o=s(e);o.then&&o.then(function(){if(H[e]&&H[e].length)for(n=H[e].length;n--;){var t=H[e][n];r.appendChild(he.swiffy(t,0===B.getDeltaFrameForPage(e)||t.autoPlay||ne.autoPlayAnim))}})}}function S(t){var n=this||t.target,i=e.Param.lastVideoPlayed,a=parseInt(n.getAttribute("data-index"),10),r=parseInt(n.getAttribute("data-page"),10),o=i?parseInt(i.getAttribute("data-index"),10):a,s=i?parseInt(i.getAttribute("data-page"),10):r,l=B.getFrameOfPage(r),u=B.getFrameOfPage(s);l!==u&&(o=a,s=r),"true"===n.getAttribute("data-has-autoplay")&&a<=o&&r<=s&&(n.play(),i&&i.pause(),e.Param.lastVideoPlayed=n)}function _(e,t){var n=document.querySelectorAll("#webpub-viewer__links-page-container-"+e+" .webpub-viewer__link-iframe"),i=n.length;if(t)for(;i--;)n[i].src=n[i].getAttribute("data-src");else for(;i--;)n[i].src="";n=void 0}function T(t){for(var n=document.querySelectorAll("#webpub-viewer__links-container > div"),i=n.length;i--;){var a=n[i],r=parseInt(a.id.substring(a.id.lastIndexOf("-")+1,a.id.length)),o=B.getFrameOfPage(r),s=o-t;R.abs(s)>ne.deltaFrameInDOM?M(r,!0):(0!==s&&(w(r,!1),_(r,!1),ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink?a.classList.remove("webpub-viewer__links-page-container-active"):ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]&&a.classList.remove("webpub-viewer__links-page-container-show")),a.style.left=B.getFrameCoordX(s)+B.getPageCoordX(r)+"px",a.style.top=B.getFrameCoordY(s)+X+"px",0===s&&(w(r,!0),_(r,!0),ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors.blink?(a.classList.remove("webpub-viewer__links-page-container-active"),a.classList.add("webpub-viewer__links-page-container-active")):ne.linkBoxAspect===e.Class.LinksManagerNew.linksBehaviors["static"]&&a.classList.add("webpub-viewer__links-page-container-show")))}}function x(e){q=e.width,Y=e.height,Q=e.left,X=e.top,L()}function C(e,t,n){var i=G.querySelectorAll(".webpub-viewer__link-iframe");i=Array.prototype.filter.call(i,function(e){return null!==e.contentWindow&&void 0!==e.contentWindow});var a=0;if("all"===e)for(a=i.length;a--;)i[a].contentWindow.postMessage(t,"*");else if("others"===e)for(a=i.length;a--;)i[a].contentWindow!==n&&i[a].contentWindow.postMessage(t,"*")}function L(){if(j.width=e.Main.xmlManager.get("common-configuration","contents","links","width")||e.Main.xmlManager.get("common-configuration","contents","swf","width"),j.height=e.Main.xmlManager.get("common-configuration","contents","links","height")||e.Main.xmlManager.get("common-configuration","contents","swf","height"),q>0){W=q/j.width,Z=Y/j.height;for(var t,n=G.childNodes,i=n.length;i--;){t=n[i];var a=t.id,r=parseInt(a.match(/[0-9]+$/)[0],10),o=B.getDeltaFrameForPage(r);Math.abs(o)>ne.deltaFrameInDOM&&(e.Utils.styleTransform(t,"scale3d("+W+", "+Z+", 1)"),M(r,!0)),t.style.left=B.getFrameCoordX(o)+B.getPageCoordX(r)+"px",t.style.top=B.getFrameCoordY(o)+X+"px",e.Utils.styleTransform(t,"scale3d("+W+", "+Z+", 1)")}re()}}function A(){N=window.innerWidth,U=window.innerHeight}function k(){G=document.createElement("div"),G.id="webpub-viewer__links-container",ne.container.appendChild(G),ee.classList.add("display-none"),te.classList.add("display-none"),document.body.appendChild(te);var e="div.webpub-viewer__links-page-container-active > .webpub-viewer__link-box { ";e+="-webkit-animation-duration: "+ne.linkBlinkDuration/1e3+"s;",e+="animation-duration: "+ne.linkBlinkDuration/1e3+"s;",e+="}";var t=document.createElement("style");t.type="text/css",t.innerText=e,document.head.appendChild(t)}function O(e){var t;for(t in e)"undefined"!=typeof ne[t]&&(ne[t]=e[t])}function D(){var t=e.Main.pageManager.getCurrent(),n=document.getElementById("webpub-viewer__links-page-container-"+t);if(null!==n)for(var i=n.querySelectorAll("video"),a=0,r=i.length;a<r;a++)i[a].pause()}function I(e){O(e||{}),k(),z=!0}var N=window.innerWidth,U=window.innerHeight,R=Math,F=document.head||document.getElementsByTagName("head")[0],B=e.Main.viewerManager,z=!1,V=!1,H={},G={},j={},W=0,Z=0,q=0,Y=0,X=0,Q=0,K=[],J=["url","drive","gallery"],$=["roundrectcomplex","roundrect","rect","circle"],ee=document.createElement("div"),te=document.createElement("iframe"),ne={pageOnFirstFrame:1,pagesInFrame:1,linksRetina:!1,deltaFrameInDOM:0,maxZoom:2.5,autoPlayAnim:!1,autoPlayVideo:!1,linkClickMargin:5,linksBoxWithDom:!0,container:e.Param.viewMain,linkBoxAspect:e.Class.LinksManagerNew.linksBehaviors.blink,linkBlinkDuration:1e3},ie=e.Utils.noop,ae=e.Utils.noop,re=e.Utils.noop,oe=e.Utils.noop,se=e.Utils.noop;"7.3"===e.Main.startupManager.get("vendor.swiffy")&&(oe=function(e){var t=e.querySelector("canvas");t&&(e.style.backgroundImage="url("+t.toDataURL()+")",e.style.backgroundSize="contain",t.classList.add("display-none"))},se=function(e){var t=e.querySelector("canvas");t&&(e.style.backgroundImage="none",t.classList.remove("display-none"))},ie=function(){if(!V){V=!0;for(var e=document.querySelectorAll(".animation_for_swiffy"),t=e.length;t--;)oe(e[t])}},ae=function(){if(V){V=!1;for(var e=document.querySelectorAll(".animation_for_swiffy"),t=e.length;t--;)se(e[t])}},re=function(){for(var e=document.querySelectorAll("#webpub-viewer__links-container > div"),t=e.length;t--;){var n=e[t],i=parseInt(n.id.substring(n.id.indexOf("_")+1,n.id.length));w(i,!1)}});var le={history:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){"back"===e.param?history.back():"fwd"===e.param&&history.forward()}),close:function(){e.Main.urlManager.get("backHome")?document.location=e.Starter.main.backHomeString:window.close()},prevPage:NIApi.page.openPrevious,nextPage:NIApi.page.openNext,firstPage:NIApi.page.openFirst,lastPage:NIApi.page.openLast,activate:function(t){"panel_pdf"===t.param?e.API.pdfDownload():"panel_search"===t.param?e.API.searchOpen():"panel_share"===t.param&&e.Main.shareManager.open("home")},gotoPage:function(e){B.goToPage(e.param)},javascript:function(e){try{new Function(e.param)()}catch(t){console.warn(t)}},popup:NIApi.lightbox.openPopup.bind(null,null),url:function(e){window.open(m(e),"_blank")},drive:function(e){window.open(f(e),"_blank")},gallery:function(e){window.open(m(e),"_blank")},window:function(t){var n=e.Utils.resolveVariable(t.param);n.indexOf("http")===-1&&"/"===n[n.length-1]&&(n+="index.html");var i={id:"link-"+t.id+"-"+t.type,height:t.height,width:t.width},a=function(e){var t=e.toLowerCase().split(".");return t[t.length-1]};["jpeg","jpg","png","gif"].indexOf(a(n))!==-1?(i.html="<div class='webpub-link-image' style=\"background-image: url("+n+')"></div>',i.theme=i.theme||"theater",i.height=i.height||"100%",i.width=i.width||"100%"):(i.header="false"===t.header?"none":"visible",i.url=n),t.theme&&(i.theme=t.theme),t.animation&&(i.animation=t.animation),new e.Class.LightboxManagerNew(i)},mailto:function(e){window.location.href="mailto:"+e.param},refreshLink:function(t){if(t.param){var n=B.getDeltaFrameForPage(t.param);if(t.linkIndex>=0){P(t.param,t.linkIndex);var i=e.Main.pageManager.getLinks(t.param).filter(a);if(i&&i.length)for(var r=o(i),s=i.length;s--;)i[s].index==t.linkIndex&&(g(i[s],t.param,n,r),"swiffy"!==i[s].type||0!==n&&!ne.autoPlayAnim||(w(t.param,!1),setTimeout(w.bind({},t.param,!0),100)))}else M(t.param,!1),R.abs(n)<=ne.deltaFrameInDOM&&y(t.param,n)}},addProduct:function(e){window.wishList.list.addProduct(e.param)}};le.lightbox=le.popup;var ue=function(){var n,i,a,r,o;return function(s,l,u,c,p,h){return a=c?ne.maxZoom:1,r=u.width*a+"px",o=u.height*a+"px",l.classList.add("webpub-viewer__link"),l.style.height=o,l.style.width=r,l.style.position="absolute",u.file&&u.file.foreground===!1?(n=document.createElement("div"),i=document.createElement("div"),n.style.width=r,n.style.height=o,n.style.position="absolute",n.style.zIndex=1,l.style.left="0",l.style.top="0",l.style.zIndex=-10,i.style.width=r,i.style.height=o,i.style.top="0",i.style.left="0",i.style.position="absolute",i.style.zIndex=10,n.appendChild(i),n.appendChild(l)):(n=l,n.style.zIndex=10),n.style.top=u.y+"px",n.style.left=u.x+"px",n.classList.add("webpub-viewer__link-"+s),p&&(n.classList.add("webpub-viewer__link-clickable"),h.url&&(n.href=h.url,n.target="_blank",t(n))),c&&e.Utils.scaleDom3d(n,1/a,0,0),e.Main.urlManager.contains("isApp")&&e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&n.addEventListener(e.Param.eventClick,function(){this.classList.add("webpub-viewer__link--focused"),setTimeout(function(){this.classList.remove("webpub-viewer__link--focused")}.bind(this),400)}),n}}(),ce=function(){var e=function(e){e.paused&&e.play()},t=function(e){e.paused||document.hackFullscreenElement||e.pause()};return function(n){n.target.paused?setTimeout(e.bind({},n.target),125):setTimeout(t.bind({},n.target),125)}}(),pe=!1;pe="safari"===e.Param.userAgent.browser.name||"ie"===e.Param.userAgent.browser.name&&e.Param.userAgent.browser.version<10?function(){var e,t=[],n=!1;return te.onload=function(){e=t.shift(),"undefined"!=typeof e?te.src=e:n=!1},function(e){n===!0?t.push(e):(n=!0,te.src=e)}}():function(e){var t=document.createElement("link");t.setAttribute("href",e),t.setAttribute("rel","prefetch prerender"),F.appendChild(t)};var he={swiffy:function(){return"7.3"===e.Main.startupManager.get("vendor.swiffy")?function(t,n){if(t!==!1){t.style.left=t.coords.x+"px",t.style.top=t.coords.y+"px",t.style.width=t.coords.w+"px",t.style.height=t.coords.h+"px",t.swiffyElement.swiffyWrapper.style.visibility="hidden";var i=function(){var t=this.firstChild;if(t){var n=this.querySelector("canvas"),a=t.offsetWidth/n.offsetWidth,r=t.offsetHeight/n.offsetHeight;t.style.overflow="visible",e.Utils.styleTransformOrigin(n,"0 0"),e.Utils.styleTransform(n,"scale3d("+a+", "+r+", 1)"),this.style.visibility=""}else window.setTimeout(i,32)}.bind(t.swiffyElement.swiffyWrapper);return window.setTimeout(i,32),n&&t.swiffyElement.swiffyObject.start(),t}}:function(e,t){if(e!==!1)return e.style.left=e.coords.x+"px",e.style.top=e.coords.y+"px",e.style.width=e.coords.w+"px",e.style.height=e.coords.h+"px",t&&e.swiffyElement.swiffyObject.start(),e}}(),iframe:function de(e,t,n,i){var de=document.createElement("iframe");return de.classList.add("webpub-viewer__link-iframe"),de.setAttribute("data-src",t.file.url),de.style.visibility="hidden",de.onload=function(){this.style.visibility="visible"},i.visible?de.src=t.file.url:pe(t.file.url),ue(e,de,t,ne.linksRetina)},javascript:function(){},image:function me(t,n,i,a,r){if(B.linkChargedInPage(a.pageNumber,t)===!1){var me=new Image;me.coord={x:n.x,y:n.y,width:n.width,height:n.height,container:j},me.idLink=t,me.onload=B.addImagesOnPage.bind({},a.pageNumber,[me]),me.src=e.Utils.resolveVariable(n.file.url)}return!!i&&(ne.linksBoxWithDom?he.rect(t,n,i,a,r):he.rect_domManager(t+"-box",n,!1,a,r))},video:function fe(t,n,i,a,r){var fe=document.createElement("video");r&&(fe.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(fe)),fe.classList.add("webpub-viewer__link-video");var o=/(?:\.([^.]+))?$/.exec(n.video.url)[1].toUpperCase(),s=document.createElement("source");return["MP4","OGG"].indexOf(o)>=0&&(s.type="video/"+o.toLowerCase(),s.src=e.Utils.resolveVariable(n.video.url)),fe.appendChild(s),fe.controls=!0,fe.preload=!0,e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&a.play===!0&&fe.setAttribute("muted",""),fe.setAttribute("data-has-autoplay",a.play),fe.setAttribute("data-page",a.pageNumber),fe.setAttribute("data-index",t),fe.loop=!1,fe.oncanplay=S,e.Param.userAgent.os.name!==e.Param.userAgent.OS.ANDROID&&fe.addEventListener(e.Param.eventStart,ce),e.Param.userAgent.os.name!==e.Param.userAgent.OS.SAFARI&&(fe.addEventListener("webkitbeginfullscreen",function(){document.hackFullscreenElement=this},!1),fe.addEventListener("webkitendfullscreen",function(){document.hackFullscreenElement=void 0,delete document.hackFullscreenElement},!1)),e.Utils.addVideoStats(fe),ue(t,fe,n,!1)},text:function ge(t,n,i,a,r){var o=document.createElement("a");r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-text ",o.align="center",o.setAttribute("data-tooltip",r);var ge=document.createElement("p");return ge.innerHTML=n.textContent,ge.style.fontSize="15px",o.appendChild(ge),ue(t,o,n,!1,i,a)},rect:function(t,n,i,a,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-rect webpub-viewer__link-box",ue(t,o,n,ne.linksRetina,i,a)},rect_domManager:function(e,t,n,i){return B.linkChargedInPage(i.pageNumber,e)===!1&&B.addLinksBoxOnPage(i.pageNumber,[{type:"rect",id:e,x:t.x,y:t.y,w:t.width,h:t.height,container:j}]),!1},circle:function(t,n,i,a,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-circle webpub-viewer__link-box",ue(t,o,n,ne.linksRetina,i,a)},circle_domManager:function(e,t,n,i){return B.linkChargedInPage(i.pageNumber,e)===!1&&B.addLinksBoxOnPage(i.pageNumber,[{type:"circle",id:e,x:t.x,y:t.y,w:t.width,h:t.height,container:j}]),!1},roundrect:function(t,n,i,a,r){var o=document.createElement("a");return r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o)),o.className="webpub-viewer__link-roundrect webpub-viewer__link-box",e.Utils.styleBorderRadius(o,n.roundrect.radius+"px"),ue(t,o,n,ne.linksRetina,i,a)},roundrect_domManager:function(e,t,n,i){return B.linkChargedInPage(i.pageNumber,e)===!1&&B.addLinksBoxOnPage(i.pageNumber,[{type:"roundrect",id:e,x:t.x,y:t.y,w:t.width,h:t.height,radius:t.roundrect.radius,container:j}]),!1},roundrectcomplex:function(t,n,i,a,r){var o=document.createElement("a");r&&(o.setAttribute("data-tooltip",r),e.Main.tooltipManager.register(o));var s=n.roundrectcomplex;return o.className="webpub-viewer__link-roundrectcomplex webpub-viewer__link-box",e.Utils.styleBorderRadius(o,s.tl_radius+"px "+s.tr_radius+"px "+s.br_radius+"px "+s.bl_radius+"px "),ue(t,o,n,ne.linksRetina,i,a)},roundrectcomplex_domManager:function(e,t,n,i){return B.linkChargedInPage(i.pageNumber,e)===!1&&B.addLinksBoxOnPage(i.pageNumber,[{type:"roundrectcomplex",id:e,x:t.x,y:t.y,w:t.width,h:t.height,tl_radius:t.roundrectcomplex.tl_radius,tr_radius:t.roundrectcomplex.tr_radius,br_radius:t.roundrectcomplex.br_radius,bl_radius:t.roundrectcomplex.bl_radius,container:j}]),!1},symbol:function(){return document.createElement("div")}};return NIApi.event.onPageChange(D),NIApi.register("viewer.linkHandler",function(e,t){var n={next:le[e]};return le[e]=t.bind(n),Promise.resolve()}),{addLinksToPage:y,removeLinksFromPage:M,preloadAnimPromise:s,setPageSize:x,addFixSwiffyAnims:ie,removeFixSwiffyAnims:ae,adjustLinksCache:T,setConfig:O,linkClick:l,linksBroadcast:C,onLayerClick:d,findClickedUserActs:h,onResize:A,init:I}},e.Class.LinksManagerNew.linksBehaviors={blink:"blink","static":"static",none:"none",revealOnTap:"revealOnTap"}}(webpublicationNamespace),function(e){e.Param.eventResize="resizeCustom",e.Param.eventKeyboardDown="keydown";var t=function(){function t(){window.innerHeight>=window.innerWidth?(e.Param.viewHtml.classList.remove("webpub-device__landscape"),e.Param.viewHtml.classList.add("webpub-device__portrait"),e.Param.isPortrait=!0):(e.Param.viewHtml.classList.remove("webpub-device__portrait"),e.Param.viewHtml.classList.add("webpub-device__landscape"),e.Param.isPortrait=!1)}function n(n){t(),e.Utils.callEvent(window,e.Param.eventResize)}t();return function(e){var t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.hackFullscreenElement;return t&&"video"===t.tagName.toLowerCase()?(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1):void n(e)}}();e.Param.userAgent.os.name===e.Param.userAgent.OS.WINDOWS&&e.Param.userAgent.device.type===e.Param.userAgent.FORMAT.PHONE?window.addEventListener("orientationchange",function(){setTimeout(t,48)}):window.addEventListener("resize",t),document.addEventListener(e.Param.eventClick,function(t){var n=e.Utils.getClosestByClass(t.target,"focusable");n!==!1&&(n.classList.add("focused"),window.setTimeout(function(){n.classList.remove("focused")},300))})}(webpublicationNamespace),function(e){!function(){document.addEventListener("touchmove",function(e){void 0!==e.scale&&1!==e.scale&&e.preventDefault()},!!e.Utils.supportsPassive()&&{passive:!1});var t=0;document.addEventListener("touchend",function(e){var n=Date.now();n-t<=300&&e.preventDefault(),t=n},!0)}(),e.Class.Main=function(){var t=function(){var t=e.Main.urlManager.get("gallery");if("undefined"!=typeof t){var n=e.Main.xmlManager.get("common-configuration","contents","gallery","path");location.href=n+"#"+t}this.backHomeString="api:backHome",e.Param.userAgent.os.name===e.Param.userAgent.OS.WINDOWS&&(this.backHomeString="api-backHome"),e.Main.eventEmul=new e.Class.EventEmul,e.Main.pdfManager=new e.Class.PdfManager,e.Main.tooltipManager=new e.Class.TooltipManager,e.Main.fullScreenManager=new e.Class.FullScreenManager,e.Main.pageManager=new e.Class.PageManager,e.Main.pageManager.init(),e.Main.paginationManager=new e.Class.PaginationManager,e.Main.paginationManager.init(e.Main.startupManager.get("ui.paging")),e.Main.pagesLoaderNew=new e.Class.PagesLoaderNew;var i=["epub-HTML","pdf-HTML","pdf-SVG","pdf-PDF","pdf-IMG"];"html"===e.Param.viewerMode&&i.indexOf(e.Param.viewerFormat)!==-1?e.Main.viewerManager=new e.Class.EpubManager(this,e.Param.viewMain):e.Main.viewerManager=new e.Class.ViewerManager,e.Main.toolsEvents=new e.Class.ToolsEvents(this),e.Main.paginationManager.addPagination("lateral",e.Param.viewMain),e.Main.summaryManager=new e.Class.SummaryManager,e.Main.shareMailManager=new e.Class.ShareMailManager,e.Main.shareManager=new e.Class.ShareManager,e.Main.shareManager.init(),null!==e.Main.startupManager.get("ui.menu")&&(e.Main.menuService=new e.Class.MenuService,e.Main.menuManager=new e.Class.MenuManager),e.Utils.callEvent(window,"webpub-init"),e.Param.newThemeVersion&&!e.Main.startupManager.has("ui.paging.counter.target","document")||e.Main.paginationManager.addPagination("counter",e.Param.viewMain)};t.prototype;return t.prototype.init=function(){var t=this;setTimeout(function(){var n=document.createElement("div");n.style.display="none",e.Main.templateManager.loadAppend("publication/mobile/img/icons.svg",n),document.body.appendChild(n);var i=e.Main.startupManager.get("startup.welcomepage.url"),a=e.Main.urlManager.get("initState"),r=e.Main.startupManager.get("startup.welcomepage.initial"),o=!1;return o="welcomepage"===a||"nowelcomepage"===a?"welcomepage"===a:"hidden"!==r,i&&o&&(e.Main.trackerManager.trackPage({name:"welcomepage"}),new e.Class.LightboxManagerNew({animation:"none",header:"none",id:"startupPanel",url:e.Utils.resolveVariable(i),onclose:function(){e.Utils.callEvent(window,"webpub-show")}})),null!==e.Main.startupManager.get("ui.menu")&&e.Main.menuManager.init({topnav:e.Main.startupManager.has("ui.menu.mode","topnav"),topnavAlwaysVisible:"sticky"===e.Main.startupManager.get("ui.menu.topnav.display")}),e.Main.viewerManager.epubMode?void t.loadModules().then(function(){this.documentReady()}.bind(t)):void e.Main.javascriptInit.removePreloader(function(){this.loadModules().then(function(){this.documentReady()}.bind(this))}.bind(t))},0)},t.prototype.loadModules=function(){if(!e.Main.xmlManager.get("common-ui","assets","products"))return Promise.resolve();var t=new Promise(function(t,n){e.require(["modules/wishlist/js/index.js"]).then(function(){e.require(["modules/wishlist/css/index.css"]).then(function(){t()})})}).then(function(){e.Class.WishList()});return t},t.prototype.documentReady=function(){if(e.Utils.callEvent(window,"webpub-ready"),e.Param.sliderDirection="horizontal","vertical"===e.Main.startupManager.get("core.viewerDirection")||"vertical"===e.Main.urlManager.get("direction")){e.Param.sliderDirection="vertical",e.Param.sliderDirectionNotice=!1;var t=function(){var t=document.createElement("span");t.classList.add("svgicon-new-text"),t.innerHTML=e.Main.xmlManager.get("locale","vertical_slide_notice");var n=e.Utils.createSvgIcon("swipe-vertical-v4","svgicon-new svgicon-v4","#ffffff"),i=document.createElement("div");i.appendChild(t),i.appendChild(n),e.Utils.toast({html:i.innerHTML,duration:5e3,position:"bottom"})};window.addEventListener("webpub-show",function(){"vertical"===e.Param.sliderDirection&&e.Param.sliderDirectionNotice===!1&&(t(),e.Param.sliderDirectionNotice=!0)})}(e.Main.urlManager.contains("bookmarks")&&e.Main.menuService.get("thumbnails_btn")===!1||e.Main.urlManager.contains("bookmark")&&e.Main.menuService.get("thumbnails_btn")===!1)&&("undefined"==typeof e.Main.thumbnailListManager&&(e.Main.thumbnailListManager=new e.Class.ThumbnailListManager),e.Main.thumbnailListManager.show("sharedBy"));var n=e.Main.viewerService.getRotateClue();if(null!==n){var i=function(t){"undefined"==typeof t&&(t="none"),new e.Class.LightboxManagerNew({header:"none",id:"rotate",theme:"theater",disableOverlay:!0,subtemplate:{url:e.Param.pathTemplate+"rotateClue.html"},priority:"high",animation:t,onload:function(t){t[0].classList.remove("webpub-lightbox--animation-none"),e.Class.LightboxManagerNew.get("rotate").params.animation="fade",t[0].classList.add("webpub-lightbox--animation-fade"),t[0].classList.add("webpub--active")}.bind(this)})};window.addEventListener(e.Param.eventResize,function(){e.Param.viewHtml.classList.contains("webpub-device__"+n)?e.Class.LightboxManagerNew.close("rotate"):i("fade")});var a=!e.Param.viewHtml.classList.contains("webpub-device__"+n);e.Param.isDesktop===!1&&a&&i()}var r=e.Main.xmlManager.get("common-ui","configs","links","mode")||e.Class.LinksManagerNew.linksBehaviors.blink,o=e.Main.xmlManager.get("common-ui","configs","links","duration")||1e3,s={pageBgColor:e.Main.cssManager.getStyle("primary","backgroundColor"),zoomPinch:e.Main.startupManager.has("ui.zoom.mode","pinch"),zoomDoubleClick:e.Main.startupManager.has("ui.zoom.mode","doubleclick"),zoomSingleClick:1===e.Main.viewerService.get("zoom","click"),draggable:e.Main.startupManager.get("ui.viewer.draggable"),pagesRetina:!(e.Param.userAgent.isIE()===!0&&e.Param.userAgent.isPhone()),zoomRetina:e.Param.isDesktop||e.Param.isTablet,domMode:e.Param.viewerMode,ePubConfig:null,highQualityKey:"svg"===e.Param.viewerFormat?"svg":"hdpi",linkBoxAspect:r,linkBlinkDuration:o,verticalSlider:"vertical"===e.Param.sliderDirection,pageQuantity:e.Main.pagesLoaderNew.getPageQuantity(),pageOnFirstFrame:e.Main.pageManager.pagesOnFirstScreen(),lowQualityDisabled:"svg"===e.Param.viewerFormat,maxZoom:e.Main.viewerService.get("zoom","max-scale"),transitionTime:parseFloat(e.Main.viewerService.get("page","transition_time")),spreadDraggable:"false"!==e.Main.viewerService.get("page","swipe"),coverPageCenter:"false"!==e.Main.viewerService.get("page","center_cover"),pageSizeType:e.Main.viewerService.get("page","size_type"),pdfHTMLMaxFontLoad:e.Main.xmlManager.get("common-ui","configs","pdfHTMLMaxFontLoad"),pageSizeMaxWidth:function(){var t=e.Main.viewerService.get("page","max_width");return t&&"auto"!==t?~~t:0}(),pageSizeMaxHeight:function(){var t=e.Main.viewerService.get("page","max_height");return"auto"===t?0:~~t}(),pageMargin:function(){var t=e.Main.viewerService.get("page","margin");if(!t)return[0,0,0,0];var n=t.split(" ");return n=n.map(function(e){return~~e})}()};e.Main.viewerManager.epubMode?("epub-HTML"===e.Param.viewerFormat?(s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","epub-HTML"),s.readerPageSrcType="EPUB_HTML"):"pdf-HTML"===e.Param.viewerFormat?(s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","pdf-HTML"),s.readerPageSrcType="PDF_HTML"):"pdf-SVG"===e.Param.viewerFormat?(s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","pdf-SVG"),s.readerPageSrcType="PDF_SVG"):"pdf-IMG"===e.Param.viewerFormat?(s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","pdf-IMG"),s.readerPageSrcType="PDF_IMG"):"pdf-PDF"===e.Param.viewerFormat?(s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","pdf-PDF"),s.readerPageSrcType="PDF_PDF"):(e.Param.viewerFormat="pdf-HTML",s.ePubConfig=e.Main.xmlManager.get("common-configuration","contents","pdf-HTML"),s.readerPageSrcType="PDF_HTML"),e.Main.viewerManager.init(s,e.Main.javascriptInit.setPercentageExternal).then(function(){
e.Main.javascriptInit.removePreloader(function(){})}.bind(this))):e.Main.viewerManager.init(s),e.Utils.callEvent(window,"webpub-load");var l=e.Main.startupManager.get("startup.welcomepage.url"),u=e.Main.urlManager.get("initState"),c=e.Main.startupManager.get("startup.welcomepage.initial"),p=!1;p="welcomepage"===u||"nowelcomepage"===u?"welcomepage"===u:"hidden"!==c,l&&p||e.Utils.callEvent(window,"webpub-show")},t}()}(webpublicationNamespace),function(e){e.Class.MenuManager=function(){function t(){NIApi.register("menu.ready",function(){return T.promise}),NIApi.register("menu.open",function(){return Promise.resolve(e.Main.menuManager.showMenu())}),NIApi.register("menu.close",function(){return Promise.resolve(e.Main.menuManager.hideMenu())}),NIApi.register("menu.toggle",function(){return Promise.resolve(e.API.menuToggle())}),NIApi.register("menu.activate",function(t){return Promise.resolve(e.Main.menuManager.callButtonClick(t))}),NIApi.register("menu.deactivate",function(e){return console.log("TODO : in developpement"),Promise.resolve()})}function n(t){if("undefined"==typeof t)return[];for(var n,i,a=[],r=0,o=t.length;r<o;r++){var s="string"==typeof t[r]?t[r]:t[r].name;i=e.Main.menuService.get(s),i&&(n=Object.assign({},i),t[r].xmlElement.hasAttribute("label")&&(n.label=t[r].xmlElement.getAttribute("label")),n.data=t[r],"logo"===n.data&&(n.data={file:e.Main.xmlManager.get("ui","logo")}),a.push(n))}return a}function i(){var t=function(e){return"menu"!==e.name&&"logo"!==e.name},n=function(e){return"documentback"!==e.name},i=function(e){return function(t){return e.indexOf(t.priority)>-1}},a=function(e){return e.name},r=e.Main.xmlManager.get("ui","menu"),o=r.left.concat(r.center,r.right).filter(t),s={};if(_=[{name:"logo"}].concat(r.left,r.center,r.right).map(function(e){return e.name}),o.length>0&&o.unshift({name:"documentback",prority:"normal"}),b===!1&&"legacy"===e.Main.startupManager.get("ui.theme.v3.mode"))s={left:[],center:[],right:[]},o.length>0&&s.left.push({name:"menu",priority:"highest"}),e.Main.xmlManager.get("common-ui","logo")&&s.center.push({name:"logo",priority:"highest"});else{var l=["highest","high"];e.Param.isPhone?l=["highest"]:e.Param.isTablet&&(l=["highest","high"]);for(var u in r)for(var c=0;c<r[u].length;c++)"logo"===r[u][c].name&&"medium"===r[u][c].priority&&(r[u][c].priority="highest");var p=i(l);s={left:r.left.filter(n).filter(p),center:r.center.filter(n).filter(p),right:r.right.filter(n).filter(p)};var h=o.filter(function(e){return!(s.left.indexOf(e)>-1||s.center.indexOf(e)>-1||s.right.indexOf(e)>-1)}).length>0;b&&s.left.length+s.center.length+s.right.length===0?x.topnav=!1:0===s.left.filter(function(e){return"menu"===e.name}).length&&h&&s.left.unshift({name:"menu"}),e.Main.urlManager.get("backHome")&&s.right.push({name:"home"})}return{left:s.left.map(a),center:s.center.map(a),right:s.right.map(a),burger:o.map(a)}}function a(){P&&P.parentNode.removeChild(P),w&&w.parentNode.removeChild(w);var t=e.Main.xmlManager.get("common-ui","menu")||i();if(x.topnav&&(e.Main.templateManager.loadPrepend(e.Param.pathTemplate+"menuTopnav.html",e.Param.viewMain,{theme:b?"v4":"v3",visible:x.topnavAlwaysVisible,itemsLeft:n(t.left),itemsCenter:n(t.center),itemsRight:n(t.right)}).then(function(e){P=document.querySelector(b?".webpub-topnav-v4":".webpub-topnav")}),x.topnavAlwaysVisible)){var a={paddingTop:b?45:60,paddingBottom:0};e.Main.viewerService.set(a)}var r={theme:b?"v4":"v3",items:n(t.burger),title:document.getElementsByTagName("title")[0].innerText},o=e.Main.xmlManager.get("common-ui","logo");o&&(r.logoSrc=e.Utils.resolveVariable(o.image)),e.Main.templateManager.loadAppend(e.Param.pathTemplate+"menuAside.html",document.body,r).then(function(t){if(b){w=document.querySelector(".webpub-aside-menu-v4");var n=document.querySelector(".webpub-aside-menu-v4__header-close"),i=w.querySelector(".webpub-aside-menu-v4__paging-wrapper");n.addEventListener(e.Param.eventStart,p,!1),e.Main.startupManager.has("ui.paging.counter.target","menu")&&e.Main.paginationManager.addPagination("counter",i)}else w=document.querySelector(".webpub-aside-menu");e.Utils.preventOverScroll(document.querySelector(".webpub-aside-menu, .webpub-aside-menu-v4")),setTimeout(function(){return T.resolve(!0)},0)}),e.Main.eventEmul.listenEvent("showMenu",e.API.menuToggle)}function r(e,t){}function o(){x.topnav?x.topnavAlwaysVisible||u():h()}function s(){return!!P&&(y||(P.classList.add(S),y=!0),!0)}function l(){return!!P&&(y&&!x.topnavAlwaysVisible&&(P.classList.remove(S),y=!1),!0)}function u(){y?l():s()}function c(){return E===!1&&(C(),E=!0,!0)}function p(){return!!E&&(L(),E=!1,!0)}function h(){E?p():c()}function d(t){if("string"==typeof t){var n=e.Main.menuService.get(t);if(n===!1&&(t+="_btn",n=e.Main.menuService.get(t)),n&&"function"==typeof n.onclick)return _.indexOf(t)===-1&&n.onload(),n.onclick(),!0}return!1}function m(){var t=e.Main.xmlManager.get("common-ui","menu");for(var n in t)if(t[n].indexOf("menu")!==-1)return!0;return!1}function f(e){for(var t in e)"undefined"!=typeof x[t]&&(x[t]=e[t])}function g(e){f(e),a(),t(),M=!0}function v(e){for(var t=document.querySelectorAll(".webpub-aside-menu-v4__type-"+e+", .webpub-topnav-v4__type-"+e+", .webpub-aside-menu__type-"+e+", .webpub-topnav__type-"+e),n=0;n<t.length;n++)t[n].classList.add("webpub--active")}var b=e.Param.newThemeVersion,y=!1,E=!1,M=!1,P=!1,w=!1,S=b?"webpub-topnav-v4--visible":"webpub-topnav--visible",_=[],T={};T.promise=new Promise(function(e,t){T.resolve=e,T.reject=t});var x={topnav:!0,topnavAlwaysVisible:!0},C=function(){function t(){e.Main.trackerManager.trackEvent({name:"menuOpen"})}return b?function(){w.classList.add("webpub-aside-menu-v4--open"),e.Utils.fadeIn(w),t()}:function(){e.Param.viewMain.classList.add("menu-open"),t()}}(),L=function(){function t(){e.Main.trackerManager.trackEvent({name:"menuClose"})}return b?function(){w.classList.remove("webpub-aside-menu-v4--open"),e.Utils.fadeOut(w),t()}:function(){e.Param.viewMain.classList.remove("menu-open"),t()}}();return{init:g,addItem:r,buildMenu:a,showTopnav:s,hideTopnav:l,toggleTopnav:u,showMenu:c,hideMenu:p,toggleMenu:h,onDocumentClick:o,callButtonClick:d,setActive:v,hasMenuBurger:m}}}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){NIApi.register("menu.setBadge",function(t,n){for(var i=document.querySelectorAll('[data-menu="'+t+'"] [data-section="badge"]'),a=0;a<i.length;a++)i[a].innerHTML=n;e.Main.menuService.set(t,{badge:n})}),NIApi.register("menu.setTitle",function(e,t){for(var n=document.querySelectorAll('[data-menu="'+e+'"]'),i=0;i<n.length;i++){n[i].hasAttribute("data-tooltip")&&n[i].setAttribute("data-tooltip",t);var a=n[i].querySelector('[data-section="title"]');a&&(a.innerHTML=t)}}),NIApi.register("menu.setIcon",function(t,n,i){i=i||document;for(var a=i.querySelectorAll('[data-menu="'+t+'"] [data-section="icon"]'),r=0;r<a.length;r++)if("object"===("undefined"==typeof n?"undefined":_typeof(n)))n.url?a[r].src=e.Utils.resolveVariable(n.url):n.text;else{var o=a[r].querySelector("svg");e.Utils.svgIcon(o,{icon:n})}}),e.Class.MenuService=function(){function t(e){var t=r[e];if(t){for(var n=a.length;n--;)t[a[n].key]||(t[a[n].key]=a[n]["default"]);return t.name=e,t}return!1}function n(t,n){var i=Object.keys(n);if("undefined"!=typeof r[t]&&i.length>0){for(var o=i.length;o--;)for(var s=0;s<a.length;s++)a[s].key===i[o]&&(r[t][i[o]]=e.Utils.resolveVariable(n[i[o]]));return!0}return!1}function i(e,t){return!("undefined"!=typeof r[e]||!t.label&&!t.template)&&(r[e]={},n(e,t))}var a=("v4"===e.Main.urlManager.get("viewer")||"v4"===e.Main.startupManager.get("core.viewer"),[{key:"label","default":""},{key:"icon","default":!1},{key:"onclick","default":e.Utils.noop},{key:"onload","default":e.Utils.noop},{key:"badge","default":""},{key:"template","default":!1}]),r={menu:{icon:"menu",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuToggle()}},documentback:{label:e.Main.xmlManager.get("locale","menu_documentback"),icon:"left-arrow",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuClose()}},page_control:{template:"menuItem-page_control"},logo:{label:"LOGO",template:"menuItem-logo",onclick:function(){var t=this.querySelector(".menu-item--logo");return t.hasAttribute("href")&&e.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:t.getAttribute("href")}}),!1}},custom:{label:"",template:"menuItem-custom"},share_btn:{label:e.Main.xmlManager.get("locale","menu_sharethis"),icon:"share",onclick:function(){e.API.menuClose(),e.Utils.prodTools.showTools(!1),e.Main.shareManager.toggle("home")},onload:function(){"undefined"==typeof e.Main.thumbnailListManager&&(e.Main.thumbnailListManager=new e.Class.ThumbnailListManager)}},thumbnails_btn:{label:e.Main.xmlManager.get("locale","menu_thumbnail"),icon:"pages",onclick:function(){e.Main.thumbnailListManager.show("none")},onload:function(t){"undefined"==typeof e.Main.thumbnailListManager&&(e.Main.thumbnailListManager=new e.Class.ThumbnailListManager),(e.Main.urlManager.contains("bookmarks")||e.Main.urlManager.contains("bookmark"))&&e.Main.thumbnailListManager.show("sharedBy")}},favorite_btn:{label:e.Main.xmlManager.get("locale","menu_favorite"),icon:"favorite",onclick:function(){e.Class.LightboxManagerNew.closeAll(),e.API.menuClose(),e.Main.thumbnailListManager.getToastData().then(function(t){e.Utils.toast({html:t,duration:3e3,position:"top-right",className:"webpub-toast-favorite"})})},onload:function(){"undefined"==typeof this.event&&(this.event=!1),"undefined"==typeof e.Main.thumbnailListManager&&(e.Main.thumbnailListManager=new e.Class.ThumbnailListManager),this.event===!1&&(NIApi.event.onPageChange(function(){e.Utils.removeToast()}),this.event=!0)}},search_btn:{label:e.Main.xmlManager.get("locale","menu_search"),icon:"search",onclick:function(){e.Main.searchManager.show()},onload:function(t){"undefined"==typeof e.Main.searchManager&&(e.Main.searchManager=new e.Class.SearchManager),e.Main.searchManager.init()}},email_btn:{label:e.Main.xmlManager.get("locale","menu_mail"),icon:"mail",onclick:function(){"mailto"===e.Param.mailType?e.Main.shareMailManager.doMailTo():e.Main.shareMailManager.load(),e.Main.trackerManager.trackPage({name:"share-email"})}},summary_btn:{label:e.Main.xmlManager.get("locale","menu_summary"),icon:"list",onclick:function(){e.Main.summaryManager.show()}},drive_btn:{label:e.Main.xmlManager.get("locale","menu_gallery"),icon:"image",onclick:function(){e.API.menuClose();var t=e.Main.xmlManager.get("common-configuration","contents","gallery","path");e.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:t}}),window.open(t)},onload:function(t){return null===e.Main.xmlManager.get("common-configuration","contents","gallery","path")&&t.parentNode.removeChild(t),!1}},fullscreen_btn:{label:e.Main.xmlManager.get("locale","menu_fullscreen"),icon:"fullscreen",onclick:function(){e.Main.fullScreenManager.fullScreenToggle()},onload:function(){return function(t){if(e.Main.fullScreenManager.hasFullScreen()===!1)return t.style.display="none",!1}}()},home:{label:"Home",icon:"close-1",onclick:function(){return e.API.menuClose(),e.Main.urlManager.get("backHome")&&(document.location=e.Starter.main.backHomeString),!1}},welcomepage_btn:{label:e.Utils.prodTools.getWordLangueByIndex("menu_welcomepage_btn"),icon:"home",onclick:function(){e.API.menuClose(),e.API.welcomepageOpen()},onload:function(t){var n=e.Main.startupManager.get("startup.welcomepage.url");if(!n)return t.style.display="none",!1}},pinterest_btn:{label:e.Main.xmlManager.get("locale","menu_pinterest_share"),icon:"pinterest",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("pinterest")}},twitter_btn:{label:e.Main.xmlManager.get("locale","menu_twitter_share"),icon:"twitter",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("twitter")}},tumblr_btn:{label:e.Main.xmlManager.get("locale","menu_tumblr_share"),icon:"tumblr",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("tumblr")}},linkedin_btn:{label:e.Main.xmlManager.get("locale","menu_linkedin_share"),icon:"linkedin",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("linkedin")}},googleplus_btn:{label:e.Main.xmlManager.get("locale","menu_googleplus_share"),icon:"googleplus",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("googleplus")}},facebook_btn:{label:e.Main.xmlManager.get("locale","menu_facebook_share"),icon:"facebook",onclick:function(){e.API.menuClose(),e.Main.shareManager.shareSocial("facebook")}},cart_btn:{label:e.Main.xmlManager.get("locale","tooltip_panel_cart"),icon:"cart-1",onload:function(){window.addEventListener("wishList-changeProductList",function(){NIApi.wishlist.getCounter().then(function(e){NIApi.menu.setBadge("cart_btn",e)})})},onclick:function(){"undefined"!=typeof wishList&&(e.API.menuClose(),wishList.listPanel.open())}},print_btn:{label:e.Main.xmlManager.get("locale","menu_print"),icon:"print",onclick:function(){e.API.menuClose(),e.Main.shareManager.open("home","print")}},pdf_btn:{label:e.Main.xmlManager.get("locale","menu_download"),icon:"download",onclick:function(){e.API.menuClose(),e.Main.shareManager.open("home","download")}},zoom_btn:{label:e.Main.xmlManager.get("locale","menu_zoomup_btn"),alternativeLabel:e.Main.xmlManager.get("locale","menu_zoomdown_btn"),icon:"zoom-up",alternativeIcon:"zoom-down",onload:function(t){var n=t.getAttribute("data-alternativeIcon"),i=t.getAttribute("data-alternativeLabel"),a=e.Param.newThemeVersion?"-v4":"",r=null,o="",s="";window.addEventListener("webpub-zoom",function(){var l=this.label,u=this.icon.url?this.icon:this.icon+a;r!==e.Param.zoom&&(e.Param.zoom&&(n&&(u=this.alternativeIcon.url?this.alternativeIcon:this.alternativeIcon+a),i&&(l=this.alternativeLabel)),o!==l&&NIApi.menu.setTitle("zoom_btn",l),s!==u&&NIApi.menu.setIcon("zoom_btn",u,t),o=l,s=u,r=e.Param.zoom)}.bind(this))},onclick:function(){e.Main.viewerManager.isZoomed()?e.Main.viewerManager.zoomOut():e.Main.viewerManager.zoomIn()}},zoomup_btn:{label:e.Main.xmlManager.get("locale","menu_zoomup_btn"),icon:"zoom-up",onclick:function(){e.Main.viewerManager.zoomIn()}},zoomdown_btn:{label:e.Main.xmlManager.get("locale","menu_zoomdown_btn"),icon:"zoom-down",onclick:function(){e.Main.viewerManager.zoomOut()}}};return r.pagemark_btn=r.favorite_btn,{get:t,set:n,add:i}}}(webpublicationNamespace),function(e){function t(){}function n(e,t){return e.index-t.index}function i(t){for(var n=t.length;n--;)t[n].content.forEach(function(i){if(i.circle)t[n].type="circle";else if(i.text)t[n].type="text";else if(i.file){"/"===i.file.url[i.file.url.length-1]&&i.file.url.indexOf("http:")===-1&&(i.file.url+="index.html");var a=/(?:\.([^.]+))?$/.exec(i.file.url)[1];a?(a=a.toUpperCase(),["JPG","JPEG","PNG","SVG","GIF"].indexOf(a)>=0?t[n].type="image":"JSON"===a?t[n].type="swiffy":"HTML"===a.substring(0,4)?(t[n].content[0].file.url=e.Utils.addParamsToUrl(t[n].content[0].file.url,"_zonesecure_sessionID="+e.Param.sessionId),t[n].type="iframe"):"SWF"===a?t[n].type="boh":t[n].type="boh"):t[n].type="boh"}else i.roundrect?t[n].type="roundrect":i.rect?t[n].type="rect":i.roundrectcomplex?t[n].type="roundrectcomplex":i.symbol?t[n].type="symbol":i.video?t[n].type="video":t[n].type="boh";i.x=parseInt(i.x),i.y=parseInt(i.y),i.width=parseInt(i.width),i.height=parseInt(i.height)});return t}var a,r={},o={},s="zoom";t.prototype.getCurrent=function(){return e.Main.pagesLoaderNew.getCurrentPage()},t.prototype.getImage=function(t,n){if("undefined"==typeof n&&(n=e.Main.pageManager.getCurrent()),"mdpi"===t)return e.Main.xmlManager.get("common-configuration","contents","low","path").replace("%num%",n);if("ldpi"===t){var i=e.Main.xmlManager.get("common-configuration","contents","thumbnails_xdpi","path"),a=e.Main.xmlManager.get("common-configuration","contents","thumbnails","path");return i?i.replace("%num%",n):a.replace("%num%",n)}return"svg"===t?e.Main.xmlManager.get("common-configuration","contents","svg","path").replace("%num%",n):e.Main.xmlManager.get("common-configuration","contents",s,"path").replace("%num%",n)},t.prototype.getSvg=function(t){return e.Main.xmlManager.get("common-configuration","contents","svg","path").replace("%num%",t)},t.prototype.getPdf=function(t){return e.Main.xmlManager.get("common-configuration","contents","pdf","path").replace("%num%",t)},t.prototype.getEpubHtml=function(t){return e.Main.xmlManager.get("common-configuration","contents","epub-HTML","path").replace("%num%",t)},t.prototype.getPdfHtml=function(t){return e.Main.xmlManager.get("common-configuration","contents","pdf-HTML","path").replace("%num%",t)},t.prototype.hasLinks=function(e){return!!r[e]},t.prototype.getLinks=function(t){return(r[t]||[]).filter(function(t){return("single"!==t.layout||2!==this.pagePerScreen())&&(("double"!==t.layout||1!==this.pagePerScreen())&&(("landscape"!==t.orientation||e.Param.isPortrait!==!0)&&("portrait"!==t.orientation||e.Param.isPortrait!==!1)))},this)},t.prototype.getRealLinks=function(e){return r[e]},t.prototype.getLinksPromise=function(t){return!!r[t]||(void 0===o[t]?(o[t]=new Promise(function(a,s){var l=new XMLHttpRequest,u=e.Main.xmlManager.get("common-configuration","contents","links","path").replace("%num%",t);l.open("GET",u,!0),l.onreadystatechange=function(){if(4===l.readyState){for(var s=[],u=null,c=l.responseXML?l.responseXML.querySelectorAll("lk"):[],p=0;p<c.length;p++)if(u=c[p].getAttribute("aim"),null===u||u.split(",").indexOf("html")!==-1){for(var h={index:c[p].getAttribute("index")||null,id:c[p].getAttribute("id")||null,layout:c[p].getAttribute("layout")||null,orientation:c[p].getAttribute("orientation")||null,useract:[],content:[]},d=c[p].querySelectorAll("content"),m=0;m<d.length;m++){var f,g={y:d[m].getAttribute("y"),x:d[m].getAttribute("x"),width:d[m].getAttribute("width"),height:d[m].getAttribute("height"),id:d[m].getAttribute("id")},v=d[m].querySelector("*");g[v.tagName]={};for(var b=0;b<v.attributes.length;b++)f=v.attributes[b].value,"true"===f?g[v.tagName][v.attributes[b].name]=!0:"false"===f?g[v.tagName][v.attributes[b].name]=!1:g[v.tagName][v.attributes[b].name]=e.Utils.resolveVariable(f);v.textContent&&(g.textContent=v.textContent),h.content.push(g)}for(var y=c[p].querySelectorAll("useract"),E=0;E<y.length;E++){for(var M={},P=0;P<y[E].attributes.length;P++)M[y[E].attributes[P].name]=y[E].attributes[P].value;M.textField=y[E].textContent,h.useract.push(M)}s.push(h)}s=i(s.sort(n)),r[t]=s,a(s),o[t]=void 0,delete o[t]}},l.send()}),o[t].isNew=!0):o[t].isNew=!1,o[t])},t.prototype.pagePerScreen=function(){var t=e.Main.pageLayoutService.get("pageLayout");return"single"===t?function(){return 1}:"double"===t?function(){return 2}:function(){var t=e.Main.xmlManager.get("common-configuration","contents","zoom","width"),n=e.Main.xmlManager.get("common-configuration","contents","zoom","height");return t>n?1:e.Param.isPortrait?1:2}}(),t.prototype.pagesOnFirstScreen=function(){var t=e.Main.pageLayoutService.get("pagesOnFirstFrame"),n=e.Main.pageManager.pagePerScreen();return t<=n?t:n},t.prototype.getBackgroundColor=function(t){return e.Main.commonLayout.get("pages."+t+".backgroundColor")||"transparent"},t.prototype.set=function(t){e.Main.xmlManager.get("common-ui","configs","deepLinking")===!0&&("undefined"==typeof e.Main.urlManager.get("page")&&e.Main.urlManager.set("page",t),t!==a&&(a=t,e.Main.urlManager.set("page",t)))},t.prototype.onChange=function(){var t=[];return window.addEventListener("hashchange",function(n){e.Main.urlManager.init();var i=parseInt(e.Main.urlManager.get("page"),10);if(i!==a)for(var r=0;r<t.length;r++)t[r](i)}),function(e){t.push(e)}}(),t.prototype.init=function(){var t=screen.height||window.innerHeight,n=screen.width||window.innerWidth,i=!0;e.Param.isDesktop===!1&&Math.max(t,n)*window.devicePixelRatio<=1300&&(i=!1),null!==e.Main.xmlManager.get("common-configuration","contents","zoom_hd","path")&&i&&(s="zoom_hd")},e.Class.PageManager=t}(webpublicationNamespace),function(e){e.Class.PagesLoaderNew=function(){function t(e){r=e;for(var t=o.length;t--;)o[t](r)}function n(){return r}function i(){return e.Main.xmlManager.get("common-configuration","config","pageCount")}function a(e){"function"==typeof e&&o.push(e)}var r=1,o=[];return{setCurrentPage:t,getCurrentPage:n,getPageQuantity:i,addPageChangeCallback:a}}}(webpublicationNamespace),function(e){e.Class.PaginationManager=function(){function t(t){NIApi.page["open"+e.Utils.capitalize(t)]()}function n(e){isNaN(e)||NIApi.page.open(e)}function i(e){return e<=m?h.parseIntToRoman(e):e-m}function a(t,n){if(Object.keys(g).indexOf(t)!==-1&&"undefined"!=typeof n&&g[t].active===!0){g[t].added=!0,g[t].type=t;var i=e.Main.templateManager.loadAppend(e.Param.pathTemplate+"pagination.html",n,g[t]);y[g[t].type]&&i.then(y[g[t].type])}}function r(e){for(var t=Object.keys(g),n=t.length;n--;)g[t[n]].active===!0&&g[t[n]].added===!0&&g[t[n]].alwaysVisible===!1&&E[t[n]]&&E[t[n]](e)}function o(){c=window.innerWidth,p=window.innerHeight}function s(t){t.mode&&(t.mode.indexOf("bottom")>=0&&(t.mode[t.mode.indexOf("bottom")]="counter"),t.bottom&&(t.counter=t.bottom),t.mode.indexOf("lateral")>=0&&(g.lateral.active=!0,t.lateral&&(t.lateral.display?g.lateral.alwaysVisible="sticky"===t.lateral.display:g.lateral.alwaysVisible=g.lateral.alwaysVisible,t.lateral.hasOwnProperty("hasPrevNext")?g.lateral.prevNext=t.lateral.hasPrevNext:g.lateral.prevNext=g.lateral.prevNext,t.lateral.hasOwnProperty("hasFirstLast")?g.lateral.firstLast=t.lateral.hasFirstLast:g.lateral.firstLast=g.lateral.firstLast),e.Param.isDesktop===!1&&g.lateral.alwaysVisible===!1&&(g.lateral.active=!1)),t.mode.indexOf("counter")>=0&&(g.counter.active=!0,(t.counter&&"sticky"===t.counter.display||e.Param.newThemeVersion&&e.Main.startupManager.has("ui.paging.counter.target","menu"))&&(g.counter.alwaysVisible=!0),g.counter.popup=e.Param.newThemeVersion===!1||e.Main.startupManager.has("ui.paging.counter.target","document")))}function l(){window.addEventListener(e.Param.eventResize,o)}function u(e){s(e),l(),o(),d=!0}var c=0,p=0,h=Math,d=!1,m=e.Main.xmlManager.get("common-configuration","config","shift"),f={left:null,right:null,leftSvgs:null,rightSvgs:null},g={lateral:{alwaysVisible:!1,firstLast:!0,prevNext:!0,active:!1},counter:{alwaysVisible:!1,active:!1}},v=function(t){return e.Main.viewerManager.getPagesOfFrame(e.Main.viewerManager.getFrameOfPage(t)).map(i).join(" - ")},b={lateral:function(t){f.left=f.left||e.Param.viewMain.querySelector(".webpub-pagination__lateral-left"),f.right=f.right||e.Param.viewMain.querySelector(".webpub-pagination__lateral-right"),f.leftSvgs=f.leftSvgs||f.left.querySelectorAll("svg"),f.rightSvgs=f.rightSvgs||f.right.querySelectorAll("svg");var n=e.Utils.prodTools.getPageLength(),i=e.Main.viewerManager.getFrameOfPage(t),a=e.Main.viewerManager.getFrameOfPage(n);1===t?f.left.classList.add("hide"):f.left.classList.remove("hide"),i===a?f.right.classList.add("hide"):f.right.classList.remove("hide"),NIApi.page.getVisiblePages().then(function(t){var n="pages."+t[0]+".paginationBackground",i="pages."+t[0]+".paginationColor";f.left.style.backgroundColor=e.Main.commonLayout.get(n)||"",Array.prototype.map.call(f.leftSvgs,function(t){t.style.fill=e.Main.commonLayout.get(i)||""}),n="pages."+t[t.length-1]+".paginationBackground",i="pages."+t[t.length-1]+".paginationColor",f.right.style.backgroundColor=e.Main.commonLayout.get(n)||"",Array.prototype.map.call(f.rightSvgs,function(t){t.style.fill=e.Main.commonLayout.get(i)||""})})},counter:function(e){g.counter.current.innerHTML=v(e)}},y={lateral:function(n){for(var i=n.length;i--;)n[i].classList.contains("webpub-pagination__lateral-left")?g.lateral.left=n[i]:n[i].classList.contains("webpub-pagination__lateral-right")&&(g.lateral.right=n[i]);if(g.lateral.prevNext&&(g.lateral.left.querySelector(".webpub-pagination__lateral-arrow-prev").addEventListener(e.Param.eventStart,t.bind({},"previous")),g.lateral.right.querySelector(".webpub-pagination__lateral-arrow-next").addEventListener(e.Param.eventStart,t.bind({},"next"))),g.lateral.firstLast&&(g.lateral.left.querySelector(".webpub-pagination__lateral-arrow-first").addEventListener(e.Param.eventStart,t.bind({},"first")),g.lateral.right.querySelector(".webpub-pagination__lateral-arrow-last").addEventListener(e.Param.eventStart,t.bind({},"last"))),g.lateral.alwaysVisible){var a={paddingLeft:52,paddingRight:52};e.Main.viewerService.set(a)}else document.addEventListener("mousemove",function(e){var t=e.clientX;t<120||t<.2*c?(g.lateral.left.classList.remove("opacity-zero"),g.lateral.left.classList.add("webpub-pagination__lateral-near")):(g.lateral.showed||g.lateral.left.classList.add("opacity-zero"),g.lateral.left.classList.remove("webpub-pagination__lateral-near")),t>c-120||t>.8*c?(g.lateral.right.classList.remove("opacity-zero"),g.lateral.right.classList.add("webpub-pagination__lateral-near")):(g.lateral.showed||g.lateral.right.classList.add("opacity-zero"),g.lateral.right.classList.remove("webpub-pagination__lateral-near"))},!0);e.Main.pagesLoaderNew.addPageChangeCallback(b.lateral)},counter:function(t){var i,a,r,o;i=e.Main.pagesLoaderNew.getPageQuantity()-m,a=e.Main.pagesLoaderNew.getCurrentPage(),r=v(a),o=e.Main.pagesLoaderNew.addPageChangeCallback;for(var s=function(){g.counter.popup.dom.classList.add("display-none"),g.counter.popup.current.blur()},l=function(){n(parseInt(g.counter.popup.current.value)+m)},u=t.length;u--;)t[u].classList.contains("webpub-pagination__counter-container")?(g.counter.dom=t[u],g.counter.current=t[u].querySelector(".webpub-pagination__counter-current"),g.counter.current.innerHTML=r,t[u].querySelector(".webpub-pagination__counter-total").innerHTML=i):t[u].classList.contains("webpub-pagination__popup-container")&&(g.counter.popup={},g.counter.popup.close=s,g.counter.popup.goToPage=l,g.counter.popup.dom=t[u],g.counter.popup.current=t[u].querySelector(".webpub-pagination__popup-current"),t[u].querySelector(".webpub-pagination__popup-total").innerHTML=i);(e.Param.newThemeVersion===!1||e.Main.startupManager.has("ui.paging.counter.target","document"))&&(g.counter.dom.addEventListener(e.Param.eventStart,function(t){("mousedown"!==t.type&&"click"!==t.type||0===t.button)&&(g.counter.popup.dom.classList.remove("display-none"),g.counter.popup.current.value=Math.max(e.Main.pagesLoaderNew.getCurrentPage()-m,0),g.counter.popup.current.focus())}),g.counter.popup.dom.querySelector(".webpub-pagination__popup-close").addEventListener(e.Param.eventClick,g.counter.popup.close),g.counter.popup.dom.querySelector("form").addEventListener("submit",function(e){return g.counter.popup.goToPage(),g.counter.popup.close(),e.preventDefault(),!1}),g.counter.popup.current.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),g.counter.popup.close())}),g.counter.popup.current.addEventListener("keyup",function(e){13===e.keyCode?g.counter.popup.close():g.counter.popup.goToPage()})),o(b.counter)}},E={lateral:function(e){e?(g.lateral.showed=!0,g.lateral.left.classList.remove("opacity-zero"),g.lateral.right.classList.remove("opacity-zero")):(g.lateral.showed=!1,g.lateral.left.classList.contains("webpub-pagination__lateral-near")||g.lateral.left.classList.add("opacity-zero"),g.lateral.right.classList.contains("webpub-pagination__lateral-near")||g.lateral.right.classList.add("opacity-zero"))},counter:function(t){t?e.Utils.fadeIn(g.counter.dom):e.Utils.fadeOut(g.counter.dom)}};return{init:u,addPagination:a,showPaginations:r}}}(webpublicationNamespace),function(e){function t(){NIApi.register("page.downloadPDF",function(t){return Promise.resolve(e.Main.pdfManager.download(t.toUpperCase()))}),NIApi.register("page.print",function(t){return"undefined"==typeof t&&(t="ALL"),"string"==typeof t&&(t=t.toUpperCase()),"ALL"===t?Promise.resolve(e.Main.pdfManager.print):Promise.resolve(e.Main.pdfManager.print.bind({},t))})}function n(){t()}n.prototype._getUrl=function(t,n){if(t.indexOf(";")!==-1||t.indexOf("-")!==-1){for(var i=t.split(";"),a=e.Main.xmlManager.get("common-configuration","config","pageCount"),r=[],o=0;o<i.length;o++)if(i[o].indexOf("-")!==-1)for(var s=parseInt(i[o].split("-")[0],10),l=parseInt(i[o].split("-")[1],10)>a?a:parseInt(i[o].split("-")[1],10);s<=l;s++)r.indexOf(s)===-1&&r.push(s);else{var u=parseInt(i[o],10)>a?a:parseInt(i[o],10);r.indexOf(u)===-1&&r.push(u)}r=r.filter(Boolean).sort(function(e,t){return e-t}),t=r.join(",")}var c=e.Utils.resolveVariable("${manager_host}/services/rest/playerGateway/pdfmerge");return c=e.Utils.addParamsToUrl(c,"genId="+e.Main.xmlManager.getVariable("id")),c=e.Utils.addParamsToUrl(c,"clientId="+e.Main.xmlManager.getVariable("client_id")),c=e.Utils.addParamsToUrl(c,"pages="+t),"print"===n&&(c=e.Utils.addParamsToUrl(c,"print=true")),c},n.prototype.download=function(t){t=t||"ALL";var n=this._getUrl(t,"download");e.Main.trackerManager.trackEvent({name:"pdfDownload",variables:{1:t}});window.open(n,"_blank");return Promise.resolve(!0)},n.prototype.print=function(t){if(t=t||"ALL",e.Param.isDesktop||e.Param.isUnknown){var n=this._getUrl(t,"print");e.Main.trackerManager.trackEvent({name:"print",variables:{1:t}}),window.open(n,"_blank")}else this.download(t)},e.Class.PdfManager=n}(webpublicationNamespace),function(e){e.Utils.prodTools={},e.Utils.prodTools.getPageLength=function(){return e.Main.xmlManager.get("common-configuration","config","pageCount")},NIApi.register("common.getDeviceInformation",function(){var t={};return t.type=e.Param.userAgent.device.type,t.os=e.Param.userAgent.os.name+" "+e.Param.userAgent.os.version,t.browser=e.Param.userAgent.browser.name,t.isApp=e.Param.isApp,Promise.resolve(t)}),NIApi.register("event.onPageChange",function(t){return e.Main.pagesLoaderNew.addPageChangeCallback(t),!0}),NIApi.register("page.getVisiblePages",function(){return Promise.resolve(e.Utils.getVisiblePages())}),NIApi.register("navigator.openUrl",function(t){return Promise.resolve(window.open(e.Utils.resolveVariable(t),"_blank"))}),NIApi.register("navigator.close",function(t){return e.Main.menuService.get("home").onclick(),Promise.resolve(!0)}),NIApi.register("page.clickButton",function(e,t){return console.log("TODO : in developpement"),Promise.resolve()}),NIApi.register("viewer.changeMode",function(t){return console.log("TODO : in developpement"),e.Utils._assertString(t,"Page number must be a string"),Promise.resolve()}),NIApi.register("tab.open",function(t){return console.log("TODO : in developpement"),e.Utils._assertInteger(t,"Page number must be an integer")?Promise.reject():Promise.resolve()}),e.Utils.prodTools.showTools=function(t){e.Main.toolsEvents.showTools(t)},e.Utils.prodTools.onPageChange=function(t){e.Main.pagesLoaderNew.addPageChangeCallback(t)},e.Utils.prodTools.getWordLangueByIndex=function(t){return e.Main.xmlManager.get("locale",t)}}(webpublicationNamespace),function(e){function t(){this.worker=null,this.counter=0,this.finalResultElement=null,this.notificationElement=null,this.resultElement=null,this.formField=null,this.searchedWord="",n()}function n(){NIApi.register("panels.search",{toggle:function(){e.Main.searchManager.toggle()}})}var i=[37,38,39,40];t.prototype.displayEnd=function(){this.setCounter(this.counter),this.finalResultElement.classList.add("search__searched"),0===this.counter?(this.notificationElement.classList.add("alert"),this.finalResultElement.classList.add("search__no-result")):(this.notificationElement.classList.add("notification"),this.finalResultElement.classList.add("search__has-result"))},t.prototype.displayResult=function(t){e.Main.templateManager.loadAppend(e.Param.pathTemplate+"component/searchItem.html",this.resultElement,{page:t.page,displayNumber:e.Utils.byOffsetIndex(t.page),string:t.string,label:t.label}),this.counter++},t.prototype.init=function(){this.worker=new Worker(e.Param.pathJavaScript+"workerSearch.js"),this.worker.addEventListener("message",function(t){
"parse"===t.data.method?this.worker.postMessage({method:"parsedString",data:e.JXONTree((new DOMParser).parseFromString(t.data.data,"text/xml")),page:t.data.page}):"result"===t.data.method?this.displayResult(t.data):"end"===t.data.method&&this.displayEnd(t.data)}.bind(this));var t={method:"config",pageLength:e.Main.xmlManager.get("common-configuration","config","pageCount"),xmlUrl:e.Param.pathRootForWorker+e.Main.xmlManager.get("common-configuration","contents","text","path")};t.wordSearch=!0,this.worker.postMessage(t)},t.prototype.reset=function(){this.resetContent(),this.formField.value="",this.searchedWord=""},t.prototype.resetContent=function(){this.notificationElement.classList.remove("alert"),this.notificationElement.classList.remove("notification"),this.finalResultElement.classList.remove("search__no-result"),this.finalResultElement.classList.remove("search__has-result"),this.finalResultElement.classList.remove("search__searched"),e.Main.searchManager.resultElement.innerHTML="",this.setCounter("")},t.prototype.search=function(t,n){n=n||2;var a=t?t.keyCode:t;i.indexOf(a)>=0||(this.resetContent(),this.counter=0,0!==this.formField.value.length&&(this.formField.value.length>=n||13===a&&this.formField.value.length<n)&&(this.resultElement.innerHTML="",e.Main.searchManager.worker.postMessage({method:"search",search:this.formField.value}),this.searchedWord=this.formField.value))},t.prototype.searchEvent=function(t){this.formField.value.length>=2&&(this.eventTimer&&clearTimeout(this.eventTimer),this.eventTimer=setTimeout(function(){e.Main.trackerManager.trackPage({name:"search-alt",variables:{1:this.formField.value}})}.bind(this),1e3))},t.prototype.setCounter=function(e){Array.prototype.slice.call(document.querySelectorAll(".search__counter")).forEach(function(t){t.innerHTML=e})},t.prototype.show=function(){var t=function(t){e.Main.searchManager.finalResultElement=t.querySelector(".search__final-result"),e.Main.searchManager.notificationElement=t.querySelector(".search__notification"),e.Main.searchManager.resultElement=t.querySelector(".search__result"),e.Main.searchManager.formField=t.querySelector(".search__form-field"),e.Main.searchManager.formField.addEventListener("keyup",e.Main.searchManager.search.bind(e.Main.searchManager)),e.Main.searchManager.formField.addEventListener("keyup",e.Main.searchManager.searchEvent.bind(e.Main.searchManager)),e.Main.searchManager.formField.addEventListener("keydown",function(e){if(13===e.keyCode||i.indexOf(e.keyCode)>=0)return 13===e.keyCode&&e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}),t.querySelector(".search__form-submit").addEventListener(e.Param.eventClick,function(t){e.Main.searchManager.search(t,1)}),t.querySelector(".search__form-reset").addEventListener(e.Param.eventClick,e.Main.searchManager.reset.bind(e.Main.searchManager)),e.Main.searchManager.resultElement.addEventListener(e.Param.eventClick,function(t){var n=e.Utils.getClosestByClass(t.target,"search__item");if(n!==!1){var i=n.getAttribute("data-page");NIApi.page.open(i),e.Class.LightboxManagerNew.closeAll()}});var n=e.Class.LightboxManagerNew.get("search-manager");n.setTitle(document.querySelector(".search__form")),""!==n.params.subtemplate.params.search&&e.Main.searchManager.search()};e.Main.trackerManager.trackPage({name:"search"}),new e.Class.LightboxManagerNew({id:"search-manager",theme:"page",menuButton:!1,animation:"none",subtemplate:{url:e.Param.pathTemplate+"search.html",params:{search:this.searchedWord}},onload:function(e){t(e[0])}})},t.prototype.toggle=function(){var t=document.querySelector("#webpub-lightbox-search-manager");t?e.Class.LightboxManagerNew.closeAll():e.Main.searchManager.show()},e.Class.SearchManager=t}(webpublicationNamespace),function(e){function t(t){t||(t=e.Utils.createUrlForPages()),t=e.Utils.whitelistParameters(t),t=t.replace("&","%26");var n="mailto:?subject="+document.title+"&body="+document.title+": %0D%0A "+t;return n}function n(t){for(var n={},r=[],s=t.querySelectorAll("input, textarea"),l=!0,u=0;u<s.length;u++){var c=s[u],p=!0;if(c.hasAttribute("data-validation")&&(p=a(c)),p){n[c.getAttribute("name")]=c.value;var h=r.indexOf(c.parentNode.getAttribute("data-error"));h>=0&&r.splice(h,1)}else l=!1,r.push(c.parentNode.getAttribute("data-error"))}if(l===!1)return o(r),!1;n.language=i(e.Main.xmlManager.getVariable("locale")),n.clientId=e.Main.xmlManager.getVariable("client_id"),n.genId=e.Main.xmlManager.getVariable("id"),e.Main.shareMailManager.url?n.pubUrl=e.Main.shareMailManager.url:n.pubUrl=e.Utils.createUrlForPages(n),n.pubUrl=e.Utils.whitelistParameters(n.pubUrl);var d=document.createElement("a");d.href=n.pubUrl,n.querySearch=d.search,n.queryHash=d.hash,n.queryHost=d.protocol+"//"+d.host+d.pathname;var m=e.Main.xmlManager.getVariables();for(var f in m)0===f.indexOf("transferring")&&"undefined"!=typeof m[f]&&(n[f]=m[f]);var g="",v=e.Main.xmlManager.get("common-ui","services","sendmail","subject");return g=n.transferring?e.Main.xmlManager.get("common-ui","services","sendmail","templateTransferring"):e.Main.xmlManager.get("common-ui","services","sendmail","template"),g&&(n.template=g),v&&(n.subject=v),n.extraAllowedParameters=[e.Main.xmlManager.get("config","transferringVariable")].join(","),n}function i(e){var t=/^([a-z][a-z]_[A-Z][A-Z])\..*$/,n=t.exec(e),i=n?n[1]:DEFAULT_LOCALE;return i}function a(t){if("mails"===t.getAttribute("data-validation")){var n=e.Utils.mailStringToArray(t.value);if(0===n.length)return t.parentNode.classList.add("alert"),!1;t.value=n.join(";").toLowerCase()}else if("required"===t.getAttribute("data-validation")&&!t.value)return t.parentNode.classList.add("alert"),!1;return t.parentNode.classList.remove("alert"),!0}function r(t){return"undefined"==typeof t||0===t.length?e.Main.xmlManager.get("locale","mail_send_error"):1===t.length?e.Main.xmlManager.get("locale","mail_"+t[0]+"_error"):t.length>1?e.Main.xmlManager.get("locale","mail_fields_error"):void 0}function o(t){e.Utils.toast({html:r(t),duration:3e3,position:"bottom"})}function s(t){"response=ok"!==t.responseText&&console.warn("mail_send_error : "+e.Main.xmlManager.get("locale","mail_send_error")),e.Utils.toast({text:e.Main.xmlManager.get("locale","mail_send_success"),duration:3e3}),document.getElementsByName("to")[0].value="",e.Class.LightboxManagerNew.get("shareManager")&&e.Main.shareManager.open("confirm")}function l(){}var u={};l.prototype.send=function(t){e.Utils.preventDefault(t);var i=n(this);if(i!==!1){u=i,e.Main.trackerManager.trackEvent({name:"shareMail"});var a=e.Main.xmlManager.get("common-ui","services","sendmail","url"),r=e.Utils.serialize(i);e.Utils.promiseXHR("POST",a,[{key:"Content-Type",value:"application/x-www-form-urlencoded; charset=UTF-8"}],r).then(s)["catch"](o)}},l.prototype.load=function(t,n){"undefined"==typeof n&&(n={}),t?this.url=t:this.url=null;var i=u,a=e.Main.shareManager.selectedThumb;i.sharedPages=a?a.pages:[],i.title=document.title,new e.Class.LightboxManagerNew({id:"thumbnails-manager",menuButton:!e.Param.isDesktop&&"close",closeButton:!!e.Param.isDesktop||this.createSendButton(),title:e.Main.xmlManager.get("locale","menu_mail"),theme:"page",animation:"none",subtemplate:{url:e.Param.pathTemplate+"shareMail.html",params:i},onload:function(t){var n=t[0].querySelector('.webpub-lightbox-page-header-close [data-action="submit"]');n&&n.addEventListener(e.Param.eventClick,function(){var t=document.querySelector(".webpub-lightbox-page-content"),n=t.querySelector('[data-action="submit"]');e.Utils.callEvent(n,"submit")}),t[0].querySelector('.webpub-lightbox-page-content [data-action="submit"]').addEventListener("submit",this.send)}.bind(this)})},l.prototype.createSendButton=function(){var t=document.createElement("div"),n=document.createElement("div"),i=e.Utils.createSvgIcon("send-v4","wpmt-button-icon-center svgicon-new svgicon-v4");return n.classList.add("wpmt-button__default"),n.classList.add("wpmt-button__type-mail"),n.classList.add("wpmt-button__style-tiny"),n.setAttribute("data-action","submit"),n.appendChild(i),t.appendChild(n),t},l.prototype.doMailTo=function(e){location.href=t(e)},e.Class.ShareMailManager=l}(webpublicationNamespace),function(e){e.Class.ShareManager=function(){function t(t,n){if((n||H[t]===!0)&&G[t]){var i=e.Utils.createUrlForPages({page:e.Main.urlManager.get("page")});return i=e.Utils.whitelistParameters(i),G[t](i),["print","download","mail"].indexOf(t)===-1&&e.Main.trackerManager.trackEvent({name:"shareSocial",variables:{1:e.Utils.capitalize(t)}}),!0}return!1}function n(){if(D="frame",2===N.length)W(A[1]);else{if(U=[e.Main.pageManager.getCurrent()],e.Main.shareManager.selectedThumb.pages=U,"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath)return void p(e.Main.shareManager.sharePanelPath);W(A[3])}}function i(){return"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?(I="pdf",void p(e.Main.shareManager.sharePanelPath)):(D="publication",W(A[2]),void Z(1))}function a(){e.Main.thumbnailListManager.show("share",e.Main.shareManager.sharePanelPath)}function r(t,n,i){return D="favorite",U=t,I=n,e.Main.shareManager.sharePanelPath=i,e.Main.shareManager.selectedThumb.pages=t,"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?void p(e.Main.shareManager.sharePanelPath):void W(A[3])}function o(e){e.length>0&&(U=e),D="favorite",W(A[3])}function s(){W(k!==A[3]||D===!1||"frame"===D&&1===N.length?A[0]:D)}function l(){if(k===A[1]){if(U=[],0===document.querySelectorAll(".webpub-share__checkbox--checked").length)return;document.querySelector(".webpub-share__left-page").classList.contains("webpub-share__checkbox--checked")?(U.push(N[0]),e.Main.shareManager.selectedThumb.pages.push(N[0])):e.Main.shareManager.selectedThumb.left=!1,document.querySelector(".webpub-share__right-page").classList.contains("webpub-share__checkbox--checked")?(U.push(N[1]),e.Main.shareManager.selectedThumb.pages.push(N[1])):e.Main.shareManager.selectedThumb.right=!1}else k===A[2]&&(document.querySelector(".webpub-share__online-url").classList.contains("webpub-share__checkbox--checked")?I="url":document.querySelector(".webpub-share__pdf").classList.contains("webpub-share__checkbox--checked")&&(I="pdf"));return"download"===e.Main.shareManager.sharePanelPath||"print"===e.Main.shareManager.sharePanelPath?void p(e.Main.shareManager.sharePanelPath):void W(A[3])}function u(t){var n=e.Utils.getClosestByClass(t.target,"webpub-share__item"),i=document.querySelector("[data-page="+n.getAttribute("data-page")+"]");i.classList.toggle("webpub-share__thumbnail-unchecked"),n.classList.toggle("webpub-share__checkbox--checked"),0===document.querySelectorAll(".webpub-share__checkbox--checked").length?document.querySelector(".webpub-share__button-confirm").classList.add("webpub-share__button-disabled"):document.querySelector(".webpub-share__button-confirm").classList.remove("webpub-share__button-disabled")}function c(t){var n=e.Utils.getClosestByClass(t.target,"webpub-share__item");n.classList.contains("webpub-share__online-url")?(n.classList.add("webpub-share__checkbox--checked"),document.querySelector(".webpub-share__pdf").classList.remove("webpub-share__checkbox--checked")):n.classList.contains("webpub-share__pdf")&&(n.classList.add("webpub-share__checkbox--checked"),document.querySelector(".webpub-share__online-url").classList.remove("webpub-share__checkbox--checked"))}function p(t){var n="";n=["print","download","mail"].indexOf(t)===-1?"frame"===D?e.Utils.createUrlForPages({page:U[0]}):"url"===I?e.Utils.createUrlForPages():e.API.pdfGetUrl():e.Utils.createUrlForPages({page:U[0]}),"favorite"===D&&(n=e.Utils.addParamsToUrl(n,"bookmarks="+U)),n=e.Utils.whitelistParameters(n),G[t](n),["print","download","mail"].indexOf(t)===-1&&e.Main.trackerManager.trackEvent({name:"shareSocial",variables:{1:e.Utils.capitalize(t)}}),["mail"].indexOf(t)===-1&&W(A[4])}function h(t,n){var i={download:"pdf",print:"print"};return e.Main.shareManager.sharePanelPath=n,e.Class.LightboxManagerNew.closeAll({except:["shareManager"]}),e.Main.shareManager.selectedThumb={left:!0,right:!0,pages:[]},("undefined"==typeof t||A.indexOf(t.toLowerCase())<0)&&(t=A[0]),C=!0,L&&clearTimeout(L),e.Main.trackerManager.trackPage({name:i[n]||"share"}),v(e.Main.pageManager.getCurrent()),W(t)}function d(){m()}function m(){return!!C&&(document.querySelector(".lightbox")?void h():(F&&F.close("shareManager"),C=!1,U=[],F=null,e.Utils.empty(O),!0))}function f(e,t){C?m():h(e,t)}function g(e){L&&clearTimeout(L),L=setTimeout(v.bind({},e),2e3)}function v(t){N=e.Utils.getVisiblePages(),Z(t)}function b(){}function y(){window.addEventListener(e.Param.eventResize,b)}function E(e){NIApi.register("page.shareSocial",function(t){return Promise.resolve(e.shareSocial(t,!0))}),NIApi.register("panels.share",{toggle:function(){e.toggle("home")}})}function M(e){for(var t in e)"undefined"!=typeof H[t]&&(H[t]=e[t]);B={facebook:H.facebook,twitter:H.twitter,googleplus:H.googleplus,linkedin:H.linkedin,pinterest:H.pinterest,tumblr:H.tumblr,instagram:H.instagram,vkontakte:H.vkontakte},P()}function P(){return H.mail=V.mail,H.print=V.print,H.download=V.download,"url"===I?(H.download=!1,H.print=!1,H.mail=!0):"pdf"===I&&(H.print=z,H.download=z,H.mail=!1),R={mail:H.mail,print:H.print,download:H.download}}function w(){for(var e={},t=!1,n=Object.keys(B),i=0;i<n.length;i++)H[n[i]]="pdf"!==I&&B[n[i]],e[n[i]]=H[n[i]],t=t||H[n[i]];return t===!1&&(e=!1),e}function S(t){switch(t){case"download":return e.Main.xmlManager.get("locale","menu_download");case"print":return e.Main.xmlManager.get("locale","menu_print");default:return t?t:e.Main.xmlManager.get("locale","menu_sharethis")}}function _(t){switch(t){case"download":return e.Main.xmlManager.get("locale","share_downloaded_confirm");case"print":return e.Main.xmlManager.get("locale","share_printed_confirm");default:return e.Main.xmlManager.get("locale","share_shared_confirm")}}function T(t){M(t),E(this),y(),e.Main.pagesLoaderNew.addPageChangeCallback(g),x=!0}var x=(e.Param.newThemeVersion,!1),C=!1,L=!1,A=["home","frame","publication","social","confirm"],k="",O=document.createElement("div"),D=!1,I=!1,N=[],U=[],R={},F=null,B=null,z=e.Param.userAgent.os.name!==e.Param.userAgent.OS.IOS||parseInt(e.Param.userAgent.os.version)>7,V={mail:!0,print:z,download:z,facebook:!0,twitter:!0,googleplus:!0,linkedin:!0,pinterest:!0,tumblr:!0,instagram:!1,vkontakte:!1},H={mail:!0,print:z,download:z,facebook:!0,twitter:!0,googleplus:!0,linkedin:!0,pinterest:!0,tumblr:!0,instagram:!1,vkontakte:!1},G={mail:function(t){"mailto"===e.Param.mailType?e.Main.shareMailManager.doMailTo(t):e.Main.shareMailManager.load(t)},print:function(){e.Main.shareManager.sharePanelPath="print","frame"===D||"favorite"===D?e.Main.pdfManager.print(U.join(",")):e.Main.pdfManager.print()},download:function(){e.Main.shareManager.sharePanelPath="download","frame"===D||"favorite"===D?e.Main.pdfManager.download(U.join(",")):e.Main.pdfManager.download()},facebook:function(t){var n=document.head.querySelector("meta[itemprop='image']"),i=document.head.querySelector("meta[itemprop='description']"),a=document.head.querySelector("meta[itemprop='name']");if(t="http://www.facebook.com/sharer.php?u="+encodeURIComponent(t),t+=n?"&picture="+n.content:"",t+=i?"&description="+i.content:"",t+=a?"&title="+a.content:"",e.Main.xmlManager.getXml("ui")){var r=e.Main.xmlManager.getXml("ui").querySelector("element#facebook_btn[template]");if(r){var o=r.querySelector("useract");o.hasAttribute("param")&&(t=o.getAttribute("param"))}}window.open(t,"_blank")},twitter:function(t){var n=document.head.querySelector("meta[itemprop='description']");if(t="https://twitter.com/share?url="+encodeURIComponent(t),t+=n?"&text="+n.content:"",e.Main.xmlManager.getXml("ui")){var i=e.Main.xmlManager.getXml("ui").querySelector("element#twitter_btn[template]");if(i){var a=i.querySelector("useract");a.hasAttribute("param")&&(t=a.getAttribute("param"))}}window.open(t,"_blank")},googleplus:function(t){if(t="http://plusone.google.com/_/+1/confirm?hl=fr&url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var n=e.Main.xmlManager.getXml("ui").querySelector("element#googleplus_btn[template]");if(n){var i=n.querySelector("useract");i.hasAttribute("param")&&(t=i.getAttribute("param"))}}window.open(t,"_blank")},linkedin:function(t){if(t="http://www.linkedin.com/shareArticle?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var n=e.Main.xmlManager.getXml("ui").querySelector("element#linkedin_btn[template]");if(n){var i=n.querySelector("useract");i.hasAttribute("param")&&(t=i.getAttribute("param"))}}window.open(t,"_blank")},pinterest:function(t){if(t="http://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var n=e.Main.xmlManager.getXml("ui").querySelector("element#pinterest_btn[template]");if(n){var i=n.querySelector("useract");i.hasAttribute("param")&&(t=i.getAttribute("param"))}}window.open(t,"_blank")},tumblr:function(t){if(t="http://www.tumblr.com/share/link?url="+encodeURIComponent(t),e.Main.xmlManager.getXml("ui")){var n=e.Main.xmlManager.getXml("ui").querySelector("element#tumblr_btn[template]");if(n){var i=n.querySelector("useract");i.hasAttribute("param")&&(t=i.getAttribute("param"))}}window.open(t,"_blank")},instagram:function(e){},vkontakte:function(e){}},j={home:function(){O.querySelector(".webpub-share__frame").addEventListener(e.Param.eventClick,n),O.querySelector(".webpub-share__publication").addEventListener(e.Param.eventClick,i),O.querySelector(".webpub-share__favorite").addEventListener(e.Param.eventStart,a),O.querySelector(".webpub-share__close").addEventListener(e.Param.eventClick,m),I=!1,D=!1},frame:function(){O.querySelector(".webpub-share__button-confirm").addEventListener(e.Param.eventClick,l),O.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s);for(var t=O.querySelectorAll(".webpub-share__item"),n=t.length;n--;)t[n].addEventListener(e.Param.eventClick,u,!1),e.Main.shareManager.selectedThumb[t[n].getAttribute("data-page")]&&t[n].classList.add("webpub-share__checkbox--checked")},publication:function(){O.querySelector(".webpub-share__button-confirm").addEventListener(e.Param.eventClick,l),O.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s);for(var t=O.querySelectorAll(".webpub-share__item"),n=t.length;n--;)t[n].addEventListener(e.Param.eventClick,c,!1);O.querySelector(".webpub-share__online-url").classList.add("webpub-share__checkbox--checked")},social:function q(){for(var q in H)H[q]===!0&&O.querySelector(".webpub-share__social-icon-"+q).addEventListener(e.Param.eventClick,p.bind({},q));O.querySelector(".webpub-share__button-back").addEventListener(e.Param.eventClick,s),O.querySelector(".webpub-share__close").addEventListener(e.Param.eventClick,m)},confirm:function(){window.setTimeout(function(){F.close("shareManager"),I=!1,D=!1,M(V)},2e3)}},W=function(){var t=function(){return new Promise(function(t){F?(F.setHTML(O.firstChild),t()):F=new e.Class.LightboxManagerNew({theme:"panel",html:O.firstChild,id:"shareManager",onclose:d,onload:t})})};return function(n){return k=n,e.Utils.empty(O),"favorite"===n&&(n="home"),e.Main.templateManager.loadAppend(e.Param.pathTemplate+"share"+e.Utils.capitalizeWord(n)+".html",O,{sharePanelTitle:S(e.Main.shareManager.sharePanelPath),confirmMessage:_(e.Main.shareManager.sharePanelPath),thumbnailUrlLeftInactive:!e.Main.shareManager.selectedThumb.left,thumbnailUrlRightInactive:!e.Main.shareManager.selectedThumb.right,thumbnailUrlLeft:e.Main.pageManager.getImage("ldpi",N[0]),thumbnailUrlRight:!!N[1]&&e.Main.pageManager.getImage("ldpi",N[1]),socials:w(),sendMethods:P()}).then(j[n]).then(t)}}(),Z=function(){var t=!1,n="";return function(i){if(t!==i){n=e.Utils.createUrlForPages({page:i}),t=i;var a=document.head.querySelector("meta[property='og:url']");a&&(a.content=n),t=i;var r=r||document.head.querySelector("meta[property='og:url']");null!==r&&(r.content=n)}}}();this.init=T,this.open=h,this.close=m,this.toggle=f,this.shareSocial=t,this.onPageChange=g,this.favoriteThumbnailsShare=r,this.favoriteDownloadShare=o}}(webpublicationNamespace),function(e){function t(){this.modulo=0,n(this)}function n(e){NIApi.register("panels.summary",{toggle:function(){e.toggle()}})}t.prototype.getOddEven=function(){return e.Utils.impair(this.modulo++)?"odd":"even"},t.prototype.getTest=function(t,n,i){for(var a=t.childNodes,r={},o=a.length,s={level:i,items:[],textContent:"",itemClass:"",itemTextClass:"",gotopage:null,pageNumber:null},l=0;l<o;l++)r=a[l],r&&r.nodeType!==r.TEXT_NODE&&("text"===r.localName?(s.textContent=r.textContent,s.itemClass=this.getOddEven(),o>1&&(s.itemTextClass="summary-content__chapter"),n&&(s.gotopage=n,s.pageNumber=e.Utils.byOffsetIndex(n))):"it"===r.localName&&s.items.push(this.getTest(r,r.getAttribute("p"),i+1)));return s},t.prototype.show=function(){var t=function(t){if(t[0]){var n=t[0].querySelector("[data-section=content]");n.addEventListener(e.Param.eventClick,function(t){var n=e.Utils.getClosestByClass(t.target,"summary-content__link"),i=n.getAttribute("data-page")||t.target.parentNode.getAttribute("data-page");i&&(e.API.pageLoad({number:i}),e.API.lightboxClose())})}},n=e.Main.xmlManager.get("summary","xml");new e.Class.LightboxManagerNew({id:"summary-manager",menuButton:!1,theme:"page",animation:"none",subtemplate:{url:e.Param.pathTemplate+"summary.html",params:{pageList:this.getTest(n.childNodes[0],null,0).items}},onload:t}),e.Main.trackerManager.trackPage({name:"contents"})},t.prototype.toggle=function(){var e=document.querySelector("#webpub-lightbox-summary-manager");e?NIApi.lightbox.closeAll():this.show()},e.Class.SummaryManager=t}(webpublicationNamespace),function(e){function t(t){if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.classList.toggle("webpub-data-item--favorited"),e.Main.thumbnailListManager.saveFavoritedThumbnails(this.getAttribute("data-favorite")),"favorite"===e.Main.thumbnailListManager.filter){var n=document.querySelector("[data-page='"+this.getAttribute("data-favorite")+"']");n.classList.remove("webpub-thumbnails-list__item-fade"),window.setTimeout(function(){n.style.display="none"},200);var i=document.querySelectorAll(".webpub-data-item--favorited");0===i.length&&e.Main.thumbnailListManager.updateContent(e.Main.thumbnailListManager.filter)}}function n(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var n=document.querySelectorAll("[data-page]"),i=this.getAttribute("data-filter-bookmarks");if(Array.prototype.forEach.call(n,function(e){e.classList.remove("webpub-thumbnails-list__item-fade")}),e.Param.isPhone){var a=t.target;i=a.options[a.selectedIndex].getAttribute("data-filter-bookmarks")}window.setTimeout(function(){e.Main.thumbnailListManager.updateContent(i)}.bind(this),200)}function i(t){var i,a=document.querySelectorAll("[data-filter-bookmarks]");if(e.Param.isPhone){var r=document.querySelector(".webpub-thumbnails-list__menu-select");r.addEventListener("change",n)}Array.prototype.forEach.call(a,function(a){e.Param.isPhone?(i=a.getAttribute("data-filter-bookmarks"),a.removeAttribute("selected"),i===t&&(a.setAttribute("selected",!0),a.parentNode.value=a.value)):(a.addEventListener(e.Param.eventClick,n),i=a.getAttribute("data-filter-bookmarks"),a.classList.remove("webpub-thumbnails-list__menu-item-active"),i===t&&a.classList.add("webpub-thumbnails-list__menu-item-active"))})}function a(e){var t=parseInt(this.getAttribute("data-page"),10);NIApi.page.open(t),NIApi.lightbox.closeAll()}function r(e){var t=document.querySelector(".webpub-action-bar__wrapper-display");t.style.display="block",window.setTimeout(function(){t.classList.toggle("webpub-action-bar__wrapper-display-visible")},200)}function o(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var n=[];if("none"!==e.Main.thumbnailListManager.filter){var i=document.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(i,function(e){e.classList.contains("webpub-data-item--favorited")&&n.push(e.getAttribute("data-favorite"))})}e.Main.shareManager.open("social","download").then(function(){e.Main.shareManager.favoriteDownloadShare(n)})}function s(n){var s=n[0];i(e.Main.thumbnailListManager.filter);var c=s.querySelectorAll("[data-page]");Array.prototype.forEach.call(c,function(t){t.addEventListener(e.Param.eventClick,a),window.setTimeout(function(){t.classList.add("webpub-thumbnails-list__item-fade")}.bind(this),100)});var p=s.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(p,function(n){n.addEventListener(e.Param.eventClick,t)});var h=s.querySelector('[data-action="confirm"]'),d=s.querySelectorAll(".webpub-action-bar__item");h&&h.addEventListener(e.Param.eventClick,l),Array.prototype.forEach.call(d,function(t){t.addEventListener(e.Param.eventClick,u)});var m=s.querySelector('[data-action="share"]');m&&m.addEventListener(e.Param.eventClick,r);var f=s.querySelector('[data-action="download"]');f&&f.addEventListener(e.Param.eventClick,o);var g=s.querySelector(".webpub-thumbnails-list__thumbnail");g&&(g.onload=function(){var e=s.querySelectorAll(".webpub-thumbnails-list__item-faker"),t=window.getComputedStyle(this).width;Array.prototype.forEach.call(e,function(e){e.style.width=t})},g.complete&&g.onload())}function l(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var n=document.querySelectorAll("[data-favorite]"),i=[],a=document.querySelector(".webpub-action-bar__share-mode.webpub-share__checkbox--checked");if(null===a)return void e.Utils.toast({text:e.Main.xmlManager.get("locale","multilinks_title"),duration:3e3,type:"error"});var r=a.getAttribute("data-share-mode");Array.prototype.forEach.call(n,function(t){"none"===e.Main.thumbnailListManager.filter?i.push(t.getAttribute("data-favorite")):t.classList.contains("webpub-data-item--favorited")&&i.push(t.getAttribute("data-favorite"))}),e.Main.shareManager.open("social").then(function(){e.Main.shareManager.favoriteThumbnailsShare(i,r,e.Main.thumbnailListManager.sharePanelPath)})}function u(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var n=e.Utils.getClosestByClass(t.target,"webpub-action-bar__item"),i=document.querySelectorAll(".webpub-action-bar__item");Array.prototype.forEach.call(i,function(e){e.classList.remove("webpub-share__checkbox--checked")}),n.classList.add("webpub-share__checkbox--checked")}function c(t){NIApi.register("panels.favorites",{toggle:function(){e.Utils.removeToast(),t.getToastData().then(function(t){e.Utils.toast({html:t,duration:3e3,position:"top-right",className:"webpub-toast-favorite"})})}}),NIApi.register("panels.thumbnail",{toggle:function(){t.toggle()}})}var p=function(){this.initFavoritedStorage(),this.sharedFavorite=e.Main.urlManager.get("bookmarks")||e.Main.urlManager.get("bookmark"),this.sharedWithMeFilter="undefined"!=typeof this.sharedFavorite,this.filter="none",c(this)};p.prototype.updateContent=function(e,t){var n=this.setParams(e,t);n.onload=s,this.popup.setSubtemplate(n)},p.prototype.setParams=function(t,n){this.filter=t||"",this.sharePanelPath=n;for(var i={},a=!1,r=0;r<e.Main.xmlManager.get("common-configuration","config","pageCount");r++)i[r+1]=e.Main.pageManager.getImage("ldpi",r+1);"favorite"!==this.filter&&"share"!==this.filter||(i=this.filterThumbnailsFromShare(i)),this.sharedFavorite&&"sharedBy"===this.filter&&(i=this.filterThumbnailsFromShare(i),a=!0),this.sharedFavorite&&"favorite"===this.filter&&(a=!0);var o=this.getFavoritedThumbnails(),s=e.Main.xmlManager.get("common-ui","configs","thumbnails","contentsDepth"),l=null;return{images:0===Object.keys(i).length?[]:i,currentFilter:this.filter,actionBar:"share"===this.filter,favorite:""!==this.filter,sharedActionBar:a,sharedByFilter:this.sharedWithMeFilter,favorited:o,printable:"print"===n||"download"===n,current:e.Main.xmlManager.get("common-configuration","config","pageCount"),offset:e.Main.xmlManager.get("common-configuration","config","shift"),summary:l=e.Main.xmlManager.get("summary","depth",s)}},p.prototype.toggle=function(){var e=document.querySelector("#webpub-lightbox-thumbnails-manager");e?NIApi.lightbox.closeAll():this.show("none")},p.prototype.show=function(t,n){var i=this.setParams(t,n),a="thumbnails",r=e.Main.xmlManager.get("locale","menu_thumbnail");"favorite"!==this.filter&&"share"!==this.filter||(r=e.Main.xmlManager.get("locale","favorites_selection"),a="favorites"),this.sharedFavorite&&"sharedBy"===this.filter&&(r=e.Main.xmlManager.get("locale","favorited_selection"),a="sharedby"),e.Main.trackerManager.trackPage({name:a});var o='<div class="application-page-loader spinner">';o+='<svg viewBox="0 0 32 32" width="32" height="32" class="spinner__circle" xmlns="http://www.w3.org/2000/svg">',o+='<path d="M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4" class="spinner__circle-background"/>',o+='<path d="M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z" class="spinner__circle-foreground" />',o+="</svg>",o+="</div>",this.popup=new e.Class.LightboxManagerNew({id:"thumbnails-manager",title:r,html:o,headerMenu:this.headerMenu||!1,subtemplate:{url:e.Param.pathTemplate+"thumbnails.html",params:i},menuButton:!1,theme:"page",animation:"none",onload:s})},p.prototype.filterThumbnailsFromShare=function(e){var t={},n=this.getDataFromFilter(this.filter);for(var i in n)t[n[i]]=e[n[i]];return t},p.prototype.getDataFromFilter=function(t){var n;if(this.sharedFavorite&&"sharedBy"===this.filter&&(n=this.sharedFavorite.split(","),e.Main.urlManager.contains("bookmark")))for(var i=0;i<n.length;i++)n[i]=parseInt(n[i])+1;return"favorite"!==this.filter&&"share"!==this.filter||(n=this.getFavoritedThumbnails()),n},p.prototype.getFavoritedThumbnails=function(){var t=[],n=e.Main.xmlManager.getVariable("client_id"),i=(e.Main.xmlManager.getVariable("id"),JSON.parse(localStorage[n]));return"undefined"!=typeof i[e.Main.xmlManager.getVariable("id")]&&(t=i[e.Main.xmlManager.getVariable("id")].favoritedPages),t},p.prototype.getToastData=function(){var n=document.createElement("div"),i=e.Main.thumbnailListManager.getFavoritedThumbnails(),a=e.Utils.getVisiblePages(),r=JSON.stringify(a[0]),o=JSON.stringify(a[1]),s={pageLeft:r,pageRight:o,pageLeftFavorited:i.indexOf(r)!==-1,pageRightFavorited:i.indexOf(o)!==-1};return e.Main.templateManager.loadAppend(e.Param.pathTemplate+"component/favoriteToast.html",n,s).then(function(n){n=n[0];var i=n.querySelectorAll("[data-favorite]");Array.prototype.forEach.call(i,function(n){n.addEventListener(e.Param.eventClick,t)});var a=n.querySelector(".webpub-toast__position--text-info--link");return a.addEventListener(e.Param.eventClick,function(){e.Main.thumbnailListManager.show("favorite")}),Promise.resolve(n)}.bind(this))},p.prototype.initFavoritedStorage=function(){var t=e.Main.xmlManager.getVariable("client_id"),n=e.Main.xmlManager.getVariable("id"),i=localStorage[t]?JSON.parse(localStorage[t]):{};if(localStorage[t]&&i[n]);else{var a={};a[n]={favoritedPages:[]},localStorage[t]=JSON.stringify(a)}},p.prototype.saveFavoritedThumbnails=function(t){var n=e.Main.xmlManager.get("locale","label_page")+" "+e.Utils.byOffsetIndex(t)+" ",i=e.Main.xmlManager.getVariable("client_id"),a=e.Main.xmlManager.getVariable("id"),r=JSON.parse(localStorage[i]),o=r[a].favoritedPages;if(o.indexOf(t)===-1)o.push(t),n=n+e.Main.xmlManager.get("locale","favorites_added_to")+" ",n+=e.Main.xmlManager.get("locale","favorites_selection"),e.Main.trackerManager.trackEvent({name:"bookmark",variables:{1:t}});else{var s=o.indexOf(t);o.splice(s,1),n=n+e.Main.xmlManager.get("locale","favorites_removed_from")+" ",n+=e.Main.xmlManager.get("locale","favorites_selection"),e.Main.trackerManager.trackEvent({name:"unbookmark",variables:{1:t}})}this.showToast(n),localStorage[i]=JSON.stringify(r)},p.prototype.showToast=function(t){var n=document.querySelector(".webpub-toast--active");n?(document.querySelector(".webpub-toast__position--text-info")&&(n=document.querySelector(".webpub-toast__position--text-info"),
n.style.paddingRight="30px"),n.innerText=t):e.Utils.toast({text:t,duration:3e3})},e.Class.ThumbnailListManager=p}(webpublicationNamespace),function(e){e.Class.ToolsEvents=function(){var t=function(t){this.parent=t,this.onshowToolsArray=[],this.showToolsInfo=0;var n=this;document.addEventListener(e.Param.eventKeyboardDown,function(e){32===e.keyCode&&n.showTools()},!1)},n=t.prototype;return n.onShowedTools=function(){var e=null,t=0;return function(){for(e=this.onshowToolsArray.length,t=0;t<e;t++)this.onshowToolsArray[t](this.showToolsInfo);return!1}}(),n.showTools=function(t){if(e.Main.menuManager.hideMenu())return!1;if(null===e.Main.startupManager.get("ui.menu")&&null===e.Main.startupManager.get("ui.carousel")&&null===e.Main.startupManager.get("ui.paging"))this.showToolsInfo=0;else if(t===!1)this.showToolsInfo=0;else if(t===!0)this.showToolsInfo=1;else if(0===this.showToolsInfo)this.showToolsInfo=1;else{if(1!==this.showToolsInfo)return!1;this.showToolsInfo=0}return 0===this.showToolsInfo?(e.Main.paginationManager.showPaginations(!1),e.Main.menuManager.hideTopnav()):(e.Main.paginationManager.showPaginations(!0),e.Main.menuManager.showTopnav()),this.onShowedTools(),!1},n.onShowTools=function(e){return this.onshowToolsArray.push(e),!1},t}()}(webpublicationNamespace),function(e){function t(t){l===!1&&(l=!0,NIApi.event.onPageChange(function(){e.Utils.callEvent(window,"tooltip.onPageChange")})),t.addEventListener("mouseenter",a)}function n(t){return clearTimeout(e.Main.tooltipManager._mouseIdleTimer),"mouseleave"===t.type||t.type===e.Param.eventStart?void r(t):void(e.Main.tooltipManager._mouseIdleTimer=setTimeout(function(e){o(e)}.bind({},t),500))}function i(t,n){n=n||t.target;var a=document.querySelector(".webpub-tooltip");if(a){var r=e.Utils.getClosestByAttribute(n,"data-tooltip");r.removeEventListener("mousemove",i),a.parentNode.removeChild(a)}}function a(t){t.target.onPageChangefunction=r.bind(t.target),t.target.addEventListener("mousemove",n),t.target.addEventListener("mouseleave",n),t.target.addEventListener(e.Param.eventStart,n),t.target.addEventListener(e.Param.eventMouseWheel,r),window.addEventListener("tooltip.onPageChange",t.target.onPageChangefunction)}function r(t){var a=t.target;"tooltip.onPageChange"===t.type&&(a=this);var o=e.Utils.getClosestByAttribute(a,"data-tooltip");i(t,a),o&&(o.removeEventListener("mousemove",n),o.removeEventListener("mouseleave",n),o.removeEventListener(e.Param.eventStart,n),o.removeEventListener(e.Param.eventMouseWheel,r)),window.removeEventListener("tooltip.onPageChange",a.onPageChangefunction)}function o(t){var n=e.Utils.getClosestByAttribute(t.target,"data-tooltip"),a={X:t.clientX,Y:t.clientY+25};n.addEventListener("mousemove",i),e.Main.tooltipManager.show(n.getAttribute("data-tooltip"),a)}var s=function(){},l=!1;s.prototype.show=function(t,n,i){if(e.Param.isDesktop!==!1&&"touchstart"!==e.Param.eventStart){t=t||"";var a=document.createElement("div");a.classList.add("webpub-tooltip"),a.innerText=t,a.style.transform="translate("+n.X+"px,"+n.Y+"px) scale(0)",a.style.webkitTransform="translate("+n.X+"px,"+n.Y+"px) scale(0)";var r=document.querySelector(".webpub-tooltip");r&&r.parentNode.removeChild(r),a.addEventListener("animationstart",function(e){e.target.style.transform="translate("+n.X+"px,"+n.Y+"px) scale(1)",e.target.style.webkitTransform="translate("+n.X+"px,"+n.Y+"px) scale(1)"},!1),a.addEventListener("animationend",function(e){var t=document.body.getBoundingClientRect().width,i=document.body.getBoundingClientRect().height,a=0;if(e.target.getBoundingClientRect().right>t){var r=e.target.getBoundingClientRect().width+15,o=Math.floor(t-r);a=o,e.target.style.transform="translate("+o+"px,"+n.Y+"px) scale(1)",e.target.style.webkitTransform="translate("+o+"px,"+n.Y+"px) scale(1)"}else e.target.getBoundingClientRect().left<0&&(e.target.style.transform="translate( 15px,"+n.Y+"px) scale(1)",e.target.style.webkitTransform="translate( 15px,"+n.Y+"px) scale(1)");if(e.target.getBoundingClientRect().bottom>i){var s=e.target.getBoundingClientRect().height+15,l=Math.floor(i-s);a=a||n.X,e.target.style.transform="translate( "+a+"px,"+l+"px) scale(1)",e.target.style.webkitTransform="translate( "+a+"px,"+l+"px) scale(1)"}},!1),document.body.appendChild(a)}},s.prototype.hide=i,s.prototype.register=t,e.Class.TooltipManager=s}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){Math.abs=function(e){return e<0?-e:e},Math.floor=function(e){return e>>0},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)},Math.parseIntToRoman=function(){var e=["I","V","X","L","C","D","M"],t=function(t,n){var i,a="",r=2*t;if(t>2)for(i=0;i<n*Math.pow(10,t-3);i++)a+="M";else if(n<4)for(i=0;i<n;i++)a+=e[r];else if(4==n)a=e[r]+e[r+1];else if(n<9)for(a=e[r+1],i=0;i<n-5;i++)a+=e[r];else 9==n&&(a=e[r]+e[r+2]);return a};return function(e){var n,i="";e=parseInt(e,10).toString();for(var a=0,r=e.length;a<r;a++){var o=parseInt(e.charAt(r-(a+1)));n=i,i=t(a,o)+n}return i}}(),Math.parseRomanToInt=function(){var e=null,t=/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/,n=/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},a=0;return function(r){if(a=0,r=r.toUpperCase(),!r||!t.test(r))return!1;for(;e=n.exec(r);)a+=i[e[0]];return a}}(),e.Utils.addParamsToUrl=function(e,t){if(""===t)return e;var n,i="";e.indexOf("#")>=0&&(i=e.substr(e.indexOf("#"),e.length),e=e.substr(0,e.indexOf("#"))),n=e.indexOf("?")===-1?e+"?"+t:e+"&"+t;var a=n.split("?")[1],r={};a.split("&").forEach(function(e){r[e.split("=")[0]]=e.split("=")[1]}),n=n.split("?")[0];for(var o in r)n=n+(n.indexOf("?")===-1?"?":"&")+o+"="+r[o];return n+i},e.Utils.createUrlForPages=function(t){t=t||{};var n=null,i=t.clientId||e.Main.xmlManager.getVariable("client_id"),a=t.genId||e.Main.xmlManager.getVariable("id"),r=t.page||"1",o=e.Main.xmlManager.getVariable("asp_url")||null;return null!==o&&(n=o+"/"+i+"/"+a+"/"),(e.Utils.isMaster()||null===n)&&(n=window.location.href),e.Param.isLocalReader&&e.Main.urlManager.get("version")&&(n=e.Utils.addParamsToUrl(n,"version="+e.Main.urlManager.get("version"))),n.indexOf("#page=")===-1&&(n+="#page="+r),n},e.Utils.getFileExtension=function(e){var t=e.split("?").shift().split("#").shift().split(".").pop();return t},e.Utils.getFilenameWithoutExtension=function(e){var t=e.split(".");return t.pop(),t.join(".")},e.Utils.componentTemplates={},e.Utils.getTemplate=function(t,n){var i=".html",a="";"component"===t?a="publication/mobile/template/component/":(a="publication/mobile/tmpl/","page"===t?a+="page/":n=t);var r=e.Utils.getFunctionName(this.constructor),o=r.replace("Manager","").toLowerCase();"string"==typeof n&&(o=n,n=void 0),"undefined"==typeof n&&"undefined"!=typeof this.config&&(n=this.config.templateList),"undefined"==typeof n?n={main:a+o+i}:"undefined"==typeof n.main&&(n.main=a+o+i);var s=e.Utils.componentTemplates[o];return"component"===t&&s&&s.tablet&&(n.tablet=s.tablet),"component"===t&&s&&s.phone&&(n.phone=s.phone),"component"===t&&s&&s.desktop&&(n.desktop=s.desktop),"undefined"!=typeof n.phone&&e.Param.isPhone===!0?n.phone:"undefined"!=typeof n.tablet&&e.Param.isTablet===!0?n.tablet:"undefined"!=typeof n.desktop&&e.Param.isUnknown===!0?n.desktop:n.main},e.Utils.GetSwiffyPromise=function(){var t="js/swiffy_runtime";return null!==e.Main.startupManager.get("vendor.swiffy")&&(t+="_"+e.Main.startupManager.get("vendor.swiffy").replace(".","_")),function(n){return e.require([t]).then(function(){return new Promise(function(e,t){var i=n.file.url.match(/\/([a-zA-Z0-9]+).json/),a=document.createElement("div");a.classList.add("animation_for_swiffy"),a.classList.add("webpub-viewer__link-"+n.id),a.id="webpub-swiffy__"+(i?i[1]:"0"),a.coords={x:n.x,y:n.y,w:n.width,h:n.height,foreground:n.foreground},a.autoPlay=!1,a.swiffyElement={swiffyObject:null,swiffyWrapper:a,id:a.id};var r=new XMLHttpRequest;r.open("GET",n.file.url,!0),r.onreadystatechange=function(){if(2===this.readyState&&200!==this.status&&0!==this.status)a.parentNode&&a.parentNode.removeChild(a),this.abort(),e(!1);else if(4===this.readyState&&this.responseText){var t=new RegExp("swiffyobject\\s*\\=\\s*([\\s\\S]*?\\})\\;$","gmi"),n=t.exec(this.responseText),i=JSON.parse(null===n?this.responseText:n[1]);a.swiffyElement.swiffyObject=new swiffy.Stage(a,i),a.swiffyElement.swiffyObject.setBackground(null),e(a)}},r.send()})})}}(),e.Utils.addVideoStats=function(t){t.addEventListener("play",function(t){e.Main.trackerManager.trackEvent({name:"videoPlay",variables:{1:Math.round(t.target.currentTime)}})}),t.addEventListener("pause",function(t){t.target.currentTime!==t.target.duration&&e.Main.trackerManager.trackEvent({name:"videoPause",variables:{1:Math.round(t.target.currentTime)}})}),t.addEventListener("ended",function(t){e.Main.trackerManager.trackEvent({name:"videoEnd"})})},e.Utils.getAudioCustomDOMElement=function(){var t=null,n=function(){var e=null,t=null;return function(n){return e=~~(n/60),t=~~(n%60),e<10&&(e=["0",e].join("")),t<10&&(t=["0",t].join("")),[e,":",t].join("")}}(),i=function(){this.audioPlayerButton.className="audio-player-button"},a=function(){this.audioPlayerButton.className="audio-player-button audio-player-pause"},r=function(){this.audioPlayerTotal.innerText=n(this.duration)},o=function(){var e=null;return function(){"undefined"!=typeof this.audioPlayerProgressValue&&(e=~~(100*(this.currentTime/this.duration)),this.audioPlayerElapsed.innerText=n(this.currentTime),this.audioPlayerProgressValue.style.width=e+"%")}}(),s=function(){this.addEventListener("timeupdate",o)},l=function(e){scale=((e.pageX||e.changedTouches[0].pageX)-this.getBoundingClientRect().left)/this.offsetWidth,this.audioDOMElement.currentTime=this.audioDOMElement.duration*scale};return function(n,o){t=o.parentNode;var u=document.createElement("audio");u.id=n,u.src=o.getAttribute("data-src"),u.className="audio-player-domelement",u.addEventListener("play",i),u.addEventListener("pause",a),u.addEventListener("durationchange",r),u.addEventListener("loadedmetadata",s),u.audioPlayerButton=o,u.audioPlayerElapsed=t.getElementsByClassName("audio-player-elapsed")[0],u.audioPlayerProgress=t.getElementsByClassName("audio-player-progress")[0],u.audioPlayerProgressContainer=t.getElementsByClassName("audio-player-progress-container")[0],u.audioPlayerProgressValue=t.getElementsByClassName("audio-player-progress-value")[0],u.audioPlayerTotal=t.getElementsByClassName("audio-player-total")[0],o.audioDOMElement=u,u.audioPlayerProgressContainer.audioDOMElement=u,u.audioPlayerProgressContainer.addEventListener(e.Param.eventStop,l),o.addEventListener(e.Param.eventClick,function(){this.audioDOMElement.paused?this.audioDOMElement.play():this.audioDOMElement.pause()}),o.parentNode.appendChild(u),e.Main.eventEmul.callEvent("audioBegin",o.getAttribute("data-src")),u.play()}}(),e.Utils.impair=function(e){return 1&e},e.Utils.clone=function(t){if("object"!=("undefined"==typeof t?"undefined":_typeof(t))||null==t)return t;var n=t.constructor(),i=null;for(i in t)n[i]=e.Utils.clone(t[i]);return n},e.Utils.getTintedSvg=function(){var e={},t=null,n=null,i=function(i,a,r){if(a)for(i=e[i].cloneNode(!0),t=i.getElementsByTagName("*"),n=t.length;--n>=0;)"string"!=typeof t[n].getAttribute("stroke")?t[n].setAttribute("fill",a):t[n].setAttribute("stroke",a);r[0].appendChild(i)};return function(t,n,a){if(!t)return!1;if("undefined"==typeof e[t]){var r=new XMLHttpRequest;r.open("GET",t,!1),r.onreadystatechange=function(o){4==r.readyState&&(e[t]=r.responseXML.getElementsByTagName("svg")[0],i(t,n,a))},r.send()}else i(t,n,a);return!1}}(),e.Utils.preventDefault=function(){return function(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&("undefined"!=typeof e.stopPropagation&&e.stopPropagation(),"undefined"!=typeof e.cancelBubble&&(e.cancelBubble=!0),"undefined"!=typeof e.preventDefault&&e.preventDefault(),!1)}}(),e.Utils.uniqueId=function(){var e=0;return function(){return e++,(new Date).getTime()+"_"+e}}(),e.Utils.byOffsetIndex=function(){var t=null,n=e.Main.xmlManager.get("common-configuration","config","shift");return function(e,i){return i?(t=~~e,e=t||0===t?t+n:Math.parseRomanToInt(e)):(n>=e?e=Math.parseIntToRoman(e):e-=n,e)}}(),e.Utils.isOffsetIndex=function(){var t=e.Main.xmlManager.get("common-configuration","config","shift");return function(e){return e-t<=0}}(),e.Utils.hex16=function(e){return 8==e.length&&(e=e.substr(2,8)),e},e.Utils.getRadiant=function(){var e=null,t=null,n=null,i=null;return function(a,r,o,s,l,u){for(e=50,u&&(e=u),t=r.split(","),n=0;n<t.length;n++)t[n]=~~(~~t[n]+e),t[n]>255&&(t[n]=255);return i="",i+="background: rgb("+r+");",i+="background: -moz-linear-gradient(-45deg,  rgba("+t+","+l+") 0%, rgba("+r+","+s+") 50%);",i+="background: -webkit-gradient(linear, left top, right bottom, color-stop(0%,rgba("+r+",1)), color-stop(50%,rgba("+r+","+s+")));",i+="background: -webkit-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",i+="background: -o-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",i+="background: -ms-linear-gradient(-45deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",i+="background: linear-gradient(135deg,  rgba("+t+","+l+") 0%,rgba("+r+","+s+") 50%);",i+="filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='"+o+","+s+"',GradientType=1 );"}}(),e.Utils.mailValid=function(){var t=document.createElement("input");return t.type="email",t.required=!0,function(n){return t.value=n,t.checkValidity()&&e.Utils.regexEmail.test(n)}}(),e.Utils.isMaster=function(){var t=e.Main.xmlManager.getVariable("asp_url")||!1;return!!t||t},e.Utils.stringtoXML=function(){var e=null;return function(t){return DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)),e}}(),e.Utils.getBase64Image=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return n.drawImage(e,0,0),t.toDataURL("image/png")},e.Utils.addVendorEventListener=function(e,t){for(var n=["","webkit","moz"],i=0;i<n.length;i++)if("on"+n[i]+e in document.documentElement){document.addEventListener(n[i]+e,t);break}},e.Utils.styleBorderRadius=function(){return"borderRadius"in document.body.style?function(e,t){e.style.borderRadius=t}:"webkitBorderRadius"in document.body.style?function(e,t){e.style.webkitBorderRadius=t}:"mozBorderRadius"in document.body.style?function(e,t){e.style.mozBorderRadius=t}:function(){}}(),e.Utils.styleTransform=function(){return"transform"in document.body.style?function(e,t){e.style.transform=t}:"webkitTransform"in document.body.style?function(e,t){e.style.webkitTransform=t}:"msTransform"in document.body.style?function(e,t){e.style.msTransform=t}:function(){}}(),e.Utils.styleTransformOrigin=function(){return"transformOrigin"in document.body.style?function(e,t){e.style.transformOrigin=t}:"webkitTransformOrigin"in document.body.style?function(e,t){e.style.webkitTransformOrigin=t}:"msTransformOrigin"in document.body.style?function(e,t){e.style.msTransformOrigin=t}:function(){}}(),e.Utils.styleTransition=function(){return"transition"in document.body.style?function(e,t){e.style.transition=t}:"webkitTransition"in document.body.style?function(e,t){e.style.webkitTransition=t}:"msTransition"in document.body.style?function(e,t){e.style.msTransition=t}:function(){}}(),e.Utils.styleTransitionTransform=function(){return"transform"in document.body.style?function(t,n,i){e.Utils.styleTransition(t,"transform "+n+"s "+i)}:"webkitTransform"in document.body.style?function(t,n,i){e.Utils.styleTransition(t,"-webkit-transform "+n+"s "+i)}:"msTransform"in document.body.style?function(t,n,i){e.Utils.styleTransition(t,"-ms-transform "+n+"s "+i)}:function(){}}(),e.Utils.resetDomTransform=function(t){e.Utils.styleTransformOrigin(t,"50% 50%"),e.Utils.styleTransform(t,"scale3d(1, 1, 1)")},e.Utils.scaleDom=function(t,n,i,a){e.Utils.styleTransformOrigin(t,i+("number"==typeof i?"px":"")+" "+a+("number"==typeof a?"px":"")),1===n?e.Utils.styleTransform(t,"none"):e.Utils.styleTransform(t,"scale("+n+", "+n+")")},e.Utils.scaleDom3d=function(t,n,i,a){e.Utils.styleTransformOrigin(t,i+("number"==typeof i?"px":"")+" "+a+("number"==typeof a?"px":"")),1===n?e.Utils.styleTransform(t,"none"):e.Utils.styleTransform(t,"scale3d("+n+", "+n+", 1)")},e.Utils.translateScaleDom3d=function(t,n,i,a,r,o){e.Utils.styleTransformOrigin(t,r+("number"==typeof r?"px":"")+" "+o+("number"==typeof o?"px":"")),0===n&&0===i&&1===a?e.Utils.styleTransform(t,"none"):e.Utils.styleTransform(t,"scale3d("+a+", "+a+", 1) translate3d("+n+"px, "+i+"px, 0px)")},e.Utils.eventPreventDefault=function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},e.Utils.preventOverScroll=function(){function e(e){0===e.scrollTop?e.scrollTop++:e.scrollTop===e.scrollHeight-e.clientHeight&&e.scrollTop--}return function(t){t.setAttribute("touch-action","auto"),t.addEventListener("touchstart",function(n){for(var i=n.target;i!==t;)e(i),i=i.parentNode;e(t)})}}(),e.Utils.forceReflow=function(e){e.style.display="none",e.style.display="block"},e.Utils.cubicBezier=function(e,t,n,i,a){return Math.pow(1-a,3)*e+3*Math.pow(1-a,2)*a*t+3*(1-a)*Math.pow(a,2)*n+Math.pow(a,3)*i},e.Utils.getFunctionName=function(e){var t="function"==typeof e,n=t&&(e.name&&["",e.name]||e.toString().match(/function ([^\(]+)/));return!t&&"not a function"||n&&n[1]||"anonymous"},e.Utils.promiseTimeout=function(e,t){return 0===e?t:new Promise(function(n,i){setTimeout(function(){n(t)},e)})},e.Utils.getSegmentLength=function(e,t,n,i){return Math.abs(Math.sqrt(Math.pow(e-n,2)+Math.pow(t-i,2)))},e.Utils.createSvgIcon=function(t,n,i){var a=document.createElement("div");return a.className="svgicon svgicon-"+t+" "+n,e.Utils.svgIcon(a,{icon:t,color:i||null}),a},e.Utils.svgIcon=function(t,n){if(n.color=n.color||null,n.icon=n.icon||null,"svg"!==t.tagName){var i=t.querySelector("svg");null===i&&(i=document.createElement("svg"),t.appendChild(i)),t=i}if(null!==n.color&&n.color.indexOf(".")>0&&(n.color=n.color.split("."),n.color=e.Main.cssManager.getStyle(n.color[0],n.color[1])),null!==n.icon){if(t.firstChild)t.firstChild.setAttribute("xlink:href","#svgicon-"+n.icon);else{var a='xmlns:xlink="http://www.w3.org/1999/xlink"',r='xlink:href="#svgicon-'+n.icon+'"';t.innerHTML="<use "+a+" "+r+"></use>"}t.setAttribute("data-icon",n.icon)}null!==n.color&&(t.style.fill=n.color,t.setAttribute("data-color",n.color))},e.Utils.empty=function(e){if(e){for(var t=e.querySelectorAll("video"),n=0;n<t.length;n++)t[n].pause(),t[n].parentNode.removeChild(t[n]);e.textContent="",e.innerHTML=""}},e.Utils.fadeIn=function(){var e=function(){this.classList.remove("opacity-zero")};return function(t){t&&(t.classList.remove("display-none"),requestAnimationFrame(e.bind(t)))}}(),e.Utils.fadeOut=function(){var e=function(){this.classList.add("display-none")};return function(t){if(t){var n=window.getComputedStyle(t),i=1e3*parseFloat(n.getPropertyValue("transition-duration"));"opacity"===n.getPropertyValue("transition-property")&&i>0&&(t.classList.add("opacity-zero"),setTimeout(e.bind(t),i)),n=null}}}(),e.Utils.getVisiblePages=function(){return function(){return e.Main.viewerManager.getCurrentPages()}}(),e.Utils.capitalizeWord=function(e){return e[0].toUpperCase()+e.substr(1,e.length).toLowerCase()},e.Utils.regexEmail=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,e.Utils.mailStringToArray=function(t){for(var n=t.split(/[,;\s]+(?=(?:[^"]*"[^"]*")*[^"]*$)/g),i=[],a=0;a<n.length;a++)e.Utils.mailValid(n[a])&&i.push(n[a]);return i},e.Utils.removeToast=function(t){var n=e.Param.viewBody.querySelector(".webpub-toast--active");n&&(clearTimeout(e.Utils.removeToastTimer),t=t||0,n.classList.remove("webpub-toast--active"),setTimeout(function(){n.parentNode.removeChild(n)},t))},e.Utils.hideShowRemove=function(t){function n(){clearTimeout(e.Utils.removeToastTimer)}function i(){e.Utils.removeToastTimer=setTimeout(function(){e.Utils.removeToast(s)},o)}var a=t.element,r=t.className,o=t.duration||3e3,s=t.delay||1e3;a.addEventListener("mouseenter",n),a.addEventListener("mouseleave",i),setTimeout(function(){a.classList.add(r),i()},16)},e.Utils.toast=function(t){var n=function o(n){var i=document.querySelector(".webpub-toast--active");i?window.setTimeout(function(){o(n)},1e3):e.Utils.hideShowRemove({element:n,className:"webpub-toast--active",duration:t.duration,delay:1e3})},i=document.createElement("div");i.classList.add("webpub-toast");for(var a=t.className?t.className.split(" "):[],r=0;r<a.length;r++)i.classList.add(a[r]);return i.classList.add("webpub-toast__position--"+t.position),"undefined"!=typeof t.html?(i.classList.add("webpub-toast__position"),"string"==typeof t.html?i.innerHTML=t.html:i.appendChild(t.html)):i.innerText=t.text,"error"===t.type&&i.classList.add("webpub-toast--error"),document.body.appendChild(i),n(i),i},e.Utils.serialize=function(e){var t="";for(var n in e)t+=t?"&":"",t+=n+"="+encodeURIComponent(e[n]);return t}}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){e.Param.zoom=!1,e.Class.ViewerManager=function(){function t(e){var t=[],n=0;if(e<=a()&&e>=0)for(var i=1;i<=dt.pagesInFrame;i++)n=e*dt.pagesInFrame+i-Pe,n<=dt.pagesQuantity&&n>0&&t.push(n);return t}function n(e){return ge.floor((e+Pe-1)/dt.pagesInFrame)}function i(e){return n(e)-Me}function a(){return ge.ceil((dt.pagesQuantity+Pe)/dt.pagesInFrame)-1}function r(t,n,i,a){var r=Ne(ge.abs((t+i)/2),2),o=Ne(ge.abs((n+a)/2),2);tt=r,nt=o,ct===!1?ct=r:ct+=(r-ct)/st,pt===!1?pt=o:pt+=(o-pt)/st,it=e.Utils.getSegmentLength(t,n,i,a),ze=Ze=0,ot&&O("out")}function o(t,n){$e=ke=!0,Ve=t-ze,Be=Ve-Ue,Ue=Ve,Re=ge.min(Ue,Re),Fe=ge.max(Ue,Fe),(ge.abs(Ve)>dt.minPxToDrag||Re<-dt.minPxToDrag||Fe>dt.minPxToDrag)&&(dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),e.Utils.styleTransform(ye,"translate3d("+Ue+"px, 0px, 0px)"),et&&clearTimeout(et),et=!1),ke=!1}function s(t,n){$e=ke=!0,qe=n-Ze,We=qe-He,He=qe,Ge=ge.min(He,Ge),je=ge.max(He,je),(ge.abs(qe)>dt.minPxToDrag||Ge<-dt.minPxToDrag||je>dt.minPxToDrag)&&(dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),e.Utils.styleTransform(ye,"translate3d(0px, "+He+"px, 0px)"),et&&clearTimeout(et),et=!1),ke=!1}function l(t,n){$e=ke=!0,(ge.abs(t-ze)>dt.minPxToDrag||ge.abs(n-Ze)>dt.minPxToDrag)&&(lt=Ne(ge.min(ge.max(ct-(t-ze)/(st-1),0),me),2),ut=Ne(ge.min(ge.max(pt-(n-Ze)/(st-1),0),fe),2),dt.verticalSlider?e.Utils.scaleDom3d(ye,st,lt,ut+fe*dt.deltaFrameInDOM):e.Utils.scaleDom3d(ye,st,lt+me*dt.deltaFrameInDOM,ut),et&&clearTimeout(et),et=!1),ke=!1}function u(t){return!dt.links||!e.Main.pageManager.hasLinks(t)||e.Main.linksManagerNew.preloadAnimPromise(t)}function c(e){var t=mt.getPage(e).image,n=e-Ee,a=i(e),r=dt.deltaFrameInCache*dt.pagesInFrame;return r+=(Ee+Pe)%dt.pagesInFrame||dt.pagesInFrame,n>-r&&n<=(2*dt.deltaFrameInCache+1)*dt.pagesInFrame-r&&(we[r+n-1]=t),ge.abs(a)<=dt.deltaFrameInDOM&&de.visualizePageAtFrame(t,a,x(t.pageNumber),ot),t}function p(t,n){var i=n?dt.highQualityKey:dt.lowQualityKey;return"svg"===i?e.Utils.promiseXHR("GET",e.Main.pageManager.getImage(i,t)).then(function(a){var r=e.Main.xmlManager.getVariable("contents")+e.Main.xmlManager.getVariable("pages")+t.toString()+"/svg/",o=document.createElement("div");return o.innerHTML=a.responseText.replace(/svg\//gi,r),o=o.querySelector("svg"),o.highQuality=n,o.pageNumber=t,o.idsLinks=[],o.quality=i,o.classList&&o.classList.add("webpub-viewer__page-img"),Promise.resolve(o)}):new Promise(function(a){var r=new Image;r.highQuality=n,r.pageNumber=t,r.idsLinks=[],r.quality=i,r.onload=a.bind({},r),r.onerror=a.bind({},!1),r.src=e.Main.pageManager.getImage(i,t)})}function h(e,t){var n=Ce.filter(function(n){return n.pageNumber===e&&n.highQuality===t});if(n.length)return n[0].promise.isNew=!1,n[0].promise;var i=p(e,t).then(function(t){if(t!==!1)return Ce.splice(Ce.indexOf(a),1),0===Te&&M(t),t.highQuality?mt.setHighPage(e,t):mt.setLowPage(e,t),c(e),Promise.resolve(t)}),a={pageNumber:e,highQuality:t,promise:i};return a.promise.isNew=!0,Ce.push(a),a.promise}function d(t){var i,a,r=mt.hasPage(t),o=e.Main.pageManager.hasLinks(t);i=r===!1?h(t,dt.lowQualityDisabled):c(t),a=o===!1?e.Main.pageManager.getLinksPromise(t):e.Main.pageManager.getLinks(t);var s=e.Utils.promiseTimeout(dt.delayLoadingHd,!0),l=function(e){n(t)===Me?g(t,e[0].highQuality):Math.abs(n(t)-Me)<2&&p(t,!0).then(function(e,t){mt.setHighPage(e,t),c(e)}.bind(this,t))};"undefined"!=typeof i.then||"undefined"!=typeof a.then?i.isNew!==!0&&a.isNew!==!0||Promise.all([i,a,s]).then(l):dt.delayLoadingHd>0?s.then(l.bind({},[i])):l([i])}function m(n,i){var a=n-Me,r=t(n),o=!1;if(dt.useBgColorPerPage){o=[];for(var s in r)o.push(e.Main.pageManager.getBackgroundColor(r[s]));for(;o.length<dt.pagesInFrame;)1===r[s]?o.unshift(o[0]):o.push(o[o.length-1])}var l=!1;if("svg"===dt.highQualityKey&&i===!0&&(l=de.setActiveFromPages(r),l&&r.forEach(function(t){e.Main.linksManagerNew.removeLinksFromPage(t,!0),e.Main.linksManagerNew.addLinksToPage(t,n-Me)})),l===!1){(ge.abs(a)<=dt.deltaFrameInDOM||n>=e.Main.xmlManager.get("common-configuration","config","pageCount"))&&de.clearDomFrame(a,o);for(var u in r)d(r[u])}}function f(){for(var e=1;e<=dt.deltaFrameInCache;e++)m(Me+e),m(Me-e)}function g(t,i){if(t<=dt.pagesQuantity&&t>0){var a=!!i||h(t,!0),r=u(t);Promise.all([a,r]).then(function(i){var a=ge.abs(n(t)-Me);dt.links&&a<=dt.deltaFrameInDOM&&i[1]&&(dt.delayLoadingAnim>0?e.Utils.promiseTimeout(dt.delayLoadingAnim,t).then(function(){i[0].highQuality&&e.Main.linksManagerNew.removeLinksFromPage(t,!0),e.Main.linksManagerNew.addLinksToPage(t,n(t)-Me)}):(i[0].highQuality&&e.Main.linksManagerNew.removeLinksFromPage(t,!0),e.Main.linksManagerNew.addLinksToPage(t,n(t)-Me)))})}}function v(e,t){var n=mt.getPage(e).image;if(n&&t.length){for(var a=t.length;a--;){var r=t[a];if(n.idsLinks.indexOf(r.idLink)<0){var o=de.addImageIntoPageDom(n,r);o.highQuality=n.highQuality,o.pageNumber=n.pageNumber,o.idsLinks=n.idsLinks.concat(r.idLink),n=o,o=void 0}}mt.setHighPage(e,n,!0);var s=i(e);ge.abs(s)<=dt.deltaFrameInDOM&&de.visualizePageAtFrame(n,s,x(e),!1)}}function b(e,t){var n=mt.getPage(e).image;if(n&&t.length){for(var a=t.length;a--;){var r=t[a];if(n.idsLinks.indexOf(r.id)<0){var o=de.addLinkBoxIntoPageDom(n,r);o.highQuality=n.highQuality,o.pageNumber=n.pageNumber,o.idsLinks=n.idsLinks.concat(r.id),n=o,o=void 0}}mt.setHighPage(e,n,!0);var s=i(e);ge.abs(s)<=dt.deltaFrameInDOM&&de.visualizePageAtFrame(n,s,x(e),!1)}}function y(e,t){var n=mt.getPage(e).image;return n&&n.idsLinks.indexOf(t)>=0}function E(e){ge.abs(e)<=2*dt.deltaFrameInCache*dt.pagesInFrame?e>0?we=we.splice(e,we.length).concat(new Array(e)):e<0&&(we=new Array((-e)).concat(we.splice(0,we.length+e))):we=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame)}function M(t){Se===!1&&(Se=e.Main.xmlManager.get("common-configuration","contents","swf","width")/e.Main.xmlManager.get("common-configuration","contents","swf","height")),Se&&(Se>=_e?(Te=Ne(dt.pageMaxWidth-2*dt.pageShadowSize),xe=Ne(dt.pageMaxWidth/Se-2*dt.pageShadowSize)):(xe=Ne(dt.pageMaxHeight-2*dt.pageShadowSize),Te=Ne(dt.pageMaxHeight*Se)),Te>dt.pageMaxWidth&&(xe=Ne(xe*dt.pageMaxWidth/Te),Te=dt.pageMaxWidth),xe>dt.pageMaxHeight&&(Te=Ne(Te*dt.pageMaxHeight/xe),xe=dt.pageMaxHeight));var n=(me-dt.paddingLeft-dt.paddingRight-Te*dt.pagesInFrame)/2;Ye=n+dt.paddingLeft,Qe=n+dt.paddingRight;var i=(fe-dt.paddingTop-dt.paddingBottom-xe)/2;if(Xe=i+dt.paddingTop,Ke=i+dt.paddingBottom,Se){var a={width:Te,height:xe,left:Ye,top:Xe};de.setPageSize(a),dt.links&&e.Main.linksManagerNew.setPageSize(a)}}function P(e){var t=[];if(e>=-dt.deltaFrameInCache||e<=dt.deltaFrameInCache){var n=(e+dt.deltaFrameInCache)*dt.pagesInFrame;t=we.slice(n,n+dt.pagesInFrame)}return t}function w(e){return((e+Pe)%dt.pagesInFrame||dt.pagesInFrame)-1}function S(){return t(n(Ee))}function _(e){return dt.verticalSlider?0:me*(dt.deltaFrameInDOM+e)}function T(e){return dt.verticalSlider?fe*(dt.deltaFrameInDOM+e):0}function x(e){return Ye+w(e)*Te}function C(){return st}function L(e,t){return Ne(ge.min(ge.max(t/e*st,1),dt.maxZoom),2)}function A(t,n,i,a){if(0!==tt&&!ke){dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),ke=!0,rt=at,at=e.Utils.getSegmentLength(t,n,i,a),it=it||at;var r=Ne(ge.abs((t+i)/2)),o=Ne(ge.abs((n+a)/2)),s=Ne(L(it,at)/st,2);lt=Ne(ge.min(ge.max(ct-(r-tt)/(s*st-1),0),me),2),ut=Ne(ge.min(ge.max(pt-(o-nt)/(s*st-1),0),fe),2),$e=Je=!1,s*st>(rt>at?1.05:1)?dt.verticalSlider?e.Utils.scaleDom3d(ye,s*st,lt,ut+fe*dt.deltaFrameInDOM):e.Utils.scaleDom3d(ye,s*st,lt+me*dt.deltaFrameInDOM,ut):ot&&I(),ke=!1}}function k(){lt!==!1&&(ct=lt,pt=ut,lt=lt=$e=!1)}function O(t){if(dt.zoomRetina&&("in"===t||"out"===t)){var n,i=S();"in"===t?(e.Param.zoom===!1&&(e.Param.zoom=!0,e.Utils.callEvent(window,"webpub-zoom")),de.zoomIn()):(e.Param.zoom===!0&&(e.Param.zoom=!1,e.Utils.callEvent(window,"webpub-zoom")),de.zoomOut());for(var a=i.length;a--;)n=mt.getPage(i[a]).image,n&&de.visualizePageAtFrame(n,0,x(n.pageNumber),"in"===t)}}function D(){ot===!1&&dt.links&&e.Main.linksManagerNew.addFixSwiffyAnims(),ot=!0,J("zoomIn"),e.Main.eventEmul.callEvent("pageZoomIn",S()),O("in")}function I(){st=1,ot=!1,J("zoomOut"),dt.links&&e.Main.linksManagerNew.removeFixSwiffyAnims(),tt=nt=it=at=0,ct=pt=lt=ut=!1,O("out"),e.Utils.resetDomTransform(ye)}function N(){var e=Ne(L(it,at)/st,2);st=Ne(e*st,2),k(),ke=!0,it=at=0,z(!1),1===st?I():ot===!1?D():O("in"),ke=!1}function U(){var e=Ue>0,t=Fe-Ue;$e=Je=!1,ot===!1&&(ge.abs(Ve)>dt.minPxToDrag||Re<-dt.minPxToDrag||Fe>dt.minPxToDrag)&&(e&&(0===Me||Be<0&&t>dt.minPxToCancelScroll||Ue<dt.minPxToChangePage)||!e&&(Me===a()||Be>0&&-t>dt.minPxToCancelScroll||-Ue<dt.minPxToChangePage)?B(0,0,!1):e?B(me,-1,!1):B(-me,1,!1))}function R(){var e=He>0,t=je-He;$e=Je=!1,ot===!1&&(ge.abs(qe)>dt.minPxToDrag||Ge<-dt.minPxToDrag||je>dt.minPxToDrag)&&(e&&(0===Me||We<0&&t>dt.minPxToCancelScroll||He<dt.minPxToChangePage)||!e&&(Me===a()||We>0&&-t>dt.minPxToCancelScroll||-He<dt.minPxToChangePage)?B(0,0,!0):e?B(fe,-1,!0):B(-fe,1,!0))}function F(t){e.Utils.styleTransition(ye,"none"),Fe=Re=Ue=je=Ge=He=0,dt.links&&e.Main.linksManagerNew.removeFixSwiffyAnims(),window.setTimeout(function(){if(0!==t){for(var n=P(t),i=n.length;i--;)n[i]&&"svg"!==dt.highQualityKey&&de.visualizePageAtFrame(n[i],0,x(n[i].pageNumber),!1);e.Utils.styleTransform(ye,"scale3d(1, 1, 1)"),ee(t>0?"next":"prev",!1)}Ae=ke=!1},50)}function B(t,n,i){var a=dt.animationTimePerPage*dt.pagesInFrame/1e3;ke=!0,e.Utils.styleTransitionTransform(ye,a,"ease-out"),clearTimeout(ht),ht=setTimeout(F.bind({},n),1e3*a),i?e.Utils.styleTransform(ye,"translate3d(0px, "+t+"px, 0px)"):e.Utils.styleTransform(ye,"translate3d("+t+"px, 0px, 0px)")}function z(t){t===!1&&e.Main.menuManager.hideMenu(),Oe!==t&&(Oe="undefined"==typeof t?!Oe:t,e.Main.menuManager.onDocumentClick(),e.Main.toolsEvents&&e.Main.toolsEvents.showTools(Oe))}function V(t){if(32===t.keyCode)z();else if(dt.draggable!==!1){if(e.Class.LightboxManagerNew.getLength()>0)return;dt.verticalSlider?[38,40].indexOf(t.keyCode)>=0&&te(38===t.keyCode?"prev":"next"):[37,39].indexOf(t.keyCode)>=0&&te(37===t.keyCode?"prev":"next")}}function H(e,t,n){et?(clearTimeout(et),et=!1,W(e,t)):et=setTimeout(function(e){0===at&&Je===!1&&$e===!1&&j(n,e),et=!1}.bind({},Me),dt.doubleTapDelay)}function G(t){if(!ke&&!$e&&("mousedown"!==t.type&&"click"!==t.type||0===t.button)){var n=t.clientX,i=t.clientY;if(ot&&(n=Ne((n+ct*(st-1))/st),i=Ne((i+pt*(st-1))/st)),dt.links&&n>Ye&&n<me-Qe&&i>Xe&&i<fe-Ke){n-=Ye,i-=Xe;var a=ge.trunc(n/Te),r=dt.pagesInFrame*Me+a+1-Pe;
r>0&&(n-=a*Te,e.Main.linksManagerNew.onLayerClick(r,n,i,t))}}}function j(t,n){if(!ke&&!$e&&"VIDEO"!==t.target.tagName&&("mousedown"!==t.type&&"click"!==t.type||0===t.button)){var i=t.clientX>=0?t.clientX:t.touches[0].clientX,a=t.clientY>=0?t.clientY:t.touches[0].clientY;ot&&(i=Ne((i+ct*(st-1))/st),a=Ne((a+pt*(st-1))/st));var r=i,o=a,s=!0;if(dt.links&&i>Ye&&i<me-Qe&&a>Xe&&a<fe-Ke){i-=Ye,a-=Xe;var l=ge.trunc(i/Te),u=dt.pagesInFrame*n+l+1-Pe;u>0&&(i-=l*Te,e.Main.linksManagerNew.findClickedUserActs(u,i,a,t)&&(s=!1))}s&&dt.zoomSingleClick?(W(r,o),$e=!1):s&&z()}}function W(t,n){ke||(ke=!0,ot?I():dt.zoomDoubleClick&&(st=dt.maxZoom,D(),z(!1),ct=t,pt=n,dt.verticalSlider?e.Utils.scaleDom3d(ye,st,t,n+fe*dt.deltaFrameInDOM):e.Utils.scaleDom3d(ye,st,t+me*dt.deltaFrameInDOM,n)),ke=!1)}function Z(e){ye.style.willChange="transform",ft(e),ke||(1===be.length?(ze=be[0].x,Ze=be[0].y,Je=!0,H(ze,Ze,e)):r(be[0].x,be[0].y,be[1].x,be[1].y))}function q(e){e.preventDefault(),ft(e),ke||(1===be.length?Je&&(ot?l(be[0].x,be[0].y):dt.draggable!==!1&&(dt.verticalSlider?s(be[0].x,be[0].y):o(be[0].x,be[0].y))):be.length>1&&dt.zoomPinch&&A(be[0].x,be[0].y,be[1].x,be[1].y))}function Y(e){ft(e),"mouseout"===e.type&&"CANVAS"===e.target.nodeName||(ot?at>0?dt.zoomPinch&&N():k():at>0?dt.zoomPinch&&N():0===be.length&&Je&&$e&&(dt.verticalSlider?R():U()),Je=!1,ye.style.willChange="")}function X(t){var i=!!document.activeElement&&"INPUT"===document.activeElement.tagName;if(!document.hasFocus()||!i){e.Param.userAgent.os.name===e.Param.userAgent.OS.IOS&&window.scrollTo(0,0),me=window.innerWidth,fe=window.innerHeight,_e=me/fe,"canvas"===dt.domMode&&(dt.maxZoom=ge.min(dt.maxZoom,Ne(10*ge.sqrt(De/(me*fe)))/10),dt.zoomScale=Math.min(dt.zoomScale,ge.round(100*ge.sqrt(De/(me*fe*dt.maxZoom*dt.maxZoom)))/100)),ot&&I(),dt=ne(dt),dt.verticalSlider?(ye.style.width="100%",ye.style.height=2*dt.deltaFrameInDOM+1+"00%",ye.style.left="0px",ye.style.top=-dt.deltaFrameInDOM+"00%",e.Param.viewMain.classList.add("webpub-viewer__container-vertical")):(ye.style.width=2*dt.deltaFrameInDOM+1+"00%",ye.style.height="100%",ye.style.left=-dt.deltaFrameInDOM+"00%",ye.style.top="0px"),dt.pageOnFirstFrame=e.Main.pageManager.pagesOnFirstScreen(),dt.pagesInFrame=e.Main.pageManager.pagePerScreen(),Pe=dt.pagesInFrame-dt.pageOnFirstFrame;for(var a=Ie.length;a--;){var r=Ie[a],o=dt[r];"string"==typeof o&&o.indexOf("px")>0?dt[r]=parseInt(o)||0:"string"==typeof o&&o.indexOf("%")>0&&(["paddingLeft","paddingRight"].indexOf(r)>=0?dt[r]=Ne(me*(parseInt(o)||0)/100):dt[r]=Ne(fe*(parseInt(o)||0)/100))}dt.pageMaxWidth=Ne((me-dt.paddingLeft-dt.paddingRight)/dt.pagesInFrame),dt.pageMaxHeight=Ne(fe-dt.paddingTop-dt.paddingBottom);var s={pageOnFirstFrame:dt.pageOnFirstFrame,pagesInFrame:dt.pagesInFrame,maxZoom:dt.maxZoom,zoomScale:dt.zoomScale};if(M(),de.setConfig(s),de.onResize(t),dt.links){e.Main.linksManagerNew.setConfig(s),e.Main.linksManagerNew.onResize(t);var l=S();l.forEach(function(t){e.Main.linksManagerNew.addLinksToPage(t,n(t)),e.Main.linksManagerNew.removeLinksFromPage(t,n(t))})}Le&&(Me=n(Ee),we=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame),m(Me,!0),f())}}function Q(e){if("string"==typeof e){var t=!1,n=!1,i=e.toUpperCase();if("NEXT"===i?e="+"+dt.pagesInFrame:"PREV"===i?e="-"+dt.pagesInFrame:"FIRST"===i?e=1:"LAST"===i&&(e=dt.pagesQuantity),["-","+"].indexOf(e[0])>=0&&(n=!0,t="-"===e[0],e=e.substr(1,e.length)),e=parseInt(e),0===e)e=Ee||1;else{if(!e)return;n&&(e=t?ge.max(Ee-e,1):ge.min(Ee+e,dt.pagesQuantity))}}return"number"==typeof e&&e>0&&e<=dt.pagesQuantity&&e}function K(i,a){"string"==typeof i&&(i=i.toUpperCase());var r=t(n(a));1===r.length?e.Main.trackerManager.trackPage({name:"page",variables:{1:r[0]}}):e.Main.trackerManager.trackPage({name:"page",variables:{1:r[0],2:r[1]}});for(var o=r.length;o--;)e.Main.trackerManager.trackEvent({name:"pageView",variables:{1:r[o]}});"NEXT"===i?e.Main.trackerManager.trackEvent({name:"pageNext",variables:{1:Ee}}):"PREV"===i&&e.Main.trackerManager.trackEvent({name:"pagePrev",variables:{1:Ee}})}function J(n){var i=t(Me);1===i.length?e.Main.trackerManager.trackEvent({name:n,variables:{1:Ee}}):e.Main.trackerManager.trackEvent({name:n,variables:{1:i[0]+"-"+i[1]}})}function $(t){ot&&I();var i=n(t),a=i-Me;a&&(E(a*dt.pagesInFrame),Ee=t,Me=i,e.Main.pagesLoaderNew.setCurrentPage(t),m(Me,!0),f(),dt.links&&e.Main.linksManagerNew.adjustLinksCache(i))}function ee(t,n){var i=Q(t);!i||i===Ee&&n!==!0||(e.Main.pageManager.set(i),K(t,i),z(!1),$(i))}function te(e){"prev"===e||e===-1?Me>0&&(dt.verticalSlider?B(fe,-1,!0):B(me,-1,!1)):"next"!==e&&1!==e||Me<a()&&(dt.verticalSlider?B(-fe,1,!0):B(-me,1,!1))}function ne(t){var n=e.Main.xmlManager.get("common-ui","configs","viewer","padding");if(n)for(var i in n)_typeof(n[i])&&(t[i]=n[i]);return t}function ie(t){dt.pagesQuantity=e.Main.pagesLoaderNew.getPageQuantity();for(var n in t)"undefined"!=typeof dt[n]&&(dt[n]=t[n]);Pe=dt.pagesInFrame-dt.pageOnFirstFrame,Le&&X(),"undefined"==typeof t.animationTimePerPage&&t.verticalSlider===!0&&(dt.animationTimePerPage=400)}function ae(e){e.preventDefault(),setTimeout(function(){var t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));te(1===t?"prev":"next")},16)}function re(){ye=document.createElement("div"),ye.id="webpub-viewer__container",ye.addEventListener(e.Param.eventClick,G,!0),ye.addEventListener(e.Param.eventStart,Z,!0),ye.addEventListener(e.Param.eventMove,q,!0),window.addEventListener(e.Param.eventStop,Y,!0),dt.container.appendChild(ye),dt.keyboardFeature&&document.addEventListener(e.Param.eventKeyboardDown,V,!1),window.addEventListener(e.Param.eventResize,X),dt.draggable!==!1&&ye.addEventListener(e.Param.eventMouseWheel,ae)}function oe(){var t={};for(var n in dt)t[n]=dt[n];if(t.container=ye,"canvas"===dt.domMode)de=new e.Class.CanvasViewerManager;else{if("html"!==dt.domMode)return!1;de=new e.Class.HtmlViewerManager}de.init(t),dt.links&&(e.Main.linksManagerNew=new e.Class.LinksManagerNew,e.Main.linksManagerNew.init(t))}function se(){NIApi.register("page.open",function(t){return e.Utils._assertInteger(t,"Page number must be an integer"),ee(t),Promise.resolve()}),NIApi.register("page.openNext",function(){return te("next"),Promise.resolve()}),NIApi.register("page.openPrevious",function(){return te("prev"),Promise.resolve()}),NIApi.register("page.openFirst",function(){return ee("first"),Promise.resolve()}),NIApi.register("page.openLast",function(){return ee("last"),Promise.resolve()}),NIApi.register("page.clickLink",function(t,n){return e.Utils._assertInteger(t,"Page number must be an integer")&&e.Utils._assertInteger(n,"Link index must be an integer")&&t>0&&t<=dt.pagesQuantity&&n>=0&&e.Main.linksManagerNew.linkClick(t,{index:n}),Promise.resolve()})}function le(t){ie(t||{}),"canvas"===dt.domMode&&(De=5e6),re(),oe(),X(),we=new Array((2*dt.deltaFrameInCache+1)*dt.pagesInFrame),Le=!0,se();var n=e.Main.urlManager.get("startPage")||e.Main.urlManager.get("page")||dt.startPage;ee(n),e.Main.pageManager.onChange(function(t){e.Main.viewerManager.goToPage(t)}),O("out")}function ue(){var e=window.innerWidth/2,t=window.innerWidth/2;W(e,t)}function ce(){ot=!1,ue()}function pe(){ot=!0,ue()}function he(){return ot}var de={},me=0,fe=0,ge=Math,ve=(e.Param.newThemeVersion,{}),be=[],ye=null,Ee=0,Me=-1,Pe=0,we=[],Se=!1,_e=!1,Te=0,xe=0,Ce=[],Le=!1,Ae=!1,ke=!1,Oe=!1,De=0,Ie=["paddingBottom","paddingRight","paddingTop","paddingLeft"],Ne=function(e,t){if("svg"===dt.highQualityKey)return e;var n=t?ge.pow(10,t):1;return ge.round(e*n)/n},Ue=0,Re=me,Fe=0,Be=0,ze=0,Ve=0,He=0,Ge=fe,je=0,We=0,Ze=0,qe=0,Ye=0,Xe=0,Qe=0,Ke=0,Je=!1,$e=!1,et=!1,tt=0,nt=0,it=0,at=0,rt=0,ot=!1,st=1,lt=!1,ut=!1,ct=!1,pt=!1,ht=null,dt={deltaFrameInCache:2,deltaFrameInDOM:1,pagesInFrame:1,pageOnFirstFrame:1,pageMaxWidth:0,pageShadowSize:0,pagesQuantity:0,lowQualityCacheLength:20,highQualityCacheLength:6,domMode:"canvas",startPage:1,highQualityKey:"hdpi",lowQualityKey:"mdpi",lowQualityDisabled:!1,links:!0,pagesRetina:!0,linksRetina:!1,zoomRetina:!0,linksBoxWithDom:!0,autoPlayVideo:!0,autoPlayAnim:!1,linkClickMargin:6,keyboardFeature:!0,zoomPinch:!0,zoomDoubleClick:!0,zoomSingleClick:!1,draggable:!0,delayLoadingHd:0,delayLoadingAnim:400,maxZoom:2.5,zoomScale:2,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,pageMaxHeight:0,minPxToChangePage:30,minPxToCancelScroll:60,minPxToDrag:5,doubleTapDelay:250,animationTimePerPage:125,pageBgColor:"rgba(240, 240, 240, 1)",useBgColorPerPage:!0,linkBoxAspect:e.Class.LinksManagerNew.linksBehaviors.blink,linkBlinkDuration:1e3,verticalSlider:!1,container:e.Param.viewMain},mt=function(){function e(e){var t,n=[],i={},a=0;"high"===e?(i=s,a=dt.highQualityCacheLength):"low"===e&&(i=o,a=dt.lowQualityCacheLength);var r=Object.keys(i);for(t=r.length;t--;)n.push(i[r[t]].date);n.sort(l);var u=n[a-1];NIApi.page.getVisiblePages().then(function(t,n,i){for(var a=[].concat(i),l=1;l<=dt.pagesInFrame;l++)a.push(i[i.length-1]+l);for(var u=1;u<=dt.pagesInFrame;u++)a.unshift(i[0]-u);for(a=a.map(function(e){return e.toString()}),l=r.length;l--;)a.indexOf(r[l])===-1&&t.hasOwnProperty(r[l])===!0&&t[r[l]].date<n&&(t[r[l]]=void 0,delete t[r[l]]);"high"===e?s=t:"low"===e&&(o=t)}.bind(null,i,u))}function t(t){"low"===t?Object.keys(o).length>dt.lowQualityCacheLength&&e(t):"high"===t&&Object.keys(s).length>dt.highQualityCacheLength&&e(t)}function n(e){var t=!1;return"undefined"!=typeof s[e]?t="high":"undefined"!=typeof o[e]&&(t="low"),t}function i(e){var t=!1;return"undefined"!=typeof s[e]?(s[e].date=new Date,t=s[e],t.highQuality=!0):"undefined"!=typeof o[e]&&(o[e].date=new Date,t=o[e],t.highQuality=!1),t}function a(e,n){o[e]&&(delete o[e],o[e]=void 0),n.setAttribute("data-pageNumber",e),o[e]={image:n,date:new Date},window.requestAnimationFrame(t.bind({},"low"))}function r(e,n,i){s[e]&&!i?s[e].date=new Date:(n.setAttribute("data-pageNumber",e),s[e]={image:n,date:new Date},window.requestAnimationFrame(t.bind({},"high")))}var o={},s={},l=function(e,t){return t-e};return{hasPage:n,getPage:i,setLowPage:a,setHighPage:r}}(),ft=function(){function t(){be=[];for(var e in ve)be.push({x:ve[e].x,y:ve[e].y})}return function(n){if(n.type.indexOf("mouse")>=0)be=n.type===e.Param.eventStop||n.type===e.Param.eventOut?[]:[{x:n.pageX,y:n.pageY}];else if(n.type.toLowerCase().indexOf("pointer")>=0)n.type===e.Param.eventStop||n.type===e.Param.eventOut?delete ve[n.pointerId]:n.type.toLowerCase().indexOf("move")>=0&&Je===!1||(ve[n.pointerId]={x:n.pageX,y:n.pageY}),t();else if(n.type.indexOf("touch")>=0){ve={};for(var i=n.touches.length;i--;)ve[n.touches[i].identifier]={x:n.touches[i].clientX,y:n.touches[i].clientY};t()}}}();return{init:le,setConfig:ie,goToPage:ee,scrollFrame:te,addImagesOnPage:v,addLinksBoxOnPage:b,linkChargedInPage:y,getScale:C,getPagesInCacheAtFrame:P,getPagePosition:w,getPageCoordX:x,getFrameCoordX:_,getFrameCoordY:T,getFrameOfPage:n,getPagesOfFrame:t,getDeltaFrameForPage:i,getCurrentPages:S,zoomIn:ce,zoomOut:pe,isZoomed:he}}}(webpublicationNamespace);var CSSJSON=new function(){var e=this;e.init=function(){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.repeat=function(e){return new Array(1+e).join(this)}},e.init();var t=/\/\*[\s\S]*?\*\//g,n=/([^\:]+):([^\;]*);/,a=/(\/\*[\s\S]*?\*\/)|([^\s\;\{\}][^\;\{\}]*(?=\{))|(\})|([^\;\{\}]+\;(?!\s*\*\/))/gim,r=1,o=2,s=3,l=4,u=function(e){return"undefined"==typeof e||0==e.length||null==e},c=function(e){return!u(e)&&(e.attributes&&e.children)};e.toJSON=function(c,p){var h={children:{},attributes:{}},d=null,m=0;if("undefined"==typeof p)var p={ordered:!1,comments:!1,stripComments:!1,split:!1};for(p.stripComments&&(p.comments=!1,c=c.replace(t,""));null!=(d=a.exec(c));)if(!u(d[r])&&p.comments){var f=d[r].trim();h[m++]=f}else if(u(d[o])){if(!u(d[s]))return h;if(!u(d[l])){var g=d[l].trim(),v=n.exec(g);if(v){var b=v[1].trim(),y=v[2].trim();if(p.ordered){var E={};E.name=b,E.value=y,E.type="attr",h[m++]=E}else if(b in h.attributes){var M=h.attributes[b];M instanceof Array||(h.attributes[b]=[M]),h.attributes[b].push(y)}else h.attributes[b]=y}else h[m++]=g}}else{var b=d[o].trim(),P=e.toJSON(c,p);if(p.ordered){var E={};E.name=b,E.value=P,E.type="rule",h[m++]=E}else{if(p.split)var w=b.split(",");else var w=[b];for(i in w){var S=w[i].trim();if(S in h.children)for(var _ in P.attributes)h.children[S].attributes[_]=P.attributes[_];else h.children[S]=P}}}return h},e.toCSS=function(e,t,n){var a="";if("undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=!1),e.attributes)for(i in e.attributes){var r=e.attributes[i];if(r instanceof Array)for(var o=0;o<r.length;o++)a+=d(i,r[o],t);else a+=d(i,r,t)}if(e.children){var s=!0;for(i in e.children)n&&!s?a+="\n":s=!1,a+=m(i,e.children[i],t)}return a},e.toHEAD=function(t,n,i){var a=document.getElementsByTagName("head")[0],r=document.getElementById(n),o=null!==r&&r instanceof HTMLStyleElement;if(!u(t)&&a instanceof HTMLHeadElement){if(o){if(i!==!0&&!u(i))return;r.removeAttribute("id")}c(t)&&(t=e.toCSS(t));var s=document.createElement("style");if(s.type="text/css",u(n)?s.id="cssjson_"+h():s.id=n,s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t)),a.appendChild(s),p(s))o&&r.parentNode.removeChild(r);else{if(s.parentNode.removeChild(s),!o)return;r.setAttribute("id",n),s=r}return s}},"undefined"!=typeof window&&(window.createCSS=e.toHEAD);var p=function(e){return e instanceof HTMLStyleElement&&e.sheet.cssRules.length>0},h=function(){return Date.now()||+new Date},d=function(e,t,n){return"\t".repeat(n)+e+": "+t+";\n"},m=function(t,n,i){var a="\t".repeat(i)+t+" {\n";return a+=e.toCSS(n,i+1),a+="\t".repeat(i)+"}\n"}},Tween=function(){function e(){}e.create=function(){var e=null,t=null,n=null;return function(i,a){for(e=[],t=arguments.length,n=2;n<t;n++)e[n-2]=arguments[n];return function(){a.apply(i,[].concat(arguments,e))}}}();var t=function(e,t,n,i,a,r,o){this.init(e,t,n,i,a,r,o)},n=t.prototype;return n.obj={},n.prop="",n.func=function(e,t,n,i){return n*e/i+t},n.begin=0,n.change=0,n.prevTime=0,n.prevPos=0,n.looping=!1,n._duration=0,n._time=0,n._pos=0,n._position=0,n._startTime=0,n._finish=0,n.name="",n.suffixe="",n._listeners=[],n.setTime=function(e){this.prevTime=this._time,e>this.getDuration()?this.looping?(this.rewind(e-this._duration),this.update(),this.broadcastMessage("onMotionLooped",{target:this,type:"onMotionLooped"})):(this._time=this._duration,this.update(),this.stop(),this.broadcastMessage("onMotionFinished",{target:this,type:"onMotionFinished"})):e<0?(this.rewind(),this.update()):(this._time=e,this.update())},n.getTime=function(){return this._time},n.setDuration=function(e){this._duration=null==e||e<0?1e5:e},n.getDuration=function(){return this._duration},n.setPosition=function(){var e=null;return function(t){this.prevPos=this._pos,e=""!=this.suffixe?this.suffixe:"",this.obj[this.prop]=Math.round(t)+e,this._pos=t,this.broadcastMessage("onMotionChanged",{target:this,type:"onMotionChanged"})}}(),n.getPosition=function(e){return void 0==e&&(e=this._time),this.func(e,this.begin,this.change,this._duration)},n.setFinish=function(e){this.change=e-this.begin},n.getFinish=function(){return this.begin+this.change},n.init=function(e,t,n,i,a,r,o){arguments.length&&(this._listeners=new Array,this.addListener(this),o&&(this.suffixe=o),this.obj=e,this.prop=t,this.begin=i,this._pos=i,this.setDuration(r),null!=n&&""!=n&&(this.func=n),this.setFinish(a))},n.start=function(){this.rewind(),this.startEnterFrame(),this.broadcastMessage("onMotionStarted",{target:this,type:"onMotionStarted"})},n.rewind=function(e){this.stop(),this._time=void 0==e?0:e,this.fixTime(),this.update()},n.fforward=function(){this._time=this._duration,this.fixTime(),this.update()},n.update=function(){this.setPosition(this.getPosition(this._time))},n.startEnterFrame=function(){this.stopEnterFrame(),this.isPlaying=!0,this.onEnterFrame()},n.onEnterFrame=function(){this.isPlaying&&(this.nextFrame(),window.requestAnimationFrame(e.create(this,this.onEnterFrame)))},n.nextFrame=function(){this.setTime((this.getTimer()-this._startTime)/1e3)},n.stop=function(){this.stopEnterFrame(),this.broadcastMessage("onMotionStopped",{target:this,type:"onMotionStopped"})},n.stopEnterFrame=function(){this.isPlaying=!1},n.continueTo=function(e,t){this.begin=this._pos,this.setFinish(e),void 0!=this._duration&&this.setDuration(t),this.start()},n.resume=function(){this.fixTime(),this.startEnterFrame(),this.broadcastMessage("onMotionResumed",{target:this,type:"onMotionResumed"})},n.yoyo=function(){this.continueTo(this.begin,this._time)},n.addListener=function(e){return this.removeListener(e),this._listeners.push(e)},n.removeListener=function(){var e=null,t=null;return function(n){for(e=this._listeners,t=e.length;t--;)if(e[t]==n)return e.splice(t,1),!0;return!1}}(),n.broadcastMessage=function(){var e=null,t=null,n=null,i=null,a=null,r=null;return function(){for(e=[],t=r=arguments.length;r--;)e.push(arguments[t-(r+1)]);for(n=e.shift(),i=this._listeners,a=i.length;a--;)i[a][n]&&i[a][n].apply(i[a],e)}}(),n.fixTime=function(){this._startTime=this.getTimer()-1e3*this._time},n.getTimer=function(){return(new Date).getTime()-this._time},t.backEaseIn=function(e,t,n,i,a,r){if(void 0==o)var o=1.70158;return n*(e/=i)*e*((o+1)*e-o)+t},t.backEaseOut=function(e,t,n,i,a,r){if(void 0==o)var o=1.70158;return n*((e=e/i-1)*e*((o+1)*e+o)+1)+t},t.backEaseInOut=function(e,t,n,i,a,r){if(void 0==o)var o=1.70158;return(e/=i/2)<1?n/2*(e*e*(((o*=1.525)+1)*e-o))+t:n/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+t},t.elasticEaseIn=function(e,t,n,i,a,r){if(0==e)return t;if(1==(e/=i))return t+n;if(r||(r=.3*i),!a||a<Math.abs(n)){a=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/a);return-(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/r))+t},t.elasticEaseOut=function(e,t,n,i,a,r){if(0==e)return t;if(1==(e/=i))return t+n;if(r||(r=.3*i),!a||a<Math.abs(n)){a=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*e)*Math.sin((e*i-o)*(2*Math.PI)/r)+n+t},t.elasticEaseInOut=function(e,t,n,i,a,r){if(0==e)return t;if(2==(e/=i/2))return t+n;if(!r)var r=i*(.3*1.5);if(!a||a<Math.abs(n))var a=n,o=r/4;else var o=r/(2*Math.PI)*Math.asin(n/a);return e<1?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/r))+t:a*Math.pow(2,-10*(e-=1))*Math.sin((e*i-o)*(2*Math.PI)/r)*.5+n+t},t.bounceEaseOut=function(e,t,n,i){return(e/=i)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},t.bounceEaseIn=function(e,n,i,a){return i-t.bounceEaseOut(a-e,0,i,a)+n},t.bounceEaseInOut=function(e,n,i,a){return e<a/2?.5*t.bounceEaseIn(2*e,0,i,a)+n:.5*t.bounceEaseOut(2*e-a,0,i,a)+.5*i+n},t.strongEaseInOut=function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},t.regularEaseIn=function(e,t,n,i){return n*(e/=i)*e+t},t.regularEaseOut=function(e,t,n,i){return-n*(e/=i)*(e-2)+t},t.regularEaseInOut=function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},t.strongEaseIn=function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},t.strongEaseOut=function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},t.strongEaseInOut=function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},t}();!function(e){var t=null;!function n(e,i,a){function r(s,l){if(!i[s]){if(!e[s]){var u="function"==typeof t&&t;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=i[s]={exports:{}};e[s][0].call(p.exports,function(t){var n=e[s][1][t];return r(n?n:t)},p,p.exports,n,e,i,a)}return i[s].exports}for(var o="function"==typeof t&&t,s=0;s<a.length;s++)r(a[s]);return r}({1:[function(e,t,n){(function(i,a){!function(e,i){"object"==typeof n&&"undefined"!=typeof t?t.exports=i():"function"==typeof define&&define.amd?define(i):e.ES6Promise=i()}(this,function(){function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function n(e){return"function"==typeof e}function r(e){q=e}function o(e){Y=e}function s(){return function(){return i.nextTick(h)}}function l(){return"undefined"!=typeof Z?function(){Z(h)}:p()}function u(){var e=0,t=new K(h),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=h,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(h,1)}}function h(){for(var e=0;e<W;e+=2){var t=ee[e],n=ee[e+1];t(n),ee[e]=void 0,ee[e+1]=void 0}W=0}function d(){try{var t=e,n=t("vertx");return Z=n.runOnLoop||n.runOnContext,l()}catch(i){return p()}}function m(e,t){var n=this,i=new this.constructor(g);void 0===i[ne]&&N(i);var a=n._state;if(a){var r=arguments[a-1];Y(function(){return O(a,i,r,n._result)})}else C(n,i,e,t);return i}function f(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(g);return S(n,e),n}function g(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function y(e){try{return e.then}catch(t){return oe.error=t,oe}}function E(e,t,n,i){try{e.call(t,n,i)}catch(a){return a}}function M(e,t,n){Y(function(e){var i=!1,a=E(n,t,function(n){i||(i=!0,t!==n?S(e,n):T(e,n))},function(t){i||(i=!0,x(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&a&&(i=!0,x(e,a))},e)}function P(e,t){t._state===ae?T(e,t._result):t._state===re?x(e,t._result):C(t,void 0,function(t){return S(e,t)},function(t){return x(e,t)})}function w(e,t,i){t.constructor===e.constructor&&i===m&&t.constructor.resolve===f?P(e,t):i===oe?(x(e,oe.error),oe.error=null):void 0===i?T(e,t):n(i)?M(e,t,i):T(e,t)}function S(e,n){e===n?x(e,v()):t(n)?w(e,n,y(n)):T(e,n)}function _(e){e._onerror&&e._onerror(e._result),L(e)}function T(e,t){e._state===ie&&(e._result=t,e._state=ae,0!==e._subscribers.length&&Y(L,e))}function x(e,t){e._state===ie&&(e._state=re,e._result=t,Y(_,e))}function C(e,t,n,i){var a=e._subscribers,r=a.length;e._onerror=null,a[r]=t,a[r+ae]=n,a[r+re]=i,0===r&&e._state&&Y(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,a=void 0,r=e._result,o=0;o<t.length;o+=3)i=t[o],a=t[o+n],i?O(n,i,a,r):a(r);e._subscribers.length=0}}function A(){this.error=null}function k(e,t){try{return e(t)}catch(n){return se.error=n,se}}function O(e,t,i,a){var r=n(i),o=void 0,s=void 0,l=void 0,u=void 0;if(r){if(o=k(i,a),o===se?(u=!0,s=o.error,o.error=null):l=!0,t===o)return void x(t,b())}else o=a,l=!0;t._state!==ie||(r&&l?S(t,o):u?x(t,s):e===ae?T(t,o):e===re&&x(t,o))}function D(e,t){try{t(function(t){S(e,t)},function(t){x(e,t)})}catch(n){x(e,n)}}function I(){return le++}function N(e){e[ne]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function U(){return new Error("Array Methods must be provided an Array")}function U(){return new Error("Array Methods must be provided an Array")}function R(e){return new ue(this,e).promise}function F(e){var t=this;return new t(j(e)?function(n,i){for(var a=e.length,r=0;r<a;r++)t.resolve(e[r]).then(n,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,n=new t(g);return x(n,e),n}function z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(){var e=void 0;if("undefined"!=typeof a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===i&&!n.cast)return}e.Promise=ce}var G=void 0;G=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var j=G,W=0,Z=void 0,q=void 0,Y=function(e,t){ee[W]=e,ee[W+1]=t,W+=2,2===W&&(q?q(h):te())},X="undefined"!=typeof window?window:void 0,Q=X||{},K=Q.MutationObserver||Q.WebKitMutationObserver,J="undefined"==typeof self&&"undefined"!=typeof i&&"[object process]"==={}.toString.call(i),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ee=new Array(1e3),te=void 0;te=J?s():K?u():$?c():void 0===X&&"function"==typeof e?d():p();var ne=Math.random().toString(36).substring(16),ie=void 0,ae=1,re=2,oe=new A,se=new A,le=0,ue=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(g),this.promise[ne]||N(this.promise),j(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&T(this.promise,this._result))):x(this.promise,U())}return e.prototype._enumerate=function(e){for(var t=0;this._state===ie&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===f){var a=y(e);if(a===m&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(n===ce){var r=new n(g);w(r,e,a),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===ie&&(this._remaining--,e===re?x(i,n):this._result[t]=n),0===this._remaining&&T(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;C(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(re,t,e)})},e}(),ce=function(){function e(t){this[ne]=I(),this._result=this._state=void 0,this._subscribers=[],g!==t&&("function"!=typeof t&&z(),this instanceof e?D(this,t):V())}return e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(e){var t=this,n=t.constructor;return t.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})},e}();return ce.prototype.then=m,ce.all=R,ce.race=F,ce.resolve=f,ce.reject=B,ce._setScheduler=r,ce._setAsap=o,ce._asap=Y,ce.polyfill=H,ce.Promise=ce,ce})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,t,n){function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function r(e){if(p===setTimeout)return setTimeout(e,0);if((p===i||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function o(e){if(h===clearTimeout)return clearTimeout(e);if((h===a||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){g&&m&&(g=!1,m.length?f=m.concat(f):v=-1,f.length&&l())}function l(){if(!g){var e=r(s);g=!0;for(var t=f.length;t;){for(m=f,f=[];++v<t;)m&&m[v].run();v=-1,t=f.length}m=null,g=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var p,h,d=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:i}catch(e){p=i}try{h="function"==typeof clearTimeout?clearTimeout:a}catch(e){h=a}}();var m,f=[],g=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new u(e,t)),1!==f.length||g||r(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],3:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./EpubConfig/EpubDefaultConfig"),r=e("./utils/enums"),o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.setConfig=function(t){e.prototype.setConfig.call(this,t),this.device=this.userAgent.device.type,this.browser=this.userAgent.browser.name,this.os=this.userAgent.os.name;var n="device_"+this.device,i="browser_"+this.browser,a="os_"+this.os;document.documentElement.classList.add("pagetype-"+r.READER_TYPES[this.readerPageSrcType].toLowerCase()),"function"==typeof this[n]&&this[n](),"function"==typeof this[i]&&this[i](),"function"==typeof this[a]&&this[a]()},t.prototype.device_phone=function(){},t.prototype.device_tab=function(){},t.prototype.device_desktop=function(){this.timeToRefreshScreenResize=0},t.prototype.browser_safari=function(){},t.prototype.browser_chrome=function(){},t.prototype.browser_firefox=function(){},t.prototype.browser_ie=function(){},t.prototype.browser_edge=function(){},t.prototype.browser_android=function(){},t.prototype.os_windows=function(){},t.prototype.os_mac=function(){},t.prototype.os_iOS=function(){},t.prototype.os_android=function(){},t}(a["default"]);n["default"]=o},{"./EpubConfig/EpubDefaultConfig":4,"./utils/enums":79}],4:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../utils/enums"),r=t("../EpubEvent"),o=function(){function t(t){this.PAGESIZETYPES={CONTAIN:"contain",COVER_MIDDLE:"coverMiddle",COVER_TOP:"coverTop",COVER_HORIZONTALLY:"coverHorizontally",CUSTOM:"custom"},this._linksSizePageWidth=0,this._linksSizePageHeight=0,this._paddingBottom=0,this._paddingTop=0,this._paddingLeft=0,this._paddingRight=0,this._spreadsLength=3,this._pagesBySpread=2,this._pageQuantity=0,this._firstCoverPage=1,this._pageOnFirstFrame=1,this._pageSizeType=this.PAGESIZETYPES.CONTAIN,this._pageSizeMaxWidth=0,this._pageSizeMaxHeight=0,this._coverPageCenter=!1,this._currentPageAtInit=1,this.countPageChange=0,this._currentPage=1,this.lastPage=1,this.domMode="html",this._spreadDraggable=!0,this.highQualityKey="hdpi",this._linkBoxAspect=a.LinksBehaviors.blink,this._linkBlinkDuration=1e3,this._pdfHTMLMaxFontLoad=0,this.pageBgColor="#fff",this.pagesRetina=!0,this._verticalSlider=!1,this.timeToRefreshScreenResize=50,this.switchLandScapeUsingPageSize=!1,this.pagesBySpreadMax=2,this.pagesBySpreadUseApiPageManager=!1,this._zoomDoubleClick=!0,this._zoomSingleClick=!1,this.zoomPinch=!0,this.zoomRetina=!0,this._zoomFactor=.008,this._maxZoom=1,this.defaultPageScaleAt=.75,this.maxPageTotalScale=1.5,this._transitionTime=.2,this._useMatrixTransformZoomable=!0,this._useMatrixTransformScrollable=!0,this._enableAspLinks=!0,this._readerPageSrcType=a.READER_TYPES.EPUB_HTML,this._pageSizeTypeConf=(n={},n[this.PAGESIZETYPES.COVER_TOP]={switchablePageBySpread:!1},n[this.PAGESIZETYPES.COVER_MIDDLE]={switchablePageBySpread:!1},n[this.PAGESIZETYPES.COVER_HORIZONTALLY]={switchablePageBySpread:!0},n[this.PAGESIZETYPES.CONTAIN]={switchablePageBySpread:!0},n[this.PAGESIZETYPES.CUSTOM]={switchablePageBySpread:!0},n),this.mainViewElementClassName="webpub-viewer__epub-container",this.spreadViewElementClassName="webpub-viewer__epub-container-spread",this.zoomableViewElementClassName="webpub-viewer__epub-container-spread-zoomable";this._currentPageAtInit=~~(e.Main.urlManager.get("page")||this._currentPage),this.epubEvent=e.epubEvent,this.userAgent=e.Param.userAgent,this.pageMargin=[0,0,0,0],this.linksSizePageWidth=parseFloat(e.Main.xmlManager.get("common-configuration","contents","swf","width")),this.linksSizePageHeight=parseFloat(e.Main.xmlManager.get("common-configuration","contents","swf","height")),this.menuViewPageControlItems=e.Main.xmlManager.get("common-ui","panelViewControlItems");
var n}return t.prototype.paddinigsUpdate=function(){var e=this.paddings;this.paddingLeft=~~e.paddingLeft+this.pageMargin[0],this.paddingTop=~~e.paddingTop+this.pageMargin[1],this.paddingRight=~~e.paddingRight+this.pageMargin[2],this.paddingBottom=~~e.paddingBottom+this.pageMargin[3]},Object.defineProperty(t.prototype,"paddings",{get:function(){return e.Main.viewerService.getPadding()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linksSizePageHeight",{get:function(){return this._linksSizePageHeight},set:function(e){this._linksSizePageHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linksSizePageWidth",{get:function(){return this._linksSizePageWidth/2},set:function(e){this._linksSizePageWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linkBoxAspect",{get:function(){return this._linkBoxAspect},set:function(e){this._linkBoxAspect=a.LinksBehaviors[e]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"linkBlinkDuration",{get:function(){return this._linkBlinkDuration},set:function(e){this._linkBlinkDuration=e,this.addLinkStyleTags()},enumerable:!0,configurable:!0}),t.prototype.addLinkStyleTags=function(e){void 0===e&&(e="ms"),void 0===this.styleElement&&(this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement));var t=".webpub-viewer__epub-container .epub-links_container-link{-webkit-animation-duration: "+(this.linkBlinkDuration+e)+"!important;animation-duration: "+(this.linkBlinkDuration+e)+"!important;}";this.styleElement.type="text/css",this.styleElement.innerText=t},Object.defineProperty(t.prototype,"navigationType",{get:function(){return this.verticalSlider===!1?"x":"y"},set:function(e){"x"===e?this.verticalSlider=!1:this.verticalSlider=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalSlider",{get:function(){return this._verticalSlider},set:function(t){this._verticalSlider=t,this._verticalSlider?e.Param.viewMain.classList.add("webpub-viewer__container-vertical"):e.Param.viewMain.classList.remove("webpub-viewer__container-vertical")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this._pagesBySpread},set:function(e){this._pageSizeTypeConf[this._pageSizeType].switchablePageBySpread!==!1&&(this._pagesBySpread=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transitionTime",{get:function(){return this._transitionTime},set:function(e){isNaN(e)||(e=Math.max(e,1e-4),this._transitionTime=e||0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesInFrame",{get:function(){return this.pagesBySpread},set:function(e){this.pagesBySpread=e,this.pagesBySpreadMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this._pageQuantity},set:function(e){this._pageQuantity=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),1===this._firstCoverPage&&(e=~~(e/this.pagesBySpread)*this.pagesBySpread||1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!0}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPageNoAnimation",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),1===this._firstCoverPage&&(e=~~(e/this.pagesBySpread)*this.pagesBySpread||1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!1}})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstCoverPage",{get:function(){return 1===this.pagesBySpread?0:this._firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coverPageCenter",{get:function(){return this._coverPageCenter},set:function(e){this._coverPageCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageOnFirstFrame",{get:function(){return this._pageOnFirstFrame},set:function(t){return this._pageOnFirstFrame=e.Main.pageLayoutService.get("pagesOnFirstFrame")||1,this._pageOnFirstFrame>1?void(this._firstCoverPage=0):void(this._firstCoverPage=1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useMatrixTransformZoomable",{get:function(){return this._useMatrixTransformZoomable},set:function(e){this._useMatrixTransformZoomable=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxZoom",{get:function(){return this._maxZoom},set:function(e){this._maxZoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return this._zoomFactor},set:function(e){this._zoomFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomDoubleClick",{get:function(){return this._zoomDoubleClick},set:function(e){this._zoomDoubleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomSingleClick",{get:function(){return this._zoomSingleClick},set:function(e){this._zoomSingleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menuViewPageControlItems",{get:function(){return this._menuViewPageControlItems},set:function(e){this._menuViewPageControlItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useMatrixTransformScrollable",{get:function(){return this._useMatrixTransformScrollable},set:function(e){this._useMatrixTransformScrollable=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spreadsLength",{get:function(){return this.pageQuantity<this._spreadsLength?this.pageQuantity:this._spreadsLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageWidth",{get:function(){return this.ePubConfig.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageHeight",{get:function(){return this.ePubConfig.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeType",{get:function(){return this._pageSizeType},set:function(e){for(var t in this.PAGESIZETYPES)if(this.PAGESIZETYPES[t]===e)return void(this._pageSizeType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeMaxWidth",{get:function(){return this._pageSizeMaxWidth},set:function(e){this._pageSizeMaxWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageMargin",{get:function(){return this._pageMargin},set:function(e){this._pageMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeMaxHeight",{get:function(){return this._pageSizeMaxHeight},set:function(e){this._pageSizeMaxHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerPageSrcType",{get:function(){return this._readerPageSrcType},set:function(e){"string"==typeof e&&(e=a.READER_TYPES[e]),this._readerPageSrcType=a.READER_TYPES[e]?e:this.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableAspLinks",{get:function(){return this._enableAspLinks},set:function(e){this._enableAspLinks=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mustLoadEpubHtmlCss",{get:function(){return this.readerPageSrcType===a.READER_TYPES.EPUB_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mustLoadPdfHtmlCss",{get:function(){return this.readerPageSrcType===a.READER_TYPES.PDF_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spreadDraggable",{get:function(){return this._spreadDraggable},set:function(e){this._spreadDraggable=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this._pdfHTMLMaxFontLoad},set:function(e){this._pdfHTMLMaxFontLoad=e||0},enumerable:!0,configurable:!0}),t.prototype.checkEnableAspLinks=function(){switch(this.enableAspLinks=!1,this.readerPageSrcType){case a.READER_TYPES.PDF_SVG:this.enableAspLinks=!0;break;case a.READER_TYPES.PDF_HTML:this.enableAspLinks=!0;break;case a.READER_TYPES.PDF_IMG:this.enableAspLinks=!0;break;case a.READER_TYPES.PDF_PDF:this.enableAspLinks=!0}},t.prototype.updateConfigFromUrlData=function(){var t=e.Main.urlManager.get("reader-params");try{t=window.decodeURI(t),"undefined"!=typeof t&&this.setConfigLoc(new window.Function("return "+t)())}catch(n){}},t.prototype.setConfigLoc=function(e){var t="";for(t in e)"undefined"!=typeof this[t]&&(this[t]=e[t])},t.prototype.checkZoomLevel=function(){this.menuViewPageControlItems&&"true"===this.menuViewPageControlItems.enable&&e.Main.viewerService.get("zoom","max-scale")?(this.maxPageTotalScale=e.Main.viewerService.get("zoom","max-scale")/1.666,this.defaultPageScaleAt=this.maxPageTotalScale/2):e.Main.viewerService.get("zoom","max-scale")&&(this.maxPageTotalScale=this.defaultPageScaleAt=e.Main.viewerService.get("zoom","max-scale")/1.666)},t.prototype.setConfig=function(e){this.setConfigLoc(e),this.checkEnableAspLinks(),this.updateConfigFromUrlData(),this.checkZoomLevel(),this.ePubConfig instanceof Object==!1&&(this.ePubConfig={})},t}();i["default"]=o},{"../EpubEvent":7,"../utils/enums":79}],5:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./utils/XHRPromise"),r=t("./utils/XHRPromise"),o=function(){function t(e){this.config=e,this.parseCss=!0,this.shadowSelector="",this.urls=[],this.styles=[],this.fontList=[]}return Object.defineProperty(t.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this.config.pdfHTMLMaxFontLoad},enumerable:!0,configurable:!0}),t.prototype.init=function(e){var t=this;this.onProgressPercentage=e;var n=window.document.querySelector(".force-font-load");this.setUrls();var i=this.load();return i.then(function(){t.appendStyle(),null===n&&(t.styles.forEach(function(e){t.parse(e)}),t.fontsLettersAppend()),t.clearUnNeeded()}),i},t.prototype.setUrls=function(){var t;this.config.mustLoadEpubHtmlCss&&(t=e.Main.xmlManager.get("common-ui","assets","epub-idGeneratedStyles"),t&&(this.urls=this.urls.concat(e.Utils.resolveVariable(t.url).split(",")))),this.config.mustLoadPdfHtmlCss&&(t=e.Main.xmlManager.get("common-ui","assets","pdf-HTML-idGeneratedStyles"),t&&(this.urls=this.urls.concat(e.Utils.resolveVariable(t.url).split(","))))},t.prototype.load=function(){for(var e=this,t=[],n=0,i=this.urls.length;n<i;n++)t.push(new a["default"](r.Protocol.GET,this.urls[n]).init());return t.length?Promise.all(t).then(function(t){t.forEach(function(t){e.styles.push(t.responseText)})}):Promise.resolve()},t.prototype.parse=function(e){var t=CSSJSON.toJSON(e,{ordered:!0,comments:!1,stripComments:!1,split:!1}),n={};return this.cloneCssObject(t,n),e},t.prototype.cloneCssObject=function(e,t){var n;for(var i in e)isNaN(Number(i))||(n=this.shadowSelector,0===e[i].name.indexOf("@")&&(this.fontsExtractFromCssObject(e[i]),n=""),t[i]=t[i]||{},t[i].type=e[i].type,t[i].name=n+e[i].name,t[i].value=t[i].value||{},this.cloneCssObjectValues(e[i].value,t[i].value))},t.prototype.cloneCssObjectValues=function(e,t){for(var n in e)isNaN(Number(n))||this.cloneCssObject(t[n],e[n])},t.prototype.fontsExtractFromCssObject=function(e){if(0===e.name.indexOf("@font-face")){var t,n=e.value[1].value,i=n.match(/\([^)]*/gi);i&&(t=i[0].replace("(",""),this.fontList.push(e))}},t.prototype.fontsLettersAppend=function(){var e=[],t=document.createElement("div");t.className="force-font-load";for(var n=function(n,a){if(n>=i.pdfHTMLMaxFontLoad&&0!==i.pdfHTMLMaxFontLoad)return"break";var r=i.fontList[n].value,o=r[0].value,s=r[1].value,l=document.createElement("span");l.style.fontFamily=o,setTimeout(function(){t.appendChild(l)},100*n),e.push("@font-face {"),e.push("font-family: '"+o+"';"),e.push("src: "+s+";}")},i=this,a=0,r=this.fontList.length;a<r;a++){var o=n(a,r);if("break"===o)break}document.body.appendChild(t),this.fontFaces=e.join(" ")},t.prototype.appendStyle=function(){CSSJSON.toHEAD(this.styles.join("\n"))},t.prototype.clearUnNeeded=function(){this.urls=[],this.fontList=[],this.shadowSelector="",this.fontFaces=""},t.prototype.getStyleElement=function(e){return void 0===e&&(e=""),"<style>"+this.styles.join("")+e+"</style>"},t}();i.EpubCssManager=o},{"./utils/XHRPromise":77}],6:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),t("es6-promise");var a=t("./EpubEvent"),r=function(){function t(t,n){e.epubEvent=e.epubEvent||new a.EpubEvent,this.epubEvent=e.epubEvent,"string"==typeof t&&"object"==typeof n&&this.onFire(t,n)}return t.prototype.onFire=function(e,t){return this["allowed_"+e]&&this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:!0,action:this["allowed_"+e].bind(this,t)}}),!1},t.prototype.allowed_action=function(e,t){var n=this;t.then(function(){var i,a,r,o=e[1].trim();return 0===o.indexOf("http")?void n.allowed_url([null,o],t):0===o.indexOf("javascript")||0===o.indexOf("js:")||o.indexOf("js :")?void n.allowed_javascript([null,o],t):0===o.indexOf("NIApi")?void n.allowed_NIApi([null,o],t):(r=o.match(/^mailto:|^mailto :/gi),null!==r&&0!==r.length?void n.allowed_mailto([null,o],t):(i=/-([0-9]*).xhtml$/gim,a=i.exec(o)||[],void(a.length>0&&n.allowed_gotoPage([null,~~a[1]],t))))})},t.prototype.allowed_gotoPage=function(e,t){t.then(function(t){t===!0&&NIApi.page.open(e[1])})},t.prototype.allowed_nextPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openNext()})},t.prototype.allowed_prevPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openPrevious()})},t.prototype.allowed_lastPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openLast()})},t.prototype.allowed_firstPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openFirst()})},t.prototype.allowed_mailto=function(e,t){t.then(function(t){if(t===!0){var n=e[1].trim(),i="mailto:",a=n.match(/^mailto:|^mailto :/gi);null!==a&&0!==a.length&&(i=""),window.location.href=i+n}})},t.prototype.allowed_url=function(e,t){t.then(function(t){t===!0&&NIApi.navigator.openUrl(e[1])})},t.prototype.allowed_popup=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},t.prototype.allowed_lightbox=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},t.prototype.allowed_javascript=function(e,t){t.then(function(t){if(t===!0){var n,i=e[1].split(":");i.shift(),n=i.join(":").trim(),new Function(n)()}})},t.prototype.allowed_NIApi=function(e,t){t.then(function(t){if(t===!0){var n=e[1];new Function(n)()}})},t}();i.EpubDomApi=r;var o=new r,s=o.onFire.bind(o);i["default"]=s},{"./EpubEvent":7,"es6-promise":1}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i;!function(e){e[e.SCREEN_ORIENTATION=0]="SCREEN_ORIENTATION",e[e.PAGE_CHANGE=1]="PAGE_CHANGE",e[e.PAGE_ZOOM=2]="PAGE_ZOOM",e[e.PAGE_CLICK=3]="PAGE_CLICK",e[e.PAGE_CLICK_PERMISSION=4]="PAGE_CLICK_PERMISSION",e[e.PAGE_IN_DOM=5]="PAGE_IN_DOM",e[e.MOUSE_WHEEL=6]="MOUSE_WHEEL",e[e.ELEMENT_SCROLL=7]="ELEMENT_SCROLL",e[e.TOUCH_POINTERDOWN=8]="TOUCH_POINTERDOWN",e[e.TOUCH_POINTERCANCEL=9]="TOUCH_POINTERCANCEL",e[e.TOUCH_POINTERLEAVE=10]="TOUCH_POINTERLEAVE",e[e.TOUCH_POINTERUP=11]="TOUCH_POINTERUP",e[e.TOUCH_POINTERMOVE=12]="TOUCH_POINTERMOVE",e[e.ZOOM_CONTROLLER_RANGE=13]="ZOOM_CONTROLLER_RANGE",e[e.ZOOM_CONTROLLER_LEVEL_CLICK=14]="ZOOM_CONTROLLER_LEVEL_CLICK",e[e.FULLSCREEN_TOGGLE=15]="FULLSCREEN_TOGGLE",e[e.ADMIN_LINK_CREATE=16]="ADMIN_LINK_CREATE",e[e.ACTION_LINK_SUCCESS=17]="ACTION_LINK_SUCCESS"}(i=n.EPUB_EVENTS||(n.EPUB_EVENTS={}));var a=function(){function e(){this.listeners={},this.iName="EpubEvent"}return e.prototype.addListener=function(e,t){"string"==typeof e&&(e=i[e]),"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].indexOf(t)===-1&&this.listeners[e].push(t)},e.prototype.fire=function(e){var t,n,a,r=0,o=0;if(e.target||(e.target=this),e.context||(e.context=this),t=e.type,"string"==typeof e.type&&(t=e.type,t=i[t]),this.listeners[t]instanceof Array){n=this.listeners[t],a=[];var s=void 0;for(o=n.length;r<o;r++)a.push(n[r]);for(;s=a.shift();)n.indexOf(s)!==-1&&s(e)}},e.prototype.removeListener=function(e,t){var n,a=0,r=0;if("string"==typeof e&&(e=i[e]),this.listeners[e]instanceof Array)for(n=this.listeners[e],a=n.length;r<a;r++){if(null!==t&&n[r]===t){n.splice(r,1);break}null===t&&n.splice(r,1)}},e}();n.EpubEvent=a},{}],8:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubGesturesEvent/Defs"),r=t("./EpubGesturesEvent/PointerEventsManager"),o=t("./EpubGesturesEvent/MouseWheelManager"),s=function(){function t(n,i){this.enableTouchPointer=!0,this.gestureEventList={},this.moveDifferer=a.getMoveDifferer(),this.gestureData=a.getGestureData(),this.preventDefaultOnMove=!1,this.wheelData=a.getWheelData(),this._enableScrollElement=!1,this._enableCheckMediaPreventDefault=!0,this.touchConvert=function(e,t){for(var n=t.length,i=0,a=0,r=0,o=0,s=0,l=0;l<n;l++)a+=t[l].clientX,r+=t[l].clientY,o=o||t[0].clientX,s=s||t[0].clientY,o-=t[l].clientX,s-=t[l].clientY,i+=this.touchConvert_getDistance(o,s),o=t[l].clientX,s=t[l].clientY;e.hypotenuse=i,e.epubClientX=a/n,e.epubClientY=r/n},this.userAgent=e.Param.userAgent,this.parent=n,this.element=i,this.element.epubGesturesEvent=this,this.resetMoveDiffererByKeyBinded=this.resetMoveDiffererByKey.bind(this),this.gestureID=Date.now().toString().concat("_UID_",(t.UID++).toString()),this.touchStart=this.touchStart.bind(this),this.touchEnd=this.touchEnd.bind(this),this.touchMove=this.touchMove.bind(this),this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.mouseMove=this.mouseMove.bind(this),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this),this.gestureEventList[t.GESTURESNAME.PINCHGESTURE]=[],this.gestureEventList[t.GESTURESNAME.PRESSGESTURE]=[],this.gestureEventList[t.GESTURESNAME.PANGESTURE]=[],this.gestureEventList[t.GESTURESNAME.TAPGESTURE]=[],this.gestureEventList[t.GESTURESNAME.DBLTAPGESTURE]=[],this.gestureEventList[t.GESTURESNAME.SWIPEGESTURE]=[],this.gestureEventList[t.GESTURESNAME.MOUSEWHEELGESTURE]=[],this.eventsStatus=t.EVENTSSTATUS.data,this.initEvent()}return Object.defineProperty(t.prototype,"enableScrollElement",{get:function(){return this._enableScrollElement},set:function(e){this._enableScrollElement=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableCheckMediaPreventDefault",{get:function(){return this._enableCheckMediaPreventDefault},set:function(e){this._enableCheckMediaPreventDefault=e},enumerable:!0,configurable:!0}),t.prototype.initEvent=function(){var e=this;"android"!==this.userAgent.os.name&&this.enableTouchPointer===!0&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||"function"==typeof window.PointerEvent)?(this.pointerEventsManager=new r.PointerEventsManager(this,this.element),this.pointerEventsManager.addListenerDown(this.pointerDown),this.pointerEventsManager.addListenerUp(this.pointerUp),this.pointerEventsManager.addListenerMove(this.pointerMove)):"ontouchstart"in window?(this.element.addEventListener(t.EVENTSTYPE.TOUCH.TOUCHSTART,this.touchStart),this.element.addEventListener(t.EVENTSTYPE.TOUCH.TOUCHEND,this.touchEnd),this.element.addEventListener(t.EVENTSTYPE.TOUCH.TOUCHMOVE,this.touchMove)):(this.element.addEventListener(t.EVENTSTYPE.MOUSE.MOUSEDOWN,this.mouseDown),this.element.addEventListener(t.EVENTSTYPE.MOUSE.MOUSEUP,this.mouseUp),this.element.addEventListener(t.EVENTSTYPE.MOUSE.MOUSEMOVE,this.mouseMove),document.addEventListener("mouseup",function(t){e.mouseUpDoc(t)},!0)),this.mouseWheelManager=new o.MouseWheelManager(this.element),this.mouseWheelHandler=this.mouseWheelHandler.bind(this),this.onScroll=this.onScroll.bind(this),this.mouseWheelManager.addListeners(this.mouseWheelHandler,this.onScroll)},t.prototype.ePreventDefault=function(e){e.preventDefault()},t.prototype.mouseWheelHandler=function(e){var n=e.data,i=n.deltaX*this.wheelData.deltaX<0,a=n.deltaY*this.wheelData.deltaY<0;0===n.deltaX&&(i=!1),0===n.deltaY&&(a=!1),n.gestureData=this.gestureData,Math.abs(n.deltaX)>Math.abs(n.deltaY)?(i=!0,a=!1):Math.abs(n.deltaX)<Math.abs(n.deltaY)&&(i=!1,a=!0),this.gestureData.wheel.isX=i,this.gestureData.wheel.isY=a,this.callGestureEvent(t.GESTURESNAME.MOUSEWHEELGESTURE,n),this.wheelData.deltaX=n.deltaX||this.wheelData.deltaX,this.wheelData.deltaY=n.deltaY||this.wheelData.deltaY},t.prototype.onScroll=function(e){this.preventAllGesture()},t.prototype.mouseDown=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchStart(e)},t.prototype.mouseUpDoc=function(e){t._eventsStatus=this.eventsStatus;var n=this.getStat(t._eventsStatus,"start");n.stat!==!1&&(e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchEnd(e))},t.prototype.mouseUp=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchEnd(e)},t.prototype.mouseMove=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchMove(e)},t.prototype.touchStart=function(e){e.changedTouches.length>0&&this.resetMoveDifferer(),this.touchConvert(e,e.touches),this.onTouchStart(e)},t.prototype.touchEnd=function(e){return 0===e.touches.length?(this.touchConvert(e,e.changedTouches),void this.onTouchEnd(e)):void this.resetMoveDifferer()},t.prototype.touchMove=function(e){this.preventDefaultOnMove&&this.ePreventDefault(e),this.touchConvert(e,e.touches),this.onTouchMove(e)},t.prototype.pointerDown=function(e){var t=e.data.currentEvent,n=e.data.touches,i=e.data.changedTouches;i.length>0&&this.resetMoveDifferer(),this.touchConvert(t,n),this.onTouchStart(t)},t.prototype.pointerUp=function(e){var t=e.data.currentEvent,n=e.data.touches,i=e.data.changedTouches;return 0===n.length?(this.touchConvert(t,i),void this.onTouchEnd(t)):void this.resetMoveDifferer()},t.prototype.pointerMove=function(e){var t=e.data.currentEvent,n=e.data.touches;this.preventDefaultOnMove&&this.ePreventDefault(t),this.touchConvert(t,n),this.onTouchMove(t)},t.prototype.overrideEventData=function(e,t,n,i,a,r,o,s,l,u,c,p,h){this.gestureData.resetAxis=this.resetMoveDiffererByKeyBinded,this.gestureData.type=t,this.gestureData.pinchZoomDiff=c,this.gestureData.x.pointDiff=n,this.gestureData.x.vectorDiff=a,this.gestureData.x.countDiff=o,this.gestureData.x.isVector=l,this.gestureData.x.client=p,this.gestureData.y.pointDiff=i,this.gestureData.y.vectorDiff=r,this.gestureData.y.countDiff=s,this.gestureData.y.isVector=u,this.gestureData.y.client=h,e.gestureData=this.gestureData},t.clearGlobalTapGestureTimer=function(){for(var e=t.globalTapGestureTimer.length,n=0;n<e;n++)clearTimeout(t.globalTapGestureTimer[n]);t.globalTapGestureTimer=[]},t.prototype.callGestureEvent=function(e,t,n){for(var i=this.gestureEventList[e].length,a=0;a<i;a++)this.gestureEventList[e][a](t,n)},t.prototype.touchConvert_getDistance=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},t.prototype.getStat=function(e,t){return e[t]},t.prototype.setStat=function(e,n,i,a){t.lastTime=a,e[n].stat=i;var r=i?"true":"false";e[n].lastTime=e[n].time,e[n].time=a,e[n][r]=e[n][r],e[n][r].lastTime=e[n][r].time,e[n][r].time=a,clearTimeout(e[n].timer)},t.prototype.setMoveDifferer=function(e){return this.moveDifferer.x.count=this.moveDifferer.x.count||e.epubClientX,this.moveDifferer.x.countDiff+=Math.abs(e.epubClientX-this.moveDifferer.x.count),this.moveDifferer.x.count=e.epubClientX,this.moveDifferer.y.count=this.moveDifferer.y.count||e.epubClientY,this.moveDifferer.y.countDiff+=Math.abs(e.epubClientY-this.moveDifferer.y.count),this.moveDifferer.y.count=e.epubClientY,this.moveDifferer.hypotenuse=this.moveDifferer.hypotenuse||e.hypotenuse,this.moveDifferer.hypotenuseDiff=e.hypotenuse-this.moveDifferer.hypotenuse,this.moveDifferer.hypotenuse=e.hypotenuse,!(this.moveDifferer.x.countDiff<t.STARTMOVEAT&&this.moveDifferer.y.countDiff<t.STARTMOVEAT&&0===this.moveDifferer.hypotenuseDiff)&&(this.moveDifferer.x.pos=this.moveDifferer.x.pos||e.epubClientX,this.moveDifferer.x.diff=e.epubClientX-this.moveDifferer.x.pos,this.moveDifferer.x.vector=this.moveDifferer.x.vector||e.epubClientX,Math.abs(e.epubClientX-this.moveDifferer.x.vector)<Math.abs(this.moveDifferer.x.vectorDiff)&&(this.moveDifferer.x.vector=e.epubClientX),this.moveDifferer.y.pos=this.moveDifferer.y.pos||e.epubClientY,this.moveDifferer.y.diff=e.epubClientY-this.moveDifferer.y.pos,this.moveDifferer.y.vector=this.moveDifferer.y.vector||e.epubClientY,Math.abs(e.epubClientY-this.moveDifferer.y.vector)<Math.abs(this.moveDifferer.y.vectorDiff)&&(this.moveDifferer.y.vector=e.epubClientY),this.moveDifferer.x.vectorDiff=e.epubClientX-this.moveDifferer.x.vector,this.moveDifferer.y.vectorDiff=e.epubClientY-this.moveDifferer.y.vector,!0)},t.prototype.resetMoveDiffererByKey=function(e){this.moveDifferer[e].diff=0,this.moveDifferer[e].count=0,this.moveDifferer[e].countDiff=0,this.moveDifferer[e].pos=0,this.moveDifferer[e].vector=0,this.moveDifferer[e].vectorDiff=0,this.moveDifferer.hypotenuseDiff=0,this.moveDifferer.hypotenuse=0},t.prototype.resetMoveDifferer=function(){this.resetMoveDiffererByKey("x"),this.resetMoveDiffererByKey("y")},t.prototype.resetStat=function(){this.eventsStatus=t.EVENTSSTATUS.data},t.prototype.onTouchStart=function(e){t._eventsStatus=this.eventsStatus;var n=this.getStat(t._eventsStatus,"start");n.stat!==!0&&(this.resetMoveDifferer(),this.setStat(t._eventsStatus,"start",!0,Date.now()),this.setStat(t._eventsStatus,"end",!1,t.lastTime),this.setStat(t._eventsStatus,"move",!1,t.lastTime),this.defineGesture(e,"start"))},t.prototype.onTouchEnd=function(e){t._eventsStatus=this.eventsStatus,this.setStat(t._eventsStatus,"start",!1,Date.now()),this.setStat(t._eventsStatus,"end",!0,t.lastTime),this.defineGesture(e,"end"),this.resetMoveDifferer()},t.prototype.onTouchMove=function(e){t._eventsStatus=this.eventsStatus,this.setStat(t._eventsStatus,"move",!1,Date.now());var n=this.getStat(t._eventsStatus,"start");if(n.stat===!0&&this.getStat(t._eventsStatus,"end").stat===!1){this.checkMediaPreventDefault(e);var i=this.setMoveDifferer(e);i===!0&&(t.clearGlobalTapGestureTimer(),this.setStat(t._eventsStatus,"move",!0,t.lastTime),this.defineGesture(e,"move"))}},t.prototype.checkMediaPreventDefault=function(e){if(this.enableCheckMediaPreventDefault!==!1){var t=e.target,n=t.tagName;if(void 0===n)return void(this.scrollableElement()===!1&&this.ePreventDefault(e));n=n.toLowerCase(),"video"!==n&&"audio"!==n&&this.scrollableElement()===!1&&this.ePreventDefault(e)}},t.prototype.tapGesture=function(e,n){var i=this;if("end"!==n)return!1;t._eventsStatus=this.eventsStatus;var a=this.getStat(t._eventsStatus,"start"),r=this.getStat(t._eventsStatus,"end"),o=this.getStat(t._eventsStatus,"move");return o.stat===!1&&r.stat===!0&&0!==a.lastTime&&(e.defaultPreventGesture===!0?t.clearGlobalTapGestureTimer():clearTimeout(a.timer),this.overrideEventData(e,t.GESTURESNAME.TAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,e.epubClientX,e.epubClientY),a.timer=setTimeout(function(){i.callGestureEvent(t.GESTURESNAME.TAPGESTURE,e)},t.TAPTIME),t.globalTapGestureTimer.push(a.timer)),!1},t.prototype.dblTapGesture=function(e,n){if("end"!==n)return!1;t._eventsStatus=this.eventsStatus;var i=this.getStat(t._eventsStatus,"start"),a=this.getStat(t._eventsStatus,"end"),r=this.getStat(t._eventsStatus,"move");return r.stat===!1&&a["true"].time-i["true"].lastTime<t.DBLTAPTIME&&(t.clearGlobalTapGestureTimer(),this.overrideEventData(e,t.GESTURESNAME.DBLTAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,e.epubClientX,e.epubClientY),!0)},t.prototype.panGesture=function(e,n){if("end"===n||"start"===n)return!1;t._eventsStatus=this.eventsStatus;var i=this.getStat(t._eventsStatus,"move");return i.stat!==!1&&(this.ePreventDefault(e),this.overrideEventData(e,t.GESTURESNAME.PANGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,e.epubClientX,e.epubClientY),!0)},t.prototype.pinchGesture=function(e){},t.prototype.pressGesture=function(e){},t.prototype.neutralSwipeGesture=function(e){return(0!==this.moveDifferer.x.vectorDiff||0!==this.moveDifferer.y.vectorDiff)&&(this.ePreventDefault(e),this.overrideEventData(e,t.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,e.epubClientX,e.epubClientY),!0)},t.prototype.swipeGesture=function(e){t._eventsStatus=this.eventsStatus;var n=!1,i=!1,a=this.getStat(t._eventsStatus,"start"),r=this.getStat(t._eventsStatus,"end"),o=this.getStat(t._eventsStatus,"move");return o.stat!==!1&&r.stat!==!1&&(n=Math.abs(this.moveDifferer.x.vectorDiff)>t.SWIPEGESTURE_AT_PIXELS,n===!1&&(n=Math.abs(this.moveDifferer.x.vectorDiff)>t.SWIPEGESTURE_AT_PIXELS_IN_TIME&&r.time-a.lastTime<=t.SWIPEGESTURE_AT_TIME),i=Math.abs(this.moveDifferer.y.vectorDiff)>t.SWIPEGESTURE_AT_PIXELS,i===!1&&(i=Math.abs(this.moveDifferer.y.vectorDiff)>t.SWIPEGESTURE_AT_PIXELS_IN_TIME&&r.lastTime-a.lastTime<=t.SWIPEGESTURE_AT_TIME),n===!1&&i===!1?this.neutralSwipeGesture(e):(this.overrideEventData(e,t.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,n,i,this.moveDifferer.hypotenuseDiff,e.epubClientX,e.epubClientY),!0))},t.prototype.defineGesture=function(e,n){if(e.defaultPreventGesture===!0||t.PREVENT_ALL===!0)return this.resetStat(),this.resetMoveDifferer(),void t.clearGlobalTapGestureTimer();t._eventsStatus=this.eventsStatus;this.getStat(t._eventsStatus,"start");return this.dblTapGesture(e,n)===!0?(this.callGestureEvent(t.GESTURESNAME.DBLTAPGESTURE,e),void t.clearGlobalTapGestureTimer()):(this.tapGesture(e,n)===!0,this.swipeGesture(e)===!0?(this.callGestureEvent(t.GESTURESNAME.SWIPEGESTURE,e),void((e.defaultPreventGesture===!0||t.PREVENT_ALL)&&t.clearGlobalTapGestureTimer())):this.panGesture(e,n)===!0?(this.callGestureEvent(t.GESTURESNAME.PANGESTURE,e),void((e.defaultPreventGesture===!0||t.PREVENT_ALL)&&t.clearGlobalTapGestureTimer())):void 0)},t.prototype.setEnableScrollElement=function(e){this.enableScrollElement=e},t.prototype.setEnableCheckMediaPreventDefault=function(e){this.enableCheckMediaPreventDefault=e},t.prototype.scrollableElement=function(){return this.enableScrollElement!==!1&&null!==this.element.parentElement},t.prototype.preventAllGesture_reset=function(){t.PREVENT_ALL=!1},t.preventAllGestureStatus=function(){return t.PREVENT_ALL},t.prototype.preventAllGesture=function(){clearTimeout(t.timer),t.PREVENT_ALL=!0,t.timer=setTimeout(this.preventAllGesture_reset,100);
},t.prototype.addEventListener=function(e,t){var n="gesture_".concat(e,"_",this.gestureID);return"undefined"==typeof t[n]&&(t[n]=!0,this.gestureEventList[e].push(t),!0)},t.prototype.removeEventListener=function(e,t){var n="gesture_".concat(e,"_",this.gestureID);if("undefined"==typeof t[n])return!1;for(var i=0,a=this.gestureEventList[e].length;i<a;i++)if(void 0!==this.gestureEventList[e][i][n])return this.gestureEventList[e][i][n]=null,delete this.gestureEventList[e][i][n],!0;return!1},t.prototype.resetMoveXDifferer=function(){this.resetMoveDiffererByKey("x")},t.prototype.resetMoveYDifferer=function(){this.resetMoveDiffererByKey("y")},t}();s.EVENTSTYPE=a.getEventsType(),s.UID=0,s.DBLTAPTIME=500,s.TAPTIME=300,s.PREVENT_ALL=!1,s.STARTMOVEAT=10,s.SWIPEGESTURE_AT_TIME=200,s.SWIPEGESTURE_AT_PIXELS_IN_TIME=7,s.SWIPEGESTURE_AT_PIXELS=50,s.EVENTSSTATUS={get data(){return a.getEpubEventStatusManager()}},s.lastTime=0,s.globalTapGestureTimer=[],s.timer=0,s.GESTURESNAME=a.getGesturesName(),i["default"]=s},{"./EpubGesturesEvent/Defs":9,"./EpubGesturesEvent/MouseWheelManager":11,"./EpubGesturesEvent/PointerEventsManager":12}],9:[function(e,t,n){function i(){return{stat:!1,time:0,lastTime:0,timere:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0}}}function a(){return{start:i(),end:i(),move:i()}}function r(){return{MOUSE:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove"},TOUCH:{TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove"},MSPOINTER:{POINTERDOWN:"MSPointerDown",POINTERCANCEL:"MSPointerCancel",POINTERLEAVE:"MSPointerLeave",POINTERUP:"MSPointerUp",POINTERMOVE:"MSPointerMove"},POINTER:{POINTERDOWN:"pointerdown",POINTERCANCEL:"pointercancel",POINTERLEAVE:"pointerleave",POINTERUP:"pointerup",POINTERMOVE:"pointermove"},MOUSEWHEEL:"mousewheel",WHEEL:"wheel",DOMMOUSESCROLL:"DOMMouseScroll"}}function o(){return{PINCHGESTURE:"pinchGesture",PRESSGESTURE:"pressGesture",PANGESTURE:"panGesture",TAPGESTURE:"tapGesture",DBLTAPGESTURE:"dblTapGesture",SWIPEGESTURE:"swipeGesture",MOUSEWHEELGESTURE:"mouseWheelGesture"}}function s(){return{x:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},y:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},hypotenuse:0,hypotenuseDiff:0}}function l(){return{type:"",pinchZoomDiff:0,wheel:{isX:!1,isY:!1},x:{point:0,vectorDiff:0,client:0,isVector:!1},y:{point:0,vectorDiff:0,client:0,isVector:!1}}}function u(){return{timerID:0,currentTime:0,deltaX:0,deltaY:0}}Object.defineProperty(n,"__esModule",{value:!0}),n.getEpubEventStatus=i,n.getEpubEventStatusManager=a,n.getEventsType=r,n.getGesturesName=o,n.getMoveDifferer=s,n.getGestureData=l,n.getWheelData=u},{}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){this.element=e,this.config=t,this.enableKeyBoard=!0,this.isMouseenter=!0,this.spreadDraggable&&(this.keyUp=this.keyUpPre.bind(this),this.element.setAttribute("tabindex","1"),this.setEvents())}return Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),e.prototype.setEvents=function(){var e=this;window.addEventListener("keyup",this.keyUp),this.element.addEventListener("mouseenter",function(t){e.isMouseenter=!0}),this.element.addEventListener("mouseleave",function(t){e.isMouseenter=!1})},e.prototype.isEditableElement=function(){var e=document.activeElement;if(null!==e&&"false"!==e.getAttribute("contenteditable")){var t=e.tagName.toLowerCase();if("input"===t||"textarea"===t||"true"===e.getAttribute("contenteditable"))return!0}return!1},e.prototype.keyUpPre=function(e){var t=e.key||e.keyIdentifier;if(this.element===document.activeElement||this.isMouseenter!==!1&&(this.isEditableElement()!==!0||document.hasFocus()!==!0))switch(t){case"ArrowLeft":this.pagePrevious();break;case"ArrowUp":this.pagePrevious();break;case"ArrowRight":this.pageNext();break;case"ArrowDown":this.pageNext();break;case"Left":this.pagePrevious();break;case"Up":this.pagePrevious();break;case"Right":this.pageNext();break;case"Down":this.pageNext()}},e.prototype.pageNext=function(){NIApi.page.openNext()},e.prototype.pagePrevious=function(){NIApi.page.openPrevious()},e}();n.EpubKeyBoardEvent=i},{}],11:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../EpubGesturesEvent/Defs"),r=t("../EpubEvent"),o=0,s=function(){function t(n){this.element=n,this.scrollDelay=400,this.scrollTimer=0,this.simpleScrollTimer=0,this.lastSentWheelTimestamp=0,this.lastHighWheelTimestamp=0,this.previousHighWheelTimestamp=0,this.wheelDirection=0,this.index=o++,this.browserName=e.Param.userAgent.browser.name,this.epubEvent=new r.EpubEvent,this.initWindowScroll();var i="WheelEvent"in window?t.EVENTSTYPE.WHEEL:t.EVENTSTYPE.MOUSEWHEEL;this.element.addEventListener(i,this.mouseWheelHandler.bind(this),!1)}return t.prototype.addListeners=function(e,t){this.epubEvent.addListener(r.EPUB_EVENTS.MOUSE_WHEEL,e),this.epubEvent.addListener(r.EPUB_EVENTS.ELEMENT_SCROLL,t)},t.prototype.removeListeners=function(e,t){this.epubEvent.removeListener(r.EPUB_EVENTS.MOUSE_WHEEL,e),this.epubEvent.removeListener(r.EPUB_EVENTS.ELEMENT_SCROLL,t)},t.prototype.initWindowScroll=function(){var e=this;t.windowScrollInit!==!0&&(t.windowScrollInit=!0,window.addEventListener("scroll",function(n){t.windowScrollStatus=!0,e.dispatchEventsScroll(n),clearTimeout(e.scrollTimer),e.scrollTimer=setTimeout(function(){t.windowScrollStatus=!1},e.scrollDelay)},!0))},t.prototype.dispatchEventsScroll=function(e){clearTimeout(this.simpleScrollTimer),this.epubEvent.fire({type:r.EPUB_EVENTS.ELEMENT_SCROLL,data:e})},t.prototype.mouseWheelHandler=function(e){if(!this.isWheelDeltaTooLow(e))return this.updateHighWheelTimestamp(),this.isWheelDirectionChanged(e)?void this.sendWheelEvent(e):this.isNewWheelSwipe()?void this.sendWheelEvent(e):void(this.isWheelTimestampTooClose()||this.sendWheelEvent(e))},t.prototype.isWheelDeltaTooLow=function(e){var t=110,n=this.getWheelDelta(e),i=0===e.deltaMode;return i&&Math.abs(n)<=t},t.prototype.getWheelDelta=function(t){var n=Math.abs(t.wheelDelta);return this.browserName===e.Param.userAgent.BROWSER.FIREFOX&&(n=t.deltaX,Math.abs(t.deltaY)>=Math.abs(t.deltaX)&&(n=t.deltaY)),n},t.prototype.isNewWheelSwipe=function(){var e=800,t=Date.now()-this.lastSentWheelTimestamp;return t>e},t.prototype.isWheelDirectionChanged=function(e){var t=this.wheelDirection;return this.wheelDirection=this.getWheelDirection(e),this.wheelDirection!==t},t.prototype.getWheelDirection=function(e){return e.wheelDelta>0?1:e.wheelDelta<0?-1:0},t.prototype.updateHighWheelTimestamp=function(){this.previousHighWheelTimestamp=this.lastHighWheelTimestamp,this.lastHighWheelTimestamp=Date.now()},t.prototype.isWheelTimestampTooClose=function(){var e=200,t=this.lastHighWheelTimestamp-this.previousHighWheelTimestamp;return t<e},t.prototype.sendWheelEvent=function(e){this.lastSentWheelTimestamp=Date.now(),this.dispatchEventsWheel(e)},t.prototype.dispatchEventsWheel=function(e){this.epubEvent.fire({type:r.EPUB_EVENTS.MOUSE_WHEEL,data:e})},t}();s.windowScrollInit=!1,s.windowMouseWheelInit=!1,s.windowScrollStatus=!1,s.EVENTSTYPE=a.getEventsType(),s.GESTURESNAME=a.getGesturesName(),i.MouseWheelManager=s},{"../EpubEvent":7,"../EpubGesturesEvent/Defs":9}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("../EpubGesturesEvent/Defs"),a=e("../EpubEvent"),r=function(){function e(e,t){this.epubGesturesEvent=e,this.element=t,this.msPointer="POINTER",this.EVENTSTYPE=i.getEventsType(),this.listeners={},this.touches=[],this.touchesMove=[],this.pointerDown=this._pointerDown.bind(this),this.pointerUp=this._pointerUp.bind(this),this.pointerCancel=this._pointerCancel.bind(this),this.pointerMove=this._pointerMove.bind(this),this.epubEvent=new a.EpubEvent,this.definePointerType()}return e.prototype.definePointerType=function(){navigator.msMaxTouchPoints>0&&(this.msPointer="MSPOINTER"),document.addEventListener(this.EVENTSTYPE.MOUSE.MOUSELEAVE,this.pointerCancel,!1),document.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERMOVE,this.pointerMove,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERDOWN,this.pointerDown,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1)},e.prototype.registeredTouchIndex=function(e,t){for(var n=0,i=t.length;n<i;n++)if(e.pointerId===t[n].pointerId)return n;return-1},e.prototype.unRegisterTouch=function(e,t){var n=this.registeredTouchIndex(e,t);return n!==-1&&(t.splice(n,1),!0)},e.prototype.registerTouch=function(e,t){var n=this.registeredTouchIndex(e,t);return n!==-1?void(t[n]=e):void t.push(e)},e.prototype._pointerDown=function(e){this.registerTouch(e,this.touches),this.epubEvent.fire({type:a.EPUB_EVENTS.TOUCH_POINTERDOWN,data:{currentEvent:e,touches:this.touches,changedTouches:[e]}})},e.prototype._pointerCancel=function(e){for(var t=0,n=this.touches.length;t<n;t++)this.pointerUp(this.touches[t]);for(var t=0,n=this.touchesMove.length;t<n;t++)this.pointerUp(this.touchesMove[t])},e.prototype._pointerUp=function(e){this.unRegisterTouch(e,this.touchesMove),this.unRegisterTouch(e,this.touches)!==!1&&this.epubEvent.fire({type:a.EPUB_EVENTS.TOUCH_POINTERUP,data:{currentEvent:e,touches:this.touches,changedTouches:[e]}})},e.prototype._pointerMove=function(e){0!==this.touches.length&&(this.registerTouch(e,this.touchesMove),this.epubEvent.fire({type:a.EPUB_EVENTS.TOUCH_POINTERMOVE,data:{currentEvent:e,touches:this.touchesMove,changedTouches:[]}}))},e.prototype.addListener=function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=t,this.epubEvent.addListener(e,t))},e.prototype.removeListeners=function(){for(var e in this.listeners)this.epubEvent.removeListener(~~e,this.listeners[e]);document.removeEventListener(this.EVENTSTYPE.MOUSE.MOUSELEAVE,this.pointerCancel,!1),document.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERMOVE,this.pointerMove,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERDOWN,this.pointerDown,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1)},e.prototype.addListenerDown=function(e){this.addListener(a.EPUB_EVENTS.TOUCH_POINTERDOWN,e)},e.prototype.addListenerUp=function(e){this.addListener(a.EPUB_EVENTS.TOUCH_POINTERUP,e)},e.prototype.addListenerMove=function(e){this.addListener(a.EPUB_EVENTS.TOUCH_POINTERMOVE,e)},e.prototype.flush=function(){this.removeListeners()},e}();n.PointerEventsManager=r},{"../EpubEvent":7,"../EpubGesturesEvent/Defs":9}],13:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubManager"),r=t("./EpubDomApi"),o=t("./polyfill/closest");o["default"]();var s;!function(t){var n=function(){function t(){e.EpubDomApi=r["default"],e.Class.EpubManager=a["default"]}return t}();t.EpubMain=n}(s||(s={})),new s.EpubMain},{"./EpubDomApi":6,"./EpubManager":14,"./polyfill/closest":76}],14:[function(t,n,i){var a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(a,r){function o(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i["throw"](e))}catch(t){r(t)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,s)}l((i=i.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,r&&(o=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(r,n[1])).done)return o;switch(r=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(i){n=[6,i],r=0}finally{a=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,r,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return{next:n(0),"throw":n(1),"return":n(2)}};Object.defineProperty(i,"__esModule",{value:!0});var o=t("./EpubConfig"),s=t("./EpubCssManager"),l=t("./EpubNavigationTypeManager"),u=t("./EpubSpreads"),c=t("./EpubStatistics"),p=t("./components/pageControl/Controller"),h=t("./EpubEvent"),d=t("./EpubGesturesEvent/EpubKeyBoardEvent"),m=t("./utils/functions"),f=t("./utils/isScrollable"),g=function(){function t(t,n){this.parent=t,this.viewMain=n,this.epubMode=!0,this.screenSize={width:0,height:0,ratio:0},this.goToPage=function(e,t){void 0===t&&(t=!0),t?this.currentPage=e:this.currentPageNoAnimation=e},this.userInteractions(!1),e.epubEvent=e.epubEvent||new h.EpubEvent,this.epubEvent=e.epubEvent,this.config=new o["default"](this),this.epubStatistics=new c.EpubStatistics(this),this.registerApi(),this.iniListeners()}return Object.defineProperty(t.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigationType",{get:function(){return this.config.navigationType},set:function(e){this.config.navigationType=e,this.epubSpreads.updateSpreads(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transitionTime",{get:function(){return this.config.transitionTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.config.currentPage},set:function(e){this.config.currentPage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPageNoAnimation",{get:function(){return this.config.currentPageNoAnimation},set:function(e){this.config.currentPageNoAnimation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},set:function(e){if(e!==this.config.pagesBySpread){if(this.config.pagesBySpread=e,void 0===this.epubSpreads)return;this.epubSpreads.updateSpreads(0)}},enumerable:!0,configurable:!0}),t.prototype.registerApi=function(){var e=this;NIApi.register("page.openNext",function(){return e.pageNext(),Promise.resolve()}),NIApi.register("page.openPrevious",function(){return e.pagePrevious(),Promise.resolve()}),NIApi.register("page.openFirst",function(){return e.pageFirst(),Promise.resolve()}),NIApi.register("page.openLast",function(){return e.pageLast(),Promise.resolve()}),NIApi.register("page.open",function(t){return e.goToPage(t),Promise.resolve()})},t.prototype.isFocusable=function(){var e,t,n=document.activeElement;return!n||(e=n.readOnly,t=n.getAttribute("contenteditable"),e!==!1&&"true"!==t)},t.prototype.focusOn=function(){this.isFocusable()===!0&&this.epubSpreads.getMainViewElement().focus()},t.prototype.iniListeners=function(){var t=this;this.epubEvent.addListener(h.EPUB_EVENTS.PAGE_CLICK,function(e){t.toggleMenu()}),this.epubEvent.addListener(h.EPUB_EVENTS.PAGE_CHANGE,function(n){void 0!==t.epubSpreads&&(n.data.useAnimationTime===!1?t.epubSpreads.updateSpreads(0):t.epubSpreads.updateSpreads(t.transitionTime),e.Main.pageManager.set(t.currentPage),e.Main.pagesLoaderNew.setCurrentPage(t.currentPage),t.setDocumentPagesAttributes(),t.focusOn(),setTimeout(function(){t.focusOn()},200))}),e.Main.pageManager.onChange(function(e){e=~~e,t.currentPage!==e&&t.goToPage(e)}),this.epubEvent.addListener(h.EPUB_EVENTS.PAGE_ZOOM,function(n){e.Param.zoom=n.data.status;var i=t.viewMain.classList.contains("epub-view_state-zoom-in");e.Param.zoom===!1&&i?t.viewMain.classList.remove("epub-view_state-zoom-in"):e.Param.zoom!==!0||i||t.viewMain.classList.add("epub-view_state-zoom-in"),e.Utils.callEvent(window,"webpub-zoom")}),window.onwheel=function(e){for(var t=e.target,n=t,i=!1;n;){if(f.isScrollable(n,e)===!0){i=!0;break}n=n.parentElement}if(i===!1)return!1},this.preventDocumentScroll()},t.prototype.preventDocumentScroll=function(){var e=this,t=!1,n=0;document.addEventListener("touchend",function(i){var a=document.activeElement.tagName.toLowerCase();if("input"!==a&&"textarea"!==a)return Date.now()-n<100?void i.preventDefault():void(t===!0&&(n=Date.now(),window.scrollTo(0,0),e.epubNavigationTypeManager.forceResize(),i.preventDefault()))},!0),document.addEventListener("touchmove",function(e){var i=document.activeElement.tagName.toLowerCase();"input"!==i&&"textarea"!==i&&(t=0!==window.scrollY||0!==window.scrollX,Date.now()-n<100&&e.preventDefault())},!1)},t.prototype.setDocumentPagesAttributes=function(){var e=this.getCurrentPages();document.documentElement.setAttribute("pages",e.join("-")),document.documentElement.setAttribute("pages-left",e[0].toString()),e[1]?document.documentElement.setAttribute("pages-right",e[1].toString()):document.documentElement.setAttribute("pages-right","")},t.prototype.showMenu=function(t){return t===!1?(e.Main.menuManager.hideMenu(),void e.Main.menuManager.hideTopnav()):void e.Main.menuManager.showTopnav()},t.prototype.toggleMenu=function(){e.Main.toolsEvents&&(1===e.Main.toolsEvents.showToolsInfo?(e.Main.toolsEvents.showTools(!1),this.showMenu(!1)):(e.Main.toolsEvents.showTools(!0),this.showMenu(!0)))},t.prototype.pageChange=function(e){this.goToPage(e)},t.prototype.pageNext=function(){this.currentPage+=this.pagesBySpread},t.prototype.pagePrevious=function(){this.currentPage-=this.pagesBySpread},t.prototype.pageFirst=function(){this.currentPage=1},t.prototype.pageLast=function(){this.currentPage=this.pageQuantity},t.prototype.canChangePage=function(e,t,n){return e!==!0?0:t>0?n<0?0:-1:t<0?n>0?0:1:0},t.prototype.userInteractions=function(e){void 0===e&&(e=!0),document.documentElement.style.cursor=e?"default":"progress",document.body.style.pointerEvents=e?"all":"none"},t.prototype.gotoPageByCoordsDiff=function(e,t){void 0===t&&(t=!0);var n;return n=this.canChangePage(e[this.navigationType].isVector,e[this.navigationType].vectorDiff,e[this.navigationType].pointDiff),n>0?void this.pageNext():n<0?void this.pagePrevious():void(t?this.currentPage=this.currentPage:this.currentPageNoAnimation=this.currentPage)},t.prototype.getPagePosition=function(){console.log(arguments)},t.prototype.getPageCoordX=function(){console.log(arguments)},t.prototype.getFrameCoordX=function(){console.log(arguments)},t.prototype.getFrameCoordY=function(){console.log(arguments)},t.prototype.getDeltaFrameForPage=function(){console.log(arguments)},t.prototype.scrollFrame=function(e){"next"===e||1===e?this.pageNext():"prev"!==e&&e!==-1||this.pagePrevious()},t.prototype.getCurrentPages=function(e){void 0===e&&(e=this.currentPage);var t,n=[],i=0,a=0;if(n=[],i=0,a=0,void 0===this.epubSpreads)return n;for(t=this.epubSpreads.getPagesFromSpreadByPageIndex(e||this.currentPage),a=t.length;i<a;i++)void 0!==t[i]&&n.push(t[i].pageIndex);return n},t.prototype.getPagesOfFrame=function(e){return this.getCurrentPages(e)},t.prototype.getFrameOfPage=function(e){return this.getCurrentPages(e)[0]},t.prototype.setConfig=function(e){this.config.setConfig(e)},t.prototype.updateSpreadsSize=function(){void 0!==this.epubSpreads&&this.epubSpreads.updateSpreadsSize()},t.prototype.switchPageBySpread=function(e){return e>this.pagesBySpreadMax&&(e=this.pagesBySpreadMax),e?void(this.pagesBySpread=e||this.pagesBySpread):void(this.pagesBySpread=this.pagesBySpread%this.pagesBySpreadMax+1)},t.prototype.switchNavigation=function(e){return e?(this.navigationType=e,this.navigationType):"x"===this.navigationType?(this.navigationType="y",this.navigationType):(this.navigationType="x",this.navigationType)},t.prototype.isZoomed=function(){return 0!==this.epubSpreads.getScaleFromCurrentSpread()},t.prototype.zoomByStep=function(e){this.epubSpreads.zoomByStep({x:.5,y:0,step:e,animate:!0})},t.prototype.zoomIn=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:this.defaultPageScaleAt,animate:!0})},t.prototype.zoomOut=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:0,animate:!0})},t.prototype.zoomTo=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!0})},t.prototype.zoomNow=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!1})},t.prototype.init=function(t,n){return a(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return m.resizeHTMLTagElement(),this.setConfig(t),this.epubCssManager=new s.EpubCssManager(this.config),[4,this.epubCssManager.init(n)];case 1:return i.sent(),this.epubNavigationTypeManager=new l["default"](this,this.config,this.viewMain),this.epubSpreads=new u["default"](this,this.config,this.viewMain,this.epubCssManager),this.pageControl=new p.Controller(this),this.epubSpreads.getMainViewElement().setAttribute("tabindex","1"),this.epubKeyBoardEvent=new d.EpubKeyBoardEvent(this.epubSpreads.getMainViewElement(),this.config),this.screenSize=this.epubNavigationTypeManager.screenSize,this.epubNavigationTypeManager.forceResize(),e.Main.pagesLoaderNew.setCurrentPage(this.currentPage),this.userInteractions(!0),[2]}})})},t}();i["default"]=g},{"./EpubConfig":3,"./EpubCssManager":5,"./EpubEvent":7,"./EpubGesturesEvent/EpubKeyBoardEvent":10,"./EpubNavigationTypeManager":15,"./EpubSpreads":55,"./EpubStatistics":57,"./components/pageControl/Controller":63,"./utils/functions":80,"./utils/isScrollable":82}],15:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubEvent"),r=t("./utils/functions"),o=function(){function t(t,n,i){var a=this;this.sizeIDString="",this.timers={resize:0,orientationchange:0},this.parent=t,this.config=n,this.epubEvent=e.epubEvent,this.screenSize=this.parent.screenSize,this.onResize=this.onResize.bind(this),this.pageLayout=e.Main.pageLayoutService.get("pageLayout");var r=e.Main.xmlManager.get("common-configuration","contents","zoom","width"),o=e.Main.xmlManager.get("common-configuration","contents","zoom","height");this.forceSinglePage=r>o,this.pageSize={width:this.pageWidth,height:this.pageHeight,ratio:1.5*this.pageWidth/this.pageHeight},this.updateScreenSize(),this.epubScreenElement=i,window.addEventListener(e.Param.eventResize,this.onResize.bind(this)),window.addEventListener("focus",this.onResize,!1),setTimeout(function(){return a.forceResize()},0),setTimeout(function(){a.localCheckWindowSize()},1e3)}return Object.defineProperty(t.prototype,"timeToRefreshScreenResize",{get:function(){return this.config.timeToRefreshScreenResize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paddinigs",{get:function(){return this.config.paddings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageWidth",{get:function(){return this.config.pageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageHeight",{get:function(){return this.config.pageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"switchLandScapeUsingPageSize",{get:function(){return this.config.switchLandScapeUsingPageSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),t.prototype.needUpdateScreenSize=function(){return this.screenSize.width===this.innerWidth&&this.screenSize.height===this.innerHeight},t.prototype.updateScreenSize=function(){var e=this.needUpdateScreenSize();return this.screenSize.width=this.innerWidth,this.screenSize.height=this.innerHeight,this.screenSize.ratio=this.screenSize.width/this.screenSize.height,e},t.prototype.ratioScreenWidthVsHeight=function(){var e=1,t=["best","auto"].indexOf(this.pageLayout)!==-1,n="double"===this.pageLayout,i=this.screenSize.width>this.screenSize.height;"single"===this.pageLayout?e=1:n?e=2:t===!0&&this.forceSinglePage===!0?e=1:t===!0&&i&&(e=2),this.parent.switchPageBySpread(e)},t.prototype.ratioPageScreen=function(){return"single"===this.pageLayout?void this.parent.switchPageBySpread(1):"double"===this.pageLayout?void this.parent.switchPageBySpread(2):void 0!==this.screenSize.ratio&&void 0!==this.pageSize.ratio&&this.screenSize.ratio>this.pageSize.ratio?void this.parent.switchPageBySpread(2):void this.parent.switchPageBySpread(1)},t.prototype.ratioPageScreenFromApi=function(){this.parent.switchPageBySpread(e.Main.pageManager.pagePerScreen())},t.prototype.onResizeSync=function(){var e;return r.resizeHTMLTagElement(),window.scrollTo(0,0),this.config.paddinigsUpdate(),this.sizeIDString=this.innerHeight+"-"+this.innerWidth,this.updateScreenSize()!==!0||(this.config.pagesBySpreadUseApiPageManager===!0?this.ratioPageScreenFromApi():this.switchLandScapeUsingPageSize===!0?this.ratioPageScreen():this.ratioScreenWidthVsHeight(),this.parent.updateSpreadsSize(),e=r.isWindowLandscape(),e!==this.windowLandscape&&(this.windowLandscape=e,this.epubEvent.fire({type:a.EPUB_EVENTS.SCREEN_ORIENTATION,data:{landscape:e}})),!1)},t.prototype.onResize=function(e){window.scrollTo(0,0),clearTimeout(this.timers[e.type]),this.onResizeSync()!==!1&&(this.timers[e.type]=setTimeout(this.onResize.bind(this,e),this.timeToRefreshScreenResize))},t.prototype.localCheckWindowSize=function(){var e=this,t=this.innerHeight,n=this.innerWidth;this.sizeIDString!==t+"-"+n&&this.forceResize(),window.setTimeout(function(){e.localCheckWindowSize()},500)},t.prototype.forceResize=function(){this.onResize({type:"resize"})},t}();i["default"]=o},{"./EpubEvent":7,"./utils/functions":80}],16:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),t("es6-promise");var a=t("./utils/enums"),r=t("./utils/XHRPromise"),o=t("./utils/XHRPromise"),s=t("./EpubPage/LinksManager"),l=t("./EpubPageEnrichment"),u=t("./utils/functions"),c=t("./EpubEvent"),p='\\<\\?xml version="1.0" encoding="UTF-8" standalone="no"\\?\\>\\n\\<\\!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"\\>',h=function(){function t(n,i,r,o){this.epubPages=n,this.config=i,this.pageIndex=r,this.epubCssManager=o,this.isVisible=!1,this.loadList=[],this._formatType=a.READER_TYPES.EPUB_HTML,this.inCache=!1,this.synchronizedWidthSpread=!1,this.isOnLoad=!1,this._pageContainsCPUElement=!1,this.load_xhrError=function(){this.inCache=!1,this.isOnLoad=!1,this.callCallBackOnload(!1)},this.epubEvent=e.epubEvent,this.pageSizeCoefLinkCallBack=this.pageSizeCoefLinkCallBack.bind(this),void 0===t.pageSizeCoefLink&&(t.pageSizeCoefLink=new Promise(this.pageSizeCoefLinkCallBack)),this.elementContainer=this.element=document.createElement("figure"),this.linksManager=new s["default"](this,i,r,this.element),this.setRootElemAttributes(this.element,r),this.readerPageSrcType===a.READER_TYPES.EPUB_HTML&&(this.epubPageEnrichment=new l["default"](this,this.config,this.elementContainer))}return t.prototype.pageSizeCoefLinkCallBack=function(e){t.pageSizeCoefLinkResolve=e},Object.defineProperty(t.prototype,"coverPageCenter",{get:function(){return this.config.coverPageCenter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"srcHdpi",{set:function(e){this.urlPageHdpi=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"src",{set:function(e){this.inCache!==!0&&(this.urlPage=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onload",{set:function(e){this._onload(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"atSpreadOffset",{set:function(e){this._lastSpreadOffset=this._spreadOffset,this._spreadOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageContainsCPUElement",{get:function(){return this._pageContainsCPUElement},set:function(e){var t="no";e===!0&&(t="yes"),"yes"===t&&this.pageContainsCPUElement===!0||"no"===t&&this.pageContainsCPUElement===!1||(this._pageContainsCPUElement=e,this.updateAttributesIframe(t))},enumerable:!0,configurable:!0}),t.prototype.updateAttributesIframe=function(e){this.zoomableParentElement&&this.zoomableParentElement.setAttribute("contains-iframe",e)},t.prototype.innerHTML=function(e,t){e.innerHTML=t},t.prototype.setPagePosition=function(){if(this.coverPageCenter!==!0){for(var e=this.element.children,t=null,n=0,i=e.length;n<i;n++)if("div"===e[n].tagName.toLowerCase()){t=e[n];break}if(null!==t){var a=window.getComputedStyle(t).width,r=0;r=parseFloat(a),this.pageIndex===this.pageQuantity?this.element.style.width=2*r+"px":1===this.pageIndex&&(this.element.style.width=2*r+"px")}}},t.prototype.makeProgressTagsHidden=function(e){if(e){var t=e.querySelectorAll(".pc.pc1 *");t.forEach(function(e){e.style.display="none"})}},t.prototype.makeProgressTagsVisible=function(e){if(e){var t=200,n=5,i=e.querySelectorAll(".pc.pc1 *");i.forEach(function(e){setTimeout(function(){e.style.display="initial"},t+n),n+=n})}},t.prototype.epubPageEnrichmentStat=function(){if(this.inCache!==!1)return 0===this._spreadOffset?void this.onVisible():void this.onNonVisible()},t.prototype.pathToSvg=function(e,t){var n=new RegExp(p,"gmi");return e=e.replace(/(\/[^\/]+)$/g,"/svg/"),t=t.replace(n,""),t.replace(/svg\//gim,e).trim()},t.prototype.parseImage=function(e){var t=this;u.htmlSecureRemoveChildren(e);var n=new Image;n.src=this.urlPage,e.appendChild(n);var i=new Promise(function(i,a){var r=n.onload=n.onerror=n.onabort=function(){i(n),e.classList.add("epub-image-page-loaded"),null!==n.parentElement&&setTimeout(function(){if(null!==n.parentElement){var i=new Image;i.src=t.urlPageHdpi,i.style.width=n.width+"px",i.style.height=n.height+"px",i.onload=function(){null!==n.parentElement&&e.replaceChild(i,n)},t.onFlush.then(function(){i.src=""})}},400)};n.complete===!0&&r()});return this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded"),n.src=""}),i},t.prototype.parseHtmlImgsload=function(e){return new Promise(function(t,n){var i=e.onload=e.onerror=e.onabort=function(){t(e)};e.complete===!0&&i()})},t.prototype.parseHtml=function(e,t){var n,i=[];this.readerPageSrcType===a.READER_TYPES.PDF_SVG&&(t=this.pathToSvg(this.urlPage,t)),u.htmlSecureRemoveChildren(e);var r=document.createElement("div");if(this.innerHTML(r,t),this.readerPageSrcType===a.READER_TYPES.EPUB_HTML)for(var o=r.querySelectorAll("iframe"),s=function(e,t){l.pageContainsCPUElement=!0;var n=o[e].getAttribute("src");if(null===n)return"continue";o[e].removeAttribute("src");var a=NIApi.common.resolveValues(n.toString()).then(function(t){o[e].setAttribute("data-src",t)});i.push(a)},l=this,c=0,p=o.length;c<p;c++)s(c,p);var h=r.childNodes[0],d=h.querySelectorAll("img");if(e.appendChild(h),(n=e.querySelector("div"))&&(this.readerPageSrcType===a.READER_TYPES.PDF_SVG?n.setAttribute("class","webpub-viewer__epub-container-spread-page-sub epub_content_tag_type-"+a.READER_TYPES[this.readerPageSrcType].toLowerCase()):(n.id="",n.classList.add("webpub-viewer__epub-container-spread-page-sub"),n.classList.add("epub_content_tag_type-"+a.READER_TYPES[this.readerPageSrcType].toLowerCase()))),this.readerPageSrcType===a.READER_TYPES.EPUB_HTML){var m=e.querySelectorAll("[src],[href]");Array.prototype.forEach.call(m,function(e){
if(e.hasAttribute("src")){var t=e.getAttribute("src");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("src",t)})}if(e.hasAttribute("href")){var t=e.getAttribute("href");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("href",t)})}})}for(var f=[],c=0,p=d.length;c<p;c++)f.push(this.parseHtmlImgsload(d[c]));var g=Promise.all(f);g.then(function(){e.classList.add("epub-image-page-loaded")}),this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded")});var v=new Promise(function(t,n){g.then(function(){Promise.all(i).then(function(){t(e)})})});return v},t.prototype.parsePdf=function(e){u.htmlSecureRemoveChildren(e);var t=document.createElement("embed");return t.src=this.urlPage+"#zoom=200",t.width=1536,t.height=2172,t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.pointerEvents="none",e.appendChild(t),Promise.resolve(e)},t.prototype.parseSwf=function(e){u.htmlSecureRemoveChildren(e);var t=document.createElement("embed");return t.src=this.urlPage.replace("pdf","swf"),t.width=1536,t.height=2172,t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.pointerEvents="none",e.appendChild(t),Promise.resolve(e)},t.prototype.setRootElemAttributes=function(e,t){e.classList.add("spread-page-"+t),e.classList.add("webpub-viewer__epub-container-spread-page")},t.prototype.load_loaded=function(e){var t,n=this;return this.inCache=!0,this.isOnLoad=!1,t=this.readerPageSrcType===a.READER_TYPES.PDF_IMG?this.parseImage(this.elementContainer):this.readerPageSrcType===a.READER_TYPES.PDF_PDF?this.parsePdf(this.elementContainer):this.parseHtml(this.elementContainer,e.responseText),t.then(function(){n.epubPageEnrichmentStat(),n.callCallBackOnload(!0),n.linksManager.load().then(function(){n.tryDispatchIsInDom()})}),t},t.prototype.load=function(){var e=this;if(this.inCache===!0)return this.epubPageEnrichmentStat(),Promise.resolve();if(this.isOnLoad===!0)return Promise.resolve();this.isOnLoad=!0;var t=u.getSplitedPromise();return new o["default"](r.Protocol.GET,this.urlPage).init().then(function(n){e.load_loaded(n).then(function(){t.resolve()})})["catch"](this.load_xhrError.bind(this)),t},t.prototype.callCallBackOnload=function(e){for(var t=0,n=this.loadList.length;t<n;t++)this.loadList[t].bind(this)(e);this.loadList=[]},t.prototype._onload=function(e){return this.inCache===!0?void e.bind(this)(!0):void this.loadList.push(e)},t.prototype.tryDispatchIsInDom=function(){if(this.inCache!==!1&&this.synchronizedWidthSpread!==!1&&this.linksManager.isLoaded()!==!1){this.epubEvent.fire({type:c.EPUB_EVENTS.PAGE_IN_DOM,data:{epubPage:this}});var e=t.coef;this.setCoefOfPageSizeToLink(),t.pageSizeCoefLinkResolve&&t.coef&&!e&&t.pageSizeCoefLinkResolve()}},t.prototype.syncElemWithSpread=function(e){var t=this;this.onFlush=u.getSplitedPromise();var n=this.load().then(function(){return t});return this.zoomableParentElement=e,this.synchronizedWidthSpread=!0,this.tryDispatchIsInDom(),{element:this.element,loaded:n}},t.prototype.setCoefOfPageSizeToLink=function(){t.coef||(t.coef=this.element.offsetHeight/this.config.linksSizePageHeight)},t.prototype.onVisible=function(){this.isVisible!==!0&&(this.isVisible=!0,this.readerPageSrcType===a.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.start(),this.linksManager.start())},t.prototype.onNonVisible=function(){this.isVisible!==!1&&(this.isVisible=!1,this.synchronizedWidthSpread=!1,this.readerPageSrcType===a.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.stop(),this.linksManager.stop())},t.prototype.flush=function(){this.onFlush&&this.onFlush.resolve(),this.inCache!==!1&&(this.synchronizedWidthSpread=!1,this.isVisible=!1,this.loadList=[],this.inCache=!1,u.htmlSecureRemoveChildren(this.elementContainer),this.readerPageSrcType===a.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.flush(),this.linksManager.flush())},t}();i["default"]=h},{"./EpubEvent":7,"./EpubPage/LinksManager":18,"./EpubPageEnrichment":44,"./utils/XHRPromise":77,"./utils/enums":79,"./utils/functions":80,"es6-promise":1}],17:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../EpubEvent"),r=t("../EpubPage"),o=t("./shapes/ShapesManager"),s=t("./useracts/UserActs"),l=function(){function t(t,n,i,r,o){this.linksManager=t,this.config=n,this.data=i,this.container=r,this.pageElement=o,this.events=new a.EpubEvent,this.started=!1,this.status=!1,this.epubEvent=e.epubEvent,this.ePubPage=t.epubPage,this.start()}return t.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container-link webpub-viewer__link-clickable"},t.prototype.setShapes=function(){this.shapesManager=new o.ShapesManager(this,this.config,this.data,this.pageElement,this.linksElem,r["default"].coef)},t.prototype.setUserActs=function(){this.userActs=new s.UserActs(this,this.config,this.data.useract,this.linksElem)},t.prototype.start=function(){var e=this;this.status=!0,r["default"].pageSizeCoefLink.then(function(){e.started===!1&&(e.createHtmlElement(),e.setShapes(),e.setUserActs()),e.started=!0,e.container.appendChild(e.linksElem)})},t.prototype.stop=function(){this.status=!1,this.started!==!1&&(this.started=!1,this.shapesManager.stop(),this.userActs.stop())},t.prototype.flush=function(){this.started=!1,this.shapesManager.flush(),this.userActs.flush()},t}();i["default"]=l},{"../EpubEvent":7,"../EpubPage":16,"./shapes/ShapesManager":28,"./useracts/UserActs":43}],18:[function(t,n,i){var a=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Link"),o=t("./../utils/enums"),s=t("../EpubEvent"),l=function(){function t(t,n,i,a){var r=this;this.epubPage=t,this.config=n,this.pageNumber=i,this.container=a,this._src="",this.promise=!1,this.inCache=!1,this.isStarted=!1,this.links=[],this.blinkLink=this.blinkLinkPre.bind(this),this.epubEvent=e.epubEvent,this.linkBoxAspect=this.config.linkBoxAspect,this.epubEvent.addListener(s.EPUB_EVENTS.ADMIN_LINK_CREATE,function(e){e.data.pageNumber===i&&r.loadLink(e.data.linkData)})}return Object.defineProperty(t.prototype,"enableAspLinks",{get:function(){return this.config.enableAspLinks},enumerable:!0,configurable:!0}),t.prototype.blinkLinkPre=function(e){var t=this;this.linksElem.classList.add("epub-links-unreveal"),clearTimeout(this.toggleTimer),this.toggleTimer=setTimeout(function(){t.linksElem.classList.remove("epub-links-unreveal")},0)},t.prototype.initLinksBehaviors=function(){this.linkBoxAspect===o.LinksBehaviors.blink&&this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CLICK,this.blinkLink)},t.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container epub-links_container-behaviour-"+o.LinksBehaviors[this.linkBoxAspect]},t.prototype.removeHtmlElement=function(){void 0!==this.linksElem&&(this.linksElem.innerHTML="")},t.prototype.isEnable=function(){return this.enableAspLinks},t.prototype.loadLink=function(e){for(var t=0,n=e.content.length;t<n;t++){var i=a({},e);i.content=[e.content[t]],this.links.push(new r["default"](this,this.config,i,this.linksElem,this.container))}},t.prototype.loadLinks=function(){this.createHtmlElement();for(var e=0,t=this.data.length;e<t;e++)this.loadLink(this.data[e]);this.initLinksBehaviors()},t.prototype.stopLinks=function(){for(var e=0,t=this.links.length;e<t;e++)this.links[e].stop()},t.prototype.flushLinks=function(){this.epubEvent.removeListener(s.EPUB_EVENTS.PAGE_CLICK,this.blinkLink),this.removeHtmlElement();for(var e=0,t=this.links.length;e<t;e++)this.links[e].flush();this.links=[]},t.prototype.startOnReady=function(){this.isStarted!==!1&&this.inCache!==!1&&(this.loadLinks(),this.container.appendChild(this.linksElem))},t.prototype.load=function(t){var n=this;return void 0===t&&(t=this.pageNumber),this.isEnable()===!1?Promise.resolve():(this.promise=e.Main.pageManager.getLinksPromise(t),this.promise===!0?(this.data=e.Main.pageManager.getRealLinks(t),this.inCache=!0,this.startOnReady(),Promise.resolve()):(this.promise=this.promise,this.promise.then(function(e){n.data=e,n.inCache=!0,n.startOnReady()}),this.promise))},t.prototype.isLoaded=function(){return this.inCache},t.prototype.flush=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.inCache=!1,this.flushLinks())},t.prototype.start=function(){this.isEnable()!==!1&&(this.isStarted=!0,this.startOnReady())},t.prototype.stop=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.stopLinks())},t}();i["default"]=l},{"../EpubEvent":7,"./../utils/enums":79,"./Link":17}],19:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Video"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentTag="audio",t}return i(t,e),t.prototype.setElement=function(){this.element=window.document.createElement("audio"),this.element.className=this.className+"-audio",this.element.setAttribute("controls",""),this.element.src=this.url,this.setPreventGestures(),this.linksElem.appendChild(this.element)},t}(a.Video);r._name="audio",n.Audio=r},{"./Video":29}],20:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=function(e){function t(t,n,i,a,r){var o=e.call(this,t,n,i,a,r)||this;return o.shapesManager=t,o.config=n,o.data=i,o.linksElem=a,o.coef=r,o.setRadius(),o}return i(t,e),t.prototype.setRadius=function(){var t=[],n=this.content.circle;"undefined"!=typeof n&&(t[0]=n.radius,e.prototype.setRadius.call(this,t,"%"))},t}(a.Shape);r._name="circle",n.Circle=r},{"./Shape":27}],21:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=e("./utils/IframeInteractions"),o=("ontouchstart"in window,function(e){function t(t,n,i,a,r,o){var s=e.call(this,t,n,i,a,r)||this;return s.shapesManager=t,s.config=n,s.data=i,s.linksElem=a,s.coef=r,s.pageElement=o,s.url="",s.foreground=!1,s.url=s.content.file.url,s.foreground=s.content.file.foreground||!1,s.setInfoToPage(),s.setElement(),s}return i(t,e),t.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},t.prototype.setElement=function(){this.element=window.document.createElement("iframe"),this.element.style.opacity="0",this.element.style.pointerEvents="none",this.element.className=this.className+"-iframe",this.element.setAttribute("data-foreground",this.foreground?"true":"false"),this.iframeInteractions=new r.IframeInteractions(this,this.config,this.element,this.linksElem,this.foreground)},t.prototype.checkLoaded=function(){this.element.addEventListener("load",this.loaded.bind(this))},t.prototype.loaded=function(){this.element.style.opacity="1";try{this.iFrameContentWindow=this.element.contentWindow,this.setAnimationInitIfNot(),this.foreground===!0&&"object"==typeof this.iFrameContentWindow.AdobeAn?this.iframeInteractions.init(this.iFrameContentWindow):this.foreground===!0&&(this.element.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow))}catch(e){}},t.prototype.setAnimationInitIfNot=function(){var e=this;try{var t=this.iFrameContentWindow.document.body,n=t.getAttribute("onload");t.removeAttribute("onload"),n&&t.addEventListener("load",function(){e.iFrameContentWindow.exportRoot||new e.iFrameContentWindow.Function(n)()})}catch(i){}},t.prototype.start=function(){var t=this;this.setInfoToPage(),this.isVisible!==!1&&(this.timerBeforAppend=setTimeout(function(){t.element.src=t.url,t.linksElem.appendChild(t.element)},850),this.checkLoaded(),e.prototype.start.call(this))},t.prototype.stop=function(){var t=this;clearTimeout(this.timerBeforAppend),this.element.parentElement&&setTimeout(function(){t.linksElem.removeChild(t.element)},300),e.prototype.stop.call(this)},t.prototype.flush=function(){this.iframeInteractions.flush(),e.prototype.flush.call(this)},t}(a.Shape));o._name="iframe",n.Iframe=o},{"./Shape":27,"./utils/IframeInteractions":30}],22:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=function(e){function t(t,n,i,a,r){var o=e.call(this,t,n,i,a,r)||this;return o.shapesManager=t,o.config=n,o.data=i,o.linksElem=a,o.coef=r,o.url="",o.foreground=!1,o.url=o.content.file.url,o.setElement(),o}return i(t,e),t.prototype.setElement=function(){this.linksElem.style.backgroundImage="url('"+this.url+"')"},t}(a.Shape);r._name="image",n.Image=r},{"./Shape":27}],23:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(e){this.mediaElement=e,this.enablePlayButton=!0,this.enableSeekBar=!0,this.enableRemainingTime=!0,this.enableCurrentTime=!0,this.enableVolumeButton=!0,this.enableFullScreenButton=!0,this.displayState=!0,this.toggleControls=this.toggleControls.bind(this),this.showControls=this.showControls.bind(this),this.addDelayUnDisplay=this.addDelayUnDisplay.bind(this),this.playState=this.playState.bind(this),this.onPlay=this.onPlay.bind(this),this.seekState=this.seekState.bind(this),this.timeupdate=this.timeupdate.bind(this),this.volumeState=this.volumeState.bind(this),this.onVolume=this.onVolume.bind(this),this.fullScreenState=this.fullScreenState.bind(this),this.eventsList=[],this.init()}return t.prototype.init=function(){this.initRootElement(),this.enablePlayButton===!0&&this.initPlayButton(),this.enableCurrentTime===!0&&this.initCurrentTime(),this.enableSeekBar===!0&&this.initSeekBar(),this.enableRemainingTime===!0&&this.initRemainingTime(),this.enableVolumeButton===!0&&this.initVolumeButton(),this.enableFullScreenButton===!0&&this.initFullScreenButton()},t.prototype.updateView=function(){this.mediaElement.parentElement&&this.mediaElement.parentElement.appendChild(this.rootElement)},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){this.removeEvents()},t.prototype.initRootElement=function(){this.rootElement=document.createElement("div"),this.initSuperPlayButton(),this.rootElement.classList.add("media_player_custom"),this.itemsElement=document.createElement("div"),this.itemsElement.classList.add("media_player_custom-items"),this.rootElement.appendChild(this.itemsElement),this.addDelayUnDisplay(),this.addEvent(this.mediaElement,"click",this.toggleControls),this.addEvent(this.mediaElement,"touchend",this.toggleControls),this.addEvent(this.mediaElement,"mousemove",this.showControls)},t.prototype.initSuperPlayButton=function(){this.superPlayButton=document.createElement("div"),this.rootElement.appendChild(this.superPlayButton),this.superPlayButton.classList.add("super-play_button-custom"),this.addEvent(this.superPlayButton,"click",this.playState),this.setIcon(this.superPlayButton,"play-bold-v4")},t.prototype.toggleControls=function(e){return e.preventDefault(),this.displayState===!1?void this.showControls(e):void this.hideControls()},t.prototype.showControls=function(e){this.addDelayUnDisplay(),this.rootElement.classList.remove("hide"),this.displayState=!0},t.prototype.hideControls=function(){this.rootElement.classList.add("hide"),this.displayState=!1},t.prototype.addDelayUnDisplay=function(){var e=this;clearTimeout(this.delayDisplayTimer),this.delayDisplayTimer=setTimeout(function(){e.hideControls()},4e3)},t.prototype.initPlayButton=function(){this.playButton=this.createItem(),this.playButton.classList.add("play_button-custom"),this.addEvent(this.playButton,"click",this.playState),this.addEvent(this.mediaElement,"play",this.onPlay),this.addEvent(this.mediaElement,"pause",this.onPlay),this.setIcon(this.playButton,"play-bold-v4"),this.setIcon(this.playButton,"pause")},t.prototype.playState=function(){return this.addDelayUnDisplay(),this.mediaElement.paused?void this.mediaElement.play():void this.mediaElement.pause()},t.prototype.onPlay=function(){return this.mediaElement.paused?(this.playButton.classList.remove("play-enbaled"),void this.superPlayButton.classList.remove("play-enbaled")):(this.playButton.classList.add("play-enbaled"),void this.superPlayButton.classList.add("play-enbaled"))},t.prototype.initCurrentTime=function(){this.currentTimeElement=this.createItem(),this.currentTimeElement.classList.add("current_time-custom"),this.currentTimeElement.classList.add("no-hover")},t.prototype.initSeekBar=function(){this.seekButton=this.createItem(),this.seekButton.classList.add("seek_button-custom"),this.seekButton.classList.add("no-hover"),this.seekButtonRange=document.createElement("input"),this.seekButton.appendChild(this.seekButtonRange),this.seekButtonRange.setAttribute("type","range"),this.seekButtonRange.setAttribute("step","0.1"),this.seekButtonRange.setAttribute("min","0"),this.seekButtonRange.setAttribute("max","100"),this.seekButtonRange.setAttribute("value","0"),this.addEvent(this.seekButtonRange,"touchstart",this.cancelBubble),this.addEvent(this.seekButtonRange,"mousemove",this.cancelBubble),this.seekButtonRange.onchange=this.seekState;try{this.seekButtonRange.oninput=this.seekState}catch(e){console.warn(e)}this.addEvent(this.mediaElement,"timeupdate",this.timeupdate)},t.prototype.initRemainingTime=function(){this.remainingTimeElement=this.createItem(),this.remainingTimeElement.classList.add("remaining_time-custom"),this.remainingTimeElement.classList.add("no-hover")},t.prototype.timeupdate=function(){var e=this.mediaElement.currentTime,t=this.mediaElement.duration-this.mediaElement.currentTime;this.seekButtonRange.value=(e/this.mediaElement.duration*100).toString(),this.onVolume(),this.currentTimeElement&&(this.currentTimeElement.innerHTML=this.getReadableTime(e)),this.remainingTimeElement&&(this.remainingTimeElement.innerHTML="-"+this.getReadableTime(t))},t.prototype.seekState=function(){this.addDelayUnDisplay();var e=parseFloat(this.seekButtonRange.value),t=e/100*this.mediaElement.duration;this.mediaElement.currentTime=t},t.prototype.initVolumeButton=function(){this.volumeButton=this.createItem(),this.volumeButton.classList.add("volume_button-custom"),this.addEvent(this.volumeButton,"click",this.volumeState),this.addEvent(this.mediaElement,"volumechange",this.onVolume),this.onVolume(),this.setIcon(this.volumeButton,"speaker-on"),this.setIcon(this.volumeButton,"speaker-off")},t.prototype.volumeState=function(){return this.addDelayUnDisplay(),0===this.mediaElement.volume||this.mediaElement.muted===!0?(this.mediaElement.muted=!1,void(this.mediaElement.volume=1)):(this.mediaElement.muted=!0,void(this.mediaElement.volume=0))},t.prototype.onVolume=function(){if(this.volumeButton){var e=this.volumeButton.classList.contains("volume-enbaled");return 0===this.mediaElement.volume||this.mediaElement.muted===!0?void(e===!0&&this.volumeButton.classList.remove("volume-enbaled")):void(e===!1&&this.volumeButton.classList.add("volume-enbaled"))}},t.prototype.initFullScreenButton=function(){this.fullscreenButton=this.createItem(),this.fullscreenButton.classList.add("fullscreen_button-custom"),this.addEvent(this.fullscreenButton,"click",this.fullScreenState),this.setIcon(this.fullscreenButton,"fullscreen-v4")},t.prototype.fullScreenState=function(){if(this.mediaElement.requestFullscreen)this.mediaElement.requestFullscreen();else if(this.mediaElement.mozRequestFullScreen)this.mediaElement.mozRequestFullScreen();else if(this.mediaElement.webkitRequestFullscreen)this.mediaElement.webkitRequestFullscreen();else if(this.mediaElement.webkitEnterFullscreen)try{this.mediaElement.webkitEnterFullscreen()}catch(e){}},t.prototype.createItem=function(){var e=document.createElement("div");return e.classList.add("media-item"),this.itemsElement.appendChild(e),e},t.prototype.setIcon=function(t,n){var i=document.createElement("div");e.Utils.svgIcon(i,{icon:n,color:null}),t.innerHTML+=i.innerHTML},t.prototype.getReadableTime=function(e){var t=[],n=parseInt(e.toString(),10),i=Math.floor(n/86400);n-=3600*i*24;var a=Math.floor(n/3600);n-=3600*a;var r=Math.floor(n/60);return n-=60*r,a&&t.push(a),t.push(r),t.push(this.padNumber(n,2)),t.join(":")},t.prototype.padNumber=function(e,t){var n="00"+e;return n.substr(n.length-t)},t.prototype.addEvent=function(e,t,n){this.eventsList.push({element:e,type:t,callBack:n}),e.addEventListener(t,n)},t.prototype.removeEvent=function(e,t,n){for(var i=0;i<this.eventsList.length;i++){var a=this.eventsList[i];if(e===a.element&&t===a.type&&n===a.callBack)return delete this.eventsList[i],this.eventsList.splice(i,1),e.removeEventListener(t,n),void this.removeEvent(e,t,n)}},t.prototype.removeEvents=function(){for(var e=0;e=this.eventsList.length;){var t=this.eventsList[e-1];this.removeEvent(t.element,t.type,t.callBack)}},t.prototype.cancelBubble=function(e){e.cancelBubble=!0},t}();i.MediaPlayer=a},{}],24:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(a.Shape);r._name="rect",n.Rect=r},{"./Shape":27}],25:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=function(e){function t(t,n,i,a,r){var o=e.call(this,t,n,i,a,r)||this;return o.shapesManager=t,o.config=n,o.data=i,o.linksElem=a,o.coef=r,o.setRadius(),o}return i(t,e),t.prototype.setRadius=function(){var t=[],n=this.content.roundrect;"undefined"!=typeof n&&(t[0]=n.radius,t[1]=n.radius,t[2]=n.radius,t[3]=n.radius,e.prototype.setRadius.call(this,t))},t}(a.Shape);r._name="roundrect",n.RoundRect=r},{"./Shape":27}],26:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Shape"),r=function(e){function t(t,n,i,a,r){var o=e.call(this,t,n,i,a,r)||this;return o.shapesManager=t,o.config=n,o.data=i,o.linksElem=a,o.coef=r,o.setRadius(),o}return i(t,e),t.prototype.setRadius=function(){var t=[],n=this.content.roundrectcomplex;"undefined"!=typeof n&&(t[0]=n.tl_radius,t[1]=n.tr_radius,t[2]=n.br_radius,t[3]=n.bl_radius,e.prototype.setRadius.call(this,t))},t}(a.Shape);r._name="roundrectcomplex",n.RoundRectComplex=r},{"./Shape":27}],27:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../../utils/enums"),a=e("../../utils/functions"),r=function(){function e(t,n,a,r,o,s){this.shapesManager=t,this.config=n,this.data=a,this.linksElem=r,this.coef=o,this.pageElement=s,this.className="",this.width=0,this.height=0,this.x=0,this.y=0,this.radius=[],this.status=i.ShapeActivityStatus.INIT,this.orientation="auto",this.isVisible=!1,this.Id=0,this.Id=e.globalID++,this.ePubPage=t.ePubPage,this.content=this.getDataContent(),this.className="epub-link-type_"+this.data.type,this.width=this.content.width,this.height=this.content.height,this.x=this.content.x,this.y=this.content.y,this.linkBlinkDuration=this.config.linkBlinkDuration,this.linkBoxAspect=this.config.linkBoxAspect,this.orientation=(this.data.orientation||this.orientation).toLowerCase(),this.setSizes(),this.initLinksBehaviors()}return e.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms"),this.linksElem.style.webkitAnimationDuration=e+t,this.linksElem.style.animationDuration=e+t},e.prototype.initLinksBehaviors=function(){this.linkBoxAspect===i.LinksBehaviors["static"]&&this.linksElem.classList.add("webpub-viewer__link--focused")},e.prototype.setRadius=function(e,t){void 0===t&&(t="px"),0!==e.length&&(this.linksElem.style.webkitBorderRadius=e.join(t+" ")+t,this.linksElem.style.borderRadius=e.join(t+" ")+t)},e.prototype.setSizes=function(){var e=[this.coef,0,0,this.coef,this.x*this.coef,this.y*this.coef];this.linksElem.style.width=this.width+"px",this.linksElem.style.height=this.height+"px",a.styleTransform(this.linksElem,"matrix("+e.join(",")+")"),this.linksElem.classList.add(this.className)},e.prototype.getDataContent=function(){return this.data.content[0]},e.prototype.display=function(e){if(e===!0&&this.isVisible!==!0)return this.isVisible=!0,this.linksElem.classList.add("epub-link-visible"),void this.start();if(e===!0);else if(e===!1&&this.isVisible!==!1)return this.isVisible=!1,this.linksElem.classList.remove("epub-link-visible"),void this.stop()},e.prototype.start=function(){this.status=i.ShapeActivityStatus.START},e.prototype.stop=function(){this.status=i.ShapeActivityStatus.STOP},e.prototype.flush=function(){this.status=i.ShapeActivityStatus.FLUSH},e}();r._name="shape",r.globalID=0,n.Shape=r},{"../../utils/functions":80,"./../../utils/enums":79}],28:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./../../utils/enums"),r=t("../../utils/functions"),o=t("./Rect"),s=t("./RoundRect"),l=t("./RoundRectComplex"),u=t("./Circle"),c=t("./Iframe"),p=t("./Video"),h=t("./Audio"),d=t("./Image"),m=t("../../EpubEvent"),f={Rect:o.Rect,RoundRect:s.RoundRect,RoundRectComplex:l.RoundRectComplex,Circle:u.Circle,Iframe:c.Iframe,Video:p.Video,Audio:h.Audio,Image:d.Image},g=function(){function t(t,n,i,a,r,o){this.link=t,this.config=n,this.data=i,this.pageElement=a,this.linksElem=r,this.coef=o,this.shapes=[],this.epubEvent=e.epubEvent,this.ePubPage=t.ePubPage,this.setShapes(),this.startShapes(),this.setEventOrientations()}return t.prototype.setShapes=function(){for(var e in f)f[e]._name===this.data.type&&this.shapes.push(new f[e](this,this.config,this.data,this.linksElem,this.coef,this.pageElement));0===this.shapes.length&&console.warn("Shape type not supported :"+this.data.type,this.data)},t.prototype.startShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status!==a.ShapeActivityStatus.START&&this.shapes[e].start()},t.prototype.stopShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status===a.ShapeActivityStatus.START&&this.shapes[e].stop()},t.prototype.setEventOrientations=function(){var e=this;this.epubEvent.addListener(m.EPUB_EVENTS.SCREEN_ORIENTATION,function(t){e.setOrientations(t.data.landscape)}),this.setOrientations(r.isWindowLandscape())},t.prototype.setOrientations=function(e){for(var t=0,n=this.shapes.length;t<n;t++)this.setOrientation(e,this.shapes[t])},t.prototype.setOrientation=function(e,t){return"auto"===t.orientation?void t.display(!0):"landscape"===t.orientation&&e===!0||"portrait"===t.orientation&&e===!1?void t.display(!0):void t.display(!1)},t.prototype.flushShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].flush()},t.prototype.start=function(){this.startShapes()},t.prototype.stop=function(){this.stopShapes()},t.prototype.flush=function(){this.flushShapes()},t}();g._name="shapes",i.ShapesManager=g},{"../../EpubEvent":7,"../../utils/functions":80,"./../../utils/enums":79,"./Audio":19,"./Circle":20,"./Iframe":21,"./Image":22,"./Rect":24,"./RoundRect":25,"./RoundRectComplex":26,"./Video":29}],29:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../../utils/enums"),o=t("./Shape"),s=t("./../../EpubGesturesEvent"),l=t("./MediaPlayer"),u=function(t){function n(n,i,a,r,o,s){var l=t.call(this,n,i,a,r,o)||this;return l.shapesManager=n,l.config=i,l.data=a,l.linksElem=r,l.coef=o,l.pageElement=s,l.url="",l.contentTag="video",l._isPlaying=!1,l.enableDefaultControls=!1,l.userAgent=e.Param.userAgent,l.url=l.content[l.contentTag].url,l.setInfoToPage(),l.setElement(),l}return a(n,t),n.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},n.prototype.setElement=function(){var t=window.document.createElement("source");this.element=window.document.createElement("video"),this.element.className=this.className+"-video",this.enableDefaultControls?this.element.setAttribute("controls",""):this.mediaPlayer=new l.MediaPlayer(this.element),this.element.setAttribute("controlsList","nodownload"),this.userAgent.os.name===e.Param.userAgent.OS.IOS&&this.content.video.autoplay&&this.element.setAttribute("muted",""),t.src=this.url,this.element.appendChild(t),this.setPreventGestures(),this.linksElem.appendChild(this.element),this.mediaPlayer&&this.mediaPlayer.updateView()},n.prototype.setPreventGestures=function(){this.element.onvolumechange=this.makeDefaultPreventGesture.bind(this),this.element.onseeking=this.element.onvolumechange,this.element.onplay=this.onplay.bind(this),this.element.onpause=this.onpause.bind(this)},n.prototype.makeDefaultPreventGesture=function(){s["default"].prototype.preventAllGesture()},n.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms")},n.prototype.initLinksBehaviors=function(){},n.prototype.setRadius=function(e,t){void 0===t&&(t="px")},n.prototype.setSizes=function(){this.linksElem.style.width=Math.round(this.width*this.coef)+"px",this.linksElem.style.height=Math.round(this.height*this.coef)+"px",this.linksElem.style.left=Math.round(this.x*this.coef)+"px",this.linksElem.style.top=Math.round(this.y*this.coef)+"px",this.linksElem.classList.add(this.className)},n.prototype.onplay=function(){this.makeDefaultPreventGesture(),this._isPlaying=!0,this.status!==r.ShapeActivityStatus.STOP&&this.status!==r.ShapeActivityStatus.FLUSH||this.element.pause()},n.prototype.onpause=function(){this.makeDefaultPreventGesture(),this._isPlaying=!1},n.prototype.start=function(){var e=this;this.isVisible!==!1&&(t.prototype.start.call(this),this.setInfoToPage(),this.content.video.autoplay&&this.element.paused&&this._isPlaying===!1&&(this.playPromise=this.element.play(),"object"==typeof this.playPromise&&this.playPromise.then&&this.playPromise.then(function(){})["catch"](function(){var t=e.element.play();t["catch"](function(){});
})))},n.prototype.stop=function(){this.mediaPlayer&&this.mediaPlayer.stop(),this.element.paused===!1&&this._isPlaying===!0&&this.element.pause(),t.prototype.stop.call(this)},n.prototype.flush=function(){this.mediaPlayer&&this.mediaPlayer.flush(),t.prototype.flush.call(this)},n}(o.Shape);u._name="video",i.Video=u},{"./../../EpubGesturesEvent":8,"./../../utils/enums":79,"./MediaPlayer":23,"./Shape":27}],30:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../EpubEvent"),r=t("../../../utils/functions"),o="ontouchstart"in window,s=400,l=function(){function t(t,n,i,a,o){this.parent=t,this.config=n,this.element=i,this.linksElem=a,this.foreground=o,this.supportCreateMouseEvent=0,this.eventsListe=["mousemove","mousedown","mouseup","mouseover","mouseout"],this.eventsListeTouch=["touchmove","touchstart","touchend"],this.epubEvent=e.epubEvent,this.removableListeners=[];var s=r.getSplitedPromise();this.waitAction=s,s.resolve()}return t.prototype.init=function(e){try{document.createEvent("MouseEvents"),this.preventZoomInteraction=!1,this.supportCreateMouseEvent=1}catch(t){if("MouseEvent"in window==!1)return this.supportCreateMouseEvent=2,this.element.style.pointerEvents="all",this.linksElem.style.pointerEvents="none",void(this.preventZoomInteraction=!0)}this.iFrameContentWindow=e,this.simulateInteractions()},Object.defineProperty(t.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),t.prototype.createMouseEvent=function(e,t){var n,i=null,a=e.type;return"mouseover"!==a&&"mouseout"!==a||(i=t),1===this.supportCreateMouseEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(a,!0,!0,this.iFrameContentWindow,0,e.offsetX,e.offsetY,e.offsetX,e.offsetY,!1,!1,!1,!1,0,i)):n=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:this.iFrameContentWindow,screenX:e.offsetX,screenY:e.offsetY,clientX:e.offsetX,clientY:e.offsetY}),n},t.prototype.getCoordsTouches=function(e){var t=e.touches[0]||e;return this.getCoords(t)},t.prototype.getCoords=function(e){var t=e.currentTarget||e.target,n=t.getBoundingClientRect(),i=t.offsetWidth/n.width;return[(e.pageX-n.left)*i,(e.pageY-n.top)*i]},t.prototype.simulateEvt=function(e){var t=this;e.preventDefault();var n,i=this.canvasElement,l=e.type,u=0,c=0;switch(l){case"touchmove":l="mousemove";break;case"touchend":l="mouseup";break;case"touchstart":l="mousedown"}var p;if(o&&void 0!==e.touches?(p=this.getCoordsTouches(e),c=p[0],u=p[1]):(c=e.offsetX,u=e.offsetY,c||u||(p=this.getCoords(e),c=p[0],u=p[1])),n=this.createMouseEvent({type:l,offsetX:c,offsetY:u},i),"mouseup"===l){var h=r.getSplitedPromise();this.waitAction=h.promise;var d=setTimeout(function(){h.resolve(),t.epubEvent.removeListener(a.EPUB_EVENTS.PAGE_CLICK,m)},s),m=function(){clearTimeout(d),t.epubEvent.removeListener(a.EPUB_EVENTS.PAGE_CLICK,m),i.dispatchEvent(n),n=t.createMouseEvent({type:"click",offsetX:c,offsetY:u},i),i.dispatchEvent(n),h.resolve()};return void this.epubEvent.addListener(a.EPUB_EVENTS.PAGE_CLICK,m)}i.dispatchEvent(n)},t.prototype.simulateInteractions=function(){var e=this;if(this.canvasElement=this.iFrameContentWindow.document.querySelector("canvas"),this.canvasElement){this.linksElem.style.pointerEvents="all";var t=this.eventsListe;o&&(t=this.eventsListeTouch),t.forEach(function(t){e.removableListeners.push({type:t,action:function(t){e.waitAction.then(function(){e.simulateEvt(t)})}})}),this.removableListeners.forEach(function(t){e.linksElem.addEventListener(t.type,t.action)})}},t.prototype.removeEvents=function(){var e=this;this.removableListeners.forEach(function(t){e.linksElem.removeEventListener(t.type,t.action)}),this.removableListeners=[]},t.prototype.setPreventZoomInteraction=function(e){if(o&&this.preventZoomInteraction!==!1){var t=e.document;t.addEventListener("touchmove",function(e){var t=e;1!==t.scale&&e.preventDefault()},!1);var n=0;t.addEventListener("touchend",function(e){var t=Date.now();t-n<=300&&(e.preventDefault(),e.cancelBubble=!0,e.stopPropagation()),n=t},!0)}},t.prototype.flush=function(){this.removeEvents()},t}();i.IframeInteractions=l},{"../../../EpubEvent":7,"../../../utils/functions":80}],31:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GotoPage"),r=e("../../EpubEvent"),o=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._static=t,n}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openFirst()})}}}),this.executedAction(arguments),!1},t}(a.GotoPage);o._name="firstPage",n.FirstPage=o},{"../../EpubEvent":7,"./GotoPage":32}],32:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./UserAct"),o=t("../../EpubEvent"),s=function(t){function n(e,i,a){var r=t.call(this,e,i,a)||this;return r.data=e,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=n,r.init(),r}return a(n,t),n.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.page.open(parseInt(e.param||0))})}}}),this.executedAction(arguments),!1},n.prototype.setTooltip=function(){var n=this.data.param;if(void 0===n)return void t.prototype.setTooltip.call(this);""===n&&(n="1");var i=e.Main.xmlManager.get("locale","tooltip_"+this.data.type),a=parseInt(n,10),r=e.Main.xmlManager.get("common-configuration","config","shift"),o=a-r;i=i.concat(" ",o.toString()),t.prototype.setTooltip.call(this,i)},n}(r.UserAct);s._name="gotoPage",i.GotoPage=s},{"../../EpubEvent":7,"./UserAct":42}],33:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./UserAct"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.exec=function(e,t){var n=this;return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)return"fwd"===e.param?void n.historyFwd():void n.historyBack()})}}}),this.executedAction(arguments),!1},t.prototype.historyBack=function(){window.history.back()},t.prototype.historyFwd=function(){window.history.forward()},t}(a.UserAct);o._name="history",n.History=o},{"../../EpubEvent":7,"./UserAct":42}],34:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./UserAct"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.exec=function(e,t){var n=this;return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)try{new Function("linkData","linkElement",e.param)(e,n.linksElem)}catch(t){console.warn(t)}})}}}),this.executedAction(arguments),!1},t}(a.UserAct);o._name="javascript",n.JavaScriptCall=o},{"../../EpubEvent":7,"./UserAct":42}],35:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GotoPage"),r=e("../../EpubEvent"),o=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._static=t,n}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openLast()})}}}),this.executedAction(arguments),!1},t}(a.GotoPage);o._name="lastPage",n.LastPage=o},{"../../EpubEvent":7,"./GotoPage":32}],36:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./UserAct"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t}(a.UserAct);o._name="lightbox",n.LightBox=o},{"../../EpubEvent":7,"./UserAct":42}],37:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./UserAct"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.mailTo=function(e){var t=e.trim(),n="mailto:",i=t.match(/^mailto:|^mailto :/gi);null!==i&&0!==i.length&&(n=""),window.location.href=n+t},t.prototype.exec=function(e,t){var n=this;return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&n.mailTo(e.param)})}}}),this.executedAction(arguments),!1},t}(a.UserAct);o._name="mailto",n.MailTo=o},{"../../EpubEvent":7,"./UserAct":42}],38:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GotoPage"),r=e("../../EpubEvent"),o=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._static=t,n}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openNext()})}}}),this.executedAction(arguments),!1},t}(a.GotoPage);o._name="nextPage",n.NextPage=o},{"../../EpubEvent":7,"./GotoPage":32}],39:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./UserAct"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.exec=function(e,t){var n=this;return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&(NIApi.navigator.openUrl(e.param),n.successAction(e))})}}}),this.executedAction(arguments),!1},t}(a.UserAct);o._name="url",n.OpenUrl=o},{"../../EpubEvent":7,"./UserAct":42}],40:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./LightBox"),r=e("../../EpubEvent"),o=function(e){function t(n,i,a){var r=e.call(this,n,i,a)||this;return r.data=n,r.linksElem=i,r.index=a,r.pointerEvents="all",r.pointerCursor="pointer",r._static=t,r.init(),r}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t}(a.LightBox);o._name="popup",n.PopUp=o},{"../../EpubEvent":7,"./LightBox":36}],41:[function(e,t,n){var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./GotoPage"),r=e("../../EpubEvent"),o=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.pointerEvents="all",n.pointerCursor="pointer",n._static=t,n}return i(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:r.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openPrevious()})}}}),this.executedAction(arguments),!1},t}(a.GotoPage);o._name="prevPage",n.PrevPage=o},{"../../EpubEvent":7,"./GotoPage":32}],42:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../EpubDomApi"),r=t("../../EpubEvent"),o=function(){function t(n,i,a){this.data=n,this.linksElem=i,this.index=a,this.pointerEvents="none",this.pointerCursor="auto",this._static=t,this.overrideOtherActions=!0,this.epubEvent=e.epubEvent}return t.prototype.init=function(){this.defineAction(),this.setPointers(),this.setTooltip()},t.prototype.defineAction=function(){0===this.index?this.setActionDefault():this.setAction()},t.prototype.setTooltip=function(t){void 0===t&&(t=""),"string"==typeof this.data.textField&&""!==this.data.textField.trim()&&(t=this.data.textField),""===t&&(t=e.Main.xmlManager.get("locale","tooltip_"+this.data.type)),this.linksElem.setAttribute("data-tooltip",t),e.Main.tooltipManager.register(this.linksElem)},t.prototype.setPointers=function(){this.linksElem.style.pointerEvents=this.pointerEvents,this.linksElem.style.cursor=this.pointerCursor},t.prototype.exec=function(e,t){return a["default"](this._static._name,[t,e.param,e]),this.executedAction(arguments),!1},t.prototype.executedAction=function(e){console.log("From LinksManager this action was exectuted",e)},t.prototype.setActionDefault=function(){var e=this.exec.bind(this,this.data,this.linksElem);this.linksElem.onclick=e,this.linksElem.ontouchend=e},t.prototype.setAction=function(){},t.prototype.successAction=function(e){this.epubEvent.fire({type:r.EPUB_EVENTS.ACTION_LINK_SUCCESS,data:{userAct:e}})},t}();o._name="userAct",i.UserAct=o},{"../../EpubDomApi":6,"../../EpubEvent":7}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./MailTo"),a=e("./OpenUrl"),r=e("./GotoPage"),o=e("./PrevPage"),s=e("./NextPage"),l=e("./PopUp"),u=e("./LightBox"),c=e("./LastPage"),p=e("./FirstPage"),h=e("./JavaScriptCall"),d=e("./History"),m={MailTo:i.MailTo,OpenUrl:a.OpenUrl,GotoPage:r.GotoPage,PrevPage:o.PrevPage,NextPage:s.NextPage,LastPage:c.LastPage,FirstPage:p.FirstPage,PopUp:l.PopUp,LightBox:u.LightBox,JavaScriptCall:h.JavaScriptCall,History:d.History},f=function(){function e(e,t,n,i){this.link=e,this.config=t,this.data=n,this.linksElem=i,this.userActs=[],this.setUserActs()}return e.prototype.makeActionFromUserAct=function(e,t){var n=[];for(var i in m)m[i]._name===e.type&&n.push(new m[i](e,this.linksElem,t));return n},e.prototype.setUserActs=function(){for(var e,t=0,n=this.data.length;t<n;t++)e=this.makeActionFromUserAct(this.data[t],t),0===e.length&&console.warn("useract type not supported :"+this.data[t].type,this.data[t]),this.userActs=this.userActs.concat(e)},e.prototype.stop=function(){},e.prototype.flush=function(){},e}();f._name="userActs",n.UserActs=f},{"./FirstPage":31,"./GotoPage":32,"./History":33,"./JavaScriptCall":34,"./LastPage":35,"./LightBox":36,"./MailTo":37,"./NextPage":38,"./OpenUrl":39,"./PopUp":40,"./PrevPage":41}],44:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./EpubGesturesEvent"),a=e("./EpubPageEnrichment/IFrames"),r=e("./EpubPageEnrichment/Medias"),o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",s=0,l=function(){function e(e,t,n){this.epubPage=e,this.config=t,this.element=n,this.eventListeners=[],this.enableRegisterInteractiveHandlers=!1,this.started=!1,this.epubAnimationsHistory=[],this.epubPageEnrichmentID=s++}return e.getActionHistoryTemplate=function(){return{func:null,args:[]}},e.prototype.start=function(){this.started=!0,this.startGifs();var e=this.element.childNodes[0],t=e.getAttribute("data-onload");return null!==t&&t.indexOf("RegisterInteractiveHandlers")===-1?void(this.enableRegisterInteractiveHandlers=!1):(this.enableRegisterInteractiveHandlers=!0,void this.registerInteractiveHandlers())},e.prototype.stop=function(){this.started!==!1&&(this.started=!1,this.stopGifs(),this.enableRegisterInteractiveHandlers!==!1&&(this.stopMedias(),this.removeEventListeners(),this.reloadActionHistory(),this.stopIFrames()))},e.prototype.flush=function(){this.stop(),this.gifs=null},e.prototype.makeDefaultPreventGesture=function(){i["default"].prototype.preventAllGesture()},e.prototype.evalActions=function(e,t){new Function("_self","selfContainerID","with(_self){ "+e+" }")(this,t)},e.prototype.removeEventListeners=function(){for(var e=0,t=this.eventListeners.length;e<t;e++)this.eventListeners[e].element.removeEventListener(this.eventListeners[e].type,this.eventListeners[e].func,this.eventListeners[e].useCapture);this.eventListeners=[]},e.prototype.addToEventListeners=function(e,t,n,i){void 0===i&&(i=!1),e.addEventListener(n,t,i),this.eventListeners.push({element:e,type:n,func:t,useCapture:i})},e.prototype.reloadActionHistory=function(){for(var e=this.epubAnimationsHistory.length;e--;)this.epubAnimationsHistory[e].func(this.epubAnimationsHistory[e].args[0],this.epubAnimationsHistory[e].args[1]);this.epubAnimationsHistory=[]},e.prototype.registerInteractiveHandlers=function(){this.registerButtonEventHandlers(),this.processAnimations(),this.processMediaGesture(),this.processIFrames()},e.prototype.processMediaGesture=function(){this.medias=this.element.querySelectorAll("video,audio"),0!==this.medias.length&&(this.mediasObject=new r.Medias(this.medias,this.config),this.mediasObject.start())},e.prototype.processIFrames=function(){this.iFrames=this.element.querySelectorAll("iframe"),0!==this.iFrames.length&&(this.iFramesObject=new a.IFrames(this.iFrames,this.config),this.iFramesObject.start())},e.prototype.startGifs=function(){this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var e=0,t=this.gifs.length;e<t;e++){var n=this.gifs[e];null===n.getAttribute("data-src")&&n.setAttribute("data-src",n.getAttribute("src")),n.src=o,function(e){setTimeout(function(){e.classList.add("gif-visible"),e.src=e.getAttribute("data-src")},0)}(n)}},e.prototype.stopGifs=function(){this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var e=0,t=this.gifs.length;e<t;e++){var n=this.gifs[e];null===n.getAttribute("data-src")&&n.setAttribute("data-src",n.getAttribute("src")),n.src=o}},e.prototype.stopIFrames=function(){this.iFramesObject&&this.iFramesObject.stop()},e.prototype.stopMedias=function(){this.mediasObject&&this.mediasObject.stop()},e.prototype.processMedia=function(){for(var e,t,n,i=this.element.querySelectorAll("._idGenMedia"),a=0,r=i.length;a<r;a++)if(e=i[a].getAttribute("data-mediaOnPageLoadActions")){t=i[a].querySelectorAll("video,audio");for(var o=0,s=t.length;o<s;o++)t[o].paused&&(n=t[o],this.evalActions(e,n))}},e.prototype.processAnimations=function(){var e=this.element.querySelectorAll("._idGenAnimation");e.length>0&&(this.epubPage.pageContainsCPUElement=!0);for(var t,n,i,a=0;a<e.length;a++)t=e[a].getAttribute("data-animationOnPageLoadActions"),t&&(n=e[a],this.evalActions(t,n)),i=e[a].className,i.indexOf("_idGenCurrentState")!=-1&&(t=e[a].getAttribute("data-animationOnStateLoadActions"),t&&(n=e[a],this.evalActions(t,n))),t=e[a].getAttribute("data-animationOnSelfClickActions"),t&&(this.addToEventListeners(e[a],this.onTouchEndForAnimations.bind(this,e[a]),"touchend",!1),this.addToEventListeners(e[a],this.onMouseUpForAnimations.bind(this,e[a]),"mouseup",!1)),t=e[a].getAttribute("data-animationOnSelfRolloverActions"),t&&this.addToEventListeners(e[a],this.onMouseOverForAnimations.bind(this,e[a]),"mouseover",!1);this.addToEventListeners(this.element,this.onPageTouchEndForAnimations.bind(this,this.element),"touchend",!1),this.addToEventListeners(this.element,this.onPageMouseUpForAnimations.bind(this,this.element),"mouseup",!1)},e.prototype.onMediaChange=function(e,t){this.makeDefaultPreventGesture()},e.prototype.onPageTouchEndForAnimations=function(e,t){for(var n,i,a=this.element.querySelectorAll("._idGenAnimation"),r=0;r<a.length;r++)n=a[r].getAttribute("data-animationOnPageClickActions"),n&&(i=a[r],this.evalActions(n,i))},e.prototype.onPageMouseUpForAnimations=function(e,t){var n="ontouchstart"in document.documentElement;if(!n)for(var i,a,r=this.element.querySelectorAll("._idGenAnimation"),o=0;o<r.length;o++)i=r[o].getAttribute("data-animationOnPageClickActions"),i&&(a=r[o],this.evalActions(i,a))},e.prototype.onTouchEndForAnimations=function(e,t){for(var n,i,a="."+e.getAttribute("data-animationObjectType"),r=this.element.querySelectorAll(a),o=0;o<r.length;o++)n=r[o].getAttribute("data-animationOnSelfClickActions"),n&&(i=r[o],this.evalActions(n,i))},e.prototype.onMouseUpForAnimations=function(e,t){var n="ontouchstart"in document.documentElement;if(!n)for(var i,a,r="."+e.getAttribute("data-animationObjectType"),o=this.element.querySelectorAll(r),s=0;s<o.length;s++)i=o[s].getAttribute("data-animationOnSelfClickActions"),i&&(a=o[s],this.evalActions(i,a))},e.prototype.onMouseOverForAnimations=function(e,t){var n="ontouchstart"in document.documentElement;if(!n){var i=e.getAttribute("data-idGenAnimationClass"),a=e.className;if(null===i||a.indexOf(i)==-1){console.log(a);for(var r,o,s="."+e.getAttribute("data-animationObjectType"),l=this.element.querySelectorAll(s),u=0;u<l.length;u++)r=l[u].getAttribute("data-animationOnSelfRolloverActions"),r&&(o=l[u],this.evalActions(r,o))}}},e.prototype.registerButtonEventHandlers=function(){for(var e=this.element.querySelectorAll("._idGenButton"),t=0;t<e.length;t++)this.addToEventListeners(e[t],this.onTouchStart.bind(this,e[t]),"touchstart",!1),this.addToEventListeners(e[t],this.onTouchEnd.bind(this,e[t]),"touchend",!1),this.addToEventListeners(e[t],this.onMouseDown.bind(this,e[t]),"mousedown",!1),this.addToEventListeners(e[t],this.onMouseUp.bind(this,e[t]),"mouseup",!1),this.addToEventListeners(e[t],this.onMouseOver.bind(this,e[t]),"mouseover",!1),this.addToEventListeners(e[t],this.onMouseOut.bind(this,e[t]),"mouseout",!1)},e.prototype.hasAppearance=function(e,t){for(var n,i=e.children,a=0;a<i.length;a++)if(n=i[a].className,n.indexOf(t)!=-1)return!0;return!1},e.prototype.isDescendantOf=function(e,t){for(var n=e;n;){if(n==t)return!0;n=n.parentNode}return!1},e.prototype.addClass=function(t,n){if(null!==n&&t.classList.contains(n)!==!0){var i=e.getActionHistoryTemplate();i.func=this.removeClass.bind(this),i.args.push(t),i.args.push(n),this.epubAnimationsHistory.push(i),t.classList.add(n)}},e.prototype.removeClass=function(t,n){if(null!==n&&t.classList.contains(n)!==!1){var i=e.getActionHistoryTemplate();i.func=this.addClass.bind(this),i.args.push(t),i.args.push(n),this.epubAnimationsHistory.push(i),t.classList.remove(n)}},e.prototype.onMouseDown=function(e,t){var n="ontouchstart"in document.documentElement;if(!n){this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var i=e.getAttribute("data-clickactions");i&&this.evalActions(i,null)}},e.prototype.onMouseUp=function(e,t){var n="ontouchstart"in document.documentElement;if(!n){this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-releaseactions");i&&this.evalActions(i,null)}},e.prototype.onMouseOver=function(e,t){var n="ontouchstart"in document.documentElement;if(!(n||t.relatedTarget&&this.isDescendantOf(t.relatedTarget,e))){this.hasAppearance(e,"_idGen-Appearance-Rollover")&&this.addClass(e,"_idGenStateHover");var i=e.getAttribute("data-rolloveractions");i&&this.evalActions(i,null)}},e.prototype.onMouseOut=function(e,t){var n="ontouchstart"in document.documentElement;if(!(n||t.relatedTarget&&this.isDescendantOf(t.relatedTarget,e))){this.removeClass(e,"_idGenStateHover"),this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-rolloffactions");i&&this.evalActions(i,null)}},e.prototype.onTouchStart=function(e,t){this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var n=e.getAttribute("data-clickactions");n&&this.evalActions(n,null)},e.prototype.onTouchEnd=function(e,t){this.removeClass(e,"_idGenStateClick");var n=e.getAttribute("data-releaseactions");n&&this.evalActions(n,null)},e.prototype.onHide=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.addClass(t,"_idGenStateHide"))},e.prototype.onShow=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.removeClass(t,"_idGenStateHide"))},e.prototype.handleMSOStateParentOfObject=function(e){for(var t,n,i=e,a=i.parentNode;null!==a&&!t;)n=a.className,n&&n.indexOf("_idGenMSO")!=-1?t=!0:i=a,a=i.parentNode;if(t)for(var r=i,o=a.children,s=0,l=void 0;l=o[s];s++)if(n=l.className,n.indexOf("_idGenCurrentState")!=-1)return this.handleMediaInMSOState(l),this.removeClass(l,"_idGenCurrentState"),this.addClass(l,"_idGenStateHide"),this.removeClass(r,"_idGenStateHide"),void this.addClass(r,"_idGenCurrentState")},e.prototype.goToDestination=function(e){if(e=e.trim(),0===e.indexOf("http"))return void webpublicationNamespace.EpubDomApi("url",[null,e]);if(0===e.indexOf("javascript")||0===e.indexOf("js:")||e.indexOf("js :"))return void webpublicationNamespace.EpubDomApi("javascript",[null,e]);if(0===e.indexOf("NIApi"))return void webpublicationNamespace.EpubDomApi("NIApi",[null,e]);var t=/-([0-9]*).xhtml$/gim,n=t.exec(e)||[];n.length>0&&webpublicationNamespace.EpubDomApi("gotoPage",[null,~~n[1]])},e.prototype.handleMediaInMSOState=function(e){for(var t,n,i=e.getElementsByTagName("*"),a=0;a<i.length;a++)t=i[a],n=t.tagName.toLowerCase(),"video"!=n&&"audio"!=n||t.paused||(t.currentTime=0,t.pause())},e.prototype.handleAnimationInMSOState=function(e){var t,n,i,a,r=e.className;r.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),n=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,n),this.addClass(e,t),i=e.getAttribute("data-animationOnStateLoadActions"),i&&(a=e.id,this.evalActions(i,a)));for(var o,s=e.getElementsByTagName("*"),l=0;l<s.length;l++)o=s[l],r=o.className,r.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),n=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,n),this.addClass(e,t),i=o.getAttribute("data-animationOnStateLoadActions"),i&&(a=o.id,this.evalActions(i,a)))},e.prototype.goToNextState=function(e,t,n){var i=this;this.makeDefaultPreventGesture(),setTimeout(function(){i.goToNextStateWrapper(e,t)},1e3*n)},e.prototype.goToNextStateWrapper=function(e,t){var n,i,a,r=this.element.querySelector("#"+e);if(null!==r){this.removeClass(r,"_idGenStateHide"),n=r.children;for(var o=0,s=void 0;s=n[o];o++)if(i=s.className,i.indexOf("_idGenCurrentState")!=-1)return a=t?o==n.length-1?n[0]:n[o+1]:o==n.length-1?n[o]:n[o+1],this.handleMediaInMSOState(s),this.removeClass(s,"_idGenCurrentState"),this.addClass(s,"_idGenStateHide"),this.removeClass(a,"_idGenStateHide"),this.addClass(a,"_idGenCurrentState"),void this.handleAnimationInMSOState(a)}},e.prototype.goToPreviousState=function(e,t,n){var i=this;this.makeDefaultPreventGesture(),setTimeout(function(){i.goToPreviousStateWrapper(e,t)},1e3*n)},e.prototype.goToPreviousStateWrapper=function(e,t){var n,i,a,r=document.getElementById(e);if(r){this.removeClass(r,"_idGenStateHide"),n=r.children;for(var o=0,s=void 0;s=n[o];o++)if(i=s.className,i.indexOf("_idGenCurrentState")!=-1)return a=t?0==o?n[n.length-1]:n[o-1]:0==o?n[0]:n[o-1],this.handleMediaInMSOState(s),this.removeClass(s,"_idGenCurrentState"),this.addClass(s,"_idGenStateHide"),this.removeClass(a,"_idGenStateHide"),this.addClass(a,"_idGenCurrentState"),void this.handleAnimationInMSOState(a)}},e.prototype.playAnimatedElement=function(e,t,n){var i=this;this.removeClass(e,"_idGenStateHide"),this.removeClass(e,"_idGenPauseAnimation");var a=e.className,r=e.getAttribute("data-idGenAnimationClass");a.indexOf(t)==-1&&a.indexOf(r)==-1?(this.addClass(e,t),e.setAttribute("data-idGenAnimationClass",t)):(this.removeClass(e,t),this.removeClass(e,r),e.removeEventListener("webkitAnimationEnd",function(t){i.onPlayAnimationEnd(e,n,t)}),e.removeEventListener("animationend",function(t){i.onPlayAnimationEnd(e,n,t)}),setTimeout(function(){i.addClass(e,t)},10),e.setAttribute("data-idGenAnimationClass",t)),this.addToEventListeners(e,this.onPlayAnimationEnd.bind(this,e,n),"webkitAnimationEnd"),this.addToEventListeners(e,this.onPlayAnimationEnd.bind(this,e,n),"animationend")},e.prototype.playAnimation=function(e,t,n,i){var a,r=this;if(a="object"==typeof e?e:document.getElementById(e)){this.handleMSOStateParentOfObject(a);var o=a.getAttribute("data-idGenAnimationStartState"),s=a.getAttribute("data-idGenAnimationEndState");this.removeClass(a,s),this.addClass(a,o),setTimeout(function(){r.playAnimatedElement(a,t,i)},1e3*n)}},e.prototype.onPlayAnimationEnd=function(e,t,n){var i=e.getAttribute("data-idGenAnimationClass"),a=e.getAttribute("data-idGenAnimationStartState"),r=e.getAttribute("data-idGenAnimationEndState");this.removeClass(e,i),this.removeClass(e,a),
this.addClass(e,r),t&&this.addClass(e,"_idGenStateHide"),n.stopPropagation()},e}();n["default"]=l},{"./EpubGesturesEvent":8,"./EpubPageEnrichment/IFrames":46,"./EpubPageEnrichment/Medias":48}],45:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/isElementVisible"),a=e("../EpubPage/shapes/utils/IframeInteractions"),r=e("../utils/enums"),o=function(){function e(e,t){this.iFrame=e,this.config=t,this.foreground=!0,this.startableAsyncDate=0,this.status={start:!1,visible:!1},this.init()}return e.prototype.init=function(){this.element=this.iFrame.parentElement,this.iFrame.style.pointerEvents="none",this.iFrame.setAttribute("data-foreground",this.foreground?"true":"false"),this.iframeInteractions=new a.IframeInteractions(this,this.config,this.iFrame,this.element,this.foreground),this.iFrame.addEventListener("load",this.loaded.bind(this)),this._onScroll=this.onScroll.bind(this),window.document.addEventListener("scroll",this._onScroll,!0),window.addEventListener("resize",this._onScroll,!0)},e.prototype.loaded=function(){try{this.iFrameContentWindow=this.iFrame.contentWindow,this.foreground===!0&&"object"==typeof this.iFrameContentWindow.AdobeAn?this.iframeInteractions.init(this.iFrameContentWindow):this.foreground!==!0&&this.config.readerPageSrcType!==r.READER_TYPES.EPUB_HTML||(this.iFrame.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow))}catch(e){this.iFrame.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow)}},e.prototype.onScroll=function(){this.startableAsync()},e.prototype.startableAsync=function(){var e=this;return clearTimeout(this.startableAsyncTimer),Date.now()-this.startableAsyncDate>1e3?(this.startableAsyncDate=Date.now(),void this.startable()):void(this.startableAsyncTimer=setTimeout(function(){e.startableAsyncDate=Date.now(),e.startable()},100))},e.prototype.startable=function(){return this.status.visible=i.isElementVisible(window.document.documentElement,this.iFrame),this.status.start===!1||this.status.visible===!1?void(this.iFrame.hasAttribute("src")===!0&&this.iFrame.removeAttribute("src")):void(this.iFrame.hasAttribute("src")===!1&&this.iFrame.setAttribute("src",this.iFrame.getAttribute("data-src")))},e.prototype.start=function(){this.onScroll(),this.status.start=!0,this.startableAsync()},e.prototype.stop=function(){this.iFrame.hasAttribute("src")===!0&&this.iFrame.removeAttribute("src"),window.document.removeEventListener("scroll",this._onScroll,!0),window.removeEventListener("resize",this._onScroll,!0),this.status.start=!1,this.iframeInteractions.flush()},e}();n.IFrame=o},{"../EpubPage/shapes/utils/IframeInteractions":30,"../utils/enums":79,"../utils/isElementVisible":81}],46:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./IFrame"),a=function(){function e(e,t){this.htmlIframes=e,this.config=t,this.iFrames=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlIframes.length;e<t;e++)this.iFrames.push(new i.IFrame(this.htmlIframes[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].start()},e.prototype.stop=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].stop()},e}();n.IFrames=a},{"./IFrame":45}],47:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("../EpubGesturesEvent"),a=e("../utils/isElementVisible"),r=function(){function e(e,t){this.media=e,this.config=t,this.foreground=!0,this.startableAsyncDate=0,this.status={start:!1,visible:!1},this.init()}return e.prototype.init=function(){this._onMediaChange=this.onMediaChange.bind(this),this.media.setAttribute("controlsList","nodownload"),this.media.addEventListener("volumechange",this._onMediaChange,!0),this.media.addEventListener("seeking",this._onMediaChange,!0)},e.prototype.onMediaChange=function(){i["default"].prototype.preventAllGesture()},e.prototype.onScroll=function(){this.startableAsync()},e.prototype.startableAsync=function(){var e=this;return clearTimeout(this.startableAsyncTimer),Date.now()-this.startableAsyncDate>1e3?(this.startableAsyncDate=Date.now(),void this.startable()):void(this.startableAsyncTimer=setTimeout(function(){e.startableAsyncDate=Date.now(),e.startable()},100))},e.prototype.startable=function(){return this.status.visible=a.isElementVisible(window.document.documentElement,this.media),this.status.start===!1||this.status.visible===!1?void this.media.pause():void(this.media.hasAttribute("autoplay")===!0&&"false"!==this.media.getAttribute("autoplay")&&this.media.play())},e.prototype.start=function(){this.status.start=!0,this.startableAsync()},e.prototype.stop=function(){this.media.removeEventListener("volumechange",this._onMediaChange,!0),this.media.removeEventListener("seeking",this._onMediaChange,!0),this.status.start=!1,this.media.pause()},e}();n.Media=r},{"../EpubGesturesEvent":8,"../utils/isElementVisible":81}],48:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Media"),a=function(){function e(e,t){this.htmlMedias=e,this.config=t,this.medias=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlMedias.length;e<t;e++)this.medias.push(new i.Media(this.htmlMedias[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].start()},e.prototype.stop=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].stop()},e}();n.Medias=a},{"./Media":47}],49:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubPage"),r=t("./utils/enums"),o=function(){function t(e,t,n){this.epubSpreads=e,this.config=t,this.epubCssManager=n,this.currentPage=0,this.pageQuantity=0,this.imagesMdpi=r.PagesImagesQualities[r.PagesImagesQualities.mdpi],this.imagesHdpi=r.PagesImagesQualities[r.PagesImagesQualities.hdpi],this.parent=this.epubSpreads,this.currentPage=this.config.currentPage,this.pageQuantity=this.config.pageQuantity,this.setPagesObject()}return Object.defineProperty(t.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),t.prototype.setPagesQty=function(){this.epubPages=new Array(this.pageQuantity),this.epubPagesRequested=new Array(this.pageQuantity)},t.prototype.setPageObject=function(t,n){return this.readerPageSrcType===r.READER_TYPES.EPUB_HTML?void(t.src=e.Main.pageManager.getEpubHtml(n)):this.readerPageSrcType===r.READER_TYPES.PDF_HTML?void(t.src=e.Main.pageManager.getPdfHtml(n)):this.readerPageSrcType===r.READER_TYPES.PDF_SVG?void(t.src=e.Main.pageManager.getSvg(n)):this.readerPageSrcType===r.READER_TYPES.PDF_IMG?(t.srcHdpi=e.Main.pageManager.getImage(this.imagesHdpi,n),void(t.src=e.Main.pageManager.getImage(this.imagesMdpi,n))):this.readerPageSrcType===r.READER_TYPES.PDF_PDF?void(t.src=e.Main.pageManager.getPdf(n)):void 0},t.prototype.setPagesObject=function(){this.setPagesQty();for(var e=0;e<this.pageQuantity;e++)this.epubPages[e]=new a["default"](this,this.config,e+1,this.epubCssManager),this.setPageObject(this.epubPages[e],e+1)},t.prototype.pageExist=function(e){return"undefined"!=typeof this.epubPages[e]},t.prototype.pageGetForSpread=function(e){return this.epubPagesRequested[e]=!0,this.epubPages[e]},t.prototype.pageGet=function(e){return this.epubPages[e]},t.prototype.resetRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]=!1},t.prototype.flushNotRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]===!1&&this.epubPages[e].flush()},t}();i["default"]=o},{"./EpubPage":16,"./utils/enums":79}],50:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t,n){this.epubScrollables=e,this.config=t,this.epubSpread=n,this.x=0,this.y=0,this.parent=this.epubScrollables,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize}return e}();n["default"]=i},{}],51:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubScrollable"),r=t("./EpubGesturesEvent"),o=t("./EpubEvent"),s=400,l=function(){function t(t,n,i){this.epubSpreads=t,this.config=n,this.mainViewElement=i,this.scrollablesLength=0,this.xStart=0,this.yStart=0,this.x=0,this.y=0,this.tapeGestureDate=0,this.epubEvent=e.epubEvent,this.parent=this.epubSpreads,this.screenSize=this.epubSpreads.screenSize,this.mainViewElementSize=this.epubSpreads.mainViewElementSize,this.element=i,this.scrollables=[],this.permissionTapList=[],this.epubGesturesEvent=new r["default"](this,this.element),this.spreadDraggable&&(this.epubGesturesEvent.addEventListener(r["default"].GESTURESNAME.SWIPEGESTURE,this.trySwip.bind(this)),this.epubGesturesEvent.addEventListener(r["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.addEventListener(r["default"].GESTURESNAME.MOUSEWHEELGESTURE,this.onMouseWheel.bind(this))),this.epubGesturesEvent.addEventListener(r["default"].GESTURESNAME.TAPGESTURE,this.checkLastActionForTapGesture.bind(this)),this.epubEvent.addListener(o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,this.permissionTapEvent.bind(this)),this.epubGesturesEvent.setEnableScrollElement(!1),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.epubGesturesEvent.setEnableScrollElement(!0)}return Object.defineProperty(t.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigationType",{get:function(){return this.config.navigationType},enumerable:!0,configurable:!0}),t.prototype.onMouseWheel=function(e){var n=Date.now(),i=0,a=(e.deltaX>e.deltaY?"x":"y",t.mouseWheelLastDelta,!1);"x"===this.navigationType&&e.gestureData.wheel.isX?i=e.deltaX:"y"===this.navigationType&&e.gestureData.wheel.isY&&(i=e.deltaY),i>0?i=1:i<0&&(i=-1),i!==t.mouseWheelLastDelta&&(a=!0),t.mouseWheelLastDelta=i,t.mouseWheelLast=n,i>0?this.epubSpreads.epubManager.pageNext():i<0&&this.epubSpreads.epubManager.pagePrevious()},t.prototype.initDrag=function(e,t){this.xStart=e,this.yStart=t},t.prototype.drag=function(e,t){return[this.x=e-this.xStart,this.y=t-this.yStart]},t.prototype.resetDrag=function(){return[this.xStart=this.x=0,this.yStart=this.y=0]},t.prototype.updateScrollablesDrop=function(e,t){0===t[0]&&0===t[1]||this.epubSpreads.gotoPageByCoordsDiff(e.gestureData)},t.prototype.updateScrollables=function(e,t){this.epubSpreads.scrollTo(t[0],t[1])},t.prototype.preserveScrollElement=function(){this.element.addEventListener("scroll",function(e){r["default"].prototype.preventAllGesture()},!0)},t.prototype.trySwip=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,this.updateScrollablesDrop(e,this.drag(e.epubClientX,e.epubClientY))},t.prototype.tryDrag=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff&&this.initDrag(e.epubClientX,e.epubClientY),this.updateScrollables(e,this.drag(e.epubClientX,e.epubClientY))},t.prototype.addScrollable=function(e){this.scrollables.push(new a["default"](this,this.config,e)),this.scrollablesLength++},t.prototype.permissionTapEvent=function(e){this.permissionTapList.push({action:e.data.action,date:Date.now()})},t.prototype.resetPermissionTapActions=function(){this.permissionTapList=[]},t.prototype.checkLastActionForTapGesture=function(e){for(var t=[],n=0,i=this.permissionTapList.length;n<i;n++)Date.now()-this.permissionTapList[n].date<s?t.push(this.permissionTapList[n]):this.permissionTapList[n].action(Promise.resolve(!1));if(this.permissionTapList=[],0===t.length)return void("pointercancel"!==e.type&&this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK}));for(var n=0,i=t.length;n<i;n++)t[n].action(Promise.resolve(!0))},t}();l.mouseWheelLast=0,l.mouseWheelLastDelta=0,i["default"]=l},{"./EpubEvent":7,"./EpubGesturesEvent":8,"./EpubScrollable":50}],52:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubSpreadZoomable"),r=t("./ProtoHTMLElement"),o=function(){function t(t,n,i,o){this.epubSpreads=t,this.config=n,this.spreadIndex=i,this.mainViewElement=o,this.optimizeQuality=!0,this.cssClassSpreadVisible="spread-is-visible",this.lastOffset=0,this.spreadOffset=0,this.parent=this.epubSpreads,this.epubEvent=e.epubEvent,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.pagesInSpread=[],this.elementSize={width:0,height:0},this.epubSpreadZoomable=new a["default"](this,this.config),this.spreadHTMLElement=new r["default"](this.config),this.spreadHTMLElement.initSpread(this,this.config,this.epubSpreadZoomable,this.spreadIndex),this.element=this.spreadHTMLElement.element,this.spreadHTMLElement.optimizeQuality=this.optimizeQuality,this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.spreadHTMLElement.setSpreadScrollable(!0,"y")}return Object.defineProperty(t.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstCoverPage",{get:function(){return this.config.firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"epubPages",{get:function(){return this.parent.epubPages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.parent.pagesBySpread},enumerable:!0,configurable:!0}),t.prototype.getSpreadOffsetByPageIndex=function(e){return this.parent.getSpreadsOffsetByPageIndex(e)[this.spreadIndex]},t.prototype.getPageIndexFromSpreadOffset=function(e,t,n){return t+e*n},t.prototype.updateSpreadAttributes=function(e,t){return 1===this.pagesBySpread?0:1===e&&1===t?1:e===this.pageQuantity&&1===t?-1:0},t.prototype.updatePages=function(e){var t=this,n=0,i=0,a=e.length,r=!1;if(0===a)return this.epubSpreadZoomable.resetContent(),void(this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded"));for(this.spreadHTMLElement.setBackgroundColor(e),this.pagesInSpread=e,this.epubSpreadZoomable.contentLength!==a&&(r=!0);n<a;n++)this.epubSpreadZoomable.lastContentIDs.indexOf(this.pagesInSpread[n].pageIndex)===-1&&(r=!0);r===!0&&(this.epubSpreadZoomable.resetContent(),this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded")),this.epubSpreadZoomable.contentLength=a,i=this.updateSpreadAttributes(this.pagesInSpread[0].pageIndex,a),this.epubSpreadZoomable.contentPosition=i;var o=[],s=!1;for(n=0;n<a;n++)this.pagesInSpread[n].atSpreadOffset=this.spreadOffset,r===!0?o.push(this.epubSpreadZoomable.updateContent(this.pagesInSpread[n])):this.pagesInSpread[n].epubPageEnrichmentStat(),this.pagesInSpread[n].pageContainsCPUElement===!0&&(s=!0);this.epubSpreadZoomable.setContainIframe(s),Promise.all(o).then(function(e){0!==e.length&&t.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")===!1&&t.epubSpreadZoomable.element.classList.add("epub-all-pages-loaded")})},t.prototype.isPageInSpread=function(e){return((e.pageIndex+this.firstCoverPage)%this.pagesBySpread||this.pagesBySpread)===this.spreadIndex},t.prototype.displaySpread=function(){this.mainViewElement.appendChild(this.element)},t.prototype.updateSpread=function(e){var t,n;this.lastOffset=this.spreadOffset,this.spreadOffset=e,0===this.spreadOffset?this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!1&&this.spreadHTMLElement.element.classList.add(this.cssClassSpreadVisible):this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!0&&this.spreadHTMLElement.element.classList.remove(this.cssClassSpreadVisible),this.epubSpreadZoomable.reset(),t=this.getPageIndexFromSpreadOffset(e,this.currentPage,this.pagesBySpread),n=this.getPagesByPageIndex(t),this.spreadHTMLElement.element.setAttribute("pages",n.length.toString()),this.updatePages(n)},t.prototype.updateSpreadSize=function(){this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight,this.epubSpreadZoomable.updateSize(),this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight},t.prototype.getPagesByPageIndex=function(e){var t,n,i=[];for(e-=1,t=~~((e+this.firstCoverPage)/this.pagesBySpread)*this.pagesBySpread,n=t+this.pagesBySpread;t<n;)this.epubPages.pageExist(t-this.firstCoverPage)===!0&&i.push(this.epubPages.pageGetForSpread(t-this.firstCoverPage)),t++;return i},t}();i["default"]=o},{"./EpubSpreadZoomable":53,"./ProtoHTMLElement":60}],53:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubEvent"),r=t("./ProtoHTMLElement"),o=t("./EpubSpreadZoomableAnimations"),s=t("./EpubZoom"),l=t("./EpubGesturesEvent"),u=t("./utils/functions"),c=function(){function t(t,n){this.epubSpread=t,this.config=n,this.contentLength=0,this.contentPosition=0,this.scale=0,this._x=0,this._y=0,this._xOrigin=0,this._yOrigin=0,this.widthScaled=0,this.heightScaled=0,this.mousedown=!1,this.savedEvent=null,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.isDesktop=e.Param.userAgent.isDesktop(),this.epubEvent=e.epubEvent,this.parent=this.epubSpread,this.screenSize=this.epubSpread.screenSize,this.mainViewElementSize=this.epubSpread.mainViewElementSize,this.updateSize=this.updateSize.bind(this),this.lastContentIDs=[],this._pageSizeType={coverTop:this.pageTypeCoverTop.bind(this),coverMiddle:this.pageTypeCoverMiddle.bind(this),contain:this.pageTypeContain.bind(this),coverHorizontally:this.coverHorizontally.bind(this),custom:this.pageTypeCustom.bind(this)},this.elementSize={width:0,height:0},this.epubZoom=new s["default"](this,this.config),this.spreadZoomableHTMLElement=new r["default"](this.config),this.spreadZoomableHTMLElement.initZoomable(this,this.config),this.element=this.spreadZoomableHTMLElement.element,this.epubSpreadZoomableAnimations=new o["default"](this,this.config,this.spreadZoomableHTMLElement),this.epubGesturesEvent=new l["default"](this,this.spreadZoomableHTMLElement.element),this.zoomDoubleClick===!0&&this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.DBLTAPGESTURE,this.tryZoom.bind(this)),this.zoomSingleClick===!0&&(this.epubEvent.addListener(a.EPUB_EVENTS.PAGE_CLICK,this.tryZoomOneClick.bind(this)),this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.TAPGESTURE,this.saveEvent.bind(this))),this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.setEnableScrollElement(!1),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.epubGesturesEvent.setEnableScrollElement(!0)}return Object.defineProperty(t.prototype,"zoomDoubleClick",{get:function(){return this.config.zoomDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentWidth",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentHeight",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spreadOffset",{get:function(){return this.parent.spreadOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeType",{get:function(){return"function"==typeof this._pageSizeType[this.config.pageSizeType]?this._pageSizeType[this.config.pageSizeType]:this._pageSizeType.contain},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coverPageCenter",{get:function(){return this.config.coverPageCenter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeMaxWidth",{get:function(){return this.config.pageSizeMaxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeMaxHeight",{get:function(){return this.config.pageSizeMaxHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useMatrixTransform",{get:function(){return this.config.useMatrixTransformZoomable},enumerable:!0,configurable:!0}),t.prototype.roundPxDevice=function(e){return~~(100*e)/100},t.prototype.coverHorizontally=function(){var e=this.parentWidth,t=this.parentHeight,n=this.paddingLeft,i=this.paddingTop,a=this.paddingRight,r=this.paddingBottom,o=0,s=0,l=0,u=0,c=0,p=0,h=0;return 0!==this.width&&0!==this.height&&(l=(e-n-a)/this.width,l=this.roundPxDevice(l),o=l*this.width,s=l*this.height,o=this.roundPxDevice(o),s=this.roundPxDevice(s),this.pageSizeMaxWidth>0&&(p=o/this.pageSizeMaxWidth),this.pageSizeMaxHeight>0&&(h=s/this.pageSizeMaxHeight),p=this.roundPxDevice(p),h=this.roundPxDevice(h),this.pageSizeMaxWidth>0&&p>=h?o>=this.pageSizeMaxWidth&&(l=this.pageSizeMaxWidth/this.width,o=l*this.width,s=l*this.height):this.pageSizeMaxHeight>0&&p<h&&s>=this.pageSizeMaxHeight&&(l=this.pageSizeMaxHeight/this.height,o=l*this.width,s=l*this.height),l=this.roundPxDevice(l),o=this.roundPxDevice(o),s=this.roundPxDevice(s),u=(e+n-a)/2-o/2,c=s+i-r>=t?i:(t+i-r)/2-s/2,u=this.roundPxDevice(u),c=this.roundPxDevice(c),this.widthScaled=o,this.heightScaled=s,this.scale!==l&&(this.scale=l,this._x=u,this._y=c,this.updateSizeFromPoint([l,0,0,u,c])),!0)},t.prototype.pageTypeCoverMiddle=function(){var e=this.parentWidth,t=this.parentHeight,n=0,i=0,a=0,r=0,o=0;return 0!==this.width&&0!==this.height&&(n=e/this.width,i=t/this.height,a=n<i?i:n,this.widthScaled=a*this.width,this.heightScaled=a*this.height,r=e/2-this.widthScaled/2,o=t/2-this.heightScaled/2,this.scale!==a&&(this.scale=a,this._x=r,this._y=o,this.updateSizeFromPoint([a,0,0,r,o])),!0)},t.prototype.pageTypeCoverTop=function(){var e=this.parentWidth,t=this.parentHeight,n=0,i=0,a=0,r=0,o=0;return 0!==this.width&&0!==this.height&&(n=e/this.width,i=t/this.height,a=n<i?i:n,this.widthScaled=a*this.width,this.heightScaled=a*this.height,r=e/2-this.widthScaled/2,this.scale!==a&&(this.scale=a,this._x=r,this._y=o,this.updateSizeFromPoint([a,0,0,r,o])),!0)},t.prototype.pageTypeContain=function(){var e=this.parentWidth,t=this.parentHeight,n=this.paddingLeft,i=this.paddingTop,a=this.paddingRight,r=this.paddingBottom,o=0,s=0,l=0,u=0,c=0,p=0,h=0,d=0,m=0;return 0!==this.width&&0!==this.height&&(l=(e-n-a)/this.width,u=(t-i-r)/this.height,c=l>u?u:l,c=this.roundPxDevice(c),o=c*this.width,s=c*this.height,o=this.roundPxDevice(o),s=this.roundPxDevice(s),this.pageSizeMaxWidth>0&&(d=o/this.pageSizeMaxWidth),this.pageSizeMaxHeight>0&&(m=s/this.pageSizeMaxHeight),this.pageSizeMaxWidth>0&&d>=m?o>=this.pageSizeMaxWidth&&(c=this.pageSizeMaxWidth/this.width,c=this.roundPxDevice(c),o=c*this.width,s=c*this.height):this.pageSizeMaxHeight>0&&d<m&&s>=this.pageSizeMaxHeight&&(c=this.pageSizeMaxHeight/this.height,c=this.roundPxDevice(c),o=c*this.width,s=c*this.height),o=this.roundPxDevice(o),s=this.roundPxDevice(s),p=0===this.contentPosition||this.coverPageCenter===!0?.5*(e+n-a)-.5*o:1===this.contentPosition?.5*(e+n-a):.5*(e+n-a)-o,h=.5*(t+i-r)-.5*s,p+o>e+n-a&&(p-=p+o-(e+n-a)),this.widthScaled=o,this.heightScaled=s,p=this.roundPxDevice(p),h=this.roundPxDevice(h),this.scale!==c&&(this.scale=c,this._x=p,this._y=h,this.updateSizeFromPoint([c,0,0,p,h])),!0)},t.prototype.pageTypeCustom=function(e,t){console.log("pageTypeCustom")},t.prototype.updateSizeFromPointAnimation=function(e){this.epubSpreadZoomableAnimations.animateScale(e,this.spreadOffset)},t.prototype.updateSizeFromPoint=function(e){this.epubSpreadZoomableAnimations.scaleDrag(e,this.spreadOffset)},t.prototype.tryClick=function(e){},t.prototype.saveEvent=function(e){if(e.target.classList.contains("epub-link-type_iframe")!==!0||e.target.classList.contains("epub-link-visible")!==!0){var t=e.target;return l["default"].preventAllGestureStatus()===!0||u.isMediaElement(t)?void(this.savedEvent=null):void(this.savedEvent=e)}},t.prototype.tryZoomOneClick=function(e){var t=this.savedEvent;return null===t||l["default"].preventAllGestureStatus()===!0?void(this.savedEvent=null):(this.savedEvent=null,void this.tryZoom(t))},t.prototype.tryZoom=function(e){var t=u.getBoundingClientRect(this.spreadZoomableHTMLElement.element,this.useMatrixTransform?1:this.scale),n=this.epubZoom.scale;return e.defaultPreventGesture=!0,0!==n?(this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):void(0===this.spreadOffset&&(this.updateSizeFromPointAnimation(this.epubZoom.getZoom(e,this.defaultPageScaleAt,e.epubClientX,e.epubClientY,t)),0===n&&this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}})))},t.prototype.getBoundingClientRect=function(e){return void 0===e&&(e=this.spreadZoomableHTMLElement.element),u.getBoundingClientRect(e,this.useMatrixTransform?1:this.scale)},t.prototype.tryZoomOnElement=function(e){var t=this.getBoundingClientRect(),n=u.getBoundingClientRect(e.target),i=n.left+n.width/2,a=n.top+n.height/2;return e.defaultPreventGesture=!0,0!==this.epubZoom.scale?void this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()):void this.updateSizeFromPointAnimation(this.epubZoom.getZoom(e,this.defaultPageScaleAt,i,a,t))},t.prototype.zoomToggle=function(e){var t=this.getBoundingClientRect(),n=t.left+t.width*e.x,i=t.top+t.height*e.y,r=e.scale;return 0===r?(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()):this.updateSizeFromPoint(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.getZoomNoEvent(r,n,i,t)):this.updateSizeFromPoint(this.epubZoom.getZoomNoEvent(r,n,i,t)),void this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}}))},t.prototype.zoomByStep=function(e){var t={x:e.x,y:e.y,scale:this.epubZoom.scale+e.step,animate:e.animate};this.zoomToggle(t)},t.prototype.zoomProgress=function(e){this.zoomToggle(e)},t.prototype.tryDrag=function(e){var t,n;0===this.epubZoom.scale&&0===e.gestureData.pinchZoomDiff||(t=this.getBoundingClientRect(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff?this.epubZoom.initdrag(e,e.epubClientX,e.epubClientY,t):(0===e.gestureData.x.pointDiff&&this.epubZoom.initdragX(e,e.epubClientX,t),0===e.gestureData.y.pointDiff&&this.epubZoom.initdragY(e,e.epubClientY,t)),n=this.epubZoom.scale+e.gestureData.pinchZoomDiff*this.config.zoomFactor,this.epubZoom.getZoom(e,n,e.epubClientX,e.epubClientY,t),this.updateSizeFromPoint(this.epubZoom.drag(e,e.epubClientX,e.epubClientY)))},t.prototype.reset=function(){var e=this.epubZoom.scale;this.updateSizeFromPoint(this.epubZoom.resetZoom()),0===e&&this.epubEvent.fire({type:a.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})},t.prototype.resetContent=function(){this.lastContentIDs=[],this.spreadZoomableHTMLElement.removeChilren()},t.prototype.updateContent=function(e){var t=this;this.lastContentIDs.push(e.pageIndex);var n=e.syncElemWithSpread(this.spreadZoomableHTMLElement.element);return this.spreadZoomableHTMLElement.element.appendChild(n.element),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&(clearTimeout(this.timeoutId2),this.timeoutId2=setTimeout(function(){t.spreadZoomableHTMLElement.scrollToTop()},0)),e.onload=this.updateSize,n.loaded},t.prototype.setContainIframe=function(e){this.spreadZoomableHTMLElement.element.setAttribute("contains-iframe",e?"yes":"no")},t.prototype.getElement=function(){return this.spreadZoomableHTMLElement.element},t.prototype.updateSize=function(){this.scale=0,this.paddingLeft=this.config.paddingLeft,this.paddingRight=this.config.paddingRight,this.paddingTop=this.config.paddingTop,this.paddingBottom=this.config.paddingBottom,this.elementSize.width=this.spreadZoomableHTMLElement.element.offsetWidth,this.elementSize.height=this.spreadZoomableHTMLElement.element.offsetHeight,this.pageSizeType()===!1&&(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.updateSize,16))},t}();i["default"]=c},{"./EpubEvent":7,"./EpubGesturesEvent":8,"./EpubSpreadZoomableAnimations":54,"./EpubZoom":58,"./ProtoHTMLElement":60,"./utils/functions":80}],54:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./utils/cssAnimations"),a=1e-4,r=.3,o=function(){function e(e,t,n){this.epubSpreadZoomable=e,this.config=t,this.spreadZoomableHTMLElement=n,this.fromPosition={x:0,y:0,scale:0},this.toPosition={x:0,y:0,scale:0},this.elementData={prc:0},this.epubTweens=new Tween(this.elementData,"prc",Tween.regularEaseInOut,0,0,a),this.epubTweens.onMotionChanged=this.tweenUpdate.bind(this)}return e.prototype.animationDomAsync=function(e,t,n,a,r){return this.config.useMatrixTransformZoomable===!0?void i.matrixDom3dAsync(e,t,n,a,r):void i.positionDomAsync(e,t,n,a,r)},e.prototype.tweenUpdate=function(e){this.fromPosition.scale+=(this.toPosition.scale-this.fromPosition.scale)*e.target._pos,this.fromPosition.x+=(this.toPosition.x-this.fromPosition.x)*e.target._pos,this.fromPosition.y+=(this.toPosition.y-this.fromPosition.y)*e.target._pos,this.animationDomAsync(this.spreadZoomableHTMLElement,this.fromPosition.scale,this.fromPosition.x,this.fromPosition.y,0)},e.prototype.tweenUpdateZero=function(){this.animationDomAsync(this.spreadZoomableHTMLElement,this.toPosition.scale,this.toPosition.x,this.toPosition.y,0)},e.prototype.setOptimizequality=function(e){return 0===e?void(this.spreadZoomableHTMLElement.optimizeQuality=!0):void(this.spreadZoomableHTMLElement.optimizeQuality=!1)},e.prototype.animateScale=function(e,t){this.setOptimizequality(t),this.toPosition.scale=e[0],this.toPosition.x=e[3],this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=0,this.epubTweens.continueTo(1,r)},e.prototype.scaleDrag=function(e,t){this.setOptimizequality(t),this.fromPosition.scale=this.toPosition.scale=e[0],this.fromPosition.x=this.toPosition.x=e[3],this.fromPosition.y=this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=1,this.tweenUpdateZero()},e}();n["default"]=o},{"./utils/cssAnimations":78}],55:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./EpubSpread"),a=e("./EpubSpreadsAnimations"),r=e("./EpubPages"),o=e("./EpubScrollables"),s=e("./utils/functions"),l=function(){function e(e,t,n,i){this.epubManager=e,this.config=t,this.viewMain=n,this.epubCssManager=i,this.parent=this.epubManager,this.screenSize=this.epubManager.screenSize,this.mainViewElementSize={width:0,height:0},this.mainViewElementClassName=this.config.mainViewElementClassName,this.epubSpreads=new Array(this.spreadsLength),this.extractedSpreads=[],this.epubPages=new r["default"](this,this.config,this.epubCssManager),this.setMainViewElement(),this.epubScrollables=new o["default"](this,this.config,this.mainViewElement),this.epubSpreadsAnimations=new a["default"](this,this.config,this.epubSpreads,this.mainViewElement),
this.initSpreads(this.epubSpreads,this.mainViewElement),this.appendMainViewElementToViewMain()}return Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastPage",{get:function(){return this.config.lastPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstCoverPage",{get:function(){return this.config.firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadsLength",{get:function(){return this.config.spreadsLength},enumerable:!0,configurable:!0}),e.prototype.initSpreads=function(e,t){for(var n=0,a=e.length;n<a;n++)e[n]=new i["default"](this,this.config,n,t),this.epubScrollables.addScrollable(e[n]);this.updateSpreads(0),this.displaySpreads(e)},e.prototype.displaySpreads=function(e){for(var t=0,n=e.length;t<n;t++)e[t].displaySpread()},e.prototype.extractSpreadFromSpreads=function(e){for(var t=0,n=e.length;t<n;t++);},e.prototype.getMainViewElement=function(){return this.mainViewElement},e.prototype.setMainViewElement=function(){this.mainViewElement=document.createElement("div"),this.mainViewElement.classList.add(this.mainViewElementClassName)},e.prototype.updateMainViewElementSize=function(){this.mainViewElementSize.width=this.mainViewElement.offsetWidth,this.mainViewElementSize.height=this.mainViewElement.offsetHeight,this.mainViewElementSize.rect=s.getBoundingClientRect(this.mainViewElement)},e.prototype.appendMainViewElementToViewMain=function(){this.viewMain.appendChild(this.mainViewElement)},e.prototype.getSpreadIndexHasPageIndex=function(e){return Math.ceil((e+this.firstCoverPage)/this.pagesBySpread)},e.prototype.getSpreadIndexByPageIndex=function(e){return(this.getSpreadIndexHasPageIndex(e)%this.epubSpreads.length||this.epubSpreads.length)-1},e.prototype.getSpreadByPageIndex=function(e){return this.epubSpreads[this.getSpreadIndexByPageIndex(e)]},e.prototype.getSpreadFromPage=function(e){return this.getSpreadByPageIndex(e.pageIndex)},e.prototype.getPagesFromSpreadByPage=function(e){return this.getPagesFromSpreadByPageIndex(e.pageIndex)},e.prototype.getPagesFromSpreadByPageIndex=function(e){return this.getSpreadByPageIndex(e).getPagesByPageIndex(e)},e.prototype.getSpreadsOffsetByPageIndex=function(e){var t=0,n=this.epubSpreads.length,i=new Array(n),a=Math.ceil(n/2),r=~~(n/2),o=0,s=0,l=this.getSpreadIndexByPageIndex(e);for(e=this.getSpreadByPageIndex(e).getPagesByPageIndex(e)[0].pageIndex,s=1+this.pageQuantity-(e+a),s<0&&(r-=s,a+=s),s=e-1-r,s<0&&(r+=s,a-=s),r>=n?(r=n-1,a++):a>=n&&e>1&&(a=n-1,r++),o=0,t=l;t<n&&0!==a;t++)i[t]=o,o++,a--;if(0!==a)for(t=0;t<a+t;t++)i[t]=o,o++,a--;else if(t<n){for(;t<n;t++)i[t]=-r,r--;t=0}else t=0;for(;t<n&&0!==r;t++)i[t]=-r,r--;return i},e.prototype.getScaleFromCurrentSpread=function(){return this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.epubZoom.scale},e.prototype.zoomToggle=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomToggle(e)},e.prototype.zoomByStep=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomByStep(e)},e.prototype.updateSpreads=function(e){var t,n=0,i=0;for(this.epubPages.resetRequested(),i=this.epubSpreads.length,t=this.getSpreadsOffsetByPageIndex(this.currentPage);n<i;n++)this.epubSpreads[n].updateSpread(t[n]);Math.abs(this.currentPage-this.lastPage)>this.pagesBySpread?this.epubSpreadsAnimations.updatePositionSizeOffset():this.epubSpreadsAnimations.animatePositionOffset(e),this.epubPages.flushNotRequested()},e.prototype.updateSpreadsSize=function(){var e=0,t=0;for(this.updateMainViewElementSize(),this.epubSpreadsAnimations.updatePositionSizeOffset(),this.goToPage(this.currentPage,!1),e=0,t=this.epubSpreads.length;e<t;e++)this.epubSpreads[e].updateSpreadSize()},e.prototype.scrollTo=function(e,t){this.epubSpreadsAnimations.updatePosition(e,t)},e.prototype.gotoPageByCoordsDiff=function(e){this.epubManager.gotoPageByCoordsDiff(e)},e.prototype.goToPage=function(e,t){void 0===t&&(t=!0),this.epubManager.goToPage(e,t)},e}();n["default"]=l},{"./EpubPages":49,"./EpubScrollables":51,"./EpubSpread":52,"./EpubSpreadsAnimations":56,"./utils/functions":80}],56:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./utils/cssAnimations"),a=1,r=function(){function e(e,t,n,i){this.parent=e,this.config=t,this.epubSpreads=n,this.mainViewElement=i,this.epubSpreadsLength=n.length,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubSpreadsData=new Array(this.epubSpreads.length),this.makeSpreadData(this.epubSpreadsData),this.pixelTimeData={x:0,w:0,y:0,h:0,date:0,time:0},this.currentPosition={width:0,height:0,inX:0,inY:0,diffCoord:0}}return Object.defineProperty(e.prototype,"navigationType",{get:function(){return this.config.navigationType},enumerable:!0,configurable:!0}),e.prototype.setPixelTime=function(e,t){var n=e-this.pixelTimeData.x,i=t-this.pixelTimeData.y,a=Date.now(),r=a-this.pixelTimeData.date;this.pixelTimeData.x=e,this.pixelTimeData.w=n,this.pixelTimeData.y=t,this.pixelTimeData.h=i,this.pixelTimeData.date=a,this.pixelTimeData.time=r},e.prototype.getPixelTime=function(e,t){var n={w:~~Math.abs(e/this.pixelTimeData.w*this.pixelTimeData.time),h:~~Math.abs(t/this.pixelTimeData.y*this.pixelTimeData.time)};return this.pixelTimeData.x=0,this.pixelTimeData.w=0,this.pixelTimeData.y=0,this.pixelTimeData.h=0,this.pixelTimeData.date=0,this.pixelTimeData.time=0,n},e.prototype.makeSpreadData=function(e){for(var t=0,n=e.length;t<n;t++)e[t]={spreadOffset:0}},e.prototype.matrixDom3dAsyncZero=function(e,t,n,r){return this.config.useMatrixTransformScrollable===!0?void i.matrixDom3dAsync(e,a,t,n,r):void i.positionDomAsync(e,a,t,n,r)},e.prototype.animateSpreads=function(e,t,n,i,a,r,o){for(var s,l=0,u=this.epubSpreadsLength,c=0,p=0,h=0,d=0,m=0,f=0,g=0;l<u;l++)g=o,f=r,s=this.epubSpreads[l],0!==s.spreadOffset&&0!==s.lastOffset&&(f=1,g=0),m=s.spreadOffset-s.lastOffset,h=s.lastOffset*e+m*e*f+a*(1-f),d=s.lastOffset*t+m*t*f+a*(1-f),c=n*h,p=i*d,this.matrixDom3dAsyncZero(s.spreadHTMLElement,c,p,g)},e.prototype.updatePositionSizeOffset=function(){this.updatePosition(0,0)},e.prototype.animatePositionOffset=function(e){var t=0,n=0,i=0,a=0,r=0;e=e||0,t=this.epubSpreadsLength,"x"===this.navigationType?(n=1,i=0):(n=0,i=1),a=this.mainViewElementSize.width,r=this.mainViewElementSize.height,this.currentPosition.width=a,this.currentPosition.height=r,this.currentPosition.inX=n,this.currentPosition.inY=i,this.animateSpreads(this.currentPosition.width,this.currentPosition.height,this.currentPosition.inX,this.currentPosition.inY,this.currentPosition.diffCoord,1,1e3*e)},e.prototype.updatePosition=function(e,t){var n,i=0,a=0,r=0,o=0,s=0,l=0,u=0,c=this.epubSpreadsLength;for(s=this.mainViewElementSize.width,l=this.mainViewElementSize.height,"x"===this.navigationType?(i=1,a=0,this.currentPosition.diffCoord=e):(i=0,a=1,this.currentPosition.diffCoord=t);u<c;u++)n=this.epubSpreads[u],this.epubSpreadsData[u].spreadOffset=n.spreadOffset,r=i*(n.spreadOffset*s+e),o=a*(n.spreadOffset*l+t),0!==n.spreadOffset&&((n.spreadOffset>0&&r>n.spreadOffset*s||n.spreadOffset<0&&r<n.spreadOffset*s)&&(r=n.spreadOffset*s),(n.spreadOffset>0&&o>n.spreadOffset*l||n.spreadOffset<0&&o<n.spreadOffset*l)&&(o=n.spreadOffset*l)),this.matrixDom3dAsyncZero(n.spreadHTMLElement,r,o,0)},e}();n["default"]=r},{"./utils/cssAnimations":78}],57:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./EpubEvent"),r=function(){function t(t){this.epubManager=t,this.trackDateMaxTime=500,this.trackPageDate=0,this.lastPage=0,this.epubEvent=e.epubEvent,this.epubEvent.addListener(a.EPUB_EVENTS.PAGE_CHANGE,this.trackPages.bind(this)),this.epubEvent.addListener(a.EPUB_EVENTS.PAGE_ZOOM,this.trackPagesZoom.bind(this)),this.epubEvent.addListener(a.EPUB_EVENTS.ACTION_LINK_SUCCESS,this.trackLinks.bind(this))}return t.prototype.trackPages=function(t){var n=this.lastPage;if(Date.now()-this.trackPageDate<this.trackDateMaxTime)return void(this.trackPageDate=Date.now());this.trackPageDate=Date.now();var i=this.epubManager.getCurrentPages(t.data.pageNumber);n=n||i[0];for(var a={},r=0,o=i.length;r<o;r++)a[r+1]=i[r];i[0]>n?(e.Main.trackerManager.trackEvent({name:"pageNext",variables:a}),this.lastPage=i[0]):i[0]<n&&(e.Main.trackerManager.trackEvent({name:"pagePrev",variables:a}),this.lastPage=i[i.length-1]),e.Main.trackerManager.trackPage({name:"page",variables:a}),this.lastPage=n},t.prototype.trackPagesZoom=function(t){var n=this.epubManager.getCurrentPages(),i="zoomIn",a={1:""};a[1]=n.join("-"),t.data.status!==!0&&(i="zoomOut"),this.lastZoomScale===t.data.scale&&this.lastZoomedPages===a[1]||0===t.data.scale&&this.lastZoomedPages!==a[1]||(this.lastZoomedPages=a[1],this.lastZoomScale=t.data.scale,e.Main.trackerManager.trackEvent({name:i,variables:a}))},t.prototype.trackLinks=function(t){var n=t.data.userAct;e.Main.trackerManager.trackEvent({name:"link",variables:{1:n.type,2:n.param}})},t}();i.EpubStatistics=r},{"./EpubEvent":7}],58:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./EpubZoomDraggable"),a=function(){function e(e,t){this.epubSpreadZoomable=e,this.config=t,this.totalScale=0,this.totalWidth=0,this.totalHeight=0,this.totalX=0,this.totalY=0,this._scale=0,this._x=0,this._y=0,this.xLimited=!1,this.yLimited=!1,this.xLimit=0,this.yLimit=0,this.elastic={axisMax:100,coef:10},this.parent=this.epubSpreadZoomable,this.maxTotalScale=this.config.maxPageTotalScale,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubZoomDraggable=new i["default"](this,this.config)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widthOrig",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightOrig",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.calcMaxCoord=function(e,t,n,i,a,r){return void 0===a&&(a=0),void 0===r&&(r=0),i.status=!1,t+a+r<n?(i.status=!0,n/2-(t+a+r)/2):e},e.prototype.setMaxX=function(){var e={status:!0},t=this.paddingLeft,n=this.paddingRight;return this.totalX=this.calcMaxCoord(this.totalX,this.totalWidth,this.mainViewElementSize.width,e,t,n),e.status},e.prototype.setMaxY=function(){var e={status:!0},t=this.paddingTop,n=this.paddingBottom;return this.totalY=this.calcMaxCoord(this.totalY,this.totalHeight,this.mainViewElementSize.height,e,t,n),e.status},e.prototype.calcMaxOnDragCoord=function(e,t,n,i,a,r,o){var s=t+n-r>-1,l=t+n+i+o<a+1;if(1===e)s===!0&&l===!0||(s===!0?n=r-t:l===!0&&(n=a-(t+i+o)));else{var u=i/2-(r/2-o/2);n=a/2-u}return n},e.prototype.getZoomNoEvent=function(e,t,n,i){return this.getZoom(null,e,t,n,i)},e.prototype.setZoomY=function(e,t,n){var i=this.paddingTop,a=this.paddingBottom,r=this.y,o=t-n.top||0,s=o/(this.heightOrig*e),l=this.heightOrig*this.totalScale;this.y=(this.heightOrig*e-l)*s+r,this.totalY=this.yOrig+this.y,this.totalHeight=l,this.yLimited=this.setMaxY(),this.yLimit=this.yLimited?0:1,this.totalY=this.calcMaxOnDragCoord(this.yLimit,this.epubZoomDraggable.y,this.totalY,l,this.mainViewElementSize.height,i,a)},e.prototype.setZoomX=function(e,t,n){var i=this.paddingLeft,a=this.paddingRight,r=this.x,o=t-n.left||0,s=o/(this.widthOrig*e),l=this.widthOrig*this.totalScale;this.x=(this.widthOrig*e-l)*s+r,this.totalX=this.xOrig+this.x,this.totalWidth=l,this.xLimited=this.setMaxX(),this.xLimit=this.xLimited?0:1,this.totalX=this.calcMaxOnDragCoord(this.xLimit,this.epubZoomDraggable.x,this.totalX,l,this.mainViewElementSize.width,i,a)},e.prototype.makeScale_=function(e){var t=this.scale;return e=e||1,this.scale=e,this.scale>this.maxTotalScale?this.scale=this.maxTotalScale:this.scale<1&&(this.scale=1),this.totalScale=this.scaleOrig*this.scale,this.scaleOrig*t},e.prototype.makeScale=function(e){var t=this.scale;return e=e||0,this.scale=e,this.scale+this.scaleOrig<this.scaleOrig?this.scale=0:this.scale+this.scaleOrig>this.maxTotalScale+this.scaleOrig&&(this.scale=this.maxTotalScale),this.totalScale=this.scale+this.scaleOrig,this.scaleOrig+t},e.prototype.getZoom=function(e,t,n,i,a){var r=0;this.paddingTop,this.paddingBottom;return r=this.makeScale(t),this.setZoomX(r,n,a),this.setZoomY(r,i,a),[this.totalScale,0,0,this.epubZoomDraggable.x+this.totalX,this.epubZoomDraggable.y+this.totalY]},e.prototype.resetZoom=function(){return this.epubZoomDraggable.resetdrag(),this.scale=0,this.x=0,this.y=0,this.totalX=0,this.totalY=0,this.totalScale=0,[this.scaleOrig,0,0,this.xOrig,this.yOrig]},e.prototype.initdrag=function(e,t,n,i){return this.epubZoomDraggable.initdrag(t,n,i)},e.prototype.initdragX=function(e,t,n){return this.epubZoomDraggable.initdragX(t,n.left)},e.prototype.initdragY=function(e,t,n){return this.epubZoomDraggable.initdragY(t,n.top)},e.prototype.drag=function(e,t,n){return this.epubZoomDraggable.drag(e,t,n)},e.prototype.resetdrag=function(){this.epubZoomDraggable.resetdrag()},e}();n["default"]=a},{"./EpubZoomDraggable":59}],59:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){this.epubZoom=e,this.config=t,this.xRect=0,this.yRect=0,this.xStart=0,this.yStart=0,this._x=0,this._y=0,this.correctionX=0,this.correctionY=0,this.parent=this.epubZoom,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.dragedData=[1,0,0,0,0]}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent.xOrig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent.yOrig},enumerable:!0,configurable:!0}),e.prototype.calcMaxOnDragCoord=function(e,t,n,i,a,r,o){if(1===e){var s=t+n-r>0,l=t+n+i+o<a;s===!0?n=r-t:l===!0&&(n=a-(t+i+o))}return n},e.prototype.initdragX=function(e,t){this.correctionX=0,this.xRect=t,this.xStart=e-this.xRect-this.x},e.prototype.initdragY=function(e,t){this.correctionY=0,this.yRect=t,this.yStart=e-this.yRect-this.y},e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.initdrag=function(e,t,n){this.initdragX(e,n.left),this.initdragY(t,n.top)},e.prototype.dragY=function(e,t){var n=this.paddingTop,i=this.paddingBottom,a=0,r=this.parent.yLimited?0:1;this.y=(t-this.yRect-this.yStart)*r,a=this.epubZoom.totalY||this.yOrig;var o=this.calcMaxOnDragCoord(r,a,this.y,this.parent.totalHeight,this.mainViewElementSize.height,n,i);return o!==this.y&&(this.y>0&&this.y<this.correctionY?(this.correctionY=this.y-1,e.gestureData.resetAxis("y")):this.y<0&&this.y>this.correctionY?(this.correctionY=this.y+1,e.gestureData.resetAxis("y")):this.correctionY=this.y),this.y=o,a+this.y},e.prototype.dragX=function(e,t){var n=this.paddingLeft,i=this.paddingRight,a=0,r=this.parent.xLimited?0:1;this.x=(t-this.xRect-this.xStart)*r,a=this.epubZoom.totalX||this.xOrig;var o=this.calcMaxOnDragCoord(r,a,this.x,this.parent.totalWidth,this.mainViewElementSize.width,n,i);return o!==this.x&&(this.x>0&&this.x<this.correctionX?(this.correctionX=this.x-1,e.gestureData.resetAxis("x")):this.x<0&&this.x>this.correctionX?(this.correctionX=this.x+1,e.gestureData.resetAxis("x")):this.correctionX=this.x),this.x=o,a+this.x},e.prototype.drag=function(e,t,n){return this.dragedData=[this.epubZoom.totalScale||this.epubZoom.scaleOrig,0,0,this.dragX(e,t),this.dragY(e,n)],this.dragedData},e.prototype.resetdragY=function(){this.yStart=0,this.y=0},e.prototype.resetdragX=function(){this.xStart=0,this.x=0},e.prototype.resetdrag=function(){this.resetdragX(),this.resetdragY()},e}();n["default"]=i},{}],60:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./utils/functions"),r=function(){function t(t){this.config=t,this.optimizeQuality=!1,this.optimizeQualityStat=!1,this.scale=1,this.scaleLastMax=1,this.x=0,this.y=0,this.useInddEpubDataExportedBackground=!1;try{this.inddEpubDataExported=e.inddEpubDataExported,this.inddEpubDataExported.config.pagesData.length,this.useInddEpubDataExportedBackground=!0}catch(n){this.useInddEpubDataExportedBackground=!1}}return Object.defineProperty(t.prototype,"spreadViewElementClassName",{get:function(){return this.config.spreadViewElementClassName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomableViewElementClassName",{get:function(){return this.config.zoomableViewElementClassName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inddEpubDataExportedPagesData",{get:function(){return this.inddEpubDataExported.config.pagesData},enumerable:!0,configurable:!0}),t.prototype.getBackgroundColor=function(t){if(this.useInddEpubDataExportedBackground===!0)try{return this.inddEpubDataExportedPagesData[t-1].bgStyle.epubStyle.backgroundColor}catch(n){return"transparent"}return e.Main.pageManager.getBackgroundColor(t)},t.prototype.setBackgroundColor=function(e){var t,n=this.getBackgroundColor(e[0].pageIndex),i=n;e.length>1&&(i=this.getBackgroundColor(e[1].pageIndex)),t="linear-gradient(90deg,"+n+" 50%,"+i+" 50%)",this.backgroundColor!==t&&(this.backgroundColor=t,this.element.style.background=t)},t.prototype.initSpread=function(e,t,n,i){this.epubSpread=e,this.config=t,this.epubSpreadZoomable=n,this.spreadIndex=i,this.element=document.createElement("div"),this.element.classList.add(this.spreadViewElementClassName),this.element.classList.add(this.spreadViewElementClassName+"-"+this.spreadIndex),this.element.innerHTML="",this.element.appendChild(this.epubSpreadZoomable.getElement())},t.prototype.initZoomable=function(e,t){this.element=document.createElement("div"),this.element.classList.add(this.zoomableViewElementClassName)},t.prototype.removeChilren=function(){a.htmlSecureRemoveChildren(this.element)},t.prototype.scrollToTop=function(){this.element.scrollTop=0},t.prototype.setSpreadScrollable=function(e,t){return e===!0?(this.element.style["overflow-"+t]="auto",void(this.element.style.webkitOverflowScrolling="touch")):(this.element.style["overflow-"+t]="hidden",void(this.element.style.webkitOverflowScrolling="auto"))},t.prototype.getSpreadScrollable=function(e){return this.element.style["overflow-"+e]},t}();i["default"]=r},{"./utils/functions":80}],61:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./View"),r=function(){function t(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return t.prototype.init=function(){var t=this;e.Main.fullScreenManager.hasFullScreen()!==!1&&(this.panel=new a.View(this.viewPanelParams),this.panel.init().then(function(){t.panel.onClick(t.toggle.bind(t))}))},t.prototype.toggle=function(t){e.Main.fullScreenManager.fullScreenToggle()},t}();i.Controller=r},{"./View":62}],62:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=t("../../EpubEvent"),s=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.path=e.Param.pathTemplate+"epub/component/fullscreenToggle/index.html",i.dataSelect="fullscreen-toggle",i.iconID="fullscreen-v4",i}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.path,{})),n[1].then(function(t){e.element=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},n.prototype.setElements=function(){this.epubEvent=new o.EpubEvent;var t=this.getElement();if(null!==t){var n=document.createElement("div");e.Utils.svgIcon(n,{icon:this.iconID,color:null}),t.innerHTML=n.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},n.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.FULLSCREEN_TOGGLE,data:{range:0}})},n.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.FULLSCREEN_TOGGLE,e)},n}(r.View);i.View=s},{"../../EpubEvent":7,"./../panel/View":67}],63:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../zoomMore/Controller"),r=t("../zoomLess/Controller"),o=t("../zoomRange/Controller"),s=t("../pageRange/Controller"),l=t("../zoomReset/Controller"),u=t("../fullscreenToggle/Controller"),c=t("./View"),p=function(){function t(t){this.epubManager=t,this.userAgent=e.Param.userAgent,this.config=this.epubManager.config,this.menuViewPageControlItems=this.config.menuViewPageControlItems,this.viewPanelParams={parentElement:this.epubManager.viewMain},this.setSupportedModules(),this.init()}return t.prototype.init=function(){var t=this;try{if("true"!==this.menuViewPageControlItems.enable||this.userAgent.browser.name===e.Param.userAgent.BROWSER.IE&&e.Param.userAgent.browser.version<11)return}catch(n){return}this.panel=new c.View(this.viewPanelParams),this.panel.init().then(function(e){t.viewChildrenPanelParams={parentElement:e[e.length-1]};for(var n=t.menuViewPageControlItems.children,i=0,a=n.length;i<a;i++)"true"===n[i].enable&&t.supportedModules[n[i].name]&&new t.supportedModules[n[i].name](t.epubManager,t.viewChildrenPanelParams)})},t.prototype.setSupportedModules=function(){this.supportedModules={zoom_range:o.Controller,page_range:s.Controller,zoom_less:r.Controller,zoom_more:a.Controller,zoom_reset:l.Controller,fullscreen_toggle:u.Controller}},t}();i.Controller=p},{"../fullscreenToggle/Controller":61,"../pageRange/Controller":65,"../zoomLess/Controller":68,"../zoomMore/Controller":70,"../zoomRange/Controller":72,"../zoomReset/Controller":74,"./View":64}],64:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.classElement="epub-page-control",i.pageControlPath=e.Param.pathTemplate+"epub/component/pageControl/index.html",i}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.pageControlPath,{})),n[1].then(function(t){e.pageControlElement=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.setElements=function(){this.view.appendChild(this.pageControlElement)},n}(r.View);i.View=o},{"./../panel/View":67}],65:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../EpubEvent"),r=t("./View"),o=function(){function t(e,t){this.epubManager=e,this.viewPanelParams=t,this.rangeDelay=50,this.config=this.epubManager.config,this.init()}return Object.defineProperty(t.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageNumber",{get:function(){return this.epubManager.currentPage},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this;this.panel=new r.View(this.viewPanelParams,1,this.pageQuantity),this.panel.init().then(function(){t.epubEvent=e.epubEvent,t.panel.updateRange(t.pageNumber),t.epubEvent.addListener(a.EPUB_EVENTS.PAGE_CHANGE,t.pageChange.bind(t)),t.panel.onRangeChange(t.changePage.bind(t))})},t.prototype.changePage=function(e){var t=e.data.range;this.pageNumber!==t&&this.changePageAsync(e)},t.prototype.changePageAsync=function(e){var t=this;clearTimeout(this.timerRange),this.timerRange=setTimeout(function(){t.timerRangeDate=Date.now(),t.epubManager.goToPage(e.data.range)},this.rangeDelay)},t.prototype.pageChange=function(e){var t=this;e.data.pageNumber;NIApi.page.getVisiblePages().then(function(e){var n=e.indexOf(parseInt(t.panel.rangeValue));n!==-1?t.panel.updateRange(e[n]):t.panel.updateRange(e[0])})},t}();i.Controller=o},{"../../EpubEvent":7,"./View":66}],66:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=t("../../EpubEvent"),s=function(t){function n(n,i,a){var r=t.call(this,n)||this;return r.params=n,r.rangeMinValue=i,r.rangeMaxValue=a,r.classElement="epub-page-range",r.pagePanelPath=e.Param.pathTemplate+"epub/component/pageRange/index.html",r.rangeStepValue=1,r}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.pagePanelPath,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),n[1].then(function(t){e.pagePanelElement=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.setElements=function(){this.view.appendChild(this.pagePanelElement),this.epubEvent=new o.EpubEvent,this.createRangeValueElement(),this.createRangeInput()},Object.defineProperty(n.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e,this.updateRangeValueElement()},enumerable:!0,configurable:!0}),n.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{range:this.rangeValue}})},n.prototype.createRangeInput=function(){this.rangeElement=this.pagePanelElement.querySelector("[data-select='range-cursor']"),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}this.view.appendChild(this.rangeElement)},n.prototype.createRangeValueElement=function(){this.rangeValueElement=this.pagePanelElement.querySelector("[data-select='range-value']")},n.prototype.updateRangeValueElement=function(){this.rangeValueElement.innerHTML=this.rangeValue.toString()},n.prototype.setStepAttribute=function(e){this.rangeElement.setAttribute("step",e.toString())},n.prototype.updateRange=function(e){this.rangeElement.value=e.toString(),this.rangeChange(!1)},n.prototype.onRangeChange=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.PAGE_CHANGE,e)},n.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(o.EPUB_EVENTS.PAGE_CHANGE,e)},n}(r.View);i.View=s},{"../../EpubEvent":7,"./../panel/View":67}],67:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t){this.params=t,this.classElement="epub-page_control-button",this.shown=!1,this.opened=!1,this.panelTemplatePath=e.Param.pathTemplate+"epub/component/panel/index.html",this.htmlPlaceHolder=document.createElement("div"),this.htmlPlaceHolder.style.display="none",this.params.parentElement.appendChild(this.htmlPlaceHolder)}return t.prototype.init=function(){var e=this,t=this.setView();return t.then(function(){e.addView()}),t},t.prototype.addToView=function(e){this.view.replaceChild(this.htmlPlaceHolder,e)},t.prototype.loadTemplate=function(t,n){var i=document.createElement("div"),a=new Promise(function(a,r){e.Main.templateManager.load(t,i,n).then(function(e){a(e[0])})});return a},t.prototype.setView=function(){var e=this,t=this.loadTemplate(this.panelTemplatePath,{});return t.then(function(t){e.view=t,e.view.classList.add.apply(e.view.classList,e.classElement.split(" "))}),t},t.prototype.addView=function(){this.params.parentElement.replaceChild(this.view,this.htmlPlaceHolder)},t.prototype.show=function(e){e===!0&&this.shown===!1||e===!1&&this.shown===!0},t.prototype.open=function(e){e===!0&&this.opened===!1||e===!1&&this.opened===!0},t}();i.View=a},{}],68:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("./View"),r=function(){function t(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return t.prototype.init=function(){var t=this;this.panel=new a.View(this.viewPanelParams),this.panel.init().then(function(){t.epubEvent=e.epubEvent,t.panel.onClick(t.zoomChangeLevel.bind(t))})},t.prototype.zoomChangeLevel=function(e){this.epubManager.zoomByStep(e.data.level)},t}();i.Controller=r},{"./View":69}],69:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("../zoomMore/View"),o=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.path=e.Param.pathTemplate+"epub/component/zoomLess/index.html",
i.iconID="minus-v4",i}return a(n,t),n}(r.View);i.View=o},{"../zoomMore/View":71}],70:[function(e,t,n){arguments[4][68][0].apply(n,arguments)},{"./View":71,dup:68}],71:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=t("../../EpubEvent"),s=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.path=e.Param.pathTemplate+"epub/component/zoomMore/index.html",i.classElement="epub-page_control-button epub-zoom-steps",i.iconID="plus-v4",i.level=10,i}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.path,{})),n[1].then(function(t){e.element=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.getLevelElement=function(){var e;if(e=null!==this.element.getAttribute("data-zoom-step")?this.element:this.element.querySelector("[data-zoom-step]"),null===e)return null;var t=e.getAttribute("data-zoom-step");return null!==t&&(this.level=parseFloat(t)),e},n.prototype.setElements=function(){var t=this.getLevelElement();if(null!==t){var n=document.createElement("div");e.Utils.svgIcon(n,{icon:this.iconID,color:null}),t.innerHTML=n.innerHTML,this.view.appendChild(this.element),this.epubEvent=new o.EpubEvent,this.element.onclick=this.click.bind(this)}},n.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,data:{level:this.level}})},n.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,e)},n}(r.View);i.View=s},{"../../EpubEvent":7,"./../panel/View":67}],72:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../EpubEvent"),r=t("./View"),o=function(){function t(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return Object.defineProperty(t.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t=this;this.panel=new r.View(this.viewPanelParams),this.panel.init().then(function(){t.epubEvent=e.epubEvent,t.epubEvent.addListener(a.EPUB_EVENTS.PAGE_ZOOM,t.zoomChange.bind(t)),t.panel.onRangeChange(t.zoomRangeChange.bind(t))})},t.prototype.zoomRangeChange=function(e){var t=~~e.data.range/100,n=t*this.maxPageTotalScale;this.scale=n,this.zoomRangeChangeAsync()},t.prototype.zoomRangeChangeAsync=function(){var e=this;Date.now()-this.timerScaleDate<16&&clearTimeout(this.timerScale),this.timerScale=setTimeout(function(){e.timerScaleDate=Date.now(),Math.abs(e.scaleLast-e.scale)>.1?e.epubManager.zoomTo(e.scale):e.epubManager.zoomNow(e.scale),e.scaleLast=e.scale},16)},t.prototype.zoomChange=function(e){var t=e.data.scale/this.maxPageTotalScale;this.scaleLast=t;var n=~~(100*t)/100;this.panel.updateRange(n)},t}();i.Controller=o},{"../../EpubEvent":7,"./View":73}],73:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=t("../../EpubEvent"),s=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.classElement="epub-zoom-range",i.dataSelect="zoom-range-cursor",i.rangeMinValue=0,i.rangeMiddleValue=50,i.rangeMaxValue=100,i.rangeStepValue=2,i.path=e.Param.pathTemplate+"epub/component/zoomRange/index.html",i}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.path,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),n[1].then(function(t){e.element=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.setElements=function(){this.view.appendChild(this.element),this.epubEvent=new o.EpubEvent,this.createRangeInput()},Object.defineProperty(n.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e},enumerable:!0,configurable:!0}),n.prototype.rangeToggle=function(){var e=parseInt(this.rangeValue);0===e?this.rangeValue=this.rangeMiddleValue.toString():this.rangeValue=this.rangeMinValue.toString(),this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},n.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},n.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},n.prototype.createRangeInput=function(){this.rangeElement=this.getElement(),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}},n.prototype.updateRange=function(e){this.rangeElement.value=Math.round(100*e).toString(),this.rangeChange(!1)},n.prototype.onRangeChange=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},n.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},n}(r.View);i.View=s},{"../../EpubEvent":7,"./../panel/View":67}],74:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./View"),a=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return e.prototype.init=function(){var e=this;this.panel=new i.View(this.viewPanelParams),this.panel.init().then(function(){e.panel.onClick(e.zoomReset.bind(e))})},e.prototype.zoomReset=function(e){this.epubManager.zoomTo(0)},e}();n.Controller=a},{"./View":75}],75:[function(t,n,i){var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:!0});var r=t("./../panel/View"),o=t("../../EpubEvent"),s=function(t){function n(n){var i=t.call(this,n)||this;return i.params=n,i.path=e.Param.pathTemplate+"epub/component/zoomReset/index.html",i.dataSelect="zoom-reset",i.iconID="close-1-v4",i}return a(n,t),n.prototype.setView=function(){var e=this,n=[];n.push(t.prototype.setView.call(this)),n.push(this.loadTemplate(this.path,{})),n[1].then(function(t){e.element=t});var i=Promise.all(n);return i.then(function(){e.setElements()}),i},n.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},n.prototype.setElements=function(){this.epubEvent=new o.EpubEvent;var t=this.getElement();if(null!==t){var n=document.createElement("div");e.Utils.svgIcon(n,{icon:this.iconID,color:null}),t.innerHTML=n.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},n.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:0}})},n.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},n}(r.View);i.View=s},{"../../EpubEvent":7,"./../panel/View":67}],76:[function(e,t,n){function i(){function e(e,t){var i=n.prototype,a=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(e){return[].indexOf.call(document.querySelectorAll(e),this)!==-1};return a.call(e,t)}function t(t){for(var n;n=this.parentElement;)if(e(n,t))return n}var n=window.Element;n&&!n.prototype.closest&&(n.prototype.closest=t)}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=i},{}],77:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e("es6-promise");var i=function(){function e(){}return e}();i.GET="GET",i.get="GET",i.POST="POST",i.post="POST",n.Protocol=i;var a=function(){function e(e,t,n){void 0===e&&(e=i.GET),void 0===t&&(t=""),void 0===n&&(n=null),this.protocol=e,this.url=t,this.data=n,this.xhr=new XMLHttpRequest}return e.prototype.onreadystatechange=function(){if(4===this.xhr.readyState)return 404===this.xhr.status?void this.reject(this):void this.resolve(this.xhr)},e.prototype.executeur=function(e,t){this.resolve=e,this.reject=t,this.xhr.open(this.protocol,this.url,!0),this.xhr.onreadystatechange=this.onreadystatechange.bind(this),this.xhr.send(this.data)},e.prototype.init=function(){return new Promise(this.executeur.bind(this))},e}();n["default"]=a},{"es6-promise":1}],78:[function(e,t,n){function i(e){if(e.element.style.transitionDuration="0",e.optimizeQualityStat!==!0){var t=e.scale;e.optimizeQualityStat=!0,l[0]=t,l[3]=t,l[4]=e.x,l[5]=e.y,e.frameTimer2d=o.styleTransform(e.element,"matrix("+l.join(",")+")")}}function a(e,t,n,a,r){t=~~(1e3*t)/1e3,n=~~n,a=~~a,e.scale===t&&e.x===n&&e.y===a&&e.optimizeQualityStat===!0||(e.scale=t,e.x=n,e.y=a,e.matrix2d=e.matrix2d||i.bind(null,e),s[0]=t,s[5]=t,s[12]=n,s[13]=a,cancelAnimationFrame(e.frameTimer3d),e.frameTimer3d=o.styleTransform(e.element,"matrix3d("+s.join(",")+")",function(){e.element.style.transitionDuration=(r||"0")+"ms"}),e.optimizeQualityStat=!1,cancelAnimationFrame(e.frameTimer2d),clearTimeout(e.timer),e.optimizeQuality===!0&&(e.timer=setTimeout(e.matrix2d,100)))}function r(e,t,n,i,a){e.scale===t&&e.x===n&&e.y===i||(e.scale=t,e.x=n,e.y=i,e.element.style.cssText+="transition-duration:"+(a+"ms"||"0")+" ;transform: none; left: "+n/t+"px; top: "+i/t+"px; zoom: "+t+";",e.optimizeQualityStat=!1)}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./functions"),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[1,0,0,1,0,0];n.matrixDom3dAsync=a,n.positionDomAsync=r},{"./functions":80}],79:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i;!function(e){e[e.EPUB_HTML=0]="EPUB_HTML",e[e.PDF_HTML=1]="PDF_HTML",e[e.PDF_SVG=2]="PDF_SVG",e[e.PDF_IMG=3]="PDF_IMG",e[e.PDF_PDF=4]="PDF_PDF"}(i=n.READER_TYPES||(n.READER_TYPES={}));var a;!function(e){e[e.INIT=0]="INIT",e[e.START=1]="START",e[e.STOP=2]="STOP",e[e.FLUSH=3]="FLUSH"}(a=n.ShapeActivityStatus||(n.ShapeActivityStatus={}));var r;!function(e){e[e.blink=0]="blink",e[e["static"]=1]="static",e[e.none=2]="none",e[e.revealOnTap=3]="revealOnTap"}(r=n.LinksBehaviors||(n.LinksBehaviors={}));var o;!function(e){e[e.hdpi=0]="hdpi",e[e.mdpi=1]="mdpi",e[e.ldpi=2]="ldpi",e[e.svg=3]="svg"}(o=n.PagesImagesQualities||(n.PagesImagesQualities={}))},{}],80:[function(t,n,i){function a(e,t){void 0===t&&(t=1);var n=e.getBoundingClientRect();return{bottom:n.bottom*t,height:n.height*t,left:n.left*t,top:n.top*t,width:n.width*t}}function r(e){for(var t;t=e.lastChild;)e.removeChild(t)}function o(e){var t=e.tagName.toLowerCase();return"video"===t||"audio"===t}function s(){return e.Param.isPortrait=!(window.innerWidth>window.innerHeight),!e.Param.isPortrait}function l(){var e=window.innerHeight/document.documentElement.clientHeight*100;document.documentElement.style.height=e+"%"}function u(){var e={promise:null,resolve:null,reject:null,then:function(){}};e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n});var t=e.promise;return e.then=t.then.bind(t),e}Object.defineProperty(i,"__esModule",{value:!0}),i.getBoundingClientRect=a;var c=function(){var e="transform";return"transform"in document.body.style?e="transform":"webkitTransform"in document.body.style?e="webkitTransform":"msTransform"in document.body.style&&(e="msTransform"),function(t,n,i){return window.requestAnimationFrame(function(){i&&i(),t.style[e]=n})}}();i.styleTransform=c,i.htmlSecureRemoveChildren=r,i.isMediaElement=o,i.isWindowLandscape=s,i.resizeHTMLTagElement=l,i.getSplitedPromise=u},{}],81:[function(e,t,n){function i(e,t){var n=t.getBoundingClientRect(),i=(e.offsetWidth,e.offsetHeight),a=.2,r=n.height*a;n.width*a;return!(n.top>i-r||n.bottom<r)}Object.defineProperty(n,"__esModule",{value:!0}),n.isElementVisible=i},{}],82:[function(e,t,n){function i(e,t){var n,i,a,r,o=t.deltaX,s=t.deltaY,l=0,u=window.getComputedStyle(e),c=u.getPropertyValue("overflow"),p=["auto","visible","scroll"];if(0!==o?(l=o,n=u.getPropertyValue("overflow-x"),a=e.scrollWidth,r=e.offsetWidth,i=e.scrollLeft):0!==s&&(l=s,n=u.getPropertyValue("overflow-y"),a=e.scrollHeight,r=e.offsetHeight,i=e.scrollTop),(p.indexOf(c)!==-1||p.indexOf(n)!==-1)&&a>r){if(i>=0&&l>0&&i<a-r)return!0;if(i<=a-r&&l<0&&i>0)return!0}return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.isScrollable=i},{}]},{},[13])}(window.webpublicationNamespace||window.w);