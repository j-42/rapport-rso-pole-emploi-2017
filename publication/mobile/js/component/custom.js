"use strict";!function(e){function t(){return NIApi.page.getVisiblePages().then(function(t){if(0===t.length)return Promise.resolve({pages:"",isOffset:!0});var i=t.map(function(t){return e.Utils.byOffsetIndex(t)});return Promise.resolve({pages:i.join(" - "),isOffset:e.Utils.isOffsetIndex(t[t.length-1])})})}function i(){t().then(function(e){this.pageControlCurrent.innerHTML=e.pages,e.isOffset?this.pageControlOffsetHidden.style.display="none":this.pageControlOffsetHidden.style.display=""}.bind(this))}e.Class.TemplateManager.addComponent("menuItem-page_control",function(t){this.pageControl=this,this.pageControlCurrent=this.querySelector('[data-section="current"]'),this.pageControlTotal=this.querySelector('[data-section="total"]'),this.pageControlChanger=this.querySelector('[data-section="changer"]'),this.pageControlClose=this.querySelector('[data-section="close"]'),this.pageControlField=this.querySelector('[data-section="field"]'),this.pageControlOffsetHidden=this.querySelector('[data-section="offset-hidden"]'),this.pageControlOffsetHidden.style.display="none",document.body.appendChild(this.pageControlChanger),e.Param.newThemeVersion&&this.classList.add("webpub--v4"),this.addEventListener("click",function(){this.pageControlChanger.classList.add("webpub--active"),this.pageControlField.focus()}),this.pageControlChanger.addEventListener("click",function(e){e.target===this&&this.classList.remove("webpub--active")}),this.pageControlClose.addEventListener("click",function(e){this.pageControlChanger.classList.remove("webpub--active")}.bind(this)),this.pageControlField.addEventListener("keyup",function(){var t=parseInt(this.value,10);if(isNaN(t))return void(""!==this.value&&(this.value=this.value.replace(/[^0-9]+/g,"")));var i=parseInt(e.Main.xmlManager.get("common-configuration","config","shift"),10)||0,n=t+i,s=e.Utils.byOffsetIndex(e.Utils.prodTools.getPageLength());t>s?(this.value=s,n=s+i):this.value=t,NIApi.page.open(n)}),i.apply(this),NIApi.page.getCount().then(function(t){this.pageControlTotal.innerHTML=e.Utils.byOffsetIndex(t)}.bind(this)),NIApi.event.onPageChange(i.bind(this)),window.addEventListener(e.Param.eventResize,function(){window.setTimeout(i.bind(this),16)}.bind(this))})}(webpublicationNamespace);