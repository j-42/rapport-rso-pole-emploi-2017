var CSSJSON=new function(){var e=this;e.init=function(){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.repeat=function(e){return new Array(1+e).join(this)}},e.init();var t=/\/\*[\s\S]*?\*\//g,n=/([^\:]+):([^\;]*);/,o=/(\/\*[\s\S]*?\*\/)|([^\s\;\{\}][^\;\{\}]*(?=\{))|(\})|([^\;\{\}]+\;(?!\s*\*\/))/gim,s=1,r=2,a=3,u=4,h=function(e){return"undefined"==typeof e||0==e.length||null==e},p=function(e){return!h(e)&&(e.attributes&&e.children)};e.toJSON=function(p,l){var c={children:{},attributes:{}},f=null,d=0;if("undefined"==typeof l)var l={ordered:!1,comments:!1,stripComments:!1,split:!1};for(l.stripComments&&(l.comments=!1,p=p.replace(t,""));null!=(f=o.exec(p));)if(!h(f[s])&&l.comments){var m=f[s].trim();c[d++]=m}else if(h(f[r])){if(!h(f[a]))return c;if(!h(f[u])){var g=f[u].trim(),v=n.exec(g);if(v){var y=v[1].trim(),E=v[2].trim();if(l.ordered){var b={};b.name=y,b.value=E,b.type="attr",c[d++]=b}else if(y in c.attributes){var S=c.attributes[y];S instanceof Array||(c.attributes[y]=[S]),c.attributes[y].push(E)}else c.attributes[y]=E}else c[d++]=g}}else{var y=f[r].trim(),P=e.toJSON(p,l);if(l.ordered){var b={};b.name=y,b.value=P,b.type="rule",c[d++]=b}else{if(l.split)var _=y.split(",");else var _=[y];for(i in _){var T=_[i].trim();if(T in c.children)for(var w in P.attributes)c.children[T].attributes[w]=P.attributes[w];else c.children[T]=P}}}return c},e.toCSS=function(e,t,n){var o="";if("undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=!1),e.attributes)for(i in e.attributes){var s=e.attributes[i];if(s instanceof Array)for(var r=0;r<s.length;r++)o+=f(i,s[r],t);else o+=f(i,s,t)}if(e.children){var a=!0;for(i in e.children)n&&!a?o+="\n":a=!1,o+=d(i,e.children[i],t)}return o},e.toHEAD=function(t,i,n){var o=document.getElementsByTagName("head")[0],s=document.getElementById(i),r=null!==s&&s instanceof HTMLStyleElement;if(!h(t)&&o instanceof HTMLHeadElement){if(r){if(n!==!0&&!h(n))return;s.removeAttribute("id")}p(t)&&(t=e.toCSS(t));var a=document.createElement("style");if(a.type="text/css",h(i)?a.id="cssjson_"+c():a.id=i,a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),o.appendChild(a),l(a))r&&s.parentNode.removeChild(s);else{if(a.parentNode.removeChild(a),!r)return;s.setAttribute("id",i),a=s}return a}},"undefined"!=typeof window&&(window.createCSS=e.toHEAD);var l=function(e){return e instanceof HTMLStyleElement&&e.sheet.cssRules.length>0},c=function(){return Date.now()||+new Date},f=function(e,t,i){return"\t".repeat(i)+e+": "+t+";\n"},d=function(t,i,n){var o="\t".repeat(n)+t+" {\n";return o+=e.toCSS(i,n+1),o+="\t".repeat(n)+"}\n"}},Tween=function(){function e(){}e.create=function(){var e=null,t=null,i=null;return function(n,o){for(e=[],t=arguments.length,i=2;i<t;i++)e[i-2]=arguments[i];return function(){o.apply(n,[].concat(arguments,e))}}}();var t=function(e,t,i,n,o,s,r){this.init(e,t,i,n,o,s,r)},i=t.prototype;return i.obj={},i.prop="",i.func=function(e,t,i,n){return i*e/n+t},i.begin=0,i.change=0,i.prevTime=0,i.prevPos=0,i.looping=!1,i._duration=0,i._time=0,i._pos=0,i._position=0,i._startTime=0,i._finish=0,i.name="",i.suffixe="",i._listeners=[],i.setTime=function(e){this.prevTime=this._time,e>this.getDuration()?this.looping?(this.rewind(e-this._duration),this.update(),this.broadcastMessage("onMotionLooped",{target:this,type:"onMotionLooped"})):(this._time=this._duration,this.update(),this.stop(),this.broadcastMessage("onMotionFinished",{target:this,type:"onMotionFinished"})):e<0?(this.rewind(),this.update()):(this._time=e,this.update())},i.getTime=function(){return this._time},i.setDuration=function(e){this._duration=null==e||e<0?1e5:e},i.getDuration=function(){return this._duration},i.setPosition=function(){var e=null;return function(t){this.prevPos=this._pos,e=""!=this.suffixe?this.suffixe:"",this.obj[this.prop]=Math.round(t)+e,this._pos=t,this.broadcastMessage("onMotionChanged",{target:this,type:"onMotionChanged"})}}(),i.getPosition=function(e){return void 0==e&&(e=this._time),this.func(e,this.begin,this.change,this._duration)},i.setFinish=function(e){this.change=e-this.begin},i.getFinish=function(){return this.begin+this.change},i.init=function(e,t,i,n,o,s,r){arguments.length&&(this._listeners=new Array,this.addListener(this),r&&(this.suffixe=r),this.obj=e,this.prop=t,this.begin=n,this._pos=n,this.setDuration(s),null!=i&&""!=i&&(this.func=i),this.setFinish(o))},i.start=function(){this.rewind(),this.startEnterFrame(),this.broadcastMessage("onMotionStarted",{target:this,type:"onMotionStarted"})},i.rewind=function(e){this.stop(),this._time=void 0==e?0:e,this.fixTime(),this.update()},i.fforward=function(){this._time=this._duration,this.fixTime(),this.update()},i.update=function(){this.setPosition(this.getPosition(this._time))},i.startEnterFrame=function(){this.stopEnterFrame(),this.isPlaying=!0,this.onEnterFrame()},i.onEnterFrame=function(){this.isPlaying&&(this.nextFrame(),window.requestAnimationFrame(e.create(this,this.onEnterFrame)))},i.nextFrame=function(){this.setTime((this.getTimer()-this._startTime)/1e3)},i.stop=function(){this.stopEnterFrame(),this.broadcastMessage("onMotionStopped",{target:this,type:"onMotionStopped"})},i.stopEnterFrame=function(){this.isPlaying=!1},i.continueTo=function(e,t){this.begin=this._pos,this.setFinish(e),void 0!=this._duration&&this.setDuration(t),this.start()},i.resume=function(){this.fixTime(),this.startEnterFrame(),this.broadcastMessage("onMotionResumed",{target:this,type:"onMotionResumed"})},i.yoyo=function(){this.continueTo(this.begin,this._time)},i.addListener=function(e){return this.removeListener(e),this._listeners.push(e)},i.removeListener=function(){var e=null,t=null;return function(i){for(e=this._listeners,t=e.length;t--;)if(e[t]==i)return e.splice(t,1),!0;return!1}}(),i.broadcastMessage=function(){var e=null,t=null,i=null,n=null,o=null,s=null;return function(){for(e=[],t=s=arguments.length;s--;)e.push(arguments[t-(s+1)]);for(i=e.shift(),n=this._listeners,o=n.length;o--;)n[o][i]&&n[o][i].apply(n[o],e)}}(),i.fixTime=function(){this._startTime=this.getTimer()-1e3*this._time},i.getTimer=function(){return(new Date).getTime()-this._time},t.backEaseIn=function(e,t,i,n,o,s){if(void 0==r)var r=1.70158;return i*(e/=n)*e*((r+1)*e-r)+t},t.backEaseOut=function(e,t,i,n,o,s){if(void 0==r)var r=1.70158;return i*((e=e/n-1)*e*((r+1)*e+r)+1)+t},t.backEaseInOut=function(e,t,i,n,o,s){if(void 0==r)var r=1.70158;return(e/=n/2)<1?i/2*(e*e*(((r*=1.525)+1)*e-r))+t:i/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},t.elasticEaseIn=function(e,t,i,n,o,s){if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),!o||o<Math.abs(i)){o=i;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(i/o);return-(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s))+t},t.elasticEaseOut=function(e,t,i,n,o,s){if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),!o||o<Math.abs(i)){o=i;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(i/o);return o*Math.pow(2,-10*e)*Math.sin((e*n-r)*(2*Math.PI)/s)+i+t},t.elasticEaseInOut=function(e,t,i,n,o,s){if(0==e)return t;if(2==(e/=n/2))return t+i;if(!s)var s=n*(.3*1.5);if(!o||o<Math.abs(i))var o=i,r=s/4;else var r=s/(2*Math.PI)*Math.asin(i/o);return e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s))+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/s)*.5+i+t},t.bounceEaseOut=function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},t.bounceEaseIn=function(e,i,n,o){return n-t.bounceEaseOut(o-e,0,n,o)+i},t.bounceEaseInOut=function(e,i,n,o){return e<o/2?.5*t.bounceEaseIn(2*e,0,n,o)+i:.5*t.bounceEaseOut(2*e-o,0,n,o)+.5*n+i},t.strongEaseInOut=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},t.regularEaseIn=function(e,t,i,n){return i*(e/=n)*e+t},t.regularEaseOut=function(e,t,i,n){return-i*(e/=n)*(e-2)+t},t.regularEaseInOut=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},t.strongEaseIn=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},t.strongEaseOut=function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},t.strongEaseInOut=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},t}();!function e(t,i,n){function o(r,a){if(!i[r]){if(!t[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[r]={exports:{}};t[r][0].call(p.exports,function(e){var i=t[r][1][e];return o(i?i:e)},p,p.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(e,t,i){(function(n,o){!function(e,n){"object"==typeof i&&"undefined"!=typeof t?t.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(this,function(){"use strict";function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function i(e){return"function"==typeof e}function s(e){Y=e}function r(e){X=e}function a(){return function(){return n.nextTick(c)}}function u(){return"undefined"!=typeof W?function(){W(c)}:l()}function h(){var e=0,t=new K(c),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function p(){var e=new MessageChannel;return e.port1.onmessage=c,function(){return e.port2.postMessage(0)}}function l(){var e=setTimeout;return function(){return e(c,1)}}function c(){for(var e=0;e<Z;e+=2){var t=ee[e],i=ee[e+1];t(i),ee[e]=void 0,ee[e+1]=void 0}Z=0}function f(){try{var t=e,i=t("vertx");return W=i.runOnLoop||i.runOnContext,u()}catch(n){return l()}}function d(e,t){var i=this,n=new this.constructor(g);void 0===n[ie]&&N(n);var o=i._state;if(o){var s=arguments[o-1];X(function(){return x(o,n,s,i._result)})}else A(i,n,e,t);return n}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var i=new t(g);return T(i,e),i}function g(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function E(e){try{return e.then}catch(t){return re.error=t,re}}function b(e,t,i,n){try{e.call(t,i,n)}catch(o){return o}}function S(e,t,i){X(function(e){var n=!1,o=b(i,t,function(i){n||(n=!0,t!==i?T(e,i):M(e,i))},function(t){n||(n=!0,O(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&o&&(n=!0,O(e,o))},e)}function P(e,t){t._state===oe?M(e,t._result):t._state===se?O(e,t._result):A(t,void 0,function(t){return T(e,t)},function(t){return O(e,t)})}function _(e,t,n){t.constructor===e.constructor&&n===d&&t.constructor.resolve===m?P(e,t):n===re?(O(e,re.error),re.error=null):void 0===n?M(e,t):i(n)?S(e,t,n):M(e,t)}function T(e,i){e===i?O(e,v()):t(i)?_(e,i,E(i)):M(e,i)}function w(e){e._onerror&&e._onerror(e._result),C(e)}function M(e,t){e._state===ne&&(e._result=t,e._state=oe,0!==e._subscribers.length&&X(C,e))}function O(e,t){e._state===ne&&(e._state=se,e._result=t,X(w,e))}function A(e,t,i,n){var o=e._subscribers,s=o.length;e._onerror=null,o[s]=t,o[s+oe]=i,o[s+se]=n,0===s&&e._state&&X(C,e)}function C(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n=void 0,o=void 0,s=e._result,r=0;r<t.length;r+=3)n=t[r],o=t[r+i],n?x(i,n,o,s):o(s);e._subscribers.length=0}}function L(){this.error=null}function D(e,t){try{return e(t)}catch(i){return ae.error=i,ae}}function x(e,t,n,o){var s=i(n),r=void 0,a=void 0,u=void 0,h=void 0;if(s){if(r=D(n,o),r===ae?(h=!0,a=r.error,r.error=null):u=!0,t===r)return void O(t,y())}else r=o,u=!0;t._state!==ne||(s&&u?T(t,r):h?O(t,a):e===oe?M(t,r):e===se&&O(t,r))}function I(e,t){try{t(function(t){T(e,t)},function(t){O(e,t)})}catch(i){O(e,i)}}function R(){return ue++}function N(e){e[ie]=ue++,e._state=void 0,e._result=void 0,e._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function k(){return new Error("Array Methods must be provided an Array")}function V(e){return new he(this,e).promise}function G(e){var t=this;return new t(F(e)?function(i,n){for(var o=e.length,s=0;s<o;s++)t.resolve(e[s]).then(i,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,i=new t(g);return O(i,e),i}function z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function j(){var e=void 0;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=e.Promise;if(i){var n=null;try{n=Object.prototype.toString.call(i.resolve())}catch(t){}if("[object Promise]"===n&&!i.cast)return}e.Promise=pe}var H=void 0;H=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var F=H,Z=0,W=void 0,Y=void 0,X=function(e,t){ee[Z]=e,ee[Z+1]=t,Z+=2,2===Z&&(Y?Y(c):te())},q="undefined"!=typeof window?window:void 0,Q=q||{},K=Q.MutationObserver||Q.WebKitMutationObserver,J="undefined"==typeof self&&"undefined"!=typeof n&&"[object process]"==={}.toString.call(n),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ee=new Array(1e3),te=void 0;te=J?a():K?h():$?p():void 0===q&&"function"==typeof e?f():l();var ie=Math.random().toString(36).substring(16),ne=void 0,oe=1,se=2,re=new L,ae=new L,ue=0,he=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(g),this.promise[ie]||N(this.promise),F(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&M(this.promise,this._result))):O(this.promise,k())}return e.prototype._enumerate=function(e){for(var t=0;this._state===ne&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,n=i.resolve;if(n===m){var o=E(e);if(o===d&&e._state!==ne)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(i===pe){var s=new i(g);_(s,e,o),this._willSettleAt(s,t)}else this._willSettleAt(new i(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,i){var n=this.promise;n._state===ne&&(this._remaining--,e===se?O(n,i):this._result[t]=i),0===this._remaining&&M(n,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;A(e,void 0,function(e){return i._settledAt(oe,t,e)},function(e){return i._settledAt(se,t,e)})},e}(),pe=function(){function e(t){this[ie]=R(),this._result=this._state=void 0,this._subscribers=[],g!==t&&("function"!=typeof t&&z(),this instanceof e?I(this,t):U())}return e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(e){var t=this,i=t.constructor;return t.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){throw t})})},e}();return pe.prototype.then=d,pe.all=V,pe.race=G,pe.resolve=m,pe.reject=B,pe._setScheduler=s,pe._setAsap=r,pe._asap=X,pe.polyfill=j,pe.Promise=pe,pe})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,t,i){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function r(e){if(c===clearTimeout)return clearTimeout(e);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function a(){g&&d&&(g=!1,d.length?m=d.concat(m):v=-1,m.length&&u())}function u(){if(!g){var e=s(a);g=!0;for(var t=m.length;t;){for(d=m,m=[];++v<t;)d&&d[v].run();v=-1,t=m.length}d=null,g=!1,r(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}var l,c,f=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{c="function"==typeof clearTimeout?clearTimeout:o}catch(e){c=o}}();var d,m=[],g=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];m.push(new h(e,t)),1!==m.length||g||s(u)},h.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=p,f.addListener=p,f.once=p,f.off=p,f.removeListener=p,f.removeAllListeners=p,f.emit=p,f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],3:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./EpubConfig/EpubDefaultConfig"),s=e("./utils/enums"),r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.setConfig=function(t){e.prototype.setConfig.call(this,t),this.device=this.userAgent.device.type,this.browser=this.userAgent.browser.name,this.os=this.userAgent.os.name;var i="device_"+this.device,n="browser_"+this.browser,o="os_"+this.os;document.documentElement.classList.add("pagetype-"+s.READER_TYPES[this.readerPageSrcType].toLowerCase()),"function"==typeof this[i]&&this[i](),"function"==typeof this[n]&&this[n](),"function"==typeof this[o]&&this[o]()},t.prototype.device_phone=function(){},t.prototype.device_tab=function(){},t.prototype.device_desktop=function(){this.timeToRefreshScreenResize=0},t.prototype.browser_safari=function(){},t.prototype.browser_chrome=function(){},t.prototype.browser_firefox=function(){},t.prototype.browser_ie=function(){},t.prototype.browser_edge=function(){},t.prototype.browser_android=function(){},t.prototype.os_windows=function(){},t.prototype.os_mac=function(){},t.prototype.os_iOS=function(){},t.prototype.os_android=function(){},t}(o["default"]);i["default"]=r},{"./EpubConfig/EpubDefaultConfig":4,"./utils/enums":79}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../utils/enums"),o=e("../EpubEvent"),s=function(){function e(e){this.PAGESIZETYPES={CONTAIN:"contain",COVER_MIDDLE:"coverMiddle",COVER_TOP:"coverTop",COVER_HORIZONTALLY:"coverHorizontally",CUSTOM:"custom"},this._linksSizePageWidth=0,this._linksSizePageHeight=0,this._paddingBottom=0,this._paddingTop=0,this._paddingLeft=0,this._paddingRight=0,this._spreadsLength=3,this._pagesBySpread=2,this._pageQuantity=0,this._firstCoverPage=1,this._pageOnFirstFrame=1,this._pageSizeType=this.PAGESIZETYPES.CONTAIN,this._pageSizeMaxWidth=0,this._pageSizeMaxHeight=0,this._coverPageCenter=!1,this._currentPageAtInit=1,this.countPageChange=0,this._currentPage=1,this.lastPage=1,this.domMode="html",this._spreadDraggable=!0,this.highQualityKey="hdpi",this._linkBoxAspect=n.LinksBehaviors.blink,this._linkBlinkDuration=1e3,this._pdfHTMLMaxFontLoad=0,this.pageBgColor="#fff",this.pagesRetina=!0,this._verticalSlider=!1,this.timeToRefreshScreenResize=50,this.switchLandScapeUsingPageSize=!1,this.pagesBySpreadMax=2,this.pagesBySpreadUseApiPageManager=!1,this._zoomDoubleClick=!0,this._zoomSingleClick=!1,this.zoomPinch=!0,this.zoomRetina=!0,this._zoomFactor=.008,this._maxZoom=1,this.defaultPageScaleAt=.75,this.maxPageTotalScale=1.5,this._transitionTime=.2,this._useMatrixTransformZoomable=!0,this._useMatrixTransformScrollable=!0,this._enableAspLinks=!0,this._readerPageSrcType=n.READER_TYPES.EPUB_HTML,this._pageSizeTypeConf=(t={},t[this.PAGESIZETYPES.COVER_TOP]={switchablePageBySpread:!1},t[this.PAGESIZETYPES.COVER_MIDDLE]={switchablePageBySpread:!1},t[this.PAGESIZETYPES.COVER_HORIZONTALLY]={switchablePageBySpread:!0},t[this.PAGESIZETYPES.CONTAIN]={switchablePageBySpread:!0},t[this.PAGESIZETYPES.CUSTOM]={switchablePageBySpread:!0},t),this.mainViewElementClassName="webpub-viewer__epub-container",this.spreadViewElementClassName="webpub-viewer__epub-container-spread",this.zoomableViewElementClassName="webpub-viewer__epub-container-spread-zoomable";this._currentPageAtInit=~~(w.Main.urlManager.get("page")||this._currentPage),this.epubEvent=w.epubEvent,this.userAgent=w.Param.userAgent,this.pageMargin=[0,0,0,0],this.linksSizePageWidth=parseFloat(w.Main.xmlManager.get("common-configuration","contents","swf","width")),this.linksSizePageHeight=parseFloat(w.Main.xmlManager.get("common-configuration","contents","swf","height")),this.menuViewPageControlItems=w.Main.xmlManager.get("common-ui","panelViewControlItems");var t}return e.prototype.paddinigsUpdate=function(){var e=this.paddings;this.paddingLeft=~~e.paddingLeft+this.pageMargin[0],this.paddingTop=~~e.paddingTop+this.pageMargin[1],this.paddingRight=~~e.paddingRight+this.pageMargin[2],this.paddingBottom=~~e.paddingBottom+this.pageMargin[3]},Object.defineProperty(e.prototype,"paddings",{get:function(){return w.Main.viewerService.getPadding()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linksSizePageHeight",{get:function(){return this._linksSizePageHeight},set:function(e){this._linksSizePageHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linksSizePageWidth",{get:function(){return this._linksSizePageWidth/2},set:function(e){this._linksSizePageWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkBoxAspect",{get:function(){return this._linkBoxAspect},set:function(e){this._linkBoxAspect=n.LinksBehaviors[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkBlinkDuration",{get:function(){return this._linkBlinkDuration},set:function(e){this._linkBlinkDuration=e,this.addLinkStyleTags()},enumerable:!0,configurable:!0}),e.prototype.addLinkStyleTags=function(e){void 0===e&&(e="ms"),void 0===this.styleElement&&(this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement));var t=".webpub-viewer__epub-container .epub-links_container-link{-webkit-animation-duration: "+(this.linkBlinkDuration+e)+"!important;animation-duration: "+(this.linkBlinkDuration+e)+"!important;}";this.styleElement.type="text/css",this.styleElement.innerText=t},Object.defineProperty(e.prototype,"navigationType",{get:function(){return this.verticalSlider===!1?"x":"y"},set:function(e){"x"===e?this.verticalSlider=!1:this.verticalSlider=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalSlider",{get:function(){return this._verticalSlider},set:function(e){this._verticalSlider=e,this._verticalSlider?w.Param.viewMain.classList.add("webpub-viewer__container-vertical"):w.Param.viewMain.classList.remove("webpub-viewer__container-vertical")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this._pagesBySpread},set:function(e){this._pageSizeTypeConf[this._pageSizeType].switchablePageBySpread!==!1&&(this._pagesBySpread=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionTime",{get:function(){return this._transitionTime},set:function(e){isNaN(e)||(e=Math.max(e,1e-4),this._transitionTime=e||0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesInFrame",{get:function(){return this.pagesBySpread},set:function(e){this.pagesBySpread=e,this.pagesBySpreadMax=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this._pageQuantity},set:function(e){this._pageQuantity=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),1===this._firstCoverPage&&(e=~~(e/this.pagesBySpread)*this.pagesBySpread||1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPageNoAnimation",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),1===this._firstCoverPage&&(e=~~(e/this.pagesBySpread)*this.pagesBySpread||1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!1}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstCoverPage",{get:function(){return 1===this.pagesBySpread?0:this._firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coverPageCenter",{get:function(){return this._coverPageCenter},set:function(e){this._coverPageCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageOnFirstFrame",{get:function(){return this._pageOnFirstFrame},set:function(e){return this._pageOnFirstFrame=w.Main.pageLayoutService.get("pagesOnFirstFrame")||1,this._pageOnFirstFrame>1?void(this._firstCoverPage=0):void(this._firstCoverPage=1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransformZoomable",{get:function(){return this._useMatrixTransformZoomable},set:function(e){this._useMatrixTransformZoomable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxZoom",{get:function(){return this._maxZoom},set:function(e){this._maxZoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this._zoomFactor},set:function(e){this._zoomFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomDoubleClick",{get:function(){return this._zoomDoubleClick},set:function(e){this._zoomDoubleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this._zoomSingleClick},set:function(e){this._zoomSingleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"menuViewPageControlItems",{get:function(){return this._menuViewPageControlItems},set:function(e){this._menuViewPageControlItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransformScrollable",{get:function(){return this._useMatrixTransformScrollable},set:function(e){this._useMatrixTransformScrollable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadsLength",{get:function(){return this.pageQuantity<this._spreadsLength?this.pageQuantity:this._spreadsLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.ePubConfig.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.ePubConfig.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeType",{get:function(){return this._pageSizeType},set:function(e){for(var t in this.PAGESIZETYPES)if(this.PAGESIZETYPES[t]===e)return void(this._pageSizeType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeMaxWidth",{get:function(){return this._pageSizeMaxWidth},set:function(e){this._pageSizeMaxWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageMargin",{get:function(){return this._pageMargin},set:function(e){this._pageMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeMaxHeight",{get:function(){return this._pageSizeMaxHeight},set:function(e){this._pageSizeMaxHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this._readerPageSrcType},set:function(e){"string"==typeof e&&(e=n.READER_TYPES[e]),this._readerPageSrcType=n.READER_TYPES[e]?e:this.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableAspLinks",{get:function(){return this._enableAspLinks},set:function(e){this._enableAspLinks=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mustLoadEpubHtmlCss",{get:function(){return this.readerPageSrcType===n.READER_TYPES.EPUB_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mustLoadPdfHtmlCss",{get:function(){return this.readerPageSrcType===n.READER_TYPES.PDF_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this._spreadDraggable},set:function(e){this._spreadDraggable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this._pdfHTMLMaxFontLoad},set:function(e){this._pdfHTMLMaxFontLoad=e||0},enumerable:!0,configurable:!0}),e.prototype.checkEnableAspLinks=function(){switch(this.enableAspLinks=!1,this.readerPageSrcType){case n.READER_TYPES.PDF_SVG:this.enableAspLinks=!0;break;case n.READER_TYPES.PDF_HTML:this.enableAspLinks=!0;break;case n.READER_TYPES.PDF_IMG:this.enableAspLinks=!0;break;case n.READER_TYPES.PDF_PDF:this.enableAspLinks=!0}},e.prototype.updateConfigFromUrlData=function(){var e=w.Main.urlManager.get("reader-params");try{e=window.decodeURI(e),"undefined"!=typeof e&&this.setConfigLoc(new window.Function("return "+e)())}catch(t){}},e.prototype.setConfigLoc=function(e){var t="";for(t in e)"undefined"!=typeof this[t]&&(this[t]=e[t])},e.prototype.checkZoomLevel=function(){this.menuViewPageControlItems&&"true"===this.menuViewPageControlItems.enable&&w.Main.viewerService.get("zoom","max-scale")?(this.maxPageTotalScale=w.Main.viewerService.get("zoom","max-scale")/1.666,this.defaultPageScaleAt=this.maxPageTotalScale/2):w.Main.viewerService.get("zoom","max-scale")&&(this.maxPageTotalScale=this.defaultPageScaleAt=w.Main.viewerService.get("zoom","max-scale")/1.666)},e.prototype.setConfig=function(e){this.setConfigLoc(e),this.checkEnableAspLinks(),this.updateConfigFromUrlData(),this.checkZoomLevel(),this.ePubConfig instanceof Object==!1&&(this.ePubConfig={})},e}();i["default"]=s},{"../EpubEvent":7,"../utils/enums":79}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/XHRPromise"),o=e("./utils/XHRPromise"),s=function(){function e(e){this.config=e,this.parseCss=!0,this.shadowSelector="",this.urls=[],this.styles=[],this.fontList=[]}return Object.defineProperty(e.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this.config.pdfHTMLMaxFontLoad},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.onProgressPercentage=e;var i=window.document.querySelector(".force-font-load");this.setUrls();var n=this.load();return n.then(function(){t.appendStyle(),null===i&&(t.styles.forEach(function(e){t.parse(e)}),t.fontsLettersAppend()),t.clearUnNeeded()}),n},e.prototype.setUrls=function(){
var e;this.config.mustLoadEpubHtmlCss&&(e=w.Main.xmlManager.get("common-ui","assets","epub-idGeneratedStyles"),e&&(this.urls=this.urls.concat(w.Utils.resolveVariable(e.url).split(",")))),this.config.mustLoadPdfHtmlCss&&(e=w.Main.xmlManager.get("common-ui","assets","pdf-HTML-idGeneratedStyles"),e&&(this.urls=this.urls.concat(w.Utils.resolveVariable(e.url).split(","))))},e.prototype.load=function(){for(var e=this,t=[],i=0,s=this.urls.length;i<s;i++)t.push(new n["default"](o.Protocol.GET,this.urls[i]).init());return t.length?Promise.all(t).then(function(t){t.forEach(function(t){e.styles.push(t.responseText)})}):Promise.resolve()},e.prototype.parse=function(e){var t=CSSJSON.toJSON(e,{ordered:!0,comments:!1,stripComments:!1,split:!1}),i={};return this.cloneCssObject(t,i),e},e.prototype.cloneCssObject=function(e,t){var i;for(var n in e)isNaN(Number(n))||(i=this.shadowSelector,0===e[n].name.indexOf("@")&&(this.fontsExtractFromCssObject(e[n]),i=""),t[n]=t[n]||{},t[n].type=e[n].type,t[n].name=i+e[n].name,t[n].value=t[n].value||{},this.cloneCssObjectValues(e[n].value,t[n].value))},e.prototype.cloneCssObjectValues=function(e,t){for(var i in e)isNaN(Number(i))||this.cloneCssObject(t[i],e[i])},e.prototype.fontsExtractFromCssObject=function(e){if(0===e.name.indexOf("@font-face")){var t,i=e.value[1].value,n=i.match(/\([^)]*/gi);n&&(t=n[0].replace("(",""),this.fontList.push(e))}},e.prototype.fontsLettersAppend=function(){var e=[],t=document.createElement("div");t.className="force-font-load";for(var i=function(i,o){if(i>=n.pdfHTMLMaxFontLoad&&0!==n.pdfHTMLMaxFontLoad)return"break";var s=n.fontList[i].value,r=s[0].value,a=s[1].value,u=document.createElement("span");u.style.fontFamily=r,setTimeout(function(){t.appendChild(u)},100*i),e.push("@font-face {"),e.push("font-family: '"+r+"';"),e.push("src: "+a+";}")},n=this,o=0,s=this.fontList.length;o<s;o++){var r=i(o,s);if("break"===r)break}document.body.appendChild(t),this.fontFaces=e.join(" ")},e.prototype.appendStyle=function(){CSSJSON.toHEAD(this.styles.join("\n"))},e.prototype.clearUnNeeded=function(){this.urls=[],this.fontList=[],this.shadowSelector="",this.fontFaces=""},e.prototype.getStyleElement=function(e){return void 0===e&&(e=""),"<style>"+this.styles.join("")+e+"</style>"},e}();i.EpubCssManager=s},{"./utils/XHRPromise":77}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=e("./EpubEvent"),o=function(){function e(e,t){w.epubEvent=w.epubEvent||new n.EpubEvent,this.epubEvent=w.epubEvent,"string"==typeof e&&"object"==typeof t&&this.onFire(e,t)}return e.prototype.onFire=function(e,t){return this["allowed_"+e]&&this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:!0,action:this["allowed_"+e].bind(this,t)}}),!1},e.prototype.allowed_action=function(e,t){var i=this;t.then(function(){var n,o,s,r=e[1].trim();return 0===r.indexOf("http")?void i.allowed_url([null,r],t):0===r.indexOf("javascript")||0===r.indexOf("js:")||r.indexOf("js :")?void i.allowed_javascript([null,r],t):0===r.indexOf("NIApi")?void i.allowed_NIApi([null,r],t):(s=r.match(/^mailto:|^mailto :/gi),null!==s&&0!==s.length?void i.allowed_mailto([null,r],t):(n=/-([0-9]*).xhtml$/gim,o=n.exec(r)||[],void(o.length>0&&i.allowed_gotoPage([null,~~o[1]],t))))})},e.prototype.allowed_gotoPage=function(e,t){t.then(function(t){t===!0&&NIApi.page.open(e[1])})},e.prototype.allowed_nextPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openNext()})},e.prototype.allowed_prevPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openPrevious()})},e.prototype.allowed_lastPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openLast()})},e.prototype.allowed_firstPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openFirst()})},e.prototype.allowed_mailto=function(e,t){t.then(function(t){if(t===!0){var i=e[1].trim(),n="mailto:",o=i.match(/^mailto:|^mailto :/gi);null!==o&&0!==o.length&&(n=""),window.location.href=n+i}})},e.prototype.allowed_url=function(e,t){t.then(function(t){t===!0&&NIApi.navigator.openUrl(e[1])})},e.prototype.allowed_popup=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},e.prototype.allowed_lightbox=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},e.prototype.allowed_javascript=function(e,t){t.then(function(t){if(t===!0){var i,n=e[1].split(":");n.shift(),i=n.join(":").trim(),new Function(i)()}})},e.prototype.allowed_NIApi=function(e,t){t.then(function(t){if(t===!0){var i=e[1];new Function(i)()}})},e}();i.EpubDomApi=o;var s=new o,r=s.onFire.bind(s);i["default"]=r},{"./EpubEvent":7,"es6-promise":1}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.SCREEN_ORIENTATION=0]="SCREEN_ORIENTATION",e[e.PAGE_CHANGE=1]="PAGE_CHANGE",e[e.PAGE_ZOOM=2]="PAGE_ZOOM",e[e.PAGE_CLICK=3]="PAGE_CLICK",e[e.PAGE_CLICK_PERMISSION=4]="PAGE_CLICK_PERMISSION",e[e.PAGE_IN_DOM=5]="PAGE_IN_DOM",e[e.MOUSE_WHEEL=6]="MOUSE_WHEEL",e[e.ELEMENT_SCROLL=7]="ELEMENT_SCROLL",e[e.TOUCH_POINTERDOWN=8]="TOUCH_POINTERDOWN",e[e.TOUCH_POINTERCANCEL=9]="TOUCH_POINTERCANCEL",e[e.TOUCH_POINTERLEAVE=10]="TOUCH_POINTERLEAVE",e[e.TOUCH_POINTERUP=11]="TOUCH_POINTERUP",e[e.TOUCH_POINTERMOVE=12]="TOUCH_POINTERMOVE",e[e.ZOOM_CONTROLLER_RANGE=13]="ZOOM_CONTROLLER_RANGE",e[e.ZOOM_CONTROLLER_LEVEL_CLICK=14]="ZOOM_CONTROLLER_LEVEL_CLICK",e[e.FULLSCREEN_TOGGLE=15]="FULLSCREEN_TOGGLE",e[e.ADMIN_LINK_CREATE=16]="ADMIN_LINK_CREATE",e[e.ACTION_LINK_SUCCESS=17]="ACTION_LINK_SUCCESS"}(n=i.EPUB_EVENTS||(i.EPUB_EVENTS={}));var o=function(){function e(){this.listeners={},this.iName="EpubEvent"}return e.prototype.addListener=function(e,t){"string"==typeof e&&(e=n[e]),"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].indexOf(t)===-1&&this.listeners[e].push(t)},e.prototype.fire=function(e){var t,i,o,s=0,r=0;if(e.target||(e.target=this),e.context||(e.context=this),t=e.type,"string"==typeof e.type&&(t=e.type,t=n[t]),this.listeners[t]instanceof Array){i=this.listeners[t],o=[];var a=void 0;for(r=i.length;s<r;s++)o.push(i[s]);for(;a=o.shift();)i.indexOf(a)!==-1&&a(e)}},e.prototype.removeListener=function(e,t){var i,o=0,s=0;if("string"==typeof e&&(e=n[e]),this.listeners[e]instanceof Array)for(i=this.listeners[e],o=i.length;s<o;s++){if(null!==t&&i[s]===t){i.splice(s,1);break}null===t&&i.splice(s,1)}},e}();i.EpubEvent=o},{}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubGesturesEvent/Defs"),o=e("./EpubGesturesEvent/PointerEventsManager"),s=e("./EpubGesturesEvent/MouseWheelManager"),r=function(){function e(t,i){this.enableTouchPointer=!0,this.gestureEventList={},this.moveDifferer=n.getMoveDifferer(),this.gestureData=n.getGestureData(),this.preventDefaultOnMove=!1,this.wheelData=n.getWheelData(),this._enableScrollElement=!1,this._enableCheckMediaPreventDefault=!0,this.touchConvert=function(e,t){for(var i=t.length,n=0,o=0,s=0,r=0,a=0,u=0;u<i;u++)o+=t[u].clientX,s+=t[u].clientY,r=r||t[0].clientX,a=a||t[0].clientY,r-=t[u].clientX,a-=t[u].clientY,n+=this.touchConvert_getDistance(r,a),r=t[u].clientX,a=t[u].clientY;e.hypotenuse=n,e.epubClientX=o/i,e.epubClientY=s/i},this.userAgent=w.Param.userAgent,this.parent=t,this.element=i,this.element.epubGesturesEvent=this,this.resetMoveDiffererByKeyBinded=this.resetMoveDiffererByKey.bind(this),this.gestureID=Date.now().toString().concat("_UID_",(e.UID++).toString()),this.touchStart=this.touchStart.bind(this),this.touchEnd=this.touchEnd.bind(this),this.touchMove=this.touchMove.bind(this),this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.mouseMove=this.mouseMove.bind(this),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this),this.gestureEventList[e.GESTURESNAME.PINCHGESTURE]=[],this.gestureEventList[e.GESTURESNAME.PRESSGESTURE]=[],this.gestureEventList[e.GESTURESNAME.PANGESTURE]=[],this.gestureEventList[e.GESTURESNAME.TAPGESTURE]=[],this.gestureEventList[e.GESTURESNAME.DBLTAPGESTURE]=[],this.gestureEventList[e.GESTURESNAME.SWIPEGESTURE]=[],this.gestureEventList[e.GESTURESNAME.MOUSEWHEELGESTURE]=[],this.eventsStatus=e.EVENTSSTATUS.data,this.initEvent()}return Object.defineProperty(e.prototype,"enableScrollElement",{get:function(){return this._enableScrollElement},set:function(e){this._enableScrollElement=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCheckMediaPreventDefault",{get:function(){return this._enableCheckMediaPreventDefault},set:function(e){this._enableCheckMediaPreventDefault=e},enumerable:!0,configurable:!0}),e.prototype.initEvent=function(){var t=this;"android"!==this.userAgent.os.name&&this.enableTouchPointer===!0&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||"function"==typeof window.PointerEvent)?(this.pointerEventsManager=new o.PointerEventsManager(this,this.element),this.pointerEventsManager.addListenerDown(this.pointerDown),this.pointerEventsManager.addListenerUp(this.pointerUp),this.pointerEventsManager.addListenerMove(this.pointerMove)):"ontouchstart"in window?(this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHSTART,this.touchStart),this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHEND,this.touchEnd),this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHMOVE,this.touchMove)):(this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEDOWN,this.mouseDown),this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEUP,this.mouseUp),this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEMOVE,this.mouseMove),document.addEventListener("mouseup",function(e){t.mouseUpDoc(e)},!0)),this.mouseWheelManager=new s.MouseWheelManager(this.element),this.mouseWheelHandler=this.mouseWheelHandler.bind(this),this.onScroll=this.onScroll.bind(this),this.mouseWheelManager.addListeners(this.mouseWheelHandler,this.onScroll)},e.prototype.ePreventDefault=function(e){e.preventDefault()},e.prototype.mouseWheelHandler=function(t){var i=t.data,n=i.deltaX*this.wheelData.deltaX<0,o=i.deltaY*this.wheelData.deltaY<0;0===i.deltaX&&(n=!1),0===i.deltaY&&(o=!1),i.gestureData=this.gestureData,Math.abs(i.deltaX)>Math.abs(i.deltaY)?(n=!0,o=!1):Math.abs(i.deltaX)<Math.abs(i.deltaY)&&(n=!1,o=!0),this.gestureData.wheel.isX=n,this.gestureData.wheel.isY=o,this.callGestureEvent(e.GESTURESNAME.MOUSEWHEELGESTURE,i),this.wheelData.deltaX=i.deltaX||this.wheelData.deltaX,this.wheelData.deltaY=i.deltaY||this.wheelData.deltaY},e.prototype.onScroll=function(e){this.preventAllGesture()},e.prototype.mouseDown=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchStart(e)},e.prototype.mouseUpDoc=function(t){e._eventsStatus=this.eventsStatus;var i=this.getStat(e._eventsStatus,"start");i.stat!==!1&&(t.hypotenuse=0,t.epubClientX=t.clientX,t.epubClientY=t.clientY,this.onTouchEnd(t))},e.prototype.mouseUp=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchEnd(e)},e.prototype.mouseMove=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchMove(e)},e.prototype.touchStart=function(e){e.changedTouches.length>0&&this.resetMoveDifferer(),this.touchConvert(e,e.touches),this.onTouchStart(e)},e.prototype.touchEnd=function(e){return 0===e.touches.length?(this.touchConvert(e,e.changedTouches),void this.onTouchEnd(e)):void this.resetMoveDifferer()},e.prototype.touchMove=function(e){this.preventDefaultOnMove&&this.ePreventDefault(e),this.touchConvert(e,e.touches),this.onTouchMove(e)},e.prototype.pointerDown=function(e){var t=e.data.currentEvent,i=e.data.touches,n=e.data.changedTouches;n.length>0&&this.resetMoveDifferer(),this.touchConvert(t,i),this.onTouchStart(t)},e.prototype.pointerUp=function(e){var t=e.data.currentEvent,i=e.data.touches,n=e.data.changedTouches;return 0===i.length?(this.touchConvert(t,n),void this.onTouchEnd(t)):void this.resetMoveDifferer()},e.prototype.pointerMove=function(e){var t=e.data.currentEvent,i=e.data.touches;this.preventDefaultOnMove&&this.ePreventDefault(t),this.touchConvert(t,i),this.onTouchMove(t)},e.prototype.overrideEventData=function(e,t,i,n,o,s,r,a,u,h,p,l,c){this.gestureData.resetAxis=this.resetMoveDiffererByKeyBinded,this.gestureData.type=t,this.gestureData.pinchZoomDiff=p,this.gestureData.x.pointDiff=i,this.gestureData.x.vectorDiff=o,this.gestureData.x.countDiff=r,this.gestureData.x.isVector=u,this.gestureData.x.client=l,this.gestureData.y.pointDiff=n,this.gestureData.y.vectorDiff=s,this.gestureData.y.countDiff=a,this.gestureData.y.isVector=h,this.gestureData.y.client=c,e.gestureData=this.gestureData},e.clearGlobalTapGestureTimer=function(){for(var t=e.globalTapGestureTimer.length,i=0;i<t;i++)clearTimeout(e.globalTapGestureTimer[i]);e.globalTapGestureTimer=[]},e.prototype.callGestureEvent=function(e,t,i){for(var n=this.gestureEventList[e].length,o=0;o<n;o++)this.gestureEventList[e][o](t,i)},e.prototype.touchConvert_getDistance=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},e.prototype.getStat=function(e,t){return e[t]},e.prototype.setStat=function(t,i,n,o){e.lastTime=o,t[i].stat=n;var s=n?"true":"false";t[i].lastTime=t[i].time,t[i].time=o,t[i][s]=t[i][s],t[i][s].lastTime=t[i][s].time,t[i][s].time=o,clearTimeout(t[i].timer)},e.prototype.setMoveDifferer=function(t){return this.moveDifferer.x.count=this.moveDifferer.x.count||t.epubClientX,this.moveDifferer.x.countDiff+=Math.abs(t.epubClientX-this.moveDifferer.x.count),this.moveDifferer.x.count=t.epubClientX,this.moveDifferer.y.count=this.moveDifferer.y.count||t.epubClientY,this.moveDifferer.y.countDiff+=Math.abs(t.epubClientY-this.moveDifferer.y.count),this.moveDifferer.y.count=t.epubClientY,this.moveDifferer.hypotenuse=this.moveDifferer.hypotenuse||t.hypotenuse,this.moveDifferer.hypotenuseDiff=t.hypotenuse-this.moveDifferer.hypotenuse,this.moveDifferer.hypotenuse=t.hypotenuse,!(this.moveDifferer.x.countDiff<e.STARTMOVEAT&&this.moveDifferer.y.countDiff<e.STARTMOVEAT&&0===this.moveDifferer.hypotenuseDiff)&&(this.moveDifferer.x.pos=this.moveDifferer.x.pos||t.epubClientX,this.moveDifferer.x.diff=t.epubClientX-this.moveDifferer.x.pos,this.moveDifferer.x.vector=this.moveDifferer.x.vector||t.epubClientX,Math.abs(t.epubClientX-this.moveDifferer.x.vector)<Math.abs(this.moveDifferer.x.vectorDiff)&&(this.moveDifferer.x.vector=t.epubClientX),this.moveDifferer.y.pos=this.moveDifferer.y.pos||t.epubClientY,this.moveDifferer.y.diff=t.epubClientY-this.moveDifferer.y.pos,this.moveDifferer.y.vector=this.moveDifferer.y.vector||t.epubClientY,Math.abs(t.epubClientY-this.moveDifferer.y.vector)<Math.abs(this.moveDifferer.y.vectorDiff)&&(this.moveDifferer.y.vector=t.epubClientY),this.moveDifferer.x.vectorDiff=t.epubClientX-this.moveDifferer.x.vector,this.moveDifferer.y.vectorDiff=t.epubClientY-this.moveDifferer.y.vector,!0)},e.prototype.resetMoveDiffererByKey=function(e){this.moveDifferer[e].diff=0,this.moveDifferer[e].count=0,this.moveDifferer[e].countDiff=0,this.moveDifferer[e].pos=0,this.moveDifferer[e].vector=0,this.moveDifferer[e].vectorDiff=0,this.moveDifferer.hypotenuseDiff=0,this.moveDifferer.hypotenuse=0},e.prototype.resetMoveDifferer=function(){this.resetMoveDiffererByKey("x"),this.resetMoveDiffererByKey("y")},e.prototype.resetStat=function(){this.eventsStatus=e.EVENTSSTATUS.data},e.prototype.onTouchStart=function(t){e._eventsStatus=this.eventsStatus;var i=this.getStat(e._eventsStatus,"start");i.stat!==!0&&(this.resetMoveDifferer(),this.setStat(e._eventsStatus,"start",!0,Date.now()),this.setStat(e._eventsStatus,"end",!1,e.lastTime),this.setStat(e._eventsStatus,"move",!1,e.lastTime),this.defineGesture(t,"start"))},e.prototype.onTouchEnd=function(t){e._eventsStatus=this.eventsStatus,this.setStat(e._eventsStatus,"start",!1,Date.now()),this.setStat(e._eventsStatus,"end",!0,e.lastTime),this.defineGesture(t,"end"),this.resetMoveDifferer()},e.prototype.onTouchMove=function(t){e._eventsStatus=this.eventsStatus,this.setStat(e._eventsStatus,"move",!1,Date.now());var i=this.getStat(e._eventsStatus,"start");if(i.stat===!0&&this.getStat(e._eventsStatus,"end").stat===!1){this.checkMediaPreventDefault(t);var n=this.setMoveDifferer(t);n===!0&&(e.clearGlobalTapGestureTimer(),this.setStat(e._eventsStatus,"move",!0,e.lastTime),this.defineGesture(t,"move"))}},e.prototype.checkMediaPreventDefault=function(e){if(this.enableCheckMediaPreventDefault!==!1){var t=e.target,i=t.tagName;if(void 0===i)return void(this.scrollableElement()===!1&&this.ePreventDefault(e));i=i.toLowerCase(),"video"!==i&&"audio"!==i&&this.scrollableElement()===!1&&this.ePreventDefault(e)}},e.prototype.tapGesture=function(t,i){var n=this;if("end"!==i)return!1;e._eventsStatus=this.eventsStatus;var o=this.getStat(e._eventsStatus,"start"),s=this.getStat(e._eventsStatus,"end"),r=this.getStat(e._eventsStatus,"move");return r.stat===!1&&s.stat===!0&&0!==o.lastTime&&(t.defaultPreventGesture===!0?e.clearGlobalTapGestureTimer():clearTimeout(o.timer),this.overrideEventData(t,e.GESTURESNAME.TAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),o.timer=setTimeout(function(){n.callGestureEvent(e.GESTURESNAME.TAPGESTURE,t)},e.TAPTIME),e.globalTapGestureTimer.push(o.timer)),!1},e.prototype.dblTapGesture=function(t,i){if("end"!==i)return!1;e._eventsStatus=this.eventsStatus;var n=this.getStat(e._eventsStatus,"start"),o=this.getStat(e._eventsStatus,"end"),s=this.getStat(e._eventsStatus,"move");return s.stat===!1&&o["true"].time-n["true"].lastTime<e.DBLTAPTIME&&(e.clearGlobalTapGestureTimer(),this.overrideEventData(t,e.GESTURESNAME.DBLTAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.panGesture=function(t,i){if("end"===i||"start"===i)return!1;e._eventsStatus=this.eventsStatus;var n=this.getStat(e._eventsStatus,"move");return n.stat!==!1&&(this.ePreventDefault(t),this.overrideEventData(t,e.GESTURESNAME.PANGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.pinchGesture=function(e){},e.prototype.pressGesture=function(e){},e.prototype.neutralSwipeGesture=function(t){return(0!==this.moveDifferer.x.vectorDiff||0!==this.moveDifferer.y.vectorDiff)&&(this.ePreventDefault(t),this.overrideEventData(t,e.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.swipeGesture=function(t){e._eventsStatus=this.eventsStatus;var i=!1,n=!1,o=this.getStat(e._eventsStatus,"start"),s=this.getStat(e._eventsStatus,"end"),r=this.getStat(e._eventsStatus,"move");return r.stat!==!1&&s.stat!==!1&&(i=Math.abs(this.moveDifferer.x.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS,i===!1&&(i=Math.abs(this.moveDifferer.x.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS_IN_TIME&&s.time-o.lastTime<=e.SWIPEGESTURE_AT_TIME),n=Math.abs(this.moveDifferer.y.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS,n===!1&&(n=Math.abs(this.moveDifferer.y.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS_IN_TIME&&s.lastTime-o.lastTime<=e.SWIPEGESTURE_AT_TIME),i===!1&&n===!1?this.neutralSwipeGesture(t):(this.overrideEventData(t,e.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,i,n,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0))},e.prototype.defineGesture=function(t,i){if(t.defaultPreventGesture===!0||e.PREVENT_ALL===!0)return this.resetStat(),this.resetMoveDifferer(),void e.clearGlobalTapGestureTimer();e._eventsStatus=this.eventsStatus;this.getStat(e._eventsStatus,"start");return this.dblTapGesture(t,i)===!0?(this.callGestureEvent(e.GESTURESNAME.DBLTAPGESTURE,t),void e.clearGlobalTapGestureTimer()):(this.tapGesture(t,i)===!0,this.swipeGesture(t)===!0?(this.callGestureEvent(e.GESTURESNAME.SWIPEGESTURE,t),void((t.defaultPreventGesture===!0||e.PREVENT_ALL)&&e.clearGlobalTapGestureTimer())):this.panGesture(t,i)===!0?(this.callGestureEvent(e.GESTURESNAME.PANGESTURE,t),void((t.defaultPreventGesture===!0||e.PREVENT_ALL)&&e.clearGlobalTapGestureTimer())):void 0)},e.prototype.setEnableScrollElement=function(e){this.enableScrollElement=e},e.prototype.setEnableCheckMediaPreventDefault=function(e){this.enableCheckMediaPreventDefault=e},e.prototype.scrollableElement=function(){return this.enableScrollElement!==!1&&null!==this.element.parentElement},e.prototype.preventAllGesture_reset=function(){e.PREVENT_ALL=!1},e.preventAllGestureStatus=function(){return e.PREVENT_ALL},e.prototype.preventAllGesture=function(){clearTimeout(e.timer),e.PREVENT_ALL=!0,e.timer=setTimeout(this.preventAllGesture_reset,100)},e.prototype.addEventListener=function(e,t){var i="gesture_".concat(e,"_",this.gestureID);return"undefined"==typeof t[i]&&(t[i]=!0,this.gestureEventList[e].push(t),!0)},e.prototype.removeEventListener=function(e,t){var i="gesture_".concat(e,"_",this.gestureID);if("undefined"==typeof t[i])return!1;for(var n=0,o=this.gestureEventList[e].length;n<o;n++)if(void 0!==this.gestureEventList[e][n][i])return this.gestureEventList[e][n][i]=null,delete this.gestureEventList[e][n][i],!0;return!1},e.prototype.resetMoveXDifferer=function(){this.resetMoveDiffererByKey("x")},e.prototype.resetMoveYDifferer=function(){this.resetMoveDiffererByKey("y")},e}();r.EVENTSTYPE=n.getEventsType(),r.UID=0,r.DBLTAPTIME=500,r.TAPTIME=300,r.PREVENT_ALL=!1,r.STARTMOVEAT=10,r.SWIPEGESTURE_AT_TIME=200,r.SWIPEGESTURE_AT_PIXELS_IN_TIME=7,r.SWIPEGESTURE_AT_PIXELS=50,r.EVENTSSTATUS={get data(){return n.getEpubEventStatusManager()}},r.lastTime=0,r.globalTapGestureTimer=[],r.timer=0,r.GESTURESNAME=n.getGesturesName(),i["default"]=r},{"./EpubGesturesEvent/Defs":9,"./EpubGesturesEvent/MouseWheelManager":11,"./EpubGesturesEvent/PointerEventsManager":12}],9:[function(e,t,i){"use strict";function n(){return{stat:!1,time:0,lastTime:0,timere:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0}}}function o(){return{start:n(),end:n(),move:n()}}function s(){return{MOUSE:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove"},TOUCH:{TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove"},MSPOINTER:{POINTERDOWN:"MSPointerDown",POINTERCANCEL:"MSPointerCancel",POINTERLEAVE:"MSPointerLeave",POINTERUP:"MSPointerUp",POINTERMOVE:"MSPointerMove"},POINTER:{POINTERDOWN:"pointerdown",POINTERCANCEL:"pointercancel",POINTERLEAVE:"pointerleave",POINTERUP:"pointerup",POINTERMOVE:"pointermove"},MOUSEWHEEL:"mousewheel",WHEEL:"wheel",DOMMOUSESCROLL:"DOMMouseScroll"}}function r(){return{PINCHGESTURE:"pinchGesture",PRESSGESTURE:"pressGesture",PANGESTURE:"panGesture",TAPGESTURE:"tapGesture",DBLTAPGESTURE:"dblTapGesture",SWIPEGESTURE:"swipeGesture",MOUSEWHEELGESTURE:"mouseWheelGesture"}}function a(){return{x:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},y:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},hypotenuse:0,hypotenuseDiff:0}}function u(){return{type:"",pinchZoomDiff:0,wheel:{isX:!1,isY:!1},x:{point:0,vectorDiff:0,client:0,isVector:!1},y:{point:0,vectorDiff:0,client:0,isVector:!1}}}function h(){return{timerID:0,currentTime:0,deltaX:0,deltaY:0}}Object.defineProperty(i,"__esModule",{value:!0}),i.getEpubEventStatus=n,i.getEpubEventStatusManager=o,i.getEventsType=s,i.getGesturesName=r,i.getMoveDifferer=a,i.getGestureData=u,i.getWheelData=h},{}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){this.element=e,this.config=t,this.enableKeyBoard=!0,this.isMouseenter=!0,this.spreadDraggable&&(this.keyUp=this.keyUpPre.bind(this),this.element.setAttribute("tabindex","1"),this.setEvents())}return Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),e.prototype.setEvents=function(){var e=this;window.addEventListener("keyup",this.keyUp),this.element.addEventListener("mouseenter",function(t){e.isMouseenter=!0}),this.element.addEventListener("mouseleave",function(t){e.isMouseenter=!1})},e.prototype.isEditableElement=function(){var e=document.activeElement;if(null!==e&&"false"!==e.getAttribute("contenteditable")){var t=e.tagName.toLowerCase();if("input"===t||"textarea"===t||"true"===e.getAttribute("contenteditable"))return!0}return!1},e.prototype.keyUpPre=function(e){var t=e.key||e.keyIdentifier;if(this.element===document.activeElement||this.isMouseenter!==!1&&(this.isEditableElement()!==!0||document.hasFocus()!==!0))switch(t){case"ArrowLeft":this.pagePrevious();break;case"ArrowUp":this.pagePrevious();break;case"ArrowRight":this.pageNext();break;case"ArrowDown":this.pageNext();break;case"Left":this.pagePrevious();break;case"Up":this.pagePrevious();break;case"Right":this.pageNext();break;case"Down":this.pageNext()}},e.prototype.pageNext=function(){NIApi.page.openNext()},e.prototype.pagePrevious=function(){NIApi.page.openPrevious()},e}();i.EpubKeyBoardEvent=n},{}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubGesturesEvent/Defs"),o=e("../EpubEvent"),s=0,r=function(){function e(t){this.element=t,this.scrollDelay=400,this.scrollTimer=0,this.simpleScrollTimer=0,this.lastSentWheelTimestamp=0,this.lastHighWheelTimestamp=0,this.previousHighWheelTimestamp=0,this.wheelDirection=0,this.index=s++,this.browserName=w.Param.userAgent.browser.name,this.epubEvent=new o.EpubEvent,this.initWindowScroll();var i="WheelEvent"in window?e.EVENTSTYPE.WHEEL:e.EVENTSTYPE.MOUSEWHEEL;this.element.addEventListener(i,this.mouseWheelHandler.bind(this),!1)}return e.prototype.addListeners=function(e,t){this.epubEvent.addListener(o.EPUB_EVENTS.MOUSE_WHEEL,e),this.epubEvent.addListener(o.EPUB_EVENTS.ELEMENT_SCROLL,t)},e.prototype.removeListeners=function(e,t){this.epubEvent.removeListener(o.EPUB_EVENTS.MOUSE_WHEEL,e),this.epubEvent.removeListener(o.EPUB_EVENTS.ELEMENT_SCROLL,t)},e.prototype.initWindowScroll=function(){var t=this;e.windowScrollInit!==!0&&(e.windowScrollInit=!0,window.addEventListener("scroll",function(i){e.windowScrollStatus=!0,t.dispatchEventsScroll(i),clearTimeout(t.scrollTimer),t.scrollTimer=setTimeout(function(){e.windowScrollStatus=!1},t.scrollDelay)},!0))},e.prototype.dispatchEventsScroll=function(e){clearTimeout(this.simpleScrollTimer),this.epubEvent.fire({type:o.EPUB_EVENTS.ELEMENT_SCROLL,data:e})},e.prototype.mouseWheelHandler=function(e){if(!this.isWheelDeltaTooLow(e))return this.updateHighWheelTimestamp(),this.isWheelDirectionChanged(e)?void this.sendWheelEvent(e):this.isNewWheelSwipe()?void this.sendWheelEvent(e):void(this.isWheelTimestampTooClose()||this.sendWheelEvent(e))},e.prototype.isWheelDeltaTooLow=function(e){var t=110,i=this.getWheelDelta(e),n=0===e.deltaMode;return n&&Math.abs(i)<=t},e.prototype.getWheelDelta=function(e){var t=Math.abs(e.wheelDelta);return this.browserName===w.Param.userAgent.BROWSER.FIREFOX&&(t=e.deltaX,Math.abs(e.deltaY)>=Math.abs(e.deltaX)&&(t=e.deltaY)),t},e.prototype.isNewWheelSwipe=function(){var e=800,t=Date.now()-this.lastSentWheelTimestamp;return t>e},e.prototype.isWheelDirectionChanged=function(e){var t=this.wheelDirection;return this.wheelDirection=this.getWheelDirection(e),this.wheelDirection!==t},e.prototype.getWheelDirection=function(e){return e.wheelDelta>0?1:e.wheelDelta<0?-1:0},e.prototype.updateHighWheelTimestamp=function(){this.previousHighWheelTimestamp=this.lastHighWheelTimestamp,this.lastHighWheelTimestamp=Date.now()},e.prototype.isWheelTimestampTooClose=function(){var e=200,t=this.lastHighWheelTimestamp-this.previousHighWheelTimestamp;return t<e},e.prototype.sendWheelEvent=function(e){this.lastSentWheelTimestamp=Date.now(),this.dispatchEventsWheel(e)},e.prototype.dispatchEventsWheel=function(e){this.epubEvent.fire({type:o.EPUB_EVENTS.MOUSE_WHEEL,data:e})},e}();r.windowScrollInit=!1,r.windowMouseWheelInit=!1,r.windowScrollStatus=!1,r.EVENTSTYPE=n.getEventsType(),r.GESTURESNAME=n.getGesturesName(),i.MouseWheelManager=r},{"../EpubEvent":7,"../EpubGesturesEvent/Defs":9}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubGesturesEvent/Defs"),o=e("../EpubEvent"),s=function(){function e(e,t){this.epubGesturesEvent=e,this.element=t,this.msPointer="POINTER",this.EVENTSTYPE=n.getEventsType(),this.listeners={},this.touches=[],this.touchesMove=[],this.pointerDown=this._pointerDown.bind(this),this.pointerUp=this._pointerUp.bind(this),this.pointerCancel=this._pointerCancel.bind(this),this.pointerMove=this._pointerMove.bind(this),this.epubEvent=new o.EpubEvent,this.definePointerType()}return e.prototype.definePointerType=function(){navigator.msMaxTouchPoints>0&&(this.msPointer="MSPOINTER"),document.addEventListener(this.EVENTSTYPE.MOUSE.MOUSELEAVE,this.pointerCancel,!1),document.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERMOVE,this.pointerMove,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERDOWN,this.pointerDown,!1),this.element.addEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1)},e.prototype.registeredTouchIndex=function(e,t){for(var i=0,n=t.length;i<n;i++)if(e.pointerId===t[i].pointerId)return i;return-1},e.prototype.unRegisterTouch=function(e,t){var i=this.registeredTouchIndex(e,t);return i!==-1&&(t.splice(i,1),!0)},e.prototype.registerTouch=function(e,t){var i=this.registeredTouchIndex(e,t);return i!==-1?void(t[i]=e):void t.push(e)},e.prototype._pointerDown=function(e){this.registerTouch(e,this.touches),this.epubEvent.fire({type:o.EPUB_EVENTS.TOUCH_POINTERDOWN,data:{currentEvent:e,touches:this.touches,changedTouches:[e]}})},e.prototype._pointerCancel=function(e){for(var t=0,i=this.touches.length;t<i;t++)this.pointerUp(this.touches[t]);for(var t=0,i=this.touchesMove.length;t<i;t++)this.pointerUp(this.touchesMove[t])},e.prototype._pointerUp=function(e){this.unRegisterTouch(e,this.touchesMove),this.unRegisterTouch(e,this.touches)!==!1&&this.epubEvent.fire({type:o.EPUB_EVENTS.TOUCH_POINTERUP,data:{currentEvent:e,touches:this.touches,changedTouches:[e]}})},e.prototype._pointerMove=function(e){0!==this.touches.length&&(this.registerTouch(e,this.touchesMove),this.epubEvent.fire({type:o.EPUB_EVENTS.TOUCH_POINTERMOVE,data:{currentEvent:e,touches:this.touchesMove,changedTouches:[]}}))},e.prototype.addListener=function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=t,this.epubEvent.addListener(e,t))},e.prototype.removeListeners=function(){for(var e in this.listeners)this.epubEvent.removeListener(~~e,this.listeners[e]);document.removeEventListener(this.EVENTSTYPE.MOUSE.MOUSELEAVE,this.pointerCancel,!1),document.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERMOVE,this.pointerMove,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERDOWN,this.pointerDown,!1),this.element.removeEventListener(this.EVENTSTYPE[this.msPointer].POINTERUP,this.pointerUp,!1)},e.prototype.addListenerDown=function(e){this.addListener(o.EPUB_EVENTS.TOUCH_POINTERDOWN,e)},e.prototype.addListenerUp=function(e){this.addListener(o.EPUB_EVENTS.TOUCH_POINTERUP,e)},e.prototype.addListenerMove=function(e){this.addListener(o.EPUB_EVENTS.TOUCH_POINTERMOVE,e)},e.prototype.flush=function(){this.removeListeners()},e}();i.PointerEventsManager=s},{"../EpubEvent":7,"../EpubGesturesEvent/Defs":9
}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubManager"),o=e("./EpubDomApi"),s=e("./polyfill/closest");s["default"]();var r;!function(e){var t=function(){function e(){w.EpubDomApi=o["default"],w.Class.EpubManager=n["default"]}return e}();e.EpubMain=t}(r||(r={})),new r.EpubMain},{"./EpubDomApi":6,"./EpubManager":14,"./polyfill/closest":76}],14:[function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{u(n.next(e))}catch(t){s(t)}}function a(e){try{u(n["throw"](e))}catch(t){s(t)}}function u(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(r,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(r=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(s,i[1])).done)return r;switch(s=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,s=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(n){i=[6,n],s=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,s,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return{next:i(0),"throw":i(1),"return":i(2)}};Object.defineProperty(i,"__esModule",{value:!0});var s=e("./EpubConfig"),r=e("./EpubCssManager"),a=e("./EpubNavigationTypeManager"),u=e("./EpubSpreads"),h=e("./EpubStatistics"),p=e("./components/pageControl/Controller"),l=e("./EpubEvent"),c=e("./EpubGesturesEvent/EpubKeyBoardEvent"),f=e("./utils/functions"),d=e("./utils/isScrollable"),m=function(){function e(e,t){this.parent=e,this.viewMain=t,this.epubMode=!0,this.screenSize={width:0,height:0,ratio:0},this.goToPage=function(e,t){void 0===t&&(t=!0),t?this.currentPage=e:this.currentPageNoAnimation=e},this.userInteractions(!1),w.epubEvent=w.epubEvent||new l.EpubEvent,this.epubEvent=w.epubEvent,this.config=new s["default"](this),this.epubStatistics=new h.EpubStatistics(this),this.registerApi(),this.iniListeners()}return Object.defineProperty(e.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationType",{get:function(){return this.config.navigationType},set:function(e){this.config.navigationType=e,this.epubSpreads.updateSpreads(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionTime",{get:function(){return this.config.transitionTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},set:function(e){this.config.currentPage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPageNoAnimation",{get:function(){return this.config.currentPageNoAnimation},set:function(e){this.config.currentPageNoAnimation=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},set:function(e){if(e!==this.config.pagesBySpread){if(this.config.pagesBySpread=e,void 0===this.epubSpreads)return;this.epubSpreads.updateSpreads(0)}},enumerable:!0,configurable:!0}),e.prototype.registerApi=function(){var e=this;NIApi.register("page.openNext",function(){return e.pageNext(),Promise.resolve()}),NIApi.register("page.openPrevious",function(){return e.pagePrevious(),Promise.resolve()}),NIApi.register("page.openFirst",function(){return e.pageFirst(),Promise.resolve()}),NIApi.register("page.openLast",function(){return e.pageLast(),Promise.resolve()}),NIApi.register("page.open",function(t){return e.goToPage(t),Promise.resolve()})},e.prototype.isFocusable=function(){var e,t,i=document.activeElement;return!i||(e=i.readOnly,t=i.getAttribute("contenteditable"),e!==!1&&"true"!==t)},e.prototype.focusOn=function(){this.isFocusable()===!0&&this.epubSpreads.getMainViewElement().focus()},e.prototype.iniListeners=function(){var e=this;this.epubEvent.addListener(l.EPUB_EVENTS.PAGE_CLICK,function(t){e.toggleMenu()}),this.epubEvent.addListener(l.EPUB_EVENTS.PAGE_CHANGE,function(t){void 0!==e.epubSpreads&&(t.data.useAnimationTime===!1?e.epubSpreads.updateSpreads(0):e.epubSpreads.updateSpreads(e.transitionTime),w.Main.pageManager.set(e.currentPage),w.Main.pagesLoaderNew.setCurrentPage(e.currentPage),e.setDocumentPagesAttributes(),e.focusOn(),setTimeout(function(){e.focusOn()},200))}),w.Main.pageManager.onChange(function(t){t=~~t,e.currentPage!==t&&e.goToPage(t)}),this.epubEvent.addListener(l.EPUB_EVENTS.PAGE_ZOOM,function(t){w.Param.zoom=t.data.status;var i=e.viewMain.classList.contains("epub-view_state-zoom-in");w.Param.zoom===!1&&i?e.viewMain.classList.remove("epub-view_state-zoom-in"):w.Param.zoom!==!0||i||e.viewMain.classList.add("epub-view_state-zoom-in"),w.Utils.callEvent(window,"webpub-zoom")}),window.onwheel=function(e){for(var t=e.target,i=t,n=!1;i;){if(d.isScrollable(i,e)===!0){n=!0;break}i=i.parentElement}if(n===!1)return!1},this.preventDocumentScroll()},e.prototype.preventDocumentScroll=function(){var e=this,t=!1,i=0;document.addEventListener("touchend",function(n){var o=document.activeElement.tagName.toLowerCase();if("input"!==o&&"textarea"!==o)return Date.now()-i<100?void n.preventDefault():void(t===!0&&(i=Date.now(),window.scrollTo(0,0),e.epubNavigationTypeManager.forceResize(),n.preventDefault()))},!0),document.addEventListener("touchmove",function(e){var n=document.activeElement.tagName.toLowerCase();"input"!==n&&"textarea"!==n&&(t=0!==window.scrollY||0!==window.scrollX,Date.now()-i<100&&e.preventDefault())},!1)},e.prototype.setDocumentPagesAttributes=function(){var e=this.getCurrentPages();document.documentElement.setAttribute("pages",e.join("-")),document.documentElement.setAttribute("pages-left",e[0].toString()),e[1]?document.documentElement.setAttribute("pages-right",e[1].toString()):document.documentElement.setAttribute("pages-right","")},e.prototype.showMenu=function(e){return e===!1?(w.Main.menuManager.hideMenu(),void w.Main.menuManager.hideTopnav()):void w.Main.menuManager.showTopnav()},e.prototype.toggleMenu=function(){w.Main.toolsEvents&&(1===w.Main.toolsEvents.showToolsInfo?(w.Main.toolsEvents.showTools(!1),this.showMenu(!1)):(w.Main.toolsEvents.showTools(!0),this.showMenu(!0)))},e.prototype.pageChange=function(e){this.goToPage(e)},e.prototype.pageNext=function(){this.currentPage+=this.pagesBySpread},e.prototype.pagePrevious=function(){this.currentPage-=this.pagesBySpread},e.prototype.pageFirst=function(){this.currentPage=1},e.prototype.pageLast=function(){this.currentPage=this.pageQuantity},e.prototype.canChangePage=function(e,t,i){return e!==!0?0:t>0?i<0?0:-1:t<0?i>0?0:1:0},e.prototype.userInteractions=function(e){void 0===e&&(e=!0),document.documentElement.style.cursor=e?"default":"progress",document.body.style.pointerEvents=e?"all":"none"},e.prototype.gotoPageByCoordsDiff=function(e,t){void 0===t&&(t=!0);var i;return i=this.canChangePage(e[this.navigationType].isVector,e[this.navigationType].vectorDiff,e[this.navigationType].pointDiff),i>0?void this.pageNext():i<0?void this.pagePrevious():void(t?this.currentPage=this.currentPage:this.currentPageNoAnimation=this.currentPage)},e.prototype.getPagePosition=function(){console.log(arguments)},e.prototype.getPageCoordX=function(){console.log(arguments)},e.prototype.getFrameCoordX=function(){console.log(arguments)},e.prototype.getFrameCoordY=function(){console.log(arguments)},e.prototype.getDeltaFrameForPage=function(){console.log(arguments)},e.prototype.scrollFrame=function(e){"next"===e||1===e?this.pageNext():"prev"!==e&&e!==-1||this.pagePrevious()},e.prototype.getCurrentPages=function(e){void 0===e&&(e=this.currentPage);var t,i=[],n=0,o=0;if(i=[],n=0,o=0,void 0===this.epubSpreads)return i;for(t=this.epubSpreads.getPagesFromSpreadByPageIndex(e||this.currentPage),o=t.length;n<o;n++)void 0!==t[n]&&i.push(t[n].pageIndex);return i},e.prototype.getPagesOfFrame=function(e){return this.getCurrentPages(e)},e.prototype.getFrameOfPage=function(e){return this.getCurrentPages(e)[0]},e.prototype.setConfig=function(e){this.config.setConfig(e)},e.prototype.updateSpreadsSize=function(){void 0!==this.epubSpreads&&this.epubSpreads.updateSpreadsSize()},e.prototype.switchPageBySpread=function(e){return e>this.pagesBySpreadMax&&(e=this.pagesBySpreadMax),e?void(this.pagesBySpread=e||this.pagesBySpread):void(this.pagesBySpread=this.pagesBySpread%this.pagesBySpreadMax+1)},e.prototype.switchNavigation=function(e){return e?(this.navigationType=e,this.navigationType):"x"===this.navigationType?(this.navigationType="y",this.navigationType):(this.navigationType="x",this.navigationType)},e.prototype.isZoomed=function(){return 0!==this.epubSpreads.getScaleFromCurrentSpread()},e.prototype.zoomByStep=function(e){this.epubSpreads.zoomByStep({x:.5,y:0,step:e,animate:!0})},e.prototype.zoomIn=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:this.defaultPageScaleAt,animate:!0})},e.prototype.zoomOut=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:0,animate:!0})},e.prototype.zoomTo=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!0})},e.prototype.zoomNow=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!1})},e.prototype.init=function(e,t){return n(this,void 0,void 0,function(){return o(this,function(i){switch(i.label){case 0:return f.resizeHTMLTagElement(),this.setConfig(e),this.epubCssManager=new r.EpubCssManager(this.config),[4,this.epubCssManager.init(t)];case 1:return i.sent(),this.epubNavigationTypeManager=new a["default"](this,this.config,this.viewMain),this.epubSpreads=new u["default"](this,this.config,this.viewMain,this.epubCssManager),this.pageControl=new p.Controller(this),this.epubSpreads.getMainViewElement().setAttribute("tabindex","1"),this.epubKeyBoardEvent=new c.EpubKeyBoardEvent(this.epubSpreads.getMainViewElement(),this.config),this.screenSize=this.epubNavigationTypeManager.screenSize,this.epubNavigationTypeManager.forceResize(),w.Main.pagesLoaderNew.setCurrentPage(this.currentPage),this.userInteractions(!0),[2]}})})},e}();i["default"]=m},{"./EpubConfig":3,"./EpubCssManager":5,"./EpubEvent":7,"./EpubGesturesEvent/EpubKeyBoardEvent":10,"./EpubNavigationTypeManager":15,"./EpubSpreads":55,"./EpubStatistics":57,"./components/pageControl/Controller":63,"./utils/functions":80,"./utils/isScrollable":82}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubEvent"),o=e("./utils/functions"),s=function(){function e(e,t,i){var n=this;this.sizeIDString="",this.timers={resize:0,orientationchange:0},this.parent=e,this.config=t,this.epubEvent=w.epubEvent,this.screenSize=this.parent.screenSize,this.onResize=this.onResize.bind(this),this.pageLayout=w.Main.pageLayoutService.get("pageLayout");var o=w.Main.xmlManager.get("common-configuration","contents","zoom","width"),s=w.Main.xmlManager.get("common-configuration","contents","zoom","height");this.forceSinglePage=o>s,this.pageSize={width:this.pageWidth,height:this.pageHeight,ratio:1.5*this.pageWidth/this.pageHeight},this.updateScreenSize(),this.epubScreenElement=i,window.addEventListener(w.Param.eventResize,this.onResize.bind(this)),window.addEventListener("focus",this.onResize,!1),setTimeout(function(){return n.forceResize()},0),setTimeout(function(){n.localCheckWindowSize()},1e3)}return Object.defineProperty(e.prototype,"timeToRefreshScreenResize",{get:function(){return this.config.timeToRefreshScreenResize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddinigs",{get:function(){return this.config.paddings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.config.pageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.config.pageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"switchLandScapeUsingPageSize",{get:function(){return this.config.switchLandScapeUsingPageSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerWidth",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerHeight",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),e.prototype.needUpdateScreenSize=function(){return this.screenSize.width===this.innerWidth&&this.screenSize.height===this.innerHeight},e.prototype.updateScreenSize=function(){var e=this.needUpdateScreenSize();return this.screenSize.width=this.innerWidth,this.screenSize.height=this.innerHeight,this.screenSize.ratio=this.screenSize.width/this.screenSize.height,e},e.prototype.ratioScreenWidthVsHeight=function(){var e=1,t=["best","auto"].indexOf(this.pageLayout)!==-1,i="double"===this.pageLayout,n=this.screenSize.width>this.screenSize.height;"single"===this.pageLayout?e=1:i?e=2:t===!0&&this.forceSinglePage===!0?e=1:t===!0&&n&&(e=2),this.parent.switchPageBySpread(e)},e.prototype.ratioPageScreen=function(){return"single"===this.pageLayout?void this.parent.switchPageBySpread(1):"double"===this.pageLayout?void this.parent.switchPageBySpread(2):void 0!==this.screenSize.ratio&&void 0!==this.pageSize.ratio&&this.screenSize.ratio>this.pageSize.ratio?void this.parent.switchPageBySpread(2):void this.parent.switchPageBySpread(1)},e.prototype.ratioPageScreenFromApi=function(){this.parent.switchPageBySpread(w.Main.pageManager.pagePerScreen())},e.prototype.onResizeSync=function(){var e;return o.resizeHTMLTagElement(),window.scrollTo(0,0),this.config.paddinigsUpdate(),this.sizeIDString=this.innerHeight+"-"+this.innerWidth,this.updateScreenSize()!==!0||(this.config.pagesBySpreadUseApiPageManager===!0?this.ratioPageScreenFromApi():this.switchLandScapeUsingPageSize===!0?this.ratioPageScreen():this.ratioScreenWidthVsHeight(),this.parent.updateSpreadsSize(),e=o.isWindowLandscape(),e!==this.windowLandscape&&(this.windowLandscape=e,this.epubEvent.fire({type:n.EPUB_EVENTS.SCREEN_ORIENTATION,data:{landscape:e}})),!1)},e.prototype.onResize=function(e){window.scrollTo(0,0),clearTimeout(this.timers[e.type]),this.onResizeSync()!==!1&&(this.timers[e.type]=setTimeout(this.onResize.bind(this,e),this.timeToRefreshScreenResize))},e.prototype.localCheckWindowSize=function(){var e=this,t=this.innerHeight,i=this.innerWidth;this.sizeIDString!==t+"-"+i&&this.forceResize(),window.setTimeout(function(){e.localCheckWindowSize()},500)},e.prototype.forceResize=function(){this.onResize({type:"resize"})},e}();i["default"]=s},{"./EpubEvent":7,"./utils/functions":80}],16:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=e("./utils/enums"),o=e("./utils/XHRPromise"),s=e("./utils/XHRPromise"),r=e("./EpubPage/LinksManager"),a=e("./EpubPageEnrichment"),u=e("./utils/functions"),h=e("./EpubEvent"),p='\\<\\?xml version="1.0" encoding="UTF-8" standalone="no"\\?\\>\\n\\<\\!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"\\>',l=function(){function e(t,i,o,s){this.epubPages=t,this.config=i,this.pageIndex=o,this.epubCssManager=s,this.isVisible=!1,this.loadList=[],this._formatType=n.READER_TYPES.EPUB_HTML,this.inCache=!1,this.synchronizedWidthSpread=!1,this.isOnLoad=!1,this._pageContainsCPUElement=!1,this.load_xhrError=function(){this.inCache=!1,this.isOnLoad=!1,this.callCallBackOnload(!1)},this.epubEvent=w.epubEvent,this.pageSizeCoefLinkCallBack=this.pageSizeCoefLinkCallBack.bind(this),void 0===e.pageSizeCoefLink&&(e.pageSizeCoefLink=new Promise(this.pageSizeCoefLinkCallBack)),this.elementContainer=this.element=document.createElement("figure"),this.linksManager=new r["default"](this,i,o,this.element),this.setRootElemAttributes(this.element,o),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&(this.epubPageEnrichment=new a["default"](this,this.config,this.elementContainer))}return e.prototype.pageSizeCoefLinkCallBack=function(t){e.pageSizeCoefLinkResolve=t},Object.defineProperty(e.prototype,"coverPageCenter",{get:function(){return this.config.coverPageCenter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"srcHdpi",{set:function(e){this.urlPageHdpi=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src",{set:function(e){this.inCache!==!0&&(this.urlPage=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onload",{set:function(e){this._onload(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atSpreadOffset",{set:function(e){this._lastSpreadOffset=this._spreadOffset,this._spreadOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContainsCPUElement",{get:function(){return this._pageContainsCPUElement},set:function(e){var t="no";e===!0&&(t="yes"),"yes"===t&&this.pageContainsCPUElement===!0||"no"===t&&this.pageContainsCPUElement===!1||(this._pageContainsCPUElement=e,this.updateAttributesIframe(t))},enumerable:!0,configurable:!0}),e.prototype.updateAttributesIframe=function(e){this.zoomableParentElement&&this.zoomableParentElement.setAttribute("contains-iframe",e)},e.prototype.innerHTML=function(e,t){e.innerHTML=t},e.prototype.setPagePosition=function(){if(this.coverPageCenter!==!0){for(var e=this.element.children,t=null,i=0,n=e.length;i<n;i++)if("div"===e[i].tagName.toLowerCase()){t=e[i];break}if(null!==t){var o=window.getComputedStyle(t).width,s=0;s=parseFloat(o),this.pageIndex===this.pageQuantity?this.element.style.width=2*s+"px":1===this.pageIndex&&(this.element.style.width=2*s+"px")}}},e.prototype.makeProgressTagsHidden=function(e){if(e){var t=e.querySelectorAll(".pc.pc1 *");t.forEach(function(e){e.style.display="none"})}},e.prototype.makeProgressTagsVisible=function(e){if(e){var t=200,i=5,n=e.querySelectorAll(".pc.pc1 *");n.forEach(function(e){setTimeout(function(){e.style.display="initial"},t+i),i+=i})}},e.prototype.epubPageEnrichmentStat=function(){if(this.inCache!==!1)return 0===this._spreadOffset?void this.onVisible():void this.onNonVisible()},e.prototype.pathToSvg=function(e,t){var i=new RegExp(p,"gmi");return e=e.replace(/(\/[^\/]+)$/g,"/svg/"),t=t.replace(i,""),t.replace(/svg\//gim,e).trim()},e.prototype.parseImage=function(e){var t=this;u.htmlSecureRemoveChildren(e);var i=new Image;i.src=this.urlPage,e.appendChild(i);var n=new Promise(function(n,o){var s=i.onload=i.onerror=i.onabort=function(){n(i),e.classList.add("epub-image-page-loaded"),null!==i.parentElement&&setTimeout(function(){if(null!==i.parentElement){var n=new Image;n.src=t.urlPageHdpi,n.style.width=i.width+"px",n.style.height=i.height+"px",n.onload=function(){null!==i.parentElement&&e.replaceChild(n,i)},t.onFlush.then(function(){n.src=""})}},400)};i.complete===!0&&s()});return this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded"),i.src=""}),n},e.prototype.parseHtmlImgsload=function(e){return new Promise(function(t,i){var n=e.onload=e.onerror=e.onabort=function(){t(e)};e.complete===!0&&n()})},e.prototype.parseHtml=function(e,t){var i,o=[];this.readerPageSrcType===n.READER_TYPES.PDF_SVG&&(t=this.pathToSvg(this.urlPage,t)),u.htmlSecureRemoveChildren(e);var s=document.createElement("div");if(this.innerHTML(s,t),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML)for(var r=s.querySelectorAll("iframe"),a=function(e,t){h.pageContainsCPUElement=!0;var i=r[e].getAttribute("src");if(null===i)return"continue";r[e].removeAttribute("src");var n=NIApi.common.resolveValues(i.toString()).then(function(t){r[e].setAttribute("data-src",t)});o.push(n)},h=this,p=0,l=r.length;p<l;p++)a(p,l);var c=s.childNodes[0],f=c.querySelectorAll("img");if(e.appendChild(c),(i=e.querySelector("div"))&&(this.readerPageSrcType===n.READER_TYPES.PDF_SVG?i.setAttribute("class","webpub-viewer__epub-container-spread-page-sub epub_content_tag_type-"+n.READER_TYPES[this.readerPageSrcType].toLowerCase()):(i.id="",i.classList.add("webpub-viewer__epub-container-spread-page-sub"),i.classList.add("epub_content_tag_type-"+n.READER_TYPES[this.readerPageSrcType].toLowerCase()))),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML){var d=e.querySelectorAll("[src],[href]");Array.prototype.forEach.call(d,function(e){if(e.hasAttribute("src")){var t=e.getAttribute("src");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("src",t)})}if(e.hasAttribute("href")){var t=e.getAttribute("href");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("href",t)})}})}for(var m=[],p=0,l=f.length;p<l;p++)m.push(this.parseHtmlImgsload(f[p]));var g=Promise.all(m);g.then(function(){e.classList.add("epub-image-page-loaded")}),this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded")});var v=new Promise(function(t,i){g.then(function(){Promise.all(o).then(function(){t(e)})})});return v},e.prototype.parsePdf=function(e){u.htmlSecureRemoveChildren(e);var t=document.createElement("embed");return t.src=this.urlPage+"#zoom=200",t.width=1536,t.height=2172,t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.pointerEvents="none",e.appendChild(t),Promise.resolve(e)},e.prototype.parseSwf=function(e){u.htmlSecureRemoveChildren(e);var t=document.createElement("embed");return t.src=this.urlPage.replace("pdf","swf"),t.width=1536,t.height=2172,t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.pointerEvents="none",e.appendChild(t),Promise.resolve(e)},e.prototype.setRootElemAttributes=function(e,t){e.classList.add("spread-page-"+t),e.classList.add("webpub-viewer__epub-container-spread-page")},e.prototype.load_loaded=function(e){var t,i=this;return this.inCache=!0,this.isOnLoad=!1,t=this.readerPageSrcType===n.READER_TYPES.PDF_IMG?this.parseImage(this.elementContainer):this.readerPageSrcType===n.READER_TYPES.PDF_PDF?this.parsePdf(this.elementContainer):this.parseHtml(this.elementContainer,e.responseText),t.then(function(){i.epubPageEnrichmentStat(),i.callCallBackOnload(!0),i.linksManager.load().then(function(){i.tryDispatchIsInDom()})}),t},e.prototype.load=function(){var e=this;if(this.inCache===!0)return this.epubPageEnrichmentStat(),Promise.resolve();if(this.isOnLoad===!0)return Promise.resolve();this.isOnLoad=!0;var t=u.getSplitedPromise();return new s["default"](o.Protocol.GET,this.urlPage).init().then(function(i){e.load_loaded(i).then(function(){t.resolve()})})["catch"](this.load_xhrError.bind(this)),t},e.prototype.callCallBackOnload=function(e){for(var t=0,i=this.loadList.length;t<i;t++)this.loadList[t].bind(this)(e);this.loadList=[]},e.prototype._onload=function(e){return this.inCache===!0?void e.bind(this)(!0):void this.loadList.push(e)},e.prototype.tryDispatchIsInDom=function(){if(this.inCache!==!1&&this.synchronizedWidthSpread!==!1&&this.linksManager.isLoaded()!==!1){this.epubEvent.fire({type:h.EPUB_EVENTS.PAGE_IN_DOM,data:{epubPage:this}});var t=e.coef;this.setCoefOfPageSizeToLink(),e.pageSizeCoefLinkResolve&&e.coef&&!t&&e.pageSizeCoefLinkResolve()}},e.prototype.syncElemWithSpread=function(e){var t=this;this.onFlush=u.getSplitedPromise();var i=this.load().then(function(){return t});return this.zoomableParentElement=e,this.synchronizedWidthSpread=!0,this.tryDispatchIsInDom(),{element:this.element,loaded:i}},e.prototype.setCoefOfPageSizeToLink=function(){e.coef||(e.coef=this.element.offsetHeight/this.config.linksSizePageHeight)},e.prototype.onVisible=function(){this.isVisible!==!0&&(this.isVisible=!0,this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.start(),this.linksManager.start())},e.prototype.onNonVisible=function(){this.isVisible!==!1&&(this.isVisible=!1,this.synchronizedWidthSpread=!1,this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.stop(),this.linksManager.stop())},e.prototype.flush=function(){this.onFlush&&this.onFlush.resolve(),this.inCache!==!1&&(this.synchronizedWidthSpread=!1,this.isVisible=!1,this.loadList=[],this.inCache=!1,u.htmlSecureRemoveChildren(this.elementContainer),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.flush(),this.linksManager.flush())},e}();i["default"]=l},{"./EpubEvent":7,"./EpubPage/LinksManager":18,"./EpubPageEnrichment":44,"./utils/XHRPromise":77,"./utils/enums":79,"./utils/functions":80,"es6-promise":1}],17:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubEvent"),o=e("../EpubPage"),s=e("./shapes/ShapesManager"),r=e("./useracts/UserActs"),a=function(){function e(e,t,i,o,s){this.linksManager=e,this.config=t,this.data=i,this.container=o,this.pageElement=s,this.events=new n.EpubEvent,this.started=!1,this.status=!1,this.epubEvent=w.epubEvent,this.ePubPage=e.epubPage,this.start()}return e.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container-link webpub-viewer__link-clickable"},e.prototype.setShapes=function(){this.shapesManager=new s.ShapesManager(this,this.config,this.data,this.pageElement,this.linksElem,o["default"].coef)},e.prototype.setUserActs=function(){this.userActs=new r.UserActs(this,this.config,this.data.useract,this.linksElem)},e.prototype.start=function(){var e=this;this.status=!0,o["default"].pageSizeCoefLink.then(function(){e.started===!1&&(e.createHtmlElement(),e.setShapes(),e.setUserActs()),e.started=!0,e.container.appendChild(e.linksElem)})},e.prototype.stop=function(){this.status=!1,this.started!==!1&&(this.started=!1,this.shapesManager.stop(),this.userActs.stop())},e.prototype.flush=function(){this.started=!1,this.shapesManager.flush(),this.userActs.flush()},e}();i["default"]=a},{"../EpubEvent":7,"../EpubPage":16,"./shapes/ShapesManager":28,"./useracts/UserActs":43}],18:[function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Link"),s=e("./../utils/enums"),r=e("../EpubEvent"),a=function(){function e(e,t,i,n){var o=this;this.epubPage=e,this.config=t,this.pageNumber=i,this.container=n,this._src="",this.promise=!1,this.inCache=!1,this.isStarted=!1,this.links=[],this.blinkLink=this.blinkLinkPre.bind(this),this.epubEvent=w.epubEvent,this.linkBoxAspect=this.config.linkBoxAspect,this.epubEvent.addListener(r.EPUB_EVENTS.ADMIN_LINK_CREATE,function(e){e.data.pageNumber===i&&o.loadLink(e.data.linkData)})}return Object.defineProperty(e.prototype,"enableAspLinks",{get:function(){return this.config.enableAspLinks},enumerable:!0,configurable:!0}),e.prototype.blinkLinkPre=function(e){var t=this;this.linksElem.classList.add("epub-links-unreveal"),clearTimeout(this.toggleTimer),this.toggleTimer=setTimeout(function(){t.linksElem.classList.remove("epub-links-unreveal")},0)},e.prototype.initLinksBehaviors=function(){this.linkBoxAspect===s.LinksBehaviors.blink&&this.epubEvent.addListener(r.EPUB_EVENTS.PAGE_CLICK,this.blinkLink)},e.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container epub-links_container-behaviour-"+s.LinksBehaviors[this.linkBoxAspect]},e.prototype.removeHtmlElement=function(){void 0!==this.linksElem&&(this.linksElem.innerHTML="")},e.prototype.isEnable=function(){return this.enableAspLinks},e.prototype.loadLink=function(e){for(var t=0,i=e.content.length;t<i;t++){var s=n({},e);s.content=[e.content[t]],this.links.push(new o["default"](this,this.config,s,this.linksElem,this.container))}},e.prototype.loadLinks=function(){this.createHtmlElement();for(var e=0,t=this.data.length;e<t;e++)this.loadLink(this.data[e]);this.initLinksBehaviors()},e.prototype.stopLinks=function(){for(var e=0,t=this.links.length;e<t;e++)this.links[e].stop()},e.prototype.flushLinks=function(){this.epubEvent.removeListener(r.EPUB_EVENTS.PAGE_CLICK,this.blinkLink),this.removeHtmlElement();for(var e=0,t=this.links.length;e<t;e++)this.links[e].flush();this.links=[]},e.prototype.startOnReady=function(){this.isStarted!==!1&&this.inCache!==!1&&(this.loadLinks(),this.container.appendChild(this.linksElem))},e.prototype.load=function(e){var t=this;return void 0===e&&(e=this.pageNumber),this.isEnable()===!1?Promise.resolve():(this.promise=w.Main.pageManager.getLinksPromise(e),this.promise===!0?(this.data=w.Main.pageManager.getRealLinks(e),this.inCache=!0,this.startOnReady(),Promise.resolve()):(this.promise=this.promise,this.promise.then(function(e){t.data=e,t.inCache=!0,t.startOnReady()}),this.promise))},e.prototype.isLoaded=function(){return this.inCache},e.prototype.flush=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.inCache=!1,this.flushLinks())},e.prototype.start=function(){this.isEnable()!==!1&&(this.isStarted=!0,this.startOnReady())},e.prototype.stop=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.stopLinks())},e}();i["default"]=a},{"../EpubEvent":7,"./../utils/enums":79,"./Link":17}],19:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Video"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentTag="audio",t}return n(t,e),t.prototype.setElement=function(){this.element=window.document.createElement("audio"),this.element.className=this.className+"-audio",this.element.setAttribute("controls",""),this.element.src=this.url,this.setPreventGestures(),this.linksElem.appendChild(this.element)},t}(o.Video);s._name="audio",i.Audio=s},{"./Video":29}],20:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=function(e){function t(t,i,n,o,s){var r=e.call(this,t,i,n,o,s)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=o,r.coef=s,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.circle;"undefined"!=typeof i&&(t[0]=i.radius,e.prototype.setRadius.call(this,t,"%"))},t}(o.Shape);s._name="circle",i.Circle=s},{"./Shape":27}],21:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){
e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=e("./utils/IframeInteractions"),r=("ontouchstart"in window,function(e){function t(t,i,n,o,s,r){var a=e.call(this,t,i,n,o,s)||this;return a.shapesManager=t,a.config=i,a.data=n,a.linksElem=o,a.coef=s,a.pageElement=r,a.url="",a.foreground=!1,a.url=a.content.file.url,a.foreground=a.content.file.foreground||!1,a.setInfoToPage(),a.setElement(),a}return n(t,e),t.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},t.prototype.setElement=function(){this.element=window.document.createElement("iframe"),this.element.style.opacity="0",this.element.style.pointerEvents="none",this.element.className=this.className+"-iframe",this.element.setAttribute("data-foreground",this.foreground?"true":"false"),this.iframeInteractions=new s.IframeInteractions(this,this.config,this.element,this.linksElem,this.foreground)},t.prototype.checkLoaded=function(){this.element.addEventListener("load",this.loaded.bind(this))},t.prototype.loaded=function(){this.element.style.opacity="1";try{this.iFrameContentWindow=this.element.contentWindow,this.setAnimationInitIfNot(),this.foreground===!0&&"object"==typeof this.iFrameContentWindow.AdobeAn?this.iframeInteractions.init(this.iFrameContentWindow):this.foreground===!0&&(this.element.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow))}catch(e){}},t.prototype.setAnimationInitIfNot=function(){var e=this;try{var t=this.iFrameContentWindow.document.body,i=t.getAttribute("onload");t.removeAttribute("onload"),i&&t.addEventListener("load",function(){e.iFrameContentWindow.exportRoot||new e.iFrameContentWindow.Function(i)()})}catch(n){}},t.prototype.start=function(){var t=this;this.setInfoToPage(),this.isVisible!==!1&&(this.timerBeforAppend=setTimeout(function(){t.element.src=t.url,t.linksElem.appendChild(t.element)},850),this.checkLoaded(),e.prototype.start.call(this))},t.prototype.stop=function(){var t=this;clearTimeout(this.timerBeforAppend),this.element.parentElement&&setTimeout(function(){t.linksElem.removeChild(t.element)},300),e.prototype.stop.call(this)},t.prototype.flush=function(){this.iframeInteractions.flush(),e.prototype.flush.call(this)},t}(o.Shape));r._name="iframe",i.Iframe=r},{"./Shape":27,"./utils/IframeInteractions":30}],22:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=function(e){function t(t,i,n,o,s){var r=e.call(this,t,i,n,o,s)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=o,r.coef=s,r.url="",r.foreground=!1,r.url=r.content.file.url,r.setElement(),r}return n(t,e),t.prototype.setElement=function(){this.linksElem.style.backgroundImage="url('"+this.url+"')"},t}(o.Shape);s._name="image",i.Image=s},{"./Shape":27}],23:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.mediaElement=e,this.enablePlayButton=!0,this.enableSeekBar=!0,this.enableRemainingTime=!0,this.enableCurrentTime=!0,this.enableVolumeButton=!0,this.enableFullScreenButton=!0,this.displayState=!0,this.toggleControls=this.toggleControls.bind(this),this.showControls=this.showControls.bind(this),this.addDelayUnDisplay=this.addDelayUnDisplay.bind(this),this.playState=this.playState.bind(this),this.onPlay=this.onPlay.bind(this),this.seekState=this.seekState.bind(this),this.timeupdate=this.timeupdate.bind(this),this.volumeState=this.volumeState.bind(this),this.onVolume=this.onVolume.bind(this),this.fullScreenState=this.fullScreenState.bind(this),this.eventsList=[],this.init()}return e.prototype.init=function(){this.initRootElement(),this.enablePlayButton===!0&&this.initPlayButton(),this.enableCurrentTime===!0&&this.initCurrentTime(),this.enableSeekBar===!0&&this.initSeekBar(),this.enableRemainingTime===!0&&this.initRemainingTime(),this.enableVolumeButton===!0&&this.initVolumeButton(),this.enableFullScreenButton===!0&&this.initFullScreenButton()},e.prototype.updateView=function(){this.mediaElement.parentElement&&this.mediaElement.parentElement.appendChild(this.rootElement)},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){this.removeEvents()},e.prototype.initRootElement=function(){this.rootElement=document.createElement("div"),this.initSuperPlayButton(),this.rootElement.classList.add("media_player_custom"),this.itemsElement=document.createElement("div"),this.itemsElement.classList.add("media_player_custom-items"),this.rootElement.appendChild(this.itemsElement),this.addDelayUnDisplay(),this.addEvent(this.mediaElement,"click",this.toggleControls),this.addEvent(this.mediaElement,"touchend",this.toggleControls),this.addEvent(this.mediaElement,"mousemove",this.showControls)},e.prototype.initSuperPlayButton=function(){this.superPlayButton=document.createElement("div"),this.rootElement.appendChild(this.superPlayButton),this.superPlayButton.classList.add("super-play_button-custom"),this.addEvent(this.superPlayButton,"click",this.playState),this.setIcon(this.superPlayButton,"play-bold-v4")},e.prototype.toggleControls=function(e){return e.preventDefault(),this.displayState===!1?void this.showControls(e):void this.hideControls()},e.prototype.showControls=function(e){this.addDelayUnDisplay(),this.rootElement.classList.remove("hide"),this.displayState=!0},e.prototype.hideControls=function(){this.rootElement.classList.add("hide"),this.displayState=!1},e.prototype.addDelayUnDisplay=function(){var e=this;clearTimeout(this.delayDisplayTimer),this.delayDisplayTimer=setTimeout(function(){e.hideControls()},4e3)},e.prototype.initPlayButton=function(){this.playButton=this.createItem(),this.playButton.classList.add("play_button-custom"),this.addEvent(this.playButton,"click",this.playState),this.addEvent(this.mediaElement,"play",this.onPlay),this.addEvent(this.mediaElement,"pause",this.onPlay),this.setIcon(this.playButton,"play-bold-v4"),this.setIcon(this.playButton,"pause")},e.prototype.playState=function(){return this.addDelayUnDisplay(),this.mediaElement.paused?void this.mediaElement.play():void this.mediaElement.pause()},e.prototype.onPlay=function(){return this.mediaElement.paused?(this.playButton.classList.remove("play-enbaled"),void this.superPlayButton.classList.remove("play-enbaled")):(this.playButton.classList.add("play-enbaled"),void this.superPlayButton.classList.add("play-enbaled"))},e.prototype.initCurrentTime=function(){this.currentTimeElement=this.createItem(),this.currentTimeElement.classList.add("current_time-custom"),this.currentTimeElement.classList.add("no-hover")},e.prototype.initSeekBar=function(){this.seekButton=this.createItem(),this.seekButton.classList.add("seek_button-custom"),this.seekButton.classList.add("no-hover"),this.seekButtonRange=document.createElement("input"),this.seekButton.appendChild(this.seekButtonRange),this.seekButtonRange.setAttribute("type","range"),this.seekButtonRange.setAttribute("step","0.1"),this.seekButtonRange.setAttribute("min","0"),this.seekButtonRange.setAttribute("max","100"),this.seekButtonRange.setAttribute("value","0"),this.addEvent(this.seekButtonRange,"touchstart",this.cancelBubble),this.addEvent(this.seekButtonRange,"mousemove",this.cancelBubble),this.seekButtonRange.onchange=this.seekState;try{this.seekButtonRange.oninput=this.seekState}catch(e){console.warn(e)}this.addEvent(this.mediaElement,"timeupdate",this.timeupdate)},e.prototype.initRemainingTime=function(){this.remainingTimeElement=this.createItem(),this.remainingTimeElement.classList.add("remaining_time-custom"),this.remainingTimeElement.classList.add("no-hover")},e.prototype.timeupdate=function(){var e=this.mediaElement.currentTime,t=this.mediaElement.duration-this.mediaElement.currentTime;this.seekButtonRange.value=(e/this.mediaElement.duration*100).toString(),this.onVolume(),this.currentTimeElement&&(this.currentTimeElement.innerHTML=this.getReadableTime(e)),this.remainingTimeElement&&(this.remainingTimeElement.innerHTML="-"+this.getReadableTime(t))},e.prototype.seekState=function(){this.addDelayUnDisplay();var e=parseFloat(this.seekButtonRange.value),t=e/100*this.mediaElement.duration;this.mediaElement.currentTime=t},e.prototype.initVolumeButton=function(){this.volumeButton=this.createItem(),this.volumeButton.classList.add("volume_button-custom"),this.addEvent(this.volumeButton,"click",this.volumeState),this.addEvent(this.mediaElement,"volumechange",this.onVolume),this.onVolume(),this.setIcon(this.volumeButton,"speaker-on"),this.setIcon(this.volumeButton,"speaker-off")},e.prototype.volumeState=function(){return this.addDelayUnDisplay(),0===this.mediaElement.volume||this.mediaElement.muted===!0?(this.mediaElement.muted=!1,void(this.mediaElement.volume=1)):(this.mediaElement.muted=!0,void(this.mediaElement.volume=0))},e.prototype.onVolume=function(){if(this.volumeButton){var e=this.volumeButton.classList.contains("volume-enbaled");return 0===this.mediaElement.volume||this.mediaElement.muted===!0?void(e===!0&&this.volumeButton.classList.remove("volume-enbaled")):void(e===!1&&this.volumeButton.classList.add("volume-enbaled"))}},e.prototype.initFullScreenButton=function(){this.fullscreenButton=this.createItem(),this.fullscreenButton.classList.add("fullscreen_button-custom"),this.addEvent(this.fullscreenButton,"click",this.fullScreenState),this.setIcon(this.fullscreenButton,"fullscreen-v4")},e.prototype.fullScreenState=function(){if(this.mediaElement.requestFullscreen)this.mediaElement.requestFullscreen();else if(this.mediaElement.mozRequestFullScreen)this.mediaElement.mozRequestFullScreen();else if(this.mediaElement.webkitRequestFullscreen)this.mediaElement.webkitRequestFullscreen();else if(this.mediaElement.webkitEnterFullscreen)try{this.mediaElement.webkitEnterFullscreen()}catch(e){}},e.prototype.createItem=function(){var e=document.createElement("div");return e.classList.add("media-item"),this.itemsElement.appendChild(e),e},e.prototype.setIcon=function(e,t){var i=document.createElement("div");w.Utils.svgIcon(i,{icon:t,color:null}),e.innerHTML+=i.innerHTML},e.prototype.getReadableTime=function(e){var t=[],i=parseInt(e.toString(),10),n=Math.floor(i/86400);i-=3600*n*24;var o=Math.floor(i/3600);i-=3600*o;var s=Math.floor(i/60);return i-=60*s,o&&t.push(o),t.push(s),t.push(this.padNumber(i,2)),t.join(":")},e.prototype.padNumber=function(e,t){var i="00"+e;return i.substr(i.length-t)},e.prototype.addEvent=function(e,t,i){this.eventsList.push({element:e,type:t,callBack:i}),e.addEventListener(t,i)},e.prototype.removeEvent=function(e,t,i){for(var n=0;n<this.eventsList.length;n++){var o=this.eventsList[n];if(e===o.element&&t===o.type&&i===o.callBack)return delete this.eventsList[n],this.eventsList.splice(n,1),e.removeEventListener(t,i),void this.removeEvent(e,t,i)}},e.prototype.removeEvents=function(){for(var e=0;e=this.eventsList.length;){var t=this.eventsList[e-1];this.removeEvent(t.element,t.type,t.callBack)}},e.prototype.cancelBubble=function(e){e.cancelBubble=!0},e}();i.MediaPlayer=n},{}],24:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o.Shape);s._name="rect",i.Rect=s},{"./Shape":27}],25:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=function(e){function t(t,i,n,o,s){var r=e.call(this,t,i,n,o,s)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=o,r.coef=s,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.roundrect;"undefined"!=typeof i&&(t[0]=i.radius,t[1]=i.radius,t[2]=i.radius,t[3]=i.radius,e.prototype.setRadius.call(this,t))},t}(o.Shape);s._name="roundrect",i.RoundRect=s},{"./Shape":27}],26:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Shape"),s=function(e){function t(t,i,n,o,s){var r=e.call(this,t,i,n,o,s)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=o,r.coef=s,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.roundrectcomplex;"undefined"!=typeof i&&(t[0]=i.tl_radius,t[1]=i.tr_radius,t[2]=i.br_radius,t[3]=i.bl_radius,e.prototype.setRadius.call(this,t))},t}(o.Shape);s._name="roundrectcomplex",i.RoundRectComplex=s},{"./Shape":27}],27:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./../../utils/enums"),o=e("../../utils/functions"),s=function(){function e(t,i,o,s,r,a){this.shapesManager=t,this.config=i,this.data=o,this.linksElem=s,this.coef=r,this.pageElement=a,this.className="",this.width=0,this.height=0,this.x=0,this.y=0,this.radius=[],this.status=n.ShapeActivityStatus.INIT,this.orientation="auto",this.isVisible=!1,this.Id=0,this.Id=e.globalID++,this.ePubPage=t.ePubPage,this.content=this.getDataContent(),this.className="epub-link-type_"+this.data.type,this.width=this.content.width,this.height=this.content.height,this.x=this.content.x,this.y=this.content.y,this.linkBlinkDuration=this.config.linkBlinkDuration,this.linkBoxAspect=this.config.linkBoxAspect,this.orientation=(this.data.orientation||this.orientation).toLowerCase(),this.setSizes(),this.initLinksBehaviors()}return e.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms"),this.linksElem.style.webkitAnimationDuration=e+t,this.linksElem.style.animationDuration=e+t},e.prototype.initLinksBehaviors=function(){this.linkBoxAspect===n.LinksBehaviors["static"]&&this.linksElem.classList.add("webpub-viewer__link--focused")},e.prototype.setRadius=function(e,t){void 0===t&&(t="px"),0!==e.length&&(this.linksElem.style.webkitBorderRadius=e.join(t+" ")+t,this.linksElem.style.borderRadius=e.join(t+" ")+t)},e.prototype.setSizes=function(){var e=[this.coef,0,0,this.coef,this.x*this.coef,this.y*this.coef];this.linksElem.style.width=this.width+"px",this.linksElem.style.height=this.height+"px",o.styleTransform(this.linksElem,"matrix("+e.join(",")+")"),this.linksElem.classList.add(this.className)},e.prototype.getDataContent=function(){return this.data.content[0]},e.prototype.display=function(e){if(e===!0&&this.isVisible!==!0)return this.isVisible=!0,this.linksElem.classList.add("epub-link-visible"),void this.start();if(e===!0);else if(e===!1&&this.isVisible!==!1)return this.isVisible=!1,this.linksElem.classList.remove("epub-link-visible"),void this.stop()},e.prototype.start=function(){this.status=n.ShapeActivityStatus.START},e.prototype.stop=function(){this.status=n.ShapeActivityStatus.STOP},e.prototype.flush=function(){this.status=n.ShapeActivityStatus.FLUSH},e}();s._name="shape",s.globalID=0,i.Shape=s},{"../../utils/functions":80,"./../../utils/enums":79}],28:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./../../utils/enums"),o=e("../../utils/functions"),s=e("./Rect"),r=e("./RoundRect"),a=e("./RoundRectComplex"),u=e("./Circle"),h=e("./Iframe"),p=e("./Video"),l=e("./Audio"),c=e("./Image"),f=e("../../EpubEvent"),d={Rect:s.Rect,RoundRect:r.RoundRect,RoundRectComplex:a.RoundRectComplex,Circle:u.Circle,Iframe:h.Iframe,Video:p.Video,Audio:l.Audio,Image:c.Image},m=function(){function e(e,t,i,n,o,s){this.link=e,this.config=t,this.data=i,this.pageElement=n,this.linksElem=o,this.coef=s,this.shapes=[],this.epubEvent=w.epubEvent,this.ePubPage=e.ePubPage,this.setShapes(),this.startShapes(),this.setEventOrientations()}return e.prototype.setShapes=function(){for(var e in d)d[e]._name===this.data.type&&this.shapes.push(new d[e](this,this.config,this.data,this.linksElem,this.coef,this.pageElement));0===this.shapes.length&&console.warn("Shape type not supported :"+this.data.type,this.data)},e.prototype.startShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status!==n.ShapeActivityStatus.START&&this.shapes[e].start()},e.prototype.stopShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status===n.ShapeActivityStatus.START&&this.shapes[e].stop()},e.prototype.setEventOrientations=function(){var e=this;this.epubEvent.addListener(f.EPUB_EVENTS.SCREEN_ORIENTATION,function(t){e.setOrientations(t.data.landscape)}),this.setOrientations(o.isWindowLandscape())},e.prototype.setOrientations=function(e){for(var t=0,i=this.shapes.length;t<i;t++)this.setOrientation(e,this.shapes[t])},e.prototype.setOrientation=function(e,t){return"auto"===t.orientation?void t.display(!0):"landscape"===t.orientation&&e===!0||"portrait"===t.orientation&&e===!1?void t.display(!0):void t.display(!1)},e.prototype.flushShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].flush()},e.prototype.start=function(){this.startShapes()},e.prototype.stop=function(){this.stopShapes()},e.prototype.flush=function(){this.flushShapes()},e}();m._name="shapes",i.ShapesManager=m},{"../../EpubEvent":7,"../../utils/functions":80,"./../../utils/enums":79,"./Audio":19,"./Circle":20,"./Iframe":21,"./Image":22,"./Rect":24,"./RoundRect":25,"./RoundRectComplex":26,"./Video":29}],29:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../../utils/enums"),s=e("./Shape"),r=e("./../../EpubGesturesEvent"),a=e("./MediaPlayer"),u=function(e){function t(t,i,n,o,s,r){var a=e.call(this,t,i,n,o,s)||this;return a.shapesManager=t,a.config=i,a.data=n,a.linksElem=o,a.coef=s,a.pageElement=r,a.url="",a.contentTag="video",a._isPlaying=!1,a.enableDefaultControls=!1,a.userAgent=w.Param.userAgent,a.url=a.content[a.contentTag].url,a.setInfoToPage(),a.setElement(),a}return n(t,e),t.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},t.prototype.setElement=function(){var e=window.document.createElement("source");this.element=window.document.createElement("video"),this.element.className=this.className+"-video",this.enableDefaultControls?this.element.setAttribute("controls",""):this.mediaPlayer=new a.MediaPlayer(this.element),this.element.setAttribute("controlsList","nodownload"),this.userAgent.os.name===w.Param.userAgent.OS.IOS&&this.content.video.autoplay&&this.element.setAttribute("muted",""),e.src=this.url,this.element.appendChild(e),this.setPreventGestures(),this.linksElem.appendChild(this.element),this.mediaPlayer&&this.mediaPlayer.updateView()},t.prototype.setPreventGestures=function(){this.element.onvolumechange=this.makeDefaultPreventGesture.bind(this),this.element.onseeking=this.element.onvolumechange,this.element.onplay=this.onplay.bind(this),this.element.onpause=this.onpause.bind(this)},t.prototype.makeDefaultPreventGesture=function(){r["default"].prototype.preventAllGesture()},t.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms")},t.prototype.initLinksBehaviors=function(){},t.prototype.setRadius=function(e,t){void 0===t&&(t="px")},t.prototype.setSizes=function(){this.linksElem.style.width=Math.round(this.width*this.coef)+"px",this.linksElem.style.height=Math.round(this.height*this.coef)+"px",this.linksElem.style.left=Math.round(this.x*this.coef)+"px",this.linksElem.style.top=Math.round(this.y*this.coef)+"px",this.linksElem.classList.add(this.className)},t.prototype.onplay=function(){this.makeDefaultPreventGesture(),this._isPlaying=!0,this.status!==o.ShapeActivityStatus.STOP&&this.status!==o.ShapeActivityStatus.FLUSH||this.element.pause()},t.prototype.onpause=function(){this.makeDefaultPreventGesture(),this._isPlaying=!1},t.prototype.start=function(){var t=this;this.isVisible!==!1&&(e.prototype.start.call(this),this.setInfoToPage(),this.content.video.autoplay&&this.element.paused&&this._isPlaying===!1&&(this.playPromise=this.element.play(),"object"==typeof this.playPromise&&this.playPromise.then&&this.playPromise.then(function(){})["catch"](function(){var e=t.element.play();e["catch"](function(){})})))},t.prototype.stop=function(){this.mediaPlayer&&this.mediaPlayer.stop(),this.element.paused===!1&&this._isPlaying===!0&&this.element.pause(),e.prototype.stop.call(this)},t.prototype.flush=function(){this.mediaPlayer&&this.mediaPlayer.flush(),e.prototype.flush.call(this)},t}(s.Shape);u._name="video",i.Video=u},{"./../../EpubGesturesEvent":8,"./../../utils/enums":79,"./MediaPlayer":23,"./Shape":27}],30:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../EpubEvent"),o=e("../../../utils/functions"),s="ontouchstart"in window,r=400,a=function(){function e(e,t,i,n,s){this.parent=e,this.config=t,this.element=i,this.linksElem=n,this.foreground=s,this.supportCreateMouseEvent=0,this.eventsListe=["mousemove","mousedown","mouseup","mouseover","mouseout"],this.eventsListeTouch=["touchmove","touchstart","touchend"],this.epubEvent=w.epubEvent,this.removableListeners=[];var r=o.getSplitedPromise();this.waitAction=r,r.resolve()}return e.prototype.init=function(e){try{document.createEvent("MouseEvents"),this.preventZoomInteraction=!1,this.supportCreateMouseEvent=1}catch(t){if("MouseEvent"in window==!1)return this.supportCreateMouseEvent=2,this.element.style.pointerEvents="all",this.linksElem.style.pointerEvents="none",void(this.preventZoomInteraction=!0)}this.iFrameContentWindow=e,this.simulateInteractions()},Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),e.prototype.createMouseEvent=function(e,t){var i,n=null,o=e.type;return"mouseover"!==o&&"mouseout"!==o||(n=t),1===this.supportCreateMouseEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(o,!0,!0,this.iFrameContentWindow,0,e.offsetX,e.offsetY,e.offsetX,e.offsetY,!1,!1,!1,!1,0,n)):i=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:this.iFrameContentWindow,screenX:e.offsetX,screenY:e.offsetY,clientX:e.offsetX,clientY:e.offsetY}),i},e.prototype.getCoordsTouches=function(e){var t=e.touches[0]||e;return this.getCoords(t)},e.prototype.getCoords=function(e){var t=e.currentTarget||e.target,i=t.getBoundingClientRect(),n=t.offsetWidth/i.width;return[(e.pageX-i.left)*n,(e.pageY-i.top)*n]},e.prototype.simulateEvt=function(e){var t=this;e.preventDefault();var i,a=this.canvasElement,u=e.type,h=0,p=0;switch(u){case"touchmove":u="mousemove";break;case"touchend":u="mouseup";break;case"touchstart":u="mousedown"}var l;if(s&&void 0!==e.touches?(l=this.getCoordsTouches(e),p=l[0],h=l[1]):(p=e.offsetX,h=e.offsetY,p||h||(l=this.getCoords(e),p=l[0],h=l[1])),i=this.createMouseEvent({type:u,offsetX:p,offsetY:h},a),"mouseup"===u){var c=o.getSplitedPromise();this.waitAction=c.promise;var f=setTimeout(function(){c.resolve(),t.epubEvent.removeListener(n.EPUB_EVENTS.PAGE_CLICK,d)},r),d=function(){clearTimeout(f),t.epubEvent.removeListener(n.EPUB_EVENTS.PAGE_CLICK,d),a.dispatchEvent(i),i=t.createMouseEvent({type:"click",offsetX:p,offsetY:h},a),a.dispatchEvent(i),c.resolve()};return void this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CLICK,d)}a.dispatchEvent(i)},e.prototype.simulateInteractions=function(){var e=this;if(this.canvasElement=this.iFrameContentWindow.document.querySelector("canvas"),this.canvasElement){this.linksElem.style.pointerEvents="all";var t=this.eventsListe;s&&(t=this.eventsListeTouch),t.forEach(function(t){e.removableListeners.push({type:t,action:function(t){e.waitAction.then(function(){e.simulateEvt(t)})}})}),this.removableListeners.forEach(function(t){e.linksElem.addEventListener(t.type,t.action)})}},e.prototype.removeEvents=function(){var e=this;this.removableListeners.forEach(function(t){e.linksElem.removeEventListener(t.type,t.action)}),this.removableListeners=[]},e.prototype.setPreventZoomInteraction=function(e){if(s&&this.preventZoomInteraction!==!1){var t=e.document;t.addEventListener("touchmove",function(e){var t=e;1!==t.scale&&e.preventDefault()},!1);var i=0;t.addEventListener("touchend",function(e){var t=Date.now();t-i<=300&&(e.preventDefault(),e.cancelBubble=!0,e.stopPropagation()),i=t},!0)}},e.prototype.flush=function(){this.removeEvents()},e}();i.IframeInteractions=a},{"../../../EpubEvent":7,"../../../utils/functions":80}],31:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./GotoPage"),s=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openFirst()})}}}),this.executedAction(arguments),!1},t}(o.GotoPage);r._name="firstPage",i.FirstPage=r},{"../../EpubEvent":7,"./GotoPage":32}],32:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.page.open(parseInt(e.param||0))})}}}),this.executedAction(arguments),!1},t.prototype.setTooltip=function(){var t=this.data.param;if(void 0===t)return void e.prototype.setTooltip.call(this);""===t&&(t="1");var i=w.Main.xmlManager.get("locale","tooltip_"+this.data.type),n=parseInt(t,10),o=w.Main.xmlManager.get("common-configuration","config","shift"),s=n-o;i=i.concat(" ",s.toString()),e.prototype.setTooltip.call(this,i)},t}(o.UserAct);r._name="gotoPage",i.GotoPage=r},{"../../EpubEvent":7,"./UserAct":42}],33:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)return"fwd"===e.param?void i.historyFwd():void i.historyBack()})}}}),this.executedAction(arguments),!1},t.prototype.historyBack=function(){window.history.back()},t.prototype.historyFwd=function(){window.history.forward()},t}(o.UserAct);r._name="history",i.History=r},{"../../EpubEvent":7,"./UserAct":42}],34:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)try{new Function("linkData","linkElement",e.param)(e,i.linksElem)}catch(t){console.warn(t)}})}}}),this.executedAction(arguments),!1},t}(o.UserAct);r._name="javascript",i.JavaScriptCall=r},{"../../EpubEvent":7,"./UserAct":42}],35:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./GotoPage"),s=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openLast()})}}}),this.executedAction(arguments),!1},t}(o.GotoPage);r._name="lastPage",i.LastPage=r},{"../../EpubEvent":7,"./GotoPage":32}],36:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t}(o.UserAct);r._name="lightbox",i.LightBox=r},{"../../EpubEvent":7,"./UserAct":42
}],37:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.mailTo=function(e){var t=e.trim(),i="mailto:",n=t.match(/^mailto:|^mailto :/gi);null!==n&&0!==n.length&&(i=""),window.location.href=i+t},t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&i.mailTo(e.param)})}}}),this.executedAction(arguments),!1},t}(o.UserAct);r._name="mailto",i.MailTo=r},{"../../EpubEvent":7,"./UserAct":42}],38:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./GotoPage"),s=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openNext()})}}}),this.executedAction(arguments),!1},t}(o.GotoPage);r._name="nextPage",i.NextPage=r},{"../../EpubEvent":7,"./GotoPage":32}],39:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./UserAct"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&(NIApi.navigator.openUrl(e.param),i.successAction(e))})}}}),this.executedAction(arguments),!1},t}(o.UserAct);r._name="url",i.OpenUrl=r},{"../../EpubEvent":7,"./UserAct":42}],40:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./LightBox"),s=e("../../EpubEvent"),r=function(e){function t(i,n,o){var s=e.call(this,i,n,o)||this;return s.data=i,s.linksElem=n,s.index=o,s.pointerEvents="all",s.pointerCursor="pointer",s._static=t,s.init(),s}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t}(o.LightBox);r._name="popup",i.PopUp=r},{"../../EpubEvent":7,"./LightBox":36}],41:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./GotoPage"),s=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.pointerEvents="all",i.pointerCursor="pointer",i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openPrevious()})}}}),this.executedAction(arguments),!1},t}(o.GotoPage);r._name="prevPage",i.PrevPage=r},{"../../EpubEvent":7,"./GotoPage":32}],42:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubDomApi"),o=e("../../EpubEvent"),s=function(){function e(t,i,n){this.data=t,this.linksElem=i,this.index=n,this.pointerEvents="none",this.pointerCursor="auto",this._static=e,this.overrideOtherActions=!0,this.epubEvent=w.epubEvent}return e.prototype.init=function(){this.defineAction(),this.setPointers(),this.setTooltip()},e.prototype.defineAction=function(){0===this.index?this.setActionDefault():this.setAction()},e.prototype.setTooltip=function(e){void 0===e&&(e=""),"string"==typeof this.data.textField&&""!==this.data.textField.trim()&&(e=this.data.textField),""===e&&(e=w.Main.xmlManager.get("locale","tooltip_"+this.data.type)),this.linksElem.setAttribute("data-tooltip",e),w.Main.tooltipManager.register(this.linksElem)},e.prototype.setPointers=function(){this.linksElem.style.pointerEvents=this.pointerEvents,this.linksElem.style.cursor=this.pointerCursor},e.prototype.exec=function(e,t){return n["default"](this._static._name,[t,e.param,e]),this.executedAction(arguments),!1},e.prototype.executedAction=function(e){console.log("From LinksManager this action was exectuted",e)},e.prototype.setActionDefault=function(){var e=this.exec.bind(this,this.data,this.linksElem);this.linksElem.onclick=e,this.linksElem.ontouchend=e},e.prototype.setAction=function(){},e.prototype.successAction=function(e){this.epubEvent.fire({type:o.EPUB_EVENTS.ACTION_LINK_SUCCESS,data:{userAct:e}})},e}();s._name="userAct",i.UserAct=s},{"../../EpubDomApi":6,"../../EpubEvent":7}],43:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MailTo"),o=e("./OpenUrl"),s=e("./GotoPage"),r=e("./PrevPage"),a=e("./NextPage"),u=e("./PopUp"),h=e("./LightBox"),p=e("./LastPage"),l=e("./FirstPage"),c=e("./JavaScriptCall"),f=e("./History"),d={MailTo:n.MailTo,OpenUrl:o.OpenUrl,GotoPage:s.GotoPage,PrevPage:r.PrevPage,NextPage:a.NextPage,LastPage:p.LastPage,FirstPage:l.FirstPage,PopUp:u.PopUp,LightBox:h.LightBox,JavaScriptCall:c.JavaScriptCall,History:f.History},m=function(){function e(e,t,i,n){this.link=e,this.config=t,this.data=i,this.linksElem=n,this.userActs=[],this.setUserActs()}return e.prototype.makeActionFromUserAct=function(e,t){var i=[];for(var n in d)d[n]._name===e.type&&i.push(new d[n](e,this.linksElem,t));return i},e.prototype.setUserActs=function(){for(var e,t=0,i=this.data.length;t<i;t++)e=this.makeActionFromUserAct(this.data[t],t),0===e.length&&console.warn("useract type not supported :"+this.data[t].type,this.data[t]),this.userActs=this.userActs.concat(e)},e.prototype.stop=function(){},e.prototype.flush=function(){},e}();m._name="userActs",i.UserActs=m},{"./FirstPage":31,"./GotoPage":32,"./History":33,"./JavaScriptCall":34,"./LastPage":35,"./LightBox":36,"./MailTo":37,"./NextPage":38,"./OpenUrl":39,"./PopUp":40,"./PrevPage":41}],44:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubGesturesEvent"),o=e("./EpubPageEnrichment/IFrames"),s=e("./EpubPageEnrichment/Medias"),r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",a=0,u=function(){function e(e,t,i){this.epubPage=e,this.config=t,this.element=i,this.eventListeners=[],this.enableRegisterInteractiveHandlers=!1,this.started=!1,this.epubAnimationsHistory=[],this.epubPageEnrichmentID=a++}return e.getActionHistoryTemplate=function(){return{func:null,args:[]}},e.prototype.start=function(){this.started=!0,this.startGifs();var e=this.element.childNodes[0],t=e.getAttribute("data-onload");return null!==t&&t.indexOf("RegisterInteractiveHandlers")===-1?void(this.enableRegisterInteractiveHandlers=!1):(this.enableRegisterInteractiveHandlers=!0,void this.registerInteractiveHandlers())},e.prototype.stop=function(){this.started!==!1&&(this.started=!1,this.stopGifs(),this.enableRegisterInteractiveHandlers!==!1&&(this.stopMedias(),this.removeEventListeners(),this.reloadActionHistory(),this.stopIFrames()))},e.prototype.flush=function(){this.stop(),this.gifs=null},e.prototype.makeDefaultPreventGesture=function(){n["default"].prototype.preventAllGesture()},e.prototype.evalActions=function(e,t){new Function("_self","selfContainerID","with(_self){ "+e+" }")(this,t)},e.prototype.removeEventListeners=function(){for(var e=0,t=this.eventListeners.length;e<t;e++)this.eventListeners[e].element.removeEventListener(this.eventListeners[e].type,this.eventListeners[e].func,this.eventListeners[e].useCapture);this.eventListeners=[]},e.prototype.addToEventListeners=function(e,t,i,n){void 0===n&&(n=!1),e.addEventListener(i,t,n),this.eventListeners.push({element:e,type:i,func:t,useCapture:n})},e.prototype.reloadActionHistory=function(){for(var e=this.epubAnimationsHistory.length;e--;)this.epubAnimationsHistory[e].func(this.epubAnimationsHistory[e].args[0],this.epubAnimationsHistory[e].args[1]);this.epubAnimationsHistory=[]},e.prototype.registerInteractiveHandlers=function(){this.registerButtonEventHandlers(),this.processAnimations(),this.processMediaGesture(),this.processIFrames()},e.prototype.processMediaGesture=function(){this.medias=this.element.querySelectorAll("video,audio"),0!==this.medias.length&&(this.mediasObject=new s.Medias(this.medias,this.config),this.mediasObject.start())},e.prototype.processIFrames=function(){this.iFrames=this.element.querySelectorAll("iframe"),0!==this.iFrames.length&&(this.iFramesObject=new o.IFrames(this.iFrames,this.config),this.iFramesObject.start())},e.prototype.startGifs=function(){this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var e=0,t=this.gifs.length;e<t;e++){var i=this.gifs[e];null===i.getAttribute("data-src")&&i.setAttribute("data-src",i.getAttribute("src")),i.src=r,function(e){setTimeout(function(){e.classList.add("gif-visible"),e.src=e.getAttribute("data-src")},0)}(i)}},e.prototype.stopGifs=function(){this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var e=0,t=this.gifs.length;e<t;e++){var i=this.gifs[e];null===i.getAttribute("data-src")&&i.setAttribute("data-src",i.getAttribute("src")),i.src=r}},e.prototype.stopIFrames=function(){this.iFramesObject&&this.iFramesObject.stop()},e.prototype.stopMedias=function(){this.mediasObject&&this.mediasObject.stop()},e.prototype.processMedia=function(){for(var e,t,i,n=this.element.querySelectorAll("._idGenMedia"),o=0,s=n.length;o<s;o++)if(e=n[o].getAttribute("data-mediaOnPageLoadActions")){t=n[o].querySelectorAll("video,audio");for(var r=0,a=t.length;r<a;r++)t[r].paused&&(i=t[r],this.evalActions(e,i))}},e.prototype.processAnimations=function(){var e=this.element.querySelectorAll("._idGenAnimation");e.length>0&&(this.epubPage.pageContainsCPUElement=!0);for(var t,i,n,o=0;o<e.length;o++)t=e[o].getAttribute("data-animationOnPageLoadActions"),t&&(i=e[o],this.evalActions(t,i)),n=e[o].className,n.indexOf("_idGenCurrentState")!=-1&&(t=e[o].getAttribute("data-animationOnStateLoadActions"),t&&(i=e[o],this.evalActions(t,i))),t=e[o].getAttribute("data-animationOnSelfClickActions"),t&&(this.addToEventListeners(e[o],this.onTouchEndForAnimations.bind(this,e[o]),"touchend",!1),this.addToEventListeners(e[o],this.onMouseUpForAnimations.bind(this,e[o]),"mouseup",!1)),t=e[o].getAttribute("data-animationOnSelfRolloverActions"),t&&this.addToEventListeners(e[o],this.onMouseOverForAnimations.bind(this,e[o]),"mouseover",!1);this.addToEventListeners(this.element,this.onPageTouchEndForAnimations.bind(this,this.element),"touchend",!1),this.addToEventListeners(this.element,this.onPageMouseUpForAnimations.bind(this,this.element),"mouseup",!1)},e.prototype.onMediaChange=function(e,t){this.makeDefaultPreventGesture()},e.prototype.onPageTouchEndForAnimations=function(e,t){for(var i,n,o=this.element.querySelectorAll("._idGenAnimation"),s=0;s<o.length;s++)i=o[s].getAttribute("data-animationOnPageClickActions"),i&&(n=o[s],this.evalActions(i,n))},e.prototype.onPageMouseUpForAnimations=function(e,t){var i="ontouchstart"in document.documentElement;if(!i)for(var n,o,s=this.element.querySelectorAll("._idGenAnimation"),r=0;r<s.length;r++)n=s[r].getAttribute("data-animationOnPageClickActions"),n&&(o=s[r],this.evalActions(n,o))},e.prototype.onTouchEndForAnimations=function(e,t){for(var i,n,o="."+e.getAttribute("data-animationObjectType"),s=this.element.querySelectorAll(o),r=0;r<s.length;r++)i=s[r].getAttribute("data-animationOnSelfClickActions"),i&&(n=s[r],this.evalActions(i,n))},e.prototype.onMouseUpForAnimations=function(e,t){var i="ontouchstart"in document.documentElement;if(!i)for(var n,o,s="."+e.getAttribute("data-animationObjectType"),r=this.element.querySelectorAll(s),a=0;a<r.length;a++)n=r[a].getAttribute("data-animationOnSelfClickActions"),n&&(o=r[a],this.evalActions(n,o))},e.prototype.onMouseOverForAnimations=function(e,t){var i="ontouchstart"in document.documentElement;if(!i){var n=e.getAttribute("data-idGenAnimationClass"),o=e.className;if(null===n||o.indexOf(n)==-1){console.log(o);for(var s,r,a="."+e.getAttribute("data-animationObjectType"),u=this.element.querySelectorAll(a),h=0;h<u.length;h++)s=u[h].getAttribute("data-animationOnSelfRolloverActions"),s&&(r=u[h],this.evalActions(s,r))}}},e.prototype.registerButtonEventHandlers=function(){for(var e=this.element.querySelectorAll("._idGenButton"),t=0;t<e.length;t++)this.addToEventListeners(e[t],this.onTouchStart.bind(this,e[t]),"touchstart",!1),this.addToEventListeners(e[t],this.onTouchEnd.bind(this,e[t]),"touchend",!1),this.addToEventListeners(e[t],this.onMouseDown.bind(this,e[t]),"mousedown",!1),this.addToEventListeners(e[t],this.onMouseUp.bind(this,e[t]),"mouseup",!1),this.addToEventListeners(e[t],this.onMouseOver.bind(this,e[t]),"mouseover",!1),this.addToEventListeners(e[t],this.onMouseOut.bind(this,e[t]),"mouseout",!1)},e.prototype.hasAppearance=function(e,t){for(var i,n=e.children,o=0;o<n.length;o++)if(i=n[o].className,i.indexOf(t)!=-1)return!0;return!1},e.prototype.isDescendantOf=function(e,t){for(var i=e;i;){if(i==t)return!0;i=i.parentNode}return!1},e.prototype.addClass=function(t,i){if(null!==i&&t.classList.contains(i)!==!0){var n=e.getActionHistoryTemplate();n.func=this.removeClass.bind(this),n.args.push(t),n.args.push(i),this.epubAnimationsHistory.push(n),t.classList.add(i)}},e.prototype.removeClass=function(t,i){if(null!==i&&t.classList.contains(i)!==!1){var n=e.getActionHistoryTemplate();n.func=this.addClass.bind(this),n.args.push(t),n.args.push(i),this.epubAnimationsHistory.push(n),t.classList.remove(i)}},e.prototype.onMouseDown=function(e,t){var i="ontouchstart"in document.documentElement;if(!i){this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var n=e.getAttribute("data-clickactions");n&&this.evalActions(n,null)}},e.prototype.onMouseUp=function(e,t){var i="ontouchstart"in document.documentElement;if(!i){this.removeClass(e,"_idGenStateClick");var n=e.getAttribute("data-releaseactions");n&&this.evalActions(n,null)}},e.prototype.onMouseOver=function(e,t){var i="ontouchstart"in document.documentElement;if(!(i||t.relatedTarget&&this.isDescendantOf(t.relatedTarget,e))){this.hasAppearance(e,"_idGen-Appearance-Rollover")&&this.addClass(e,"_idGenStateHover");var n=e.getAttribute("data-rolloveractions");n&&this.evalActions(n,null)}},e.prototype.onMouseOut=function(e,t){var i="ontouchstart"in document.documentElement;if(!(i||t.relatedTarget&&this.isDescendantOf(t.relatedTarget,e))){this.removeClass(e,"_idGenStateHover"),this.removeClass(e,"_idGenStateClick");var n=e.getAttribute("data-rolloffactions");n&&this.evalActions(n,null)}},e.prototype.onTouchStart=function(e,t){this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var i=e.getAttribute("data-clickactions");i&&this.evalActions(i,null)},e.prototype.onTouchEnd=function(e,t){this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-releaseactions");i&&this.evalActions(i,null)},e.prototype.onHide=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.addClass(t,"_idGenStateHide"))},e.prototype.onShow=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.removeClass(t,"_idGenStateHide"))},e.prototype.handleMSOStateParentOfObject=function(e){for(var t,i,n=e,o=n.parentNode;null!==o&&!t;)i=o.className,i&&i.indexOf("_idGenMSO")!=-1?t=!0:n=o,o=n.parentNode;if(t)for(var s=n,r=o.children,a=0,u=void 0;u=r[a];a++)if(i=u.className,i.indexOf("_idGenCurrentState")!=-1)return this.handleMediaInMSOState(u),this.removeClass(u,"_idGenCurrentState"),this.addClass(u,"_idGenStateHide"),this.removeClass(s,"_idGenStateHide"),void this.addClass(s,"_idGenCurrentState")},e.prototype.goToDestination=function(e){if(e=e.trim(),0===e.indexOf("http"))return void webpublicationNamespace.EpubDomApi("url",[null,e]);if(0===e.indexOf("javascript")||0===e.indexOf("js:")||e.indexOf("js :"))return void webpublicationNamespace.EpubDomApi("javascript",[null,e]);if(0===e.indexOf("NIApi"))return void webpublicationNamespace.EpubDomApi("NIApi",[null,e]);var t=/-([0-9]*).xhtml$/gim,i=t.exec(e)||[];i.length>0&&webpublicationNamespace.EpubDomApi("gotoPage",[null,~~i[1]])},e.prototype.handleMediaInMSOState=function(e){for(var t,i,n=e.getElementsByTagName("*"),o=0;o<n.length;o++)t=n[o],i=t.tagName.toLowerCase(),"video"!=i&&"audio"!=i||t.paused||(t.currentTime=0,t.pause())},e.prototype.handleAnimationInMSOState=function(e){var t,i,n,o,s=e.className;s.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),i=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,i),this.addClass(e,t),n=e.getAttribute("data-animationOnStateLoadActions"),n&&(o=e.id,this.evalActions(n,o)));for(var r,a=e.getElementsByTagName("*"),u=0;u<a.length;u++)r=a[u],s=r.className,s.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),i=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,i),this.addClass(e,t),n=r.getAttribute("data-animationOnStateLoadActions"),n&&(o=r.id,this.evalActions(n,o)))},e.prototype.goToNextState=function(e,t,i){var n=this;this.makeDefaultPreventGesture(),setTimeout(function(){n.goToNextStateWrapper(e,t)},1e3*i)},e.prototype.goToNextStateWrapper=function(e,t){var i,n,o,s=this.element.querySelector("#"+e);if(null!==s){this.removeClass(s,"_idGenStateHide"),i=s.children;for(var r=0,a=void 0;a=i[r];r++)if(n=a.className,n.indexOf("_idGenCurrentState")!=-1)return o=t?r==i.length-1?i[0]:i[r+1]:r==i.length-1?i[r]:i[r+1],this.handleMediaInMSOState(a),this.removeClass(a,"_idGenCurrentState"),this.addClass(a,"_idGenStateHide"),this.removeClass(o,"_idGenStateHide"),this.addClass(o,"_idGenCurrentState"),void this.handleAnimationInMSOState(o)}},e.prototype.goToPreviousState=function(e,t,i){var n=this;this.makeDefaultPreventGesture(),setTimeout(function(){n.goToPreviousStateWrapper(e,t)},1e3*i)},e.prototype.goToPreviousStateWrapper=function(e,t){var i,n,o,s=document.getElementById(e);if(s){this.removeClass(s,"_idGenStateHide"),i=s.children;for(var r=0,a=void 0;a=i[r];r++)if(n=a.className,n.indexOf("_idGenCurrentState")!=-1)return o=t?0==r?i[i.length-1]:i[r-1]:0==r?i[0]:i[r-1],this.handleMediaInMSOState(a),this.removeClass(a,"_idGenCurrentState"),this.addClass(a,"_idGenStateHide"),this.removeClass(o,"_idGenStateHide"),this.addClass(o,"_idGenCurrentState"),void this.handleAnimationInMSOState(o)}},e.prototype.playAnimatedElement=function(e,t,i){var n=this;this.removeClass(e,"_idGenStateHide"),this.removeClass(e,"_idGenPauseAnimation");var o=e.className,s=e.getAttribute("data-idGenAnimationClass");o.indexOf(t)==-1&&o.indexOf(s)==-1?(this.addClass(e,t),e.setAttribute("data-idGenAnimationClass",t)):(this.removeClass(e,t),this.removeClass(e,s),e.removeEventListener("webkitAnimationEnd",function(t){n.onPlayAnimationEnd(e,i,t)}),e.removeEventListener("animationend",function(t){n.onPlayAnimationEnd(e,i,t)}),setTimeout(function(){n.addClass(e,t)},10),e.setAttribute("data-idGenAnimationClass",t)),this.addToEventListeners(e,this.onPlayAnimationEnd.bind(this,e,i),"webkitAnimationEnd"),this.addToEventListeners(e,this.onPlayAnimationEnd.bind(this,e,i),"animationend")},e.prototype.playAnimation=function(e,t,i,n){var o,s=this;if(o="object"==typeof e?e:document.getElementById(e)){this.handleMSOStateParentOfObject(o);var r=o.getAttribute("data-idGenAnimationStartState"),a=o.getAttribute("data-idGenAnimationEndState");this.removeClass(o,a),this.addClass(o,r),setTimeout(function(){s.playAnimatedElement(o,t,n)},1e3*i)}},e.prototype.onPlayAnimationEnd=function(e,t,i){var n=e.getAttribute("data-idGenAnimationClass"),o=e.getAttribute("data-idGenAnimationStartState"),s=e.getAttribute("data-idGenAnimationEndState");this.removeClass(e,n),this.removeClass(e,o),this.addClass(e,s),t&&this.addClass(e,"_idGenStateHide"),i.stopPropagation()},e}();i["default"]=u},{"./EpubGesturesEvent":8,"./EpubPageEnrichment/IFrames":46,"./EpubPageEnrichment/Medias":48}],45:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../utils/isElementVisible"),o=e("../EpubPage/shapes/utils/IframeInteractions"),s=e("../utils/enums"),r=function(){function e(e,t){this.iFrame=e,this.config=t,this.foreground=!0,this.startableAsyncDate=0,this.status={start:!1,visible:!1},this.init()}return e.prototype.init=function(){this.element=this.iFrame.parentElement,this.iFrame.style.pointerEvents="none",this.iFrame.setAttribute("data-foreground",this.foreground?"true":"false"),this.iframeInteractions=new o.IframeInteractions(this,this.config,this.iFrame,this.element,this.foreground),this.iFrame.addEventListener("load",this.loaded.bind(this)),this._onScroll=this.onScroll.bind(this),window.document.addEventListener("scroll",this._onScroll,!0),window.addEventListener("resize",this._onScroll,!0)},e.prototype.loaded=function(){try{this.iFrameContentWindow=this.iFrame.contentWindow,this.foreground===!0&&"object"==typeof this.iFrameContentWindow.AdobeAn?this.iframeInteractions.init(this.iFrameContentWindow):this.foreground!==!0&&this.config.readerPageSrcType!==s.READER_TYPES.EPUB_HTML||(this.iFrame.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow))}catch(e){this.iFrame.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow)}},e.prototype.onScroll=function(){this.startableAsync()},e.prototype.startableAsync=function(){var e=this;return clearTimeout(this.startableAsyncTimer),Date.now()-this.startableAsyncDate>1e3?(this.startableAsyncDate=Date.now(),void this.startable()):void(this.startableAsyncTimer=setTimeout(function(){e.startableAsyncDate=Date.now(),e.startable()},100))},e.prototype.startable=function(){return this.status.visible=n.isElementVisible(window.document.documentElement,this.iFrame),this.status.start===!1||this.status.visible===!1?void(this.iFrame.hasAttribute("src")===!0&&this.iFrame.removeAttribute("src")):void(this.iFrame.hasAttribute("src")===!1&&this.iFrame.setAttribute("src",this.iFrame.getAttribute("data-src")))},e.prototype.start=function(){this.onScroll(),this.status.start=!0,this.startableAsync()},e.prototype.stop=function(){this.iFrame.hasAttribute("src")===!0&&this.iFrame.removeAttribute("src"),window.document.removeEventListener("scroll",this._onScroll,!0),window.removeEventListener("resize",this._onScroll,!0),this.status.start=!1,this.iframeInteractions.flush()},e}();i.IFrame=r},{"../EpubPage/shapes/utils/IframeInteractions":30,"../utils/enums":79,"../utils/isElementVisible":81}],46:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./IFrame"),o=function(){function e(e,t){this.htmlIframes=e,this.config=t,this.iFrames=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlIframes.length;e<t;e++)this.iFrames.push(new n.IFrame(this.htmlIframes[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].start()},e.prototype.stop=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].stop()},e}();i.IFrames=o},{"./IFrame":45}],47:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubGesturesEvent"),o=e("../utils/isElementVisible"),s=function(){function e(e,t){this.media=e,this.config=t,this.foreground=!0,this.startableAsyncDate=0,this.status={start:!1,visible:!1},this.init()}return e.prototype.init=function(){this._onMediaChange=this.onMediaChange.bind(this),this.media.setAttribute("controlsList","nodownload"),this.media.addEventListener("volumechange",this._onMediaChange,!0),this.media.addEventListener("seeking",this._onMediaChange,!0)},e.prototype.onMediaChange=function(){n["default"].prototype.preventAllGesture()},e.prototype.onScroll=function(){this.startableAsync()},e.prototype.startableAsync=function(){var e=this;return clearTimeout(this.startableAsyncTimer),Date.now()-this.startableAsyncDate>1e3?(this.startableAsyncDate=Date.now(),void this.startable()):void(this.startableAsyncTimer=setTimeout(function(){e.startableAsyncDate=Date.now(),e.startable()},100))},e.prototype.startable=function(){return this.status.visible=o.isElementVisible(window.document.documentElement,this.media),this.status.start===!1||this.status.visible===!1?void this.media.pause():void(this.media.hasAttribute("autoplay")===!0&&"false"!==this.media.getAttribute("autoplay")&&this.media.play())},e.prototype.start=function(){this.status.start=!0,this.startableAsync()},e.prototype.stop=function(){this.media.removeEventListener("volumechange",this._onMediaChange,!0),this.media.removeEventListener("seeking",this._onMediaChange,!0),this.status.start=!1,this.media.pause()},e}();i.Media=s},{"../EpubGesturesEvent":8,"../utils/isElementVisible":81}],48:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Media"),o=function(){function e(e,t){this.htmlMedias=e,this.config=t,this.medias=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlMedias.length;e<t;e++)this.medias.push(new n.Media(this.htmlMedias[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].start()},e.prototype.stop=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].stop()},e}();i.Medias=o},{"./Media":47}],49:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubPage"),o=e("./utils/enums"),s=function(){function e(e,t,i){this.epubSpreads=e,this.config=t,this.epubCssManager=i,this.currentPage=0,this.pageQuantity=0,this.imagesMdpi=o.PagesImagesQualities[o.PagesImagesQualities.mdpi],this.imagesHdpi=o.PagesImagesQualities[o.PagesImagesQualities.hdpi],this.parent=this.epubSpreads,this.currentPage=this.config.currentPage,this.pageQuantity=this.config.pageQuantity,this.setPagesObject()}return Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),e.prototype.setPagesQty=function(){this.epubPages=new Array(this.pageQuantity),this.epubPagesRequested=new Array(this.pageQuantity)},e.prototype.setPageObject=function(e,t){return this.readerPageSrcType===o.READER_TYPES.EPUB_HTML?void(e.src=w.Main.pageManager.getEpubHtml(t)):this.readerPageSrcType===o.READER_TYPES.PDF_HTML?void(e.src=w.Main.pageManager.getPdfHtml(t)):this.readerPageSrcType===o.READER_TYPES.PDF_SVG?void(e.src=w.Main.pageManager.getSvg(t)):this.readerPageSrcType===o.READER_TYPES.PDF_IMG?(e.srcHdpi=w.Main.pageManager.getImage(this.imagesHdpi,t),void(e.src=w.Main.pageManager.getImage(this.imagesMdpi,t))):this.readerPageSrcType===o.READER_TYPES.PDF_PDF?void(e.src=w.Main.pageManager.getPdf(t)):void 0},e.prototype.setPagesObject=function(){this.setPagesQty();for(var e=0;e<this.pageQuantity;e++)this.epubPages[e]=new n["default"](this,this.config,e+1,this.epubCssManager),this.setPageObject(this.epubPages[e],e+1)},e.prototype.pageExist=function(e){return"undefined"!=typeof this.epubPages[e]},e.prototype.pageGetForSpread=function(e){return this.epubPagesRequested[e]=!0,this.epubPages[e]},e.prototype.pageGet=function(e){return this.epubPages[e]},e.prototype.resetRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]=!1},e.prototype.flushNotRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]===!1&&this.epubPages[e].flush()},e}();i["default"]=s},{"./EpubPage":16,"./utils/enums":79}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.epubScrollables=e,this.config=t,this.epubSpread=i,this.x=0,this.y=0,this.parent=this.epubScrollables,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize}return e}();i["default"]=n},{}],51:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubScrollable"),o=e("./EpubGesturesEvent"),s=e("./EpubEvent"),r=400,a=function(){function e(e,t,i){this.epubSpreads=e,this.config=t,this.mainViewElement=i,this.scrollablesLength=0,this.xStart=0,this.yStart=0,this.x=0,this.y=0,this.tapeGestureDate=0,this.epubEvent=w.epubEvent,this.parent=this.epubSpreads,this.screenSize=this.epubSpreads.screenSize,this.mainViewElementSize=this.epubSpreads.mainViewElementSize,this.element=i,this.scrollables=[],this.permissionTapList=[],this.epubGesturesEvent=new o["default"](this,this.element),this.spreadDraggable&&(this.epubGesturesEvent.addEventListener(o["default"].GESTURESNAME.SWIPEGESTURE,this.trySwip.bind(this)),this.epubGesturesEvent.addEventListener(o["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.addEventListener(o["default"].GESTURESNAME.MOUSEWHEELGESTURE,this.onMouseWheel.bind(this))),this.epubGesturesEvent.addEventListener(o["default"].GESTURESNAME.TAPGESTURE,this.checkLastActionForTapGesture.bind(this)),this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CLICK_PERMISSION,this.permissionTapEvent.bind(this)),this.epubGesturesEvent.setEnableScrollElement(!1),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.epubGesturesEvent.setEnableScrollElement(!0)}return Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationType",{get:function(){return this.config.navigationType},enumerable:!0,configurable:!0}),e.prototype.onMouseWheel=function(t){var i=Date.now(),n=0,o=(t.deltaX>t.deltaY?"x":"y",e.mouseWheelLastDelta,!1);"x"===this.navigationType&&t.gestureData.wheel.isX?n=t.deltaX:"y"===this.navigationType&&t.gestureData.wheel.isY&&(n=t.deltaY),n>0?n=1:n<0&&(n=-1),n!==e.mouseWheelLastDelta&&(o=!0),e.mouseWheelLastDelta=n,e.mouseWheelLast=i,n>0?this.epubSpreads.epubManager.pageNext():n<0&&this.epubSpreads.epubManager.pagePrevious()},e.prototype.initDrag=function(e,t){this.xStart=e,this.yStart=t},e.prototype.drag=function(e,t){return[this.x=e-this.xStart,this.y=t-this.yStart]},e.prototype.resetDrag=function(){return[this.xStart=this.x=0,this.yStart=this.y=0];
},e.prototype.updateScrollablesDrop=function(e,t){0===t[0]&&0===t[1]||this.epubSpreads.gotoPageByCoordsDiff(e.gestureData)},e.prototype.updateScrollables=function(e,t){this.epubSpreads.scrollTo(t[0],t[1])},e.prototype.preserveScrollElement=function(){this.element.addEventListener("scroll",function(e){o["default"].prototype.preventAllGesture()},!0)},e.prototype.trySwip=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,this.updateScrollablesDrop(e,this.drag(e.epubClientX,e.epubClientY))},e.prototype.tryDrag=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff&&this.initDrag(e.epubClientX,e.epubClientY),this.updateScrollables(e,this.drag(e.epubClientX,e.epubClientY))},e.prototype.addScrollable=function(e){this.scrollables.push(new n["default"](this,this.config,e)),this.scrollablesLength++},e.prototype.permissionTapEvent=function(e){this.permissionTapList.push({action:e.data.action,date:Date.now()})},e.prototype.resetPermissionTapActions=function(){this.permissionTapList=[]},e.prototype.checkLastActionForTapGesture=function(e){for(var t=[],i=0,n=this.permissionTapList.length;i<n;i++)Date.now()-this.permissionTapList[i].date<r?t.push(this.permissionTapList[i]):this.permissionTapList[i].action(Promise.resolve(!1));if(this.permissionTapList=[],0===t.length)return void("pointercancel"!==e.type&&this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CLICK}));for(var i=0,n=t.length;i<n;i++)t[i].action(Promise.resolve(!0))},e}();a.mouseWheelLast=0,a.mouseWheelLastDelta=0,i["default"]=a},{"./EpubEvent":7,"./EpubGesturesEvent":8,"./EpubScrollable":50}],52:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubSpreadZoomable"),o=e("./ProtoHTMLElement"),s=function(){function e(e,t,i,s){this.epubSpreads=e,this.config=t,this.spreadIndex=i,this.mainViewElement=s,this.optimizeQuality=!0,this.cssClassSpreadVisible="spread-is-visible",this.lastOffset=0,this.spreadOffset=0,this.parent=this.epubSpreads,this.epubEvent=w.epubEvent,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.pagesInSpread=[],this.elementSize={width:0,height:0},this.epubSpreadZoomable=new n["default"](this,this.config),this.spreadHTMLElement=new o["default"](this.config),this.spreadHTMLElement.initSpread(this,this.config,this.epubSpreadZoomable,this.spreadIndex),this.element=this.spreadHTMLElement.element,this.spreadHTMLElement.optimizeQuality=this.optimizeQuality,this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.spreadHTMLElement.setSpreadScrollable(!0,"y")}return Object.defineProperty(e.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstCoverPage",{get:function(){return this.config.firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"epubPages",{get:function(){return this.parent.epubPages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.parent.pagesBySpread},enumerable:!0,configurable:!0}),e.prototype.getSpreadOffsetByPageIndex=function(e){return this.parent.getSpreadsOffsetByPageIndex(e)[this.spreadIndex]},e.prototype.getPageIndexFromSpreadOffset=function(e,t,i){return t+e*i},e.prototype.updateSpreadAttributes=function(e,t){return 1===this.pagesBySpread?0:1===e&&1===t?1:e===this.pageQuantity&&1===t?-1:0},e.prototype.updatePages=function(e){var t=this,i=0,n=0,o=e.length,s=!1;if(0===o)return this.epubSpreadZoomable.resetContent(),void(this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded"));for(this.spreadHTMLElement.setBackgroundColor(e),this.pagesInSpread=e,this.epubSpreadZoomable.contentLength!==o&&(s=!0);i<o;i++)this.epubSpreadZoomable.lastContentIDs.indexOf(this.pagesInSpread[i].pageIndex)===-1&&(s=!0);s===!0&&(this.epubSpreadZoomable.resetContent(),this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded")),this.epubSpreadZoomable.contentLength=o,n=this.updateSpreadAttributes(this.pagesInSpread[0].pageIndex,o),this.epubSpreadZoomable.contentPosition=n;var r=[],a=!1;for(i=0;i<o;i++)this.pagesInSpread[i].atSpreadOffset=this.spreadOffset,s===!0?r.push(this.epubSpreadZoomable.updateContent(this.pagesInSpread[i])):this.pagesInSpread[i].epubPageEnrichmentStat(),this.pagesInSpread[i].pageContainsCPUElement===!0&&(a=!0);this.epubSpreadZoomable.setContainIframe(a),Promise.all(r).then(function(e){0!==e.length&&t.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")===!1&&t.epubSpreadZoomable.element.classList.add("epub-all-pages-loaded")})},e.prototype.isPageInSpread=function(e){return((e.pageIndex+this.firstCoverPage)%this.pagesBySpread||this.pagesBySpread)===this.spreadIndex},e.prototype.displaySpread=function(){this.mainViewElement.appendChild(this.element)},e.prototype.updateSpread=function(e){var t,i;this.lastOffset=this.spreadOffset,this.spreadOffset=e,0===this.spreadOffset?this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!1&&this.spreadHTMLElement.element.classList.add(this.cssClassSpreadVisible):this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!0&&this.spreadHTMLElement.element.classList.remove(this.cssClassSpreadVisible),this.epubSpreadZoomable.reset(),t=this.getPageIndexFromSpreadOffset(e,this.currentPage,this.pagesBySpread),i=this.getPagesByPageIndex(t),this.spreadHTMLElement.element.setAttribute("pages",i.length.toString()),this.updatePages(i)},e.prototype.updateSpreadSize=function(){this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight,this.epubSpreadZoomable.updateSize(),this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight},e.prototype.getPagesByPageIndex=function(e){var t,i,n=[];for(e-=1,t=~~((e+this.firstCoverPage)/this.pagesBySpread)*this.pagesBySpread,i=t+this.pagesBySpread;t<i;)this.epubPages.pageExist(t-this.firstCoverPage)===!0&&n.push(this.epubPages.pageGetForSpread(t-this.firstCoverPage)),t++;return n},e}();i["default"]=s},{"./EpubSpreadZoomable":53,"./ProtoHTMLElement":60}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubEvent"),o=e("./ProtoHTMLElement"),s=e("./EpubSpreadZoomableAnimations"),r=e("./EpubZoom"),a=e("./EpubGesturesEvent"),u=e("./utils/functions"),h=function(){function e(e,t){this.epubSpread=e,this.config=t,this.contentLength=0,this.contentPosition=0,this.scale=0,this._x=0,this._y=0,this._xOrigin=0,this._yOrigin=0,this.widthScaled=0,this.heightScaled=0,this.mousedown=!1,this.savedEvent=null,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.isDesktop=w.Param.userAgent.isDesktop(),this.epubEvent=w.epubEvent,this.parent=this.epubSpread,this.screenSize=this.epubSpread.screenSize,this.mainViewElementSize=this.epubSpread.mainViewElementSize,this.updateSize=this.updateSize.bind(this),this.lastContentIDs=[],this._pageSizeType={coverTop:this.pageTypeCoverTop.bind(this),coverMiddle:this.pageTypeCoverMiddle.bind(this),contain:this.pageTypeContain.bind(this),coverHorizontally:this.coverHorizontally.bind(this),custom:this.pageTypeCustom.bind(this)},this.elementSize={width:0,height:0},this.epubZoom=new r["default"](this,this.config),this.spreadZoomableHTMLElement=new o["default"](this.config),this.spreadZoomableHTMLElement.initZoomable(this,this.config),this.element=this.spreadZoomableHTMLElement.element,this.epubSpreadZoomableAnimations=new s["default"](this,this.config,this.spreadZoomableHTMLElement),this.epubGesturesEvent=new a["default"](this,this.spreadZoomableHTMLElement.element),this.zoomDoubleClick===!0&&this.epubGesturesEvent.addEventListener(a["default"].GESTURESNAME.DBLTAPGESTURE,this.tryZoom.bind(this)),this.zoomSingleClick===!0&&(this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CLICK,this.tryZoomOneClick.bind(this)),this.epubGesturesEvent.addEventListener(a["default"].GESTURESNAME.TAPGESTURE,this.saveEvent.bind(this))),this.epubGesturesEvent.addEventListener(a["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.setEnableScrollElement(!1),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&this.epubGesturesEvent.setEnableScrollElement(!0)}return Object.defineProperty(e.prototype,"zoomDoubleClick",{get:function(){return this.config.zoomDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentWidth",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentHeight",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadOffset",{get:function(){return this.parent.spreadOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeType",{get:function(){return"function"==typeof this._pageSizeType[this.config.pageSizeType]?this._pageSizeType[this.config.pageSizeType]:this._pageSizeType.contain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coverPageCenter",{get:function(){return this.config.coverPageCenter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeMaxWidth",{get:function(){return this.config.pageSizeMaxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeMaxHeight",{get:function(){return this.config.pageSizeMaxHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransform",{get:function(){return this.config.useMatrixTransformZoomable},enumerable:!0,configurable:!0}),e.prototype.roundPxDevice=function(e){return~~(100*e)/100},e.prototype.coverHorizontally=function(){var e=this.parentWidth,t=this.parentHeight,i=this.paddingLeft,n=this.paddingTop,o=this.paddingRight,s=this.paddingBottom,r=0,a=0,u=0,h=0,p=0,l=0,c=0;return 0!==this.width&&0!==this.height&&(u=(e-i-o)/this.width,u=this.roundPxDevice(u),r=u*this.width,a=u*this.height,r=this.roundPxDevice(r),a=this.roundPxDevice(a),this.pageSizeMaxWidth>0&&(l=r/this.pageSizeMaxWidth),this.pageSizeMaxHeight>0&&(c=a/this.pageSizeMaxHeight),l=this.roundPxDevice(l),c=this.roundPxDevice(c),this.pageSizeMaxWidth>0&&l>=c?r>=this.pageSizeMaxWidth&&(u=this.pageSizeMaxWidth/this.width,r=u*this.width,a=u*this.height):this.pageSizeMaxHeight>0&&l<c&&a>=this.pageSizeMaxHeight&&(u=this.pageSizeMaxHeight/this.height,r=u*this.width,a=u*this.height),u=this.roundPxDevice(u),r=this.roundPxDevice(r),a=this.roundPxDevice(a),h=(e+i-o)/2-r/2,p=a+n-s>=t?n:(t+n-s)/2-a/2,h=this.roundPxDevice(h),p=this.roundPxDevice(p),this.widthScaled=r,this.heightScaled=a,this.scale!==u&&(this.scale=u,this._x=h,this._y=p,this.updateSizeFromPoint([u,0,0,h,p])),!0)},e.prototype.pageTypeCoverMiddle=function(){var e=this.parentWidth,t=this.parentHeight,i=0,n=0,o=0,s=0,r=0;return 0!==this.width&&0!==this.height&&(i=e/this.width,n=t/this.height,o=i<n?n:i,this.widthScaled=o*this.width,this.heightScaled=o*this.height,s=e/2-this.widthScaled/2,r=t/2-this.heightScaled/2,this.scale!==o&&(this.scale=o,this._x=s,this._y=r,this.updateSizeFromPoint([o,0,0,s,r])),!0)},e.prototype.pageTypeCoverTop=function(){var e=this.parentWidth,t=this.parentHeight,i=0,n=0,o=0,s=0,r=0;return 0!==this.width&&0!==this.height&&(i=e/this.width,n=t/this.height,o=i<n?n:i,this.widthScaled=o*this.width,this.heightScaled=o*this.height,s=e/2-this.widthScaled/2,this.scale!==o&&(this.scale=o,this._x=s,this._y=r,this.updateSizeFromPoint([o,0,0,s,r])),!0)},e.prototype.pageTypeContain=function(){var e=this.parentWidth,t=this.parentHeight,i=this.paddingLeft,n=this.paddingTop,o=this.paddingRight,s=this.paddingBottom,r=0,a=0,u=0,h=0,p=0,l=0,c=0,f=0,d=0;return 0!==this.width&&0!==this.height&&(u=(e-i-o)/this.width,h=(t-n-s)/this.height,p=u>h?h:u,p=this.roundPxDevice(p),r=p*this.width,a=p*this.height,r=this.roundPxDevice(r),a=this.roundPxDevice(a),this.pageSizeMaxWidth>0&&(f=r/this.pageSizeMaxWidth),this.pageSizeMaxHeight>0&&(d=a/this.pageSizeMaxHeight),this.pageSizeMaxWidth>0&&f>=d?r>=this.pageSizeMaxWidth&&(p=this.pageSizeMaxWidth/this.width,p=this.roundPxDevice(p),r=p*this.width,a=p*this.height):this.pageSizeMaxHeight>0&&f<d&&a>=this.pageSizeMaxHeight&&(p=this.pageSizeMaxHeight/this.height,p=this.roundPxDevice(p),r=p*this.width,a=p*this.height),r=this.roundPxDevice(r),a=this.roundPxDevice(a),l=0===this.contentPosition||this.coverPageCenter===!0?.5*(e+i-o)-.5*r:1===this.contentPosition?.5*(e+i-o):.5*(e+i-o)-r,c=.5*(t+n-s)-.5*a,l+r>e+i-o&&(l-=l+r-(e+i-o)),this.widthScaled=r,this.heightScaled=a,l=this.roundPxDevice(l),c=this.roundPxDevice(c),this.scale!==p&&(this.scale=p,this._x=l,this._y=c,this.updateSizeFromPoint([p,0,0,l,c])),!0)},e.prototype.pageTypeCustom=function(e,t){console.log("pageTypeCustom")},e.prototype.updateSizeFromPointAnimation=function(e){this.epubSpreadZoomableAnimations.animateScale(e,this.spreadOffset)},e.prototype.updateSizeFromPoint=function(e){this.epubSpreadZoomableAnimations.scaleDrag(e,this.spreadOffset)},e.prototype.tryClick=function(e){},e.prototype.saveEvent=function(e){if(e.target.classList.contains("epub-link-type_iframe")!==!0||e.target.classList.contains("epub-link-visible")!==!0){var t=e.target;return a["default"].preventAllGestureStatus()===!0||u.isMediaElement(t)?void(this.savedEvent=null):void(this.savedEvent=e)}},e.prototype.tryZoomOneClick=function(e){var t=this.savedEvent;return null===t||a["default"].preventAllGestureStatus()===!0?void(this.savedEvent=null):(this.savedEvent=null,void this.tryZoom(t))},e.prototype.tryZoom=function(e){var t=u.getBoundingClientRect(this.spreadZoomableHTMLElement.element,this.useMatrixTransform?1:this.scale),i=this.epubZoom.scale;return e.defaultPreventGesture=!0,0!==i?(this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):void(0===this.spreadOffset&&(this.updateSizeFromPointAnimation(this.epubZoom.getZoom(e,this.defaultPageScaleAt,e.epubClientX,e.epubClientY,t)),0===i&&this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}})))},e.prototype.getBoundingClientRect=function(e){return void 0===e&&(e=this.spreadZoomableHTMLElement.element),u.getBoundingClientRect(e,this.useMatrixTransform?1:this.scale)},e.prototype.tryZoomOnElement=function(e){var t=this.getBoundingClientRect(),i=u.getBoundingClientRect(e.target),n=i.left+i.width/2,o=i.top+i.height/2;return e.defaultPreventGesture=!0,0!==this.epubZoom.scale?void this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()):void this.updateSizeFromPointAnimation(this.epubZoom.getZoom(e,this.defaultPageScaleAt,n,o,t))},e.prototype.zoomToggle=function(e){var t=this.getBoundingClientRect(),i=t.left+t.width*e.x,o=t.top+t.height*e.y,s=e.scale;return 0===s?(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()):this.updateSizeFromPoint(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.getZoomNoEvent(s,i,o,t)):this.updateSizeFromPoint(this.epubZoom.getZoomNoEvent(s,i,o,t)),void this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}}))},e.prototype.zoomByStep=function(e){var t={x:e.x,y:e.y,scale:this.epubZoom.scale+e.step,animate:e.animate};this.zoomToggle(t)},e.prototype.zoomProgress=function(e){this.zoomToggle(e)},e.prototype.tryDrag=function(e){var t,i;0===this.epubZoom.scale&&0===e.gestureData.pinchZoomDiff||(t=this.getBoundingClientRect(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff?this.epubZoom.initdrag(e,e.epubClientX,e.epubClientY,t):(0===e.gestureData.x.pointDiff&&this.epubZoom.initdragX(e,e.epubClientX,t),0===e.gestureData.y.pointDiff&&this.epubZoom.initdragY(e,e.epubClientY,t)),i=this.epubZoom.scale+e.gestureData.pinchZoomDiff*this.config.zoomFactor,this.epubZoom.getZoom(e,i,e.epubClientX,e.epubClientY,t),this.updateSizeFromPoint(this.epubZoom.drag(e,e.epubClientX,e.epubClientY)))},e.prototype.reset=function(){var e=this.epubZoom.scale;this.updateSizeFromPoint(this.epubZoom.resetZoom()),0===e&&this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})},e.prototype.resetContent=function(){this.lastContentIDs=[],this.spreadZoomableHTMLElement.removeChilren()},e.prototype.updateContent=function(e){var t=this;this.lastContentIDs.push(e.pageIndex);var i=e.syncElemWithSpread(this.spreadZoomableHTMLElement.element);return this.spreadZoomableHTMLElement.element.appendChild(i.element),this.config.pageSizeType===this.config.PAGESIZETYPES.COVER_HORIZONTALLY&&(clearTimeout(this.timeoutId2),this.timeoutId2=setTimeout(function(){t.spreadZoomableHTMLElement.scrollToTop()},0)),e.onload=this.updateSize,i.loaded},e.prototype.setContainIframe=function(e){this.spreadZoomableHTMLElement.element.setAttribute("contains-iframe",e?"yes":"no")},e.prototype.getElement=function(){return this.spreadZoomableHTMLElement.element},e.prototype.updateSize=function(){this.scale=0,this.paddingLeft=this.config.paddingLeft,this.paddingRight=this.config.paddingRight,this.paddingTop=this.config.paddingTop,this.paddingBottom=this.config.paddingBottom,this.elementSize.width=this.spreadZoomableHTMLElement.element.offsetWidth,this.elementSize.height=this.spreadZoomableHTMLElement.element.offsetHeight,this.pageSizeType()===!1&&(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.updateSize,16))},e}();i["default"]=h},{"./EpubEvent":7,"./EpubGesturesEvent":8,"./EpubSpreadZoomableAnimations":54,"./EpubZoom":58,"./ProtoHTMLElement":60,"./utils/functions":80}],54:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/cssAnimations"),o=1e-4,s=.3,r=function(){function e(e,t,i){this.epubSpreadZoomable=e,this.config=t,this.spreadZoomableHTMLElement=i,this.fromPosition={x:0,y:0,scale:0},this.toPosition={x:0,y:0,scale:0},this.elementData={prc:0},this.epubTweens=new Tween(this.elementData,"prc",Tween.regularEaseInOut,0,0,o),this.epubTweens.onMotionChanged=this.tweenUpdate.bind(this)}return e.prototype.animationDomAsync=function(e,t,i,o,s){return this.config.useMatrixTransformZoomable===!0?void n.matrixDom3dAsync(e,t,i,o,s):void n.positionDomAsync(e,t,i,o,s)},e.prototype.tweenUpdate=function(e){this.fromPosition.scale+=(this.toPosition.scale-this.fromPosition.scale)*e.target._pos,this.fromPosition.x+=(this.toPosition.x-this.fromPosition.x)*e.target._pos,this.fromPosition.y+=(this.toPosition.y-this.fromPosition.y)*e.target._pos,this.animationDomAsync(this.spreadZoomableHTMLElement,this.fromPosition.scale,this.fromPosition.x,this.fromPosition.y,0)},e.prototype.tweenUpdateZero=function(){this.animationDomAsync(this.spreadZoomableHTMLElement,this.toPosition.scale,this.toPosition.x,this.toPosition.y,0)},e.prototype.setOptimizequality=function(e){return 0===e?void(this.spreadZoomableHTMLElement.optimizeQuality=!0):void(this.spreadZoomableHTMLElement.optimizeQuality=!1)},e.prototype.animateScale=function(e,t){this.setOptimizequality(t),this.toPosition.scale=e[0],this.toPosition.x=e[3],this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=0,this.epubTweens.continueTo(1,s)},e.prototype.scaleDrag=function(e,t){this.setOptimizequality(t),this.fromPosition.scale=this.toPosition.scale=e[0],this.fromPosition.x=this.toPosition.x=e[3],this.fromPosition.y=this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=1,this.tweenUpdateZero()},e}();i["default"]=r},{"./utils/cssAnimations":78}],55:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubSpread"),o=e("./EpubSpreadsAnimations"),s=e("./EpubPages"),r=e("./EpubScrollables"),a=e("./utils/functions"),u=function(){function e(e,t,i,n){this.epubManager=e,this.config=t,this.viewMain=i,this.epubCssManager=n,this.parent=this.epubManager,this.screenSize=this.epubManager.screenSize,this.mainViewElementSize={width:0,height:0},this.mainViewElementClassName=this.config.mainViewElementClassName,this.epubSpreads=new Array(this.spreadsLength),this.extractedSpreads=[],this.epubPages=new s["default"](this,this.config,this.epubCssManager),this.setMainViewElement(),this.epubScrollables=new r["default"](this,this.config,this.mainViewElement),this.epubSpreadsAnimations=new o["default"](this,this.config,this.epubSpreads,this.mainViewElement),this.initSpreads(this.epubSpreads,this.mainViewElement),this.appendMainViewElementToViewMain()}return Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastPage",{get:function(){return this.config.lastPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstCoverPage",{get:function(){return this.config.firstCoverPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.config.pagesBySpread},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadsLength",{get:function(){return this.config.spreadsLength},enumerable:!0,configurable:!0}),e.prototype.initSpreads=function(e,t){for(var i=0,o=e.length;i<o;i++)e[i]=new n["default"](this,this.config,i,t),this.epubScrollables.addScrollable(e[i]);this.updateSpreads(0),this.displaySpreads(e)},e.prototype.displaySpreads=function(e){for(var t=0,i=e.length;t<i;t++)e[t].displaySpread()},e.prototype.extractSpreadFromSpreads=function(e){for(var t=0,i=e.length;t<i;t++);},e.prototype.getMainViewElement=function(){return this.mainViewElement},e.prototype.setMainViewElement=function(){this.mainViewElement=document.createElement("div"),this.mainViewElement.classList.add(this.mainViewElementClassName)},e.prototype.updateMainViewElementSize=function(){this.mainViewElementSize.width=this.mainViewElement.offsetWidth,this.mainViewElementSize.height=this.mainViewElement.offsetHeight,this.mainViewElementSize.rect=a.getBoundingClientRect(this.mainViewElement)},e.prototype.appendMainViewElementToViewMain=function(){this.viewMain.appendChild(this.mainViewElement)},e.prototype.getSpreadIndexHasPageIndex=function(e){return Math.ceil((e+this.firstCoverPage)/this.pagesBySpread)},e.prototype.getSpreadIndexByPageIndex=function(e){return(this.getSpreadIndexHasPageIndex(e)%this.epubSpreads.length||this.epubSpreads.length)-1},e.prototype.getSpreadByPageIndex=function(e){return this.epubSpreads[this.getSpreadIndexByPageIndex(e)]},e.prototype.getSpreadFromPage=function(e){return this.getSpreadByPageIndex(e.pageIndex)},e.prototype.getPagesFromSpreadByPage=function(e){return this.getPagesFromSpreadByPageIndex(e.pageIndex)},e.prototype.getPagesFromSpreadByPageIndex=function(e){return this.getSpreadByPageIndex(e).getPagesByPageIndex(e)},e.prototype.getSpreadsOffsetByPageIndex=function(e){var t=0,i=this.epubSpreads.length,n=new Array(i),o=Math.ceil(i/2),s=~~(i/2),r=0,a=0,u=this.getSpreadIndexByPageIndex(e);for(e=this.getSpreadByPageIndex(e).getPagesByPageIndex(e)[0].pageIndex,a=1+this.pageQuantity-(e+o),a<0&&(s-=a,o+=a),a=e-1-s,a<0&&(s+=a,o-=a),s>=i?(s=i-1,o++):o>=i&&e>1&&(o=i-1,s++),r=0,t=u;t<i&&0!==o;t++)n[t]=r,r++,o--;if(0!==o)for(t=0;t<o+t;t++)n[t]=r,r++,o--;else if(t<i){for(;t<i;t++)n[t]=-s,s--;t=0}else t=0;for(;t<i&&0!==s;t++)n[t]=-s,s--;return n},e.prototype.getScaleFromCurrentSpread=function(){return this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.epubZoom.scale},e.prototype.zoomToggle=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomToggle(e)},e.prototype.zoomByStep=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomByStep(e)},e.prototype.updateSpreads=function(e){var t,i=0,n=0;for(this.epubPages.resetRequested(),n=this.epubSpreads.length,t=this.getSpreadsOffsetByPageIndex(this.currentPage);i<n;i++)this.epubSpreads[i].updateSpread(t[i]);Math.abs(this.currentPage-this.lastPage)>this.pagesBySpread?this.epubSpreadsAnimations.updatePositionSizeOffset():this.epubSpreadsAnimations.animatePositionOffset(e),this.epubPages.flushNotRequested()},e.prototype.updateSpreadsSize=function(){var e=0,t=0;for(this.updateMainViewElementSize(),this.epubSpreadsAnimations.updatePositionSizeOffset(),this.goToPage(this.currentPage,!1),e=0,t=this.epubSpreads.length;e<t;e++)this.epubSpreads[e].updateSpreadSize()},e.prototype.scrollTo=function(e,t){this.epubSpreadsAnimations.updatePosition(e,t)},e.prototype.gotoPageByCoordsDiff=function(e){this.epubManager.gotoPageByCoordsDiff(e)},e.prototype.goToPage=function(e,t){void 0===t&&(t=!0),this.epubManager.goToPage(e,t)},e}();i["default"]=u},{"./EpubPages":49,"./EpubScrollables":51,"./EpubSpread":52,"./EpubSpreadsAnimations":56,"./utils/functions":80}],56:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/cssAnimations"),o=1,s=function(){function e(e,t,i,n){this.parent=e,this.config=t,this.epubSpreads=i,this.mainViewElement=n,this.epubSpreadsLength=i.length,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubSpreadsData=new Array(this.epubSpreads.length),this.makeSpreadData(this.epubSpreadsData),this.pixelTimeData={x:0,w:0,y:0,h:0,date:0,time:0},this.currentPosition={width:0,height:0,inX:0,inY:0,diffCoord:0}}return Object.defineProperty(e.prototype,"navigationType",{get:function(){return this.config.navigationType},enumerable:!0,configurable:!0}),e.prototype.setPixelTime=function(e,t){var i=e-this.pixelTimeData.x,n=t-this.pixelTimeData.y,o=Date.now(),s=o-this.pixelTimeData.date;this.pixelTimeData.x=e,this.pixelTimeData.w=i,this.pixelTimeData.y=t,this.pixelTimeData.h=n,this.pixelTimeData.date=o,this.pixelTimeData.time=s},e.prototype.getPixelTime=function(e,t){var i={w:~~Math.abs(e/this.pixelTimeData.w*this.pixelTimeData.time),h:~~Math.abs(t/this.pixelTimeData.y*this.pixelTimeData.time)};return this.pixelTimeData.x=0,this.pixelTimeData.w=0,this.pixelTimeData.y=0,this.pixelTimeData.h=0,this.pixelTimeData.date=0,this.pixelTimeData.time=0,i},e.prototype.makeSpreadData=function(e){for(var t=0,i=e.length;t<i;t++)e[t]={spreadOffset:0}},e.prototype.matrixDom3dAsyncZero=function(e,t,i,s){return this.config.useMatrixTransformScrollable===!0?void n.matrixDom3dAsync(e,o,t,i,s):void n.positionDomAsync(e,o,t,i,s)},e.prototype.animateSpreads=function(e,t,i,n,o,s,r){for(var a,u=0,h=this.epubSpreadsLength,p=0,l=0,c=0,f=0,d=0,m=0,g=0;u<h;u++)g=r,m=s,a=this.epubSpreads[u],0!==a.spreadOffset&&0!==a.lastOffset&&(m=1,g=0),d=a.spreadOffset-a.lastOffset,c=a.lastOffset*e+d*e*m+o*(1-m),f=a.lastOffset*t+d*t*m+o*(1-m),p=i*c,l=n*f,this.matrixDom3dAsyncZero(a.spreadHTMLElement,p,l,g)},e.prototype.updatePositionSizeOffset=function(){this.updatePosition(0,0)},e.prototype.animatePositionOffset=function(e){var t=0,i=0,n=0,o=0,s=0;e=e||0,t=this.epubSpreadsLength,"x"===this.navigationType?(i=1,n=0):(i=0,n=1),o=this.mainViewElementSize.width,s=this.mainViewElementSize.height,this.currentPosition.width=o,this.currentPosition.height=s,this.currentPosition.inX=i,this.currentPosition.inY=n,this.animateSpreads(this.currentPosition.width,this.currentPosition.height,this.currentPosition.inX,this.currentPosition.inY,this.currentPosition.diffCoord,1,1e3*e)},e.prototype.updatePosition=function(e,t){var i,n=0,o=0,s=0,r=0,a=0,u=0,h=0,p=this.epubSpreadsLength;for(a=this.mainViewElementSize.width,u=this.mainViewElementSize.height,"x"===this.navigationType?(n=1,o=0,this.currentPosition.diffCoord=e):(n=0,o=1,this.currentPosition.diffCoord=t);h<p;h++)i=this.epubSpreads[h],this.epubSpreadsData[h].spreadOffset=i.spreadOffset,s=n*(i.spreadOffset*a+e),r=o*(i.spreadOffset*u+t),0!==i.spreadOffset&&((i.spreadOffset>0&&s>i.spreadOffset*a||i.spreadOffset<0&&s<i.spreadOffset*a)&&(s=i.spreadOffset*a),(i.spreadOffset>0&&r>i.spreadOffset*u||i.spreadOffset<0&&r<i.spreadOffset*u)&&(r=i.spreadOffset*u)),this.matrixDom3dAsyncZero(i.spreadHTMLElement,s,r,0)},e}();i["default"]=s},{"./utils/cssAnimations":78}],57:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubEvent"),o=function(){function e(e){this.epubManager=e,this.trackDateMaxTime=500,this.trackPageDate=0,this.lastPage=0,this.epubEvent=w.epubEvent,this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CHANGE,this.trackPages.bind(this)),this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_ZOOM,this.trackPagesZoom.bind(this)),this.epubEvent.addListener(n.EPUB_EVENTS.ACTION_LINK_SUCCESS,this.trackLinks.bind(this))}return e.prototype.trackPages=function(e){var t=this.lastPage;if(Date.now()-this.trackPageDate<this.trackDateMaxTime)return void(this.trackPageDate=Date.now());this.trackPageDate=Date.now();var i=this.epubManager.getCurrentPages(e.data.pageNumber);t=t||i[0];for(var n={},o=0,s=i.length;o<s;o++)n[o+1]=i[o];i[0]>t?(w.Main.trackerManager.trackEvent({name:"pageNext",variables:n}),this.lastPage=i[0]):i[0]<t&&(w.Main.trackerManager.trackEvent({name:"pagePrev",variables:n}),this.lastPage=i[i.length-1]),w.Main.trackerManager.trackPage({name:"page",variables:n}),this.lastPage=t},e.prototype.trackPagesZoom=function(e){var t=this.epubManager.getCurrentPages(),i="zoomIn",n={1:""};n[1]=t.join("-"),e.data.status!==!0&&(i="zoomOut"),this.lastZoomScale===e.data.scale&&this.lastZoomedPages===n[1]||0===e.data.scale&&this.lastZoomedPages!==n[1]||(this.lastZoomedPages=n[1],this.lastZoomScale=e.data.scale,w.Main.trackerManager.trackEvent({name:i,variables:n}))},e.prototype.trackLinks=function(e){var t=e.data.userAct;w.Main.trackerManager.trackEvent({name:"link",variables:{1:t.type,2:t.param}})},e}();i.EpubStatistics=o},{"./EpubEvent":7}],58:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubZoomDraggable"),o=function(){function e(e,t){this.epubSpreadZoomable=e,this.config=t,this.totalScale=0,this.totalWidth=0,this.totalHeight=0,this.totalX=0,this.totalY=0,this._scale=0,this._x=0,this._y=0,this.xLimited=!1,this.yLimited=!1,this.xLimit=0,this.yLimit=0,this.elastic={axisMax:100,coef:10},this.parent=this.epubSpreadZoomable,this.maxTotalScale=this.config.maxPageTotalScale,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubZoomDraggable=new n["default"](this,this.config)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{
get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widthOrig",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightOrig",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.calcMaxCoord=function(e,t,i,n,o,s){return void 0===o&&(o=0),void 0===s&&(s=0),n.status=!1,t+o+s<i?(n.status=!0,i/2-(t+o+s)/2):e},e.prototype.setMaxX=function(){var e={status:!0},t=this.paddingLeft,i=this.paddingRight;return this.totalX=this.calcMaxCoord(this.totalX,this.totalWidth,this.mainViewElementSize.width,e,t,i),e.status},e.prototype.setMaxY=function(){var e={status:!0},t=this.paddingTop,i=this.paddingBottom;return this.totalY=this.calcMaxCoord(this.totalY,this.totalHeight,this.mainViewElementSize.height,e,t,i),e.status},e.prototype.calcMaxOnDragCoord=function(e,t,i,n,o,s,r){var a=t+i-s>-1,u=t+i+n+r<o+1;if(1===e)a===!0&&u===!0||(a===!0?i=s-t:u===!0&&(i=o-(t+n+r)));else{var h=n/2-(s/2-r/2);i=o/2-h}return i},e.prototype.getZoomNoEvent=function(e,t,i,n){return this.getZoom(null,e,t,i,n)},e.prototype.setZoomY=function(e,t,i){var n=this.paddingTop,o=this.paddingBottom,s=this.y,r=t-i.top||0,a=r/(this.heightOrig*e),u=this.heightOrig*this.totalScale;this.y=(this.heightOrig*e-u)*a+s,this.totalY=this.yOrig+this.y,this.totalHeight=u,this.yLimited=this.setMaxY(),this.yLimit=this.yLimited?0:1,this.totalY=this.calcMaxOnDragCoord(this.yLimit,this.epubZoomDraggable.y,this.totalY,u,this.mainViewElementSize.height,n,o)},e.prototype.setZoomX=function(e,t,i){var n=this.paddingLeft,o=this.paddingRight,s=this.x,r=t-i.left||0,a=r/(this.widthOrig*e),u=this.widthOrig*this.totalScale;this.x=(this.widthOrig*e-u)*a+s,this.totalX=this.xOrig+this.x,this.totalWidth=u,this.xLimited=this.setMaxX(),this.xLimit=this.xLimited?0:1,this.totalX=this.calcMaxOnDragCoord(this.xLimit,this.epubZoomDraggable.x,this.totalX,u,this.mainViewElementSize.width,n,o)},e.prototype.makeScale_=function(e){var t=this.scale;return e=e||1,this.scale=e,this.scale>this.maxTotalScale?this.scale=this.maxTotalScale:this.scale<1&&(this.scale=1),this.totalScale=this.scaleOrig*this.scale,this.scaleOrig*t},e.prototype.makeScale=function(e){var t=this.scale;return e=e||0,this.scale=e,this.scale+this.scaleOrig<this.scaleOrig?this.scale=0:this.scale+this.scaleOrig>this.maxTotalScale+this.scaleOrig&&(this.scale=this.maxTotalScale),this.totalScale=this.scale+this.scaleOrig,this.scaleOrig+t},e.prototype.getZoom=function(e,t,i,n,o){var s=0;this.paddingTop,this.paddingBottom;return s=this.makeScale(t),this.setZoomX(s,i,o),this.setZoomY(s,n,o),[this.totalScale,0,0,this.epubZoomDraggable.x+this.totalX,this.epubZoomDraggable.y+this.totalY]},e.prototype.resetZoom=function(){return this.epubZoomDraggable.resetdrag(),this.scale=0,this.x=0,this.y=0,this.totalX=0,this.totalY=0,this.totalScale=0,[this.scaleOrig,0,0,this.xOrig,this.yOrig]},e.prototype.initdrag=function(e,t,i,n){return this.epubZoomDraggable.initdrag(t,i,n)},e.prototype.initdragX=function(e,t,i){return this.epubZoomDraggable.initdragX(t,i.left)},e.prototype.initdragY=function(e,t,i){return this.epubZoomDraggable.initdragY(t,i.top)},e.prototype.drag=function(e,t,i){return this.epubZoomDraggable.drag(e,t,i)},e.prototype.resetdrag=function(){this.epubZoomDraggable.resetdrag()},e}();i["default"]=o},{"./EpubZoomDraggable":59}],59:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){this.epubZoom=e,this.config=t,this.xRect=0,this.yRect=0,this.xStart=0,this.yStart=0,this._x=0,this._y=0,this.correctionX=0,this.correctionY=0,this.parent=this.epubZoom,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.dragedData=[1,0,0,0,0]}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent.xOrig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent.yOrig},enumerable:!0,configurable:!0}),e.prototype.calcMaxOnDragCoord=function(e,t,i,n,o,s,r){if(1===e){var a=t+i-s>0,u=t+i+n+r<o;a===!0?i=s-t:u===!0&&(i=o-(t+n+r))}return i},e.prototype.initdragX=function(e,t){this.correctionX=0,this.xRect=t,this.xStart=e-this.xRect-this.x},e.prototype.initdragY=function(e,t){this.correctionY=0,this.yRect=t,this.yStart=e-this.yRect-this.y},e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.initdrag=function(e,t,i){this.initdragX(e,i.left),this.initdragY(t,i.top)},e.prototype.dragY=function(e,t){var i=this.paddingTop,n=this.paddingBottom,o=0,s=this.parent.yLimited?0:1;this.y=(t-this.yRect-this.yStart)*s,o=this.epubZoom.totalY||this.yOrig;var r=this.calcMaxOnDragCoord(s,o,this.y,this.parent.totalHeight,this.mainViewElementSize.height,i,n);return r!==this.y&&(this.y>0&&this.y<this.correctionY?(this.correctionY=this.y-1,e.gestureData.resetAxis("y")):this.y<0&&this.y>this.correctionY?(this.correctionY=this.y+1,e.gestureData.resetAxis("y")):this.correctionY=this.y),this.y=r,o+this.y},e.prototype.dragX=function(e,t){var i=this.paddingLeft,n=this.paddingRight,o=0,s=this.parent.xLimited?0:1;this.x=(t-this.xRect-this.xStart)*s,o=this.epubZoom.totalX||this.xOrig;var r=this.calcMaxOnDragCoord(s,o,this.x,this.parent.totalWidth,this.mainViewElementSize.width,i,n);return r!==this.x&&(this.x>0&&this.x<this.correctionX?(this.correctionX=this.x-1,e.gestureData.resetAxis("x")):this.x<0&&this.x>this.correctionX?(this.correctionX=this.x+1,e.gestureData.resetAxis("x")):this.correctionX=this.x),this.x=r,o+this.x},e.prototype.drag=function(e,t,i){return this.dragedData=[this.epubZoom.totalScale||this.epubZoom.scaleOrig,0,0,this.dragX(e,t),this.dragY(e,i)],this.dragedData},e.prototype.resetdragY=function(){this.yStart=0,this.y=0},e.prototype.resetdragX=function(){this.xStart=0,this.x=0},e.prototype.resetdrag=function(){this.resetdragX(),this.resetdragY()},e}();i["default"]=n},{}],60:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/functions"),o=function(){function e(e){this.config=e,this.optimizeQuality=!1,this.optimizeQualityStat=!1,this.scale=1,this.scaleLastMax=1,this.x=0,this.y=0,this.useInddEpubDataExportedBackground=!1;try{this.inddEpubDataExported=w.inddEpubDataExported,this.inddEpubDataExported.config.pagesData.length,this.useInddEpubDataExportedBackground=!0}catch(t){this.useInddEpubDataExportedBackground=!1}}return Object.defineProperty(e.prototype,"spreadViewElementClassName",{get:function(){return this.config.spreadViewElementClassName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomableViewElementClassName",{get:function(){return this.config.zoomableViewElementClassName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inddEpubDataExportedPagesData",{get:function(){return this.inddEpubDataExported.config.pagesData},enumerable:!0,configurable:!0}),e.prototype.getBackgroundColor=function(e){if(this.useInddEpubDataExportedBackground===!0)try{return this.inddEpubDataExportedPagesData[e-1].bgStyle.epubStyle.backgroundColor}catch(t){return"transparent"}return w.Main.pageManager.getBackgroundColor(e)},e.prototype.setBackgroundColor=function(e){var t,i=this.getBackgroundColor(e[0].pageIndex),n=i;e.length>1&&(n=this.getBackgroundColor(e[1].pageIndex)),t="linear-gradient(90deg,"+i+" 50%,"+n+" 50%)",this.backgroundColor!==t&&(this.backgroundColor=t,this.element.style.background=t)},e.prototype.initSpread=function(e,t,i,n){this.epubSpread=e,this.config=t,this.epubSpreadZoomable=i,this.spreadIndex=n,this.element=document.createElement("div"),this.element.classList.add(this.spreadViewElementClassName),this.element.classList.add(this.spreadViewElementClassName+"-"+this.spreadIndex),this.element.innerHTML="",this.element.appendChild(this.epubSpreadZoomable.getElement())},e.prototype.initZoomable=function(e,t){this.element=document.createElement("div"),this.element.classList.add(this.zoomableViewElementClassName)},e.prototype.removeChilren=function(){n.htmlSecureRemoveChildren(this.element)},e.prototype.scrollToTop=function(){this.element.scrollTop=0},e.prototype.setSpreadScrollable=function(e,t){return e===!0?(this.element.style["overflow-"+t]="auto",void(this.element.style.webkitOverflowScrolling="touch")):(this.element.style["overflow-"+t]="hidden",void(this.element.style.webkitOverflowScrolling="auto"))},e.prototype.getSpreadScrollable=function(e){return this.element.style["overflow-"+e]},e}();i["default"]=o},{"./utils/functions":80}],61:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),o=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return e.prototype.init=function(){var e=this;w.Main.fullScreenManager.hasFullScreen()!==!1&&(this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.panel.onClick(e.toggle.bind(e))}))},e.prototype.toggle=function(e){w.Main.fullScreenManager.fullScreenToggle()},e}();i.Controller=o},{"./View":62}],62:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/fullscreenToggle/index.html",i.dataSelect="fullscreen-toggle",i.iconID="fullscreen-v4",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.setElements=function(){this.epubEvent=new s.EpubEvent;var e=this.getElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:s.EPUB_EVENTS.FULLSCREEN_TOGGLE,data:{range:0}})},t.prototype.onClick=function(e){this.epubEvent.addListener(s.EPUB_EVENTS.FULLSCREEN_TOGGLE,e)},t}(o.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":67}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../zoomMore/Controller"),o=e("../zoomLess/Controller"),s=e("../zoomRange/Controller"),r=e("../pageRange/Controller"),a=e("../zoomReset/Controller"),u=e("../fullscreenToggle/Controller"),h=e("./View"),p=function(){function e(e){this.epubManager=e,this.userAgent=w.Param.userAgent,this.config=this.epubManager.config,this.menuViewPageControlItems=this.config.menuViewPageControlItems,this.viewPanelParams={parentElement:this.epubManager.viewMain},this.setSupportedModules(),this.init()}return e.prototype.init=function(){var e=this;try{if("true"!==this.menuViewPageControlItems.enable||this.userAgent.browser.name===w.Param.userAgent.BROWSER.IE&&w.Param.userAgent.browser.version<11)return}catch(t){return}this.panel=new h.View(this.viewPanelParams),this.panel.init().then(function(t){e.viewChildrenPanelParams={parentElement:t[t.length-1]};for(var i=e.menuViewPageControlItems.children,n=0,o=i.length;n<o;n++)"true"===i[n].enable&&e.supportedModules[i[n].name]&&new e.supportedModules[i[n].name](e.epubManager,e.viewChildrenPanelParams)})},e.prototype.setSupportedModules=function(){this.supportedModules={zoom_range:s.Controller,page_range:r.Controller,zoom_less:o.Controller,zoom_more:n.Controller,zoom_reset:a.Controller,fullscreen_toggle:u.Controller}},e}();i.Controller=p},{"../fullscreenToggle/Controller":61,"../pageRange/Controller":65,"../zoomLess/Controller":68,"../zoomMore/Controller":70,"../zoomRange/Controller":72,"../zoomReset/Controller":74,"./View":64}],64:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.classElement="epub-page-control",i.pageControlPath=w.Param.pathTemplate+"epub/component/pageControl/index.html",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.pageControlPath,{})),i[1].then(function(e){t.pageControlElement=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.pageControlElement)},t}(o.View);i.View=s},{"./../panel/View":67}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubEvent"),o=e("./View"),s=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.rangeDelay=50,this.config=this.epubManager.config,this.init()}return Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this.epubManager.currentPage},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.panel=new o.View(this.viewPanelParams,1,this.pageQuantity),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.panel.updateRange(e.pageNumber),e.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CHANGE,e.pageChange.bind(e)),e.panel.onRangeChange(e.changePage.bind(e))})},e.prototype.changePage=function(e){var t=e.data.range;this.pageNumber!==t&&this.changePageAsync(e)},e.prototype.changePageAsync=function(e){var t=this;clearTimeout(this.timerRange),this.timerRange=setTimeout(function(){t.timerRangeDate=Date.now(),t.epubManager.goToPage(e.data.range)},this.rangeDelay)},e.prototype.pageChange=function(e){var t=this;e.data.pageNumber;NIApi.page.getVisiblePages().then(function(e){var i=e.indexOf(parseInt(t.panel.rangeValue));i!==-1?t.panel.updateRange(e[i]):t.panel.updateRange(e[0])})},e}();i.Controller=s},{"../../EpubEvent":7,"./View":66}],66:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=e("../../EpubEvent"),r=function(e){function t(t,i,n){var o=e.call(this,t)||this;return o.params=t,o.rangeMinValue=i,o.rangeMaxValue=n,o.classElement="epub-page-range",o.pagePanelPath=w.Param.pathTemplate+"epub/component/pageRange/index.html",o.rangeStepValue=1,o}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.pagePanelPath,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),i[1].then(function(e){t.pagePanelElement=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.pagePanelElement),this.epubEvent=new s.EpubEvent,this.createRangeValueElement(),this.createRangeInput()},Object.defineProperty(t.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e,this.updateRangeValueElement()},enumerable:!0,configurable:!0}),t.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_CHANGE,data:{range:this.rangeValue}})},t.prototype.createRangeInput=function(){this.rangeElement=this.pagePanelElement.querySelector("[data-select='range-cursor']"),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}this.view.appendChild(this.rangeElement)},t.prototype.createRangeValueElement=function(){this.rangeValueElement=this.pagePanelElement.querySelector("[data-select='range-value']")},t.prototype.updateRangeValueElement=function(){this.rangeValueElement.innerHTML=this.rangeValue.toString()},t.prototype.setStepAttribute=function(e){this.rangeElement.setAttribute("step",e.toString())},t.prototype.updateRange=function(e){this.rangeElement.value=e.toString(),this.rangeChange(!1)},t.prototype.onRangeChange=function(e){this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CHANGE,e)},t.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(s.EPUB_EVENTS.PAGE_CHANGE,e)},t}(o.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":67}],67:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.params=e,this.classElement="epub-page_control-button",this.shown=!1,this.opened=!1,this.panelTemplatePath=w.Param.pathTemplate+"epub/component/panel/index.html",this.htmlPlaceHolder=document.createElement("div"),this.htmlPlaceHolder.style.display="none",this.params.parentElement.appendChild(this.htmlPlaceHolder)}return e.prototype.init=function(){var e=this,t=this.setView();return t.then(function(){e.addView()}),t},e.prototype.addToView=function(e){this.view.replaceChild(this.htmlPlaceHolder,e)},e.prototype.loadTemplate=function(e,t){var i=document.createElement("div"),n=new Promise(function(n,o){w.Main.templateManager.load(e,i,t).then(function(e){n(e[0])})});return n},e.prototype.setView=function(){var e=this,t=this.loadTemplate(this.panelTemplatePath,{});return t.then(function(t){e.view=t,e.view.classList.add.apply(e.view.classList,e.classElement.split(" "))}),t},e.prototype.addView=function(){this.params.parentElement.replaceChild(this.view,this.htmlPlaceHolder)},e.prototype.show=function(e){e===!0&&this.shown===!1||e===!1&&this.shown===!0},e.prototype.open=function(e){e===!0&&this.opened===!1||e===!1&&this.opened===!0},e}();i.View=n},{}],68:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),o=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return e.prototype.init=function(){var e=this;this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.panel.onClick(e.zoomChangeLevel.bind(e))})},e.prototype.zoomChangeLevel=function(e){this.epubManager.zoomByStep(e.data.level)},e}();i.Controller=o},{"./View":69}],69:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("../zoomMore/View"),s=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomLess/index.html",i.iconID="minus-v4",i}return n(t,e),t}(o.View);i.View=s},{"../zoomMore/View":71}],70:[function(e,t,i){arguments[4][68][0].apply(i,arguments)},{"./View":71,dup:68}],71:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomMore/index.html",i.classElement="epub-page_control-button epub-zoom-steps",i.iconID="plus-v4",i.level=10,i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getLevelElement=function(){var e;if(e=null!==this.element.getAttribute("data-zoom-step")?this.element:this.element.querySelector("[data-zoom-step]"),null===e)return null;var t=e.getAttribute("data-zoom-step");return null!==t&&(this.level=parseFloat(t)),e},t.prototype.setElements=function(){var e=this.getLevelElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.epubEvent=new s.EpubEvent,this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:s.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,data:{level:this.level}})},t.prototype.onClick=function(e){this.epubEvent.addListener(s.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,e)},t}(o.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":67}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubEvent"),o=e("./View"),s=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return Object.defineProperty(e.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.panel=new o.View(this.viewPanelParams),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.epubEvent.addListener(n.EPUB_EVENTS.PAGE_ZOOM,e.zoomChange.bind(e)),e.panel.onRangeChange(e.zoomRangeChange.bind(e))})},e.prototype.zoomRangeChange=function(e){var t=~~e.data.range/100,i=t*this.maxPageTotalScale;this.scale=i,this.zoomRangeChangeAsync()},e.prototype.zoomRangeChangeAsync=function(){var e=this;Date.now()-this.timerScaleDate<16&&clearTimeout(this.timerScale),this.timerScale=setTimeout(function(){e.timerScaleDate=Date.now(),Math.abs(e.scaleLast-e.scale)>.1?e.epubManager.zoomTo(e.scale):e.epubManager.zoomNow(e.scale),e.scaleLast=e.scale},16)},e.prototype.zoomChange=function(e){var t=e.data.scale/this.maxPageTotalScale;this.scaleLast=t;var i=~~(100*t)/100;this.panel.updateRange(i)},e}();i.Controller=s},{"../../EpubEvent":7,"./View":73}],73:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.classElement="epub-zoom-range",i.dataSelect="zoom-range-cursor",i.rangeMinValue=0,i.rangeMiddleValue=50,i.rangeMaxValue=100,i.rangeStepValue=2,i.path=w.Param.pathTemplate+"epub/component/zoomRange/index.html",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.element),this.epubEvent=new s.EpubEvent,this.createRangeInput()},Object.defineProperty(t.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e},enumerable:!0,configurable:!0}),t.prototype.rangeToggle=function(){var e=parseInt(this.rangeValue);0===e?this.rangeValue=this.rangeMiddleValue.toString():this.rangeValue=this.rangeMinValue.toString(),this.epubEvent.fire({type:s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},t.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.createRangeInput=function(){this.rangeElement=this.getElement(),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}},t.prototype.updateRange=function(e){this.rangeElement.value=Math.round(100*e).toString(),this.rangeChange(!1)},t.prototype.onRangeChange=function(e){this.epubEvent.addListener(s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t}(o.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":67}],74:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),o=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return e.prototype.init=function(){var e=this;this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.panel.onClick(e.zoomReset.bind(e))})},e.prototype.zoomReset=function(e){this.epubManager.zoomTo(0)},e}();i.Controller=o},{"./View":75}],75:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./../panel/View"),s=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomReset/index.html",i.dataSelect="zoom-reset",i.iconID="close-1-v4",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.setElements=function(){this.epubEvent=new s.EpubEvent;var e=this.getElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:0}})},t.prototype.onClick=function(e){this.epubEvent.addListener(s.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t}(o.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":67}],76:[function(e,t,i){"use strict";function n(){function e(e,t){var n=i.prototype,o=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(e){return[].indexOf.call(document.querySelectorAll(e),this)!==-1};return o.call(e,t)}function t(t){for(var i;i=this.parentElement;)if(e(i,t))return i}var i=window.Element;i&&!i.prototype.closest&&(i.prototype.closest=t)}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],77:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=function(){function e(){}return e}();n.GET="GET",n.get="GET",n.POST="POST",n.post="POST",i.Protocol=n;var o=function(){function e(e,t,i){void 0===e&&(e=n.GET),void 0===t&&(t=""),void 0===i&&(i=null),this.protocol=e,this.url=t,this.data=i,this.xhr=new XMLHttpRequest}return e.prototype.onreadystatechange=function(){if(4===this.xhr.readyState)return 404===this.xhr.status?void this.reject(this):void this.resolve(this.xhr)},e.prototype.executeur=function(e,t){this.resolve=e,this.reject=t,this.xhr.open(this.protocol,this.url,!0),this.xhr.onreadystatechange=this.onreadystatechange.bind(this),this.xhr.send(this.data)},e.prototype.init=function(){return new Promise(this.executeur.bind(this))},e}();i["default"]=o},{"es6-promise":1}],78:[function(e,t,i){"use strict";function n(e){if(e.element.style.transitionDuration="0",e.optimizeQualityStat!==!0){var t=e.scale;e.optimizeQualityStat=!0,u[0]=t,u[3]=t,u[4]=e.x,u[5]=e.y,e.frameTimer2d=r.styleTransform(e.element,"matrix("+u.join(",")+")")}}function o(e,t,i,o,s){t=~~(1e3*t)/1e3,i=~~i,o=~~o,e.scale===t&&e.x===i&&e.y===o&&e.optimizeQualityStat===!0||(e.scale=t,e.x=i,e.y=o,e.matrix2d=e.matrix2d||n.bind(null,e),a[0]=t,a[5]=t,a[12]=i,a[13]=o,cancelAnimationFrame(e.frameTimer3d),e.frameTimer3d=r.styleTransform(e.element,"matrix3d("+a.join(",")+")",function(){
e.element.style.transitionDuration=(s||"0")+"ms"}),e.optimizeQualityStat=!1,cancelAnimationFrame(e.frameTimer2d),clearTimeout(e.timer),e.optimizeQuality===!0&&(e.timer=setTimeout(e.matrix2d,100)))}function s(e,t,i,n,o){e.scale===t&&e.x===i&&e.y===n||(e.scale=t,e.x=i,e.y=n,e.element.style.cssText+="transition-duration:"+(o+"ms"||"0")+" ;transform: none; left: "+i/t+"px; top: "+n/t+"px; zoom: "+t+";",e.optimizeQualityStat=!1)}Object.defineProperty(i,"__esModule",{value:!0});var r=e("./functions"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[1,0,0,1,0,0];i.matrixDom3dAsync=o,i.positionDomAsync=s},{"./functions":80}],79:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.EPUB_HTML=0]="EPUB_HTML",e[e.PDF_HTML=1]="PDF_HTML",e[e.PDF_SVG=2]="PDF_SVG",e[e.PDF_IMG=3]="PDF_IMG",e[e.PDF_PDF=4]="PDF_PDF"}(n=i.READER_TYPES||(i.READER_TYPES={}));var o;!function(e){e[e.INIT=0]="INIT",e[e.START=1]="START",e[e.STOP=2]="STOP",e[e.FLUSH=3]="FLUSH"}(o=i.ShapeActivityStatus||(i.ShapeActivityStatus={}));var s;!function(e){e[e.blink=0]="blink",e[e["static"]=1]="static",e[e.none=2]="none",e[e.revealOnTap=3]="revealOnTap"}(s=i.LinksBehaviors||(i.LinksBehaviors={}));var r;!function(e){e[e.hdpi=0]="hdpi",e[e.mdpi=1]="mdpi",e[e.ldpi=2]="ldpi",e[e.svg=3]="svg"}(r=i.PagesImagesQualities||(i.PagesImagesQualities={}))},{}],80:[function(e,t,i){"use strict";function n(e,t){void 0===t&&(t=1);var i=e.getBoundingClientRect();return{bottom:i.bottom*t,height:i.height*t,left:i.left*t,top:i.top*t,width:i.width*t}}function o(e){for(var t;t=e.lastChild;)e.removeChild(t)}function s(e){var t=e.tagName.toLowerCase();return"video"===t||"audio"===t}function r(){return w.Param.isPortrait=!(window.innerWidth>window.innerHeight),!w.Param.isPortrait}function a(){var e=window.innerHeight/document.documentElement.clientHeight*100;document.documentElement.style.height=e+"%"}function u(){var e={promise:null,resolve:null,reject:null,then:function(){}};e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i});var t=e.promise;return e.then=t.then.bind(t),e}Object.defineProperty(i,"__esModule",{value:!0}),i.getBoundingClientRect=n;var h=function(){var e="transform";return"transform"in document.body.style?e="transform":"webkitTransform"in document.body.style?e="webkitTransform":"msTransform"in document.body.style&&(e="msTransform"),function(t,i,n){return window.requestAnimationFrame(function(){n&&n(),t.style[e]=i})}}();i.styleTransform=h,i.htmlSecureRemoveChildren=o,i.isMediaElement=s,i.isWindowLandscape=r,i.resizeHTMLTagElement=a,i.getSplitedPromise=u},{}],81:[function(e,t,i){"use strict";function n(e,t){var i=t.getBoundingClientRect(),n=(e.offsetWidth,e.offsetHeight),o=.2,s=i.height*o;i.width*o;return!(i.top>n-s||i.bottom<s)}Object.defineProperty(i,"__esModule",{value:!0}),i.isElementVisible=n},{}],82:[function(e,t,i){"use strict";function n(e,t){var i,n,o,s,r=t.deltaX,a=t.deltaY,u=0,h=window.getComputedStyle(e),p=h.getPropertyValue("overflow"),l=["auto","visible","scroll"];if(0!==r?(u=r,i=h.getPropertyValue("overflow-x"),o=e.scrollWidth,s=e.offsetWidth,n=e.scrollLeft):0!==a&&(u=a,i=h.getPropertyValue("overflow-y"),o=e.scrollHeight,s=e.offsetHeight,n=e.scrollTop),(l.indexOf(p)!==-1||l.indexOf(i)!==-1)&&o>s){if(n>=0&&u>0&&n<o-s)return!0;if(n<=o-s&&u<0&&n>0)return!0}return!1}Object.defineProperty(i,"__esModule",{value:!0}),i.isScrollable=n},{}]},{},[13]);