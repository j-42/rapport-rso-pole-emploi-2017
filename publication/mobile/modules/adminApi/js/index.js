!function e(t,n,r){function i(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){(function(r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.ES6Promise=r()}(this,function(){"use strict";function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function n(e){return"function"==typeof e}function o(e){z=e}function s(e){H=e}function u(){return function(){return r.nextTick(h)}}function c(){return"undefined"!=typeof W?function(){W(h)}:l()}function a(){var e=0,t=new X(h),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function f(){var e=new MessageChannel;return e.port1.onmessage=h,function(){return e.port2.postMessage(0)}}function l(){var e=setTimeout;return function(){return e(h,1)}}function h(){for(var e=0;e<K;e+=2){var t=ee[e],n=ee[e+1];t(n),ee[e]=void 0,ee[e+1]=void 0}K=0}function p(){try{var t=e,n=t("vertx");return W=n.runOnLoop||n.runOnContext,c()}catch(r){return l()}}function d(e,t){var n=this,r=new this.constructor(y);void 0===r[ne]&&N(r);var i=n._state;if(i){var o=arguments[i-1];H(function(){return S(i,r,o,n._result)})}else M(n,r,e,t);return r}function v(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(y);return T(n,e),n}function y(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function w(e){try{return e.then}catch(t){return se.error=t,se}}function _(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function b(e,t,n){H(function(e){var r=!1,i=_(n,t,function(n){r||(r=!0,t!==n?T(e,n):L(e,n))},function(t){r||(r=!0,O(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,O(e,i))},e)}function A(e,t){t._state===ie?L(e,t._result):t._state===oe?O(e,t._result):M(t,void 0,function(t){return T(e,t)},function(t){return O(e,t)})}function j(e,t,r){t.constructor===e.constructor&&r===d&&t.constructor.resolve===v?A(e,t):r===se?(O(e,se.error),se.error=null):void 0===r?L(e,t):n(r)?b(e,t,r):L(e,t)}function T(e,n){e===n?O(e,m()):t(n)?j(e,n,w(n)):L(e,n)}function E(e){e._onerror&&e._onerror(e._result),R(e)}function L(e,t){e._state===re&&(e._result=t,e._state=ie,0!==e._subscribers.length&&H(R,e))}function O(e,t){e._state===re&&(e._state=oe,e._result=t,H(E,e))}function M(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+ie]=n,i[o+oe]=r,0===o&&e._state&&H(R,e)}function R(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)r=t[s],i=t[s+n],r?S(n,r,i,o):i(o);e._subscribers.length=0}}function k(){this.error=null}function C(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function S(e,t,r,i){var o=n(r),s=void 0,u=void 0,c=void 0,a=void 0;if(o){if(s=C(r,i),s===ue?(a=!0,u=s.error,s.error=null):c=!0,t===s)return void O(t,g())}else s=i,c=!0;t._state!==re||(o&&c?T(t,s):a?O(t,u):e===ie?L(t,s):e===oe&&O(t,s))}function P(e,t){try{t(function(t){T(e,t)},function(t){O(e,t)})}catch(n){O(e,n)}}function x(){return ce++}function N(e){e[ne]=ce++,e._state=void 0,e._result=void 0,e._subscribers=[]}function I(){return new Error("Array Methods must be provided an Array")}function I(){return new Error("Array Methods must be provided an Array")}function q(e){return new ae(this,e).promise}function V(e){var t=this;return new t(G(e)?function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,n=new t(y);return O(n,e),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=fe}var Y=void 0;Y=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G=Y,K=0,W=void 0,z=void 0,H=function(e,t){ee[K]=e,ee[K+1]=t,K+=2,2===K&&(z?z(h):te())},J="undefined"!=typeof window?window:void 0,Q=J||{},X=Q.MutationObserver||Q.WebKitMutationObserver,Z="undefined"==typeof self&&"undefined"!=typeof r&&"[object process]"==={}.toString.call(r),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ee=new Array(1e3),te=void 0;te=Z?u():X?a():$?f():void 0===J&&"function"==typeof e?p():l();var ne=Math.random().toString(36).substring(16),re=void 0,ie=1,oe=2,se=new k,ue=new k,ce=0,ae=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(y),this.promise[ne]||N(this.promise),G(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&L(this.promise,this._result))):O(this.promise,I())}return e.prototype._enumerate=function(e){for(var t=0;this._state===re&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===v){var i=w(e);if(i===d&&e._state!==re)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===fe){var o=new n(y);j(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===re&&(this._remaining--,e===oe?O(r,n):this._result[t]=n),0===this._remaining&&L(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;M(e,void 0,function(e){return n._settledAt(ie,t,e)},function(e){return n._settledAt(oe,t,e)})},e}(),fe=function(){function e(t){this[ne]=x(),this._result=this._state=void 0,this._subscribers=[],y!==t&&("function"!=typeof t&&D(),this instanceof e?P(this,t):U())}return e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(e){var t=this,n=t.constructor;return t.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})},e}();return fe.prototype.then=d,fe.all=q,fe.race=V,fe.resolve=v,fe.reject=B,fe._setScheduler=o,fe._setAsap=s,fe._asap=H,fe.polyfill=F,fe.Promise=fe,fe})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function u(){y&&d&&(y=!1,d.length?v=d.concat(v):m=-1,v.length&&c())}function c(){if(!y){var e=o(u);y=!0;for(var t=v.length;t;){for(d=v,v=[];++m<t;)d&&d[m].run();m=-1,t=v.length}d=null,y=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function f(){}var l,h,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var d,v=[],y=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.push(new a(e,t)),1!==v.length||y||o(c)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.listeners={},this.iName="ApiEvent"}return e.prototype.addListener=function(e,t){"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].indexOf(t)===-1&&this.listeners[e].push(t)},e.prototype.fire=function(e){var t,n,r=0,i=0;if(e.target||(e.target=this),e.context||(e.context=this),this.listeners[e.type]instanceof Array){t=this.listeners[e.type],n=[];var o=void 0;for(i=t.length;r<i;r++)n.push(t[r]);for(;o=n.shift();)t.indexOf(o)!==-1&&o(e)}},e.prototype.removeListener=function(e,t){var n,r=0,i=0;if(this.listeners[e]instanceof Array)for(n=this.listeners[e],r=n.length;i<r;i++){if(null!==t&&n[i]===t){n.splice(i,1);break}null===t&&n.splice(i,1)}},e}();n.ApiEvents=r},{}],4:[function(e,t,n){"use strict";function r(e,t){return e===t}Object.defineProperty(n,"__esModule",{value:!0}),e("es6-promise");var i=e("../../../javascript/system/ts/utils/ApiEvents"),o=function(){function e(){this.isConnected=!1,this.listeners=[],this.listenersBind=[],this.tasks=[],this.isConnected=!1,this.actionReceiver=this.actionReceiver.bind(this),this.apiEvents=new i.ApiEvents}return e.prototype.init=function(){var e=this,t=new Promise(function(t,n){e.ApiReadyResolve=t,e.ApiReadyReject=n});return this.addListener("getConnection",function(t){e.isConnected=!0,t.resolve(),e.ApiReadyResolve(t)}),this.requestConnection(),this.addMessageListeners(),t},e.prototype.call=function(e,t){var n,r,i,o=this;return n={task:e,arguments:t,id:s(),type:"call",responseType:"resolve",responseValue:"",resolve:null,reject:null},i=new Promise(function(e,t){r=Object.assign({},n),r.resolve=e,r.reject=t,o.tasks.push(r)}),this.postMessage(n),i},e.prototype.addListener=function(e,t){var n=function(e){t(e.data)};this.listeners.push(t),this.listenersBind.push(n),this.apiEvents.addListener(e,n)},e.prototype.removeListener=function(e,t){var n=this.listeners,r=this.listenersBind;this.listeners=[],this.listenersBind=[];for(var i=0,o=n.length;i<o;i++)n[i]!==t?(this.listeners.push(n[i]),this.listenersBind.push(r[i])):this.apiEvents.removeListener(e,r[i])},e.prototype.flush=function(){this.removeMessageListeners()},e.prototype.___responseCall=function(e){({task:e.task,arguments:e.arguments,id:e.id,type:"response",responseType:e.responseType,responseValue:e.responseValue})},e.prototype.responseCall=function(e){var t=Object.assign({},e);this.postMessage(Object.assign(t,{resolve:null,reject:null,type:"response"}))},e.prototype.dispatchEvent=function(e){this.apiEvents.fire({type:e.task,data:{arguments:e.arguments,resolve:e.resolve,reject:e.reject}})},e.prototype.postMessage=function(e){return r(window,window.parent)===!0?void this.ApiReadyReject("there is no child or parent window"):void window.parent.postMessage(e,"*")},e.prototype.requestConnection=function(){var e=this;this.call("getConnection","Reader try to make connection with backoffice").then(function(t){e.isConnected=!0,e.ApiReadyResolve(t)})},e.prototype.addMessageListeners=function(){window.addEventListener("message",this.actionReceiver,!1)},e.prototype.removeMessageListeners=function(){window.removeEventListener("message",this.actionReceiver,!1)},e.prototype.actionReceiver=function(e){var t,n,i,o=this;if(!r(window.parent,e.source)||e.data instanceof Object==!1)return void console.log("Receive canceled message",e);if(i=e.data,t=this.tasks.length,this.tasks=this.tasks.filter(function(e){return e.id!==i.id?e:void("resolve"===i.responseType?e.resolve(i.arguments):e.reject(i.responseValue))}),t===this.tasks.length){if("response"===i.type)return;n=new Promise(function(e,t){i.resolve=e,i.reject=t}),n.then(function(e){i.arguments=e,i.responseType="resolve",i.responseValue="",o.responseCall(i)})["catch"](function(e){i.arguments=[],i.responseType="reject",i.responseValue=e,o.responseCall(i)}),this.dispatchEvent(i)}},e}(),s=function(){var e=0;return function(){return"reader-"+e++ +Date.now()}}();n["default"]=o},{"../../../javascript/system/ts/utils/ApiEvents":3,"es6-promise":1}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ReaderApi");!function(){var e=new Promise(function(e){window.addEventListener("webpub-show",function(){e()})});e.then(function(){var e=new r["default"];e.init().then(function(t){console.log("Reader connected with backoffice"),e.addListener("styleSheet.getObject",function(e){try{e.resolve(NIApi.styleSheet.getObject())}catch(t){e.reject(t)}}),e.addListener("styleSheet.reParse",function(e){try{NIApi.styleSheet.reParse(e.arguments[0]),e.resolve(NIApi.styleSheet.getObject())}catch(t){e.reject(t)}}),e.addListener("brand.logo.getObject",function(e){try{NIApi.menu.ready().then(function(){e.resolve(NIApi.styleSheet.logoGetObject())})}catch(t){e.reject(t)}}),e.addListener("brand.logo.update",function(e){try{NIApi.menu.ready().then(function(){e.resolve(NIApi.styleSheet.logoUpdate(e.arguments[0]))})}catch(t){e.reject(t)}})})["catch"](function(e){console.log(e)})})}()},{"./ReaderApi":4}]},{},[5]);